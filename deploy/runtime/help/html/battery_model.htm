<!DOCTYPE HTML>
<html>
<head>
   <title>Battery Storage</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   
   <meta http-equiv="X-UA-Compatible" content="IE=edge" />
   <link type="text/css" href="default.css" rel="stylesheet" />
   <style type="text/css">
     body { margin: 0px; background: #FFFFFF; }
   </style>
   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>

   <script type="text/javascript">
     HMSyncTOC("index.html", "battery_model.htm");
   </script>
   <script type="text/javascript" src="highlight.js"></script>
   <script type="text/javascript">
     $(document).ready(function(){highlight();});
   </script>
</head>
<body>


<table style="width:100%; border:none; border-spacing:0px; padding:5px; background:#FFFFFF; color:#0072C6;">
  <tr style="vertical-align:middle">
    <td style="text-align:left">
      <h1 class="p_Heading1"><span class="f_Heading1">Battery Storage</span></h1>

    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table style="width:100%;border:none;border-spacing:0px"><tr style="vertical-align:top"><td style="text-align:left;padding:5px">
<p class="p_Text"><span class="f_Text">The battery storage model provides a way to analyze the performance of lead-acid and lithium-ion batteries. &nbsp;Important factors contributing to battery performance, such as voltage variation with charge state, capacity fade with cycling, and temperature effects on capacity are modelled with the goal of giving a realistic picture of how a battery will perform and degrade over time. &nbsp;The inputs for most of the models were chosen with the goal of providing simple, but sufficiently detailed options for users of varying degrees of interest and expertise. Many of the inputs will be available on typical manufacturer data sheets. &nbsp;For other inputs, reasonable default parameters have been set depending on battery chemistry. The user is provided a manual dispatch controller to tailor when and how to use the battery to meet the electric load.</span></p>
<p class="p_Text"><span style="font-size: 11pt; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif;">For details about the implementation of SAM's battery model, see DiOrio, N.; Dobos, a.; (DRAFT 2015). &quot;SAM Battery Storage and &nbsp;Dispatch,&quot; available on the <a href="https://sam.nrel.gov/reference" target="_blank" class="weblink" title="https://sam.nrel.gov/reference">Performance Model Documentation</a> page of the SAM website.</span></p>
<p class="p_Text"><span style="font-size: 11pt; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif;">For general information about batteries and the one of the references used to develop this model, see Linden, D.; Reddy, T.; (2011).</span><span style="font-size: 11pt; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif; font-style: italic;"> Linden's Handbook of Batteries</span><span style="font-size: 11pt; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif;">. 4th edition. New York: McGraw Hill.</span></p>
<p style="line-height: 1.38; margin: 0px 0px 13px 0px;"><span style="font-size: 11pt; font-family: Calibri,Vectora,'Droid Sans','Open Sans',Frutiger,sans-serif;">DiOrio, N.; Dobos, A. SAM Battery Storage and Dispatch (forthcoming, will be posted on <a href="https://sam.nrel.gov/performance" target="_blank" class="weblink" title="https://sam.nrel.gov/performance">SAM website</a> when available.)</span></p>
<p class="p_TitleProcedure" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_TitleProcedure">To model a photovoltaic system with battery storage:</span></p>
<p style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 24px; margin: 0px 0px 3px 24px;"><span style="font-size:10pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:24px;margin-left:-24px">&#8226;</span><span class="f_ProcedureStep">On the Battery Storage page, choose Enable battery.</span></p><p class="p_ProcedureStepNoNumber"><img alt="SS_Battery-ChooseModel" width="161" height="101" style="margin:0;width:161px;height:101px;border:none" src="ss_battery-choosemodel.gif"/></p>
<h4 class="p_Heading4"><span class="f_Heading4">Battery Bank Configuration</span></h4>
<p class="p_Text"><span class="f_Text">There a few common ways batteries may be integrated into a system. &nbsp;In a DC-connected system, batteries are connected to the DC side of a PV panel. &nbsp;In an AC-connected system, the battery is connected after the inverter.</span></p>
<p class="p_VariableName" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_VariableName">DC Connected</span></p>
<p class="p_VariableDescription"><span class="f_CHInterfaceElement">DC to DC conversion efficiency</span><span class="f_VariableDescription"> A loss applied while feeding energy from the PV to the battery via any charge regulator or controller. &nbsp;This loss is applied as energy goes to and from the battery.</span></p>
<p class="p_VariableName" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_VariableName">AC Connected</span></p>
<p class="p_VariableDescription"><span class="f_CHInterfaceElement">AC to DC conversion efficiency</span><span class="f_VariableDescription"> &nbsp;A loss applied as the battery internally converts input AC power to DC for storage. &nbsp;This efficiency is applied as energy comes into the battery.</span></p>
<p class="p_VariableDescription"><span class="f_CHInterfaceElement">DC to AC conversion efficiency</span><span class="f_VariableDescription"> &nbsp;A loss applied as the battery internally inverts DC power to AC to meet the load. &nbsp;This efficiency is applied as energy leaves the battery.</span></p>
<h4 class="p_Heading4"><span class="f_Heading4">Battery Bank Sizing</span></h4>
<p class="p_Text"><span class="f_Text">From an end-use perspective, the most important aspects of any PV battery system are the bank capacity, voltage, and power rating. &nbsp;SAM allows a user to either specify the desired bank size or individual cells.</span></p>
<p class="p_VariableName" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_VariableName">Specify desired bank size</span></p>
<p class="p_VariableDescription">If this option is selected, enter the desired bank capacity in kWh and the desired bank voltage in V. &nbsp;SAM will add cells in series until the bank voltage is met or slightly exceeded, using the “Cell nominal voltage” input in the <span style="font-style: italic;">Voltage Properties</span> section. &nbsp;So for instance, if the desired bank voltage is 24V, and the cell nominal voltage is set to 3.6V, 7 cells will be added series to yield an actual bank voltage of 25.2V.  </p>
<p class="p_VariableDescription">The desired bank capacity will be met by adding strings of cells in parallel. &nbsp;Cell capacity is specified in the <span style="font-style: italic;">Current and Capacity</span> section, in the “Fully charged” row under “Cell Capacity”. &nbsp;Using the same example, if the desired bank capacity is 3kWh, the fully charged cell capacity is 1.5Ah, and the computed bank voltage is 25.2V, then one string of cells has a capacity of 25.2V × 1.5Ah = 37.8 Wh, or 0.0378 kWh. To reach 3 kWh, 79 more strings must be added in parallel. SAM does not make decisions on whether adding so many strings in parallel is a good design decision or not, it simply attempts to reach the desired bank capacity given the specified cell properties.</p>
<p class="p_VariableName" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_VariableName">Specify cells</span></p>
<p class="p_VariableDescription">If this option is selected, SAM will by-pass the process of computing the number of cells in series and parallel based on desired bank size and voltage. <span style="font-style: italic;">Nominal bank voltage</span> is computed as <span style="font-style: italic;">nominal bank voltage × fully charged cell capacity × number of strings.</span></p>
<h4 class="p_Heading4"><span class="f_Heading4">Chemistry</span></h4>
<p class="p_Text">Rather than maintain an ever-changing list of batteries to choose from, SAM seeks to provide reasonable default parameters for common stationary battery chemistries. Toggling between Lead Acid and Lithium Ion will change portions of the algorithms used to compute battery capacity. Toggling between specific types of batteries within a chemistry does not affect any of the underlying algorithms, but rather gives the user the option to populate the fields with default values selected from battery reference literature [1]. &nbsp;Only secondary batteries (“rechargeable” batteries which can undergo charge and discharge cycles) are considered. By choosing either Lead Acid: Custom or Lithium Ion: Custom, no defaults will be changed. Selection of any other option will prompt for whether to change the defaults or not. Upon changing the defaults, one still can manually update fields as desired.</p>
<p class="p_VariableName" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_VariableName">Lead Acid</span></p>
<p class="p_VariableDescription"><span class="f_VariableDescription">Selection of lead acid battery type enables the lead-acid specific capacity model described in [2]. Specific lead-acid battery types that are commonly available for PV coupled storage are:</span></p>
<p style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 13px; margin: 0px 0px 6px 24px;"><span style="font-size:10pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_VariableDescription">Flooded lead acid batteries – These batteries have a liquid electrolyte</span></p><p style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 13px; margin: 0px 0px 6px 24px;"><span style="font-size:10pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_VariableDescription">Valve Regulated (VRLA) Gel – These sealed batteries have the electrolyte bound in a gel form. </span></p><p style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 13px; margin: 0px 0px 6px 24px;"><span style="font-size:10pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_VariableDescription">VRLA Absorptive Glass Mat (AGM) – These sealed batteries immobilize the electrolyte in porous separators. </span></p><p class="p_VariableDescription">Lead acid capacity is highly dependent on the current discharge rate. Toggling between the three available lead-acid chemistries changes internal defaults regarding the relation between capacity and discharge rate. The default values for these chemistries were selected by compiling information from multiple batteries across various manufacturers. SAM considers the 20-hour discharge rate as the nominal capacity of a stationary lead-acid battery and scales the capacity at faster discharge rates as a percent of the 20-hour capacity. The default values programmed into SAM are:</p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 6px 24px;"><table style="border:none; border-spacing:0px;">
<thead>
<tr style="text-align:left;vertical-align:top;">
<th style="vertical-align:top; padding:0px;"><p class="p_TableHeadColumn" style="page-break-inside: avoid;"><span class="f_TableHeadColumn">Discharge Rate</span></p>
</th>
<th style="vertical-align:top; padding:0px;"><p class="p_TableHeadColumn" style="page-break-inside: avoid;"><span class="f_TableHeadColumn">Flooded: Capacity %</span></p>
</th>
<th style="vertical-align:top; padding:0px;"><p class="p_TableHeadColumn" style="page-break-inside: avoid;"><span class="f_TableHeadColumn">VRLA Gel: Capacity %</span></p>
</th>
<th style="vertical-align:top; padding:0px;"><p class="p_TableHeadColumn" style="page-break-inside: avoid;"><span class="f_TableHeadColumn">VRLA AGM: Capacity %</span></p>
</th>
</tr>
</thead>
<tbody>
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; padding:0px;"><p class="p_TableTextCenter" style="page-break-inside: avoid;"><span class="f_TableTextCenter">20-hr ( 0.05 C)</span></p>
</td>
<td style="vertical-align:top; padding:0px;"><p class="p_TableTextCenter" style="page-break-inside: avoid;"><span class="f_TableTextCenter">100</span></p>
</td>
<td style="vertical-align:top; padding:0px;"><p class="p_TableTextCenter" style="page-break-inside: avoid;"><span class="f_TableTextCenter">100</span></p>
</td>
<td style="vertical-align:top; padding:0px;"><p class="p_TableTextCenter" style="page-break-inside: avoid;"><span class="f_TableTextCenter">100</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; padding:0px;"><p class="p_TableTextCenter" style="page-break-inside: avoid;"><span class="f_TableTextCenter">10-hr (0.1C)</span></p>
</td>
<td style="vertical-align:top; padding:0px;"><p class="p_TableTextCenter" style="page-break-inside: avoid;"><span class="f_TableTextCenter">87</span></p>
</td>
<td style="vertical-align:top; padding:0px;"><p class="p_TableTextCenter" style="page-break-inside: avoid;"><span class="f_TableTextCenter">84.9</span></p>
</td>
<td style="vertical-align:top; padding:0px;"><p class="p_TableTextCenter" style="page-break-inside: avoid;"><span class="f_TableTextCenter">93.2</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; padding:0px;"><p class="p_TableTextCenter" style="page-break-inside: avoid;"><span class="f_TableTextCenter">1-hr (C)</span></p>
</td>
<td style="vertical-align:top; padding:0px;"><p class="p_TableTextCenter" style="page-break-inside: avoid;"><span class="f_TableTextCenter">47</span></p>
</td>
<td style="vertical-align:top; padding:0px;"><p class="p_TableTextCenter" style="page-break-inside: avoid;"><span class="f_TableTextCenter">63.1</span></p>
</td>
<td style="vertical-align:top; padding:0px;"><p class="p_TableTextCenter" style="page-break-inside: avoid;"><span class="f_TableTextCenter">58.1</span></p>
</td>
</tr>
</tbody>
</table>
</div>
<p class="p_VariableDescription">These percent values provide kinetic information to the internal lead-acid model. At this time, it is not possible to change these values through the SAM UI.</p>
<p class="p_VariableName" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_VariableName">Lithium Ion</span></p>
<p class="p_VariableDescription"><span class="f_VariableDescription">Selection of the lithium ion chemistry causes use of the lithium-ion specific capacity model described in [2]. Specific chemistries of lithium-ion battery types provided in SAM are:</span></p>
<p style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 13px; margin: 0px 0px 6px 24px;"><span style="font-size:10pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_VariableDescription">LMO: Lithium Manganese Oxide (<img alt="EQ_BATT_lmo" width="50" height="16" style="margin:0;width:50px;height:16px;border:none" src="eq_batt_lmo.gif"/>) – An inexpensive high-voltage cathode material with high power capabilities but potentially lower lifespan.</span></p><p style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 13px; margin: 0px 0px 6px 24px;"><span style="font-size:10pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_VariableDescription">LFP: Lithium Iron Phosphate (<img alt="EQ_BATT_lfp" width="54" height="16" style="margin:0;width:54px;height:16px;border:none" src="eq_batt_lfp.gif"/> – A lower voltage cathode material with excellent safety properties but lower volumetric energy.</span></p><p style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 13px; margin: 0px 0px 6px 24px;"><span style="font-size:10pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_VariableDescription">LCO: Lithium Cobalt Oxide (<img alt="EQ_BATT_lco" width="47" height="16" style="margin:0;width:47px;height:16px;border:none" src="eq_batt_lco.gif"/> – Among the first and still a common cathode material with high specific energy, but potentially costly and toxic.</span></p><p style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 13px; margin: 0px 0px 6px 24px;"><span style="font-size:10pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_VariableDescription">LTO: Lithium Titanate (<img alt="EQ_BATT_lto" width="61" height="16" style="margin:0;width:61px;height:16px;border:none" src="eq_batt_lto.gif"/> – A promising anode material with excellent lifetime properties but lower specific capacity and important cost considerations.</span></p><p style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 13px; margin: 0px 0px 6px 24px;"><span style="font-size:10pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_VariableDescription">NMC: Nickel Manganese Cobalt (<img alt="EQ_BATT_nmc" width="80" height="16" style="margin:0;width:80px;height:16px;border:none" src="eq_batt_nmc.gif"/> – A less expensive cathode material than LCO with potentially improved safety characteristics</span></p><p style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 13px; margin: 0px 0px 6px 24px;"><span style="font-size:10pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_VariableDescription">NCA: Nickel Cobalt Aluminum (<img alt="EQ_BATT_nca" width="73" height="16" style="margin:0;width:73px;height:16px;border:none" src="eq_batt_nca.gif"/> – Similar in respects to NMC as a cathode material with high specific energy</span></p><p class="p_VariableDescription"><span class="f_VariableDescription">Selection of one of these chemistries changes the defaults of the voltage, lifetime, and thermal properties on the page without affecting internal modeling algorithms. Defaults were selected from battery references [1] and manufacturer data sheets where necessary. </span></p>
<h4 class="p_Heading4"><span class="f_Heading4">Voltage Properties</span></h4>
<p class="p_Text"><span class="f_Text">Battery voltage varies with charge state as the internal open circuit potential decreases or increases. When a battery charges, positive ions travel from the cathode to the anode, lowering the open circuit potential of the anode and increasing the open circuit potential of the cathode, resulting in a net increase of potential between the anode and cathode. Similarly, as a battery discharges, ions flow back from the anode to the cathode, reducing the net potential. Battery data sheets typically report a voltage-discharge curve of some kind to illustrate this behavior. SAM uses a dynamic voltage model, which specifies how to extract information from a data sheet to populate the voltage discharge curve. This process will be explained below. </span></p>
<p class="p_Text"><span class="f_Text">Also note that voltage variations in charging and discharging contribute to round-trip efficiency. During charging, voltage increases, requiring more power to charge the cell. During discharge the voltage decreases and less power can be extracted. The round-trip efficiency is computed as the net amount of energy discharged from a cell divided by how much energy it took to charge the cell.</span></p>
<p class="p_VariableName" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_VariableName">Cell nominal voltage</span></p>
<p class="p_VariableDescription"><span class="f_VariableDescription">The reported voltage for a given cell type. Lead acid cells typically have a cell voltage of 2V, whereas Lithium ion cells have nominal voltages around 3.7V. This quantity is used to size the battery bank and compute the Nominal bank voltage.</span></p>
<p class="p_VariableName" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_VariableName">Internal resistance</span></p>
<p class="p_VariableDescription"><span class="f_VariableDescription">The reported internal resistance for the battery in Ohms. &nbsp;This value is assumed constant and is used both for voltage calculations as well as thermal calculations.</span></p>
<p class="p_VariableName" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_VariableName">C-rate of discharge curve</span></p>
<p class="p_VariableDescription"><span class="f_VariableDescription">Battery manufacturers data sheets typically come with a curve detailed the cell voltage as a function of charge removed, and report several different curves depending on the discharge rate. The “C-rate” is the current used to discharge the battery. It is defined as the current divided by the rated capacity. So if the discharge current is at the 20-hour discharge rate, the “C-rate” is</span><span class="f_CHEquationVariable"> I</span><span class="f_CHEquationVariable" style="font-size: 7pt; vertical-align: sub;">20</span><span class="f_CHEquationVariable"> ÷ q</span><span class="f_CHEquationVariable" style="font-size: 7pt; vertical-align: sub;">20</span><span class="f_CHEquationVariable"> × C = 0.05 × C (C/20)</span><span class="f_VariableDescription">. </span></p>
<p style="text-align: center; margin: 0px 0px 6px 0px;"><img alt="IMG_BATT-DischargeCurve" width="469" height="371" style="margin:0px auto 0px auto;width:469px;height:371px;border:none" src="img_batt-dischargecurve.gif"/></p>
<p class="p_VariableName" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_VariableName">Fully charged: Cell Voltage</span></p>
<p class="p_VariableDescription"><span class="f_VariableDescription">The voltage at the given C-rate when a cell is at its maximum charge</span></p>
<p class="p_VariableName" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_VariableName">Fully charged: Cell Capacity</span></p>
<p class="p_VariableDescription"><span class="f_VariableDescription">The capacity at the given C-rate when the cell is fully charged </span></p>
<p class="p_VariableName" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_VariableName">Cell voltage, Cell charge removed </span></p>
<p class="p_VariableDescription"><span class="f_VariableDescription">Voltage vs discharge curves show that cell-voltage typically undergoes several distinct regions depending on charge. </span></p>
<p class="p_VariableDescription"><span class="f_CHInterfaceElement">Exponential Zone</span><span class="f_VariableDescription">: As seen in the plot below, enter the cell voltage at the end of the exponential zone. The cell charge removed at this point is </span><img alt="EQ_BATT_Exponential" width="54" height="20" style="margin:0;width:54px;height:20px;border:none" src="eq_batt_exponential.gif"/><span class="f_VariableDescription">. </span></p>
<p class="p_VariableDescription"><span class="f_CHInterfaceElement">Nominal Zone</span><span class="f_VariableDescription">: As seen in the plot below, enter the cell voltage at the end of the nominal zone. The cell charge removed at this point is </span><img alt="EQ_BATT_Nominal" width="54" height="20" style="margin:0;width:54px;height:20px;border:none" src="eq_batt_nominal.gif"/></p>
<p class="p_TextCenter"><img alt="IMG_BATT-NominalDischargeCharacteristic" width="563" height="343" style="margin:0px auto 0px auto;width:563px;height:343px;border:none" src="img_batt-nominaldischargecharacteristic.gif"/></p>
<h4 class="p_Heading4"><span class="f_Heading4">Current Capacity</span></h4>
<p class="p_VariableName" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_VariableName">Cell capacity</span></p>
<p class="p_VariableDescription"><span class="f_VariableDescription">The cell capacity when fully charged.</span></p>
<p class="p_VariableName" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_VariableName">Max C-rate charge</span></p>
<p class="p_VariableDescription"><span class="f_VariableDescription">Batteries typically have some limits based on chemistry for how much power can be input during charging or extracted during discharging. </span>Recall, the C-rate is the current divided by the nominal capacity at that current. A one-hour discharge rate is 1C, whereas a half hour is 2C and two hours is 0.5C.<span class="f_VariableDescription"> If this value is reported on a battery data sheet in units of power, then compute the C-rate either as:</span></p>
<p class="p_VariableDescription"><span class="f_VariableDescription">C = P ÷ (Vnom × Qnom)</span></p>
<p class="p_VariableDescription"><span class="f_VariableDescription">C = P ÷ Ebatt</span></p>
<p class="p_VariableDescription"><span class="f_VariableDescription">Where,</span></p>
<p class="p_VariableDescription"><span class="f_VariableDescription">P = power limit in units of W</span></p>
<p class="p_VariableDescription"><span class="f_VariableDescription">Vnom = the nominal voltage of the battery bank in V</span></p>
<p class="p_VariableDescription"><span class="f_VariableDescription">Qnom = nominal charge of battery bank in Ah</span></p>
<p class="p_VariableDescription"><span class="f_VariableDescription">Ebatt = nominal bank capacity in Wh</span></p>
<p class="p_VariableDescription"><span class="f_VariableDescription">The battery thermal model also considers current flow as a primary mechanism for battery heating. Reducing the maximum current charge and discharge is one strategy to reduce thermal losses and improve battery efficiency.</span></p>
<p class="p_VariableName" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_VariableName">Max C-rate discharge</span></p>
<p class="p_VariableDescription"><span class="f_VariableDescription">Enter the maximum allowed C-rate of discharge.</span></p>
<p class="p_VariableName" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_VariableName">Computed properties</span></p>
<p class="p_VariableDescription"><span class="f_CHInterfaceElement">Nominal bank capacity</span><span class="f_VariableDescription"> Computed as the total number of cells multiplied by the fully charged cell capacity.</span></p>
<p class="p_VariableDescription"><span class="f_CHInterfaceElement">Nominal bank voltage</span><span class="f_VariableDescription"> Computed as the number of cells in series multiplied by the cell nominal voltage</span></p>
<p class="p_VariableDescription"><span class="f_CHInterfaceElement">Cells in series</span><span class="f_VariableDescription"> Either computed based on the cell nominal voltage and desired bank voltage, or specified as user input</span></p>
<p class="p_VariableDescription"><span class="f_CHInterfaceElement">Cells in parallel</span><span class="f_VariableDescription"> Either computed based on the number of cells in series, fully charged cell capacity and desired bank capacity, or specified as user input. Note the number of cells in parallel must be divisible by the number of cells in series, as cells in parallel are added as strings.</span></p>
<p class="p_VariableDescription"><span class="f_CHInterfaceElement">Max charge current</span><span class="f_VariableDescription"> Computed from Max C-rate charge as Max current = 1000*Max C-rate charge * Nominal bank capacity/Nominal bank voltage.</span></p>
<p class="p_VariableDescription"><span class="f_CHInterfaceElement">Max discharge current</span><span class="f_VariableDescription"> Computed from Max C-rate discharge as Max current = 1000*Max C-rate discharge * Nominal bank capacity/Nominal bank voltage.</span></p>
<h4 class="p_Heading4"><span class="f_Heading4">Battery Lifetime</span></h4>
<p class="p_Text"><span class="f_Text">The lifetime model currently considers battery cycling as the primary cause of capacity degradation, though future improvements may include the addition of calendar losses and thermal damage. </span></p>
<p class="p_VariableName" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_VariableName">Replace batteries at</span></p>
<p class="p_VariableDescription"><span class="f_VariableDescription">This box, if checked, allows the user to replace batteries as they reach a certain capacity degradation. For instance, if cycling has damaged the battery such that it can only maintain a charge of 70% the original capacity, the user can replace the battery at this point, or wait until the battery can maintain no charge (0%). If this box is not selected and the battery fails during the simulation, subsequent time steps will be treated as if there is no battery. </span>Due to simulation issues as the battery maximum capacity approaches 0% of its original capacity, an internal minimum cutoff of 2% is used as replacement criterion.</p>
<p style="line-height: 1.38; margin: 0px 0px 13px 0px;">The model relies on information about capacity fade at the number of cycles elapsed at an average depth of discharge. For the most comprehensive analysis, it is recommended to enter two or three triplets of information for two or three depths of discharge. As an example of a comprehensive input, consider the battery data sheet diagram:</p>
<p class="p_TextCenter"><img alt="IMG_BATT-LifeVSDepthDischarge" width="600" height="417" style="margin:0px auto 0px auto;width:600px;height:417px;border:none" src="img_batt-lifevsdepthdischarge.gif"/></p>
<p class="p_Text"><span class="f_Text">This information would be entered into the SAM UI as:</span></p>
<p class="p_TextCenter"><img alt="IMG_Batt-LifeToSAM" width="681" height="239" style="margin:0px auto 0px auto;width:681px;height:239px;border:none" src="img_batt-lifetosam.gif"/></p>
<p class="p_Text"><span class="f_Text">Some battery data sheets do not report comprehensive information about cycle life vs. depth of discharge. For these batteries, the provided defaults can be used. At least rows of information must be provided. When multiple depths of discharge are entered, a bilinear interpolation is done to consider both the average depth-of-discharge and cycle number when applying the capacity fade. If information is only entered at one depth-of-discharge, then only the cycle number will be considered when assessing capacity fade, as interpolation between multiple depths-of-discharge is not possible. Cycles are counted using a common rainflow counting procedure.</span></p>
<h4 class="p_Heading4"><span class="f_Heading4">Manual Storage Dispatch Controller</span></h4>
<p class="p_Text"><span class="f_Text">The manual storage dispatch controller determines how the battery is charged from the grid or photovoltaic (PV) array and how it discharges to meet the load.</span></p>
<p class="p_Note"><span class="f_CHNote">Notes.</span><span class="f_Note"> </span><br />
<span class="f_Note">&nbsp;</span><br />
<span class="f_Note">You must define how the battery charges and discharges by hand using the manual storage dispatch controller inputs. SAM does not make any automatic decisions about how to operate the battery. You may want to use the information on the <a href="electricity_rates.htm" class="topiclink">Electricity Rates</a> page to help you choose how to define the controller inputs.</span><br />
<span class="f_Note">&nbsp;</span><br />
<span class="f_Note">We hope to include some automatic controls in a future version of SAM. For now you can use <a href="parametrics.htm" class="topiclink">parametric simulations</a> and or write an <a href="macros.htm" class="topiclink">LK script</a> to optimize the battery's operation.</span><br />
<span class="f_Note">&nbsp;</span><br />
<span class="f_Note">The controller uses hours to define periods, even for subhourly simulations.</span></p>
<p class="p_Text" style="text-align: center;"><img alt="IMG_BATT-Dispatch" width="624" height="255" style="margin:0px auto 0px auto;width:624px;height:255px;border:none" src="img_batt-dispatch.gif"/></p>
<p class="p_VariableName" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_VariableName">Charge from grid</span></p>
<p class="p_VariableDescription"><span class="f_VariableDescription">Select the </span><span class="f_CHInterfaceElement">Charge from grid</span><span class="f_VariableDescription"> check box to allow the battery to charge from the grid in the given period.</span></p>
<p class="p_VariableDescription"><span class="f_VariableDescription">If the </span><span class="f_CHInterfaceElement">Charge from grid</span><span class="f_VariableDescription"> and </span><span class="f_CHInterfaceElement">Charge from PV</span><span class="f_VariableDescription"> check boxes are both selected and the PV array output is greater than the <a href="electric_load.htm" class="topiclink">load</a>, the grid supplements the PV array: all available excess PV electricity charges the battery and the grid meets the remaining charge requirement.</span></p>
<p class="p_VariableDescription"><span class="f_VariableDescription">If the </span><span class="f_CHInterfaceElement">Charge from grid</span><span class="f_VariableDescription"> and </span><span class="f_CHInterfaceElement">Allow discharging</span><span class="f_VariableDescription"> check boxes are both selected and the battery state of charge is above the minimum state of charge, the battery discharges until it reaches the minimum state of charge, at which point it starts charging from the grid, either until it reaches the maximum state of charge, or until the time period changes to one that does not allow charging from the grid.</span></p>
<p class="p_VariableName" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_VariableName">Charge from PV</span></p>
<p class="p_VariableDescription"><span class="f_VariableDescription">Select the </span><span class="f_CHInterfaceElement">Charge from PV</span><span class="f_VariableDescription"> check box to allow the PV array to charge the battery when the PV array output exceeds the load.</span></p>
<p class="p_VariableName" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_VariableName">Allow discharging</span></p>
<p class="p_VariableDescription"><span class="f_VariableDescription">Select the </span><span class="f_CHInterfaceElement">Allow discharging</span><span class="f_VariableDescription"> check box to allow available battery power to meet the <a href="electric_load.htm" class="topiclink">load</a>.</span></p>
<p class="p_VariableName" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_VariableName">% capacity to discharge</span></p>
<p class="p_VariableDescription"><span class="f_VariableDescription">If the </span><span class="f_CHInterfaceElement">Allow discharging</span><span class="f_VariableDescription"> check box is selected for a given Period, type a percentage to specify how much of the battery's available charge the system can dispatch. The available charge is defined by the minimum and maximum state of charge. Use this value to limit the rate of discharge over consecutive hours in the period.</span></p>
<p class="p_VariableDescription"><span class="f_VariableDescription">For example, in the screenshot above, For Period 3, the capacity to discharge is 25%, the available charge is limited by the 30% and 96% minimum and maximum state of charge and by the battery's state of charge at the beginning of the period. The period is for four consecutive hours between 3 pm and 6 pm. </span></p>
<p class="p_VariableDescription"><span class="f_VariableDescription">For an hourly simulation, that would allow up to 25% of the charge the battery holds at the beginning of the 3 pm hour to be discharged over the hour. For the 4 pm hour, 25% of the charge at the end of the 3 pm hour would be available, and so on until the end of Period 3. The 25% value would discharge the battery over the full four-hour period. (A 20% value would have the same effect for a 5-hour period, i.e., if Period 3 were between 3 pm and 7 pm.)</span></p>
<p class="p_VariableDescription"><span class="f_VariableDescription">For a one-minute simulation, a capacity to discharge of 25% would allow up to 25% of the available charge to be dispatched </span><span class="f_Emphasis">every minute</span><span class="f_VariableDescription"> over Period 3, so a smaller percentage would be required to allow the battery to discharge over the full four-hour period.</span></p>
<p class="p_VariableName" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_VariableName">Minimum state of charge</span></p>
<p class="p_VariableDescription"><span class="f_VariableDescription">This value sets a limit on how much energy can be discharged from the battery. Battery lifetime is highly dependent on depth-of-discharge, so this value should be set based on your battery chemistry and desired performance over time.</span></p>
<p class="p_VariableName" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_VariableName">Maximum state of charge</span></p>
<p class="p_VariableDescription"><span class="f_VariableDescription">This value sets a limit on how much energy can be drained from the battery. &nbsp;Battery lifetime is highly dependent on depth-of-discharge, so this value should be set based on your battery chemistry and desired performance over time.</span></p>
<p class="p_VariableName" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_VariableName">Minimum time at charge state</span></p>
<p class="p_VariableDescription"><span class="f_VariableDescription">For sub-hourly simulations, there may be periods of time where the amount of PV production exceeds electric load, but then dips to where load exceeds PV production. These swings can result in rapid cycling of the battery which may degrade performance over time, particularly if the cycles are deep. This setting will only allow a battery to change between charging and discharging every n minutes. </span></p>
<h4 class="p_Heading4"><span class="f_Heading4">Thermal Behavior </span></h4>
<p class="p_Text"><span class="f_Text">The thermal model computes the battery temperature, which modifies the battery capacity. The system configuration assumes that the battery is stored in a conditioned room at some given temperature and is not directly affected by solar insolation. The two main heat-transfer terms are transfer to/from the room, and internal energy generation via resistive heating.</span></p>
<p class="p_VariableName" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_VariableName">Heat transfer</span></p>
<p class="p_VariableDescription"><span class="f_CHInterfaceElement">Battery Cp</span><span class="f_VariableDescription"> Estimated specific heat capacity for the battery</span></p>
<p class="p_VariableDescription"><span class="f_CHInterfaceElement">Battery h</span><span class="f_VariableDescription"> Estimated heat transfer coefficient from the battery to the room</span></p>
<p class="p_VariableDescription"><span class="f_CHInterfaceElement">Room temperature</span><span class="f_VariableDescription"> Temperature of the room where the battery will be stored</span></p>
<p class="p_VariableName" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_VariableName">Capacity fade with temperature</span></p>
<p class="p_VariableDescription"><span class="f_VariableDescription">Many manufacturers’ data sheets include battery capacity vs. temperature, showing that as temperature decreases, the relative battery capacity decreases as well. So, if at 32°F, the capacity is 85% of nominal, the capacity percent would be entered as 85%.</span></p>
<p class="p_VariableName" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_VariableName">Physical properties</span></p>
<p class="p_VariableDescription"><span class="f_VariableDescription">In order to scale battery mass and surface area as the battery bank is sized, properties are entered on a per Wh basis.</span></p>
<p class="p_VariableDescription"><span class="f_CHInterfaceElement">Specific energy per mass</span><span class="f_VariableDescription"> Energy content per unit mass</span></p>
<p class="p_VariableDescription"><span class="f_CHInterfaceElement">Surface energy per volume</span><span class="f_VariableDescription"> Energy content per unit volume</span></p>
<p class="p_VariableDescription"><span class="f_VariableDescription">Given these two properties, approximate battery length, width, height and mass are computed.</span></p>
<h3 class="p_Heading3_atocs_" style="page-break-inside: avoid; page-break-after: avoid; border-top: none; border-right: none; border-left: none;"><span class="f_Heading3_atocs_">Battery Macro</span></h3>
<p style="line-height: 1.38; margin: 0px 0px 13px 0px;">The Battery Financials <a href="macros.htm" class="topiclink">macro</a> calculates the cost and value of three scenarios based on the inputs in the current case. The macro runs lifetime simulations to show metrics for a scenario with no system where the entire building load is met by grid power, a scenario with a photovoltaic system but no batter, and a scenario with photovoltaic system with battery.</p>
<p class="p_Text"><span class="f_Text">The primary purpose of the macro is to allow quick evaluation of a battery system against just a PV system or no system and illustrate which specific charges are reduced, and which are increased. &nbsp; In the simulation above, the PV+Battery system has reduced electricity charges considerable over the 25 year analysis period; however capital and replacement costs coupled with operation and maintenance costs coupled with the nominal discount rate yield a result where No System is the most attractive option. &nbsp;Additional costs and benefits may eventually be added to yield a more realistic evaluation.</span></p>
<p style="line-height: 1.38; margin: 0px 0px 13px 0px;">To run the macro, set up a case for the photovoltaic system with battery, and then click <span class="f_CHInterfaceElement">Macros</span> (in the lower left corner of the SAM window) &nbsp;and choose Battery Financials to show the macro. Click <span class="f_CHInterfaceElement">Run macro</span> to run the macro.</p>
<p style="text-align: center; line-height: 1.38; margin: 0px 0px 13px 0px;"><img alt="SS_Battery-Macro" width="433" height="432" style="margin:0px auto 0px auto;width:433px;height:432px;border:none" src="ss_battery-macro.gif"/></p>

</td></tr></table>

</body>
</html>
