<!DOCTYPE html>
<html>
<head>
   <title>Weather Data and LK</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   
   <meta http-equiv="X-UA-Compatible" content="IE=edge" />
   <link type="text/css" href="default.css" rel="stylesheet" />
   <style type="text/css">
     body { margin: 0px; background: #FFFFFF; }
   </style>
   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>

   <script type="text/javascript">
     HMSyncTOC("index.html", "accessing-weather-data-from-lk.htm");
   </script>
   <script type="text/javascript" src="highlight.js"></script>
   <script type="text/javascript">
     $(document).ready(function(){highlight();});
   </script>
</head>
<body>


<table style="width:100%; border:none; border-spacing:0px; padding:5px; background:#FFFFFF; color:#0072C6;">
  <tr style="vertical-align:middle">
    <td style="text-align:left">
      <h1 class="p_Heading1"><span class="f_Heading1">Weather Data and LK</span></h1>

    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table style="width:100%;border:none;border-spacing:0px"><tr style="vertical-align:top"><td style="text-align:left;padding:5px">
<p class="p_Text"><span class="f_Text">Use the following variables and functions to work with weather files from an <a href="macros.htm" class="topiclink">LK script</a>.</span></p>
<p class="p_Text"><span class="f_Text">To specify a file that is in your solar resource library, set </span><span class="f_CHCode">solar_resource</span><span class="f_Text"> to the file name as it appears in the library with no extension:</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">set(&nbsp;&quot;solar_resource&quot;&nbsp;,&nbsp;&quot;phoenix_az_33.450495_-111.983688_psmv3_60_tmy&quot;);</span></p>
<p class="p_Text"><span class="f_Text">To generate a list of files in your solar resource library as an array, and specify the third file in the library:</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">weather_file_list&nbsp;=&nbsp;library(&nbsp;&quot;SolarResourceData&quot;&nbsp;);</span><br />
<span class="f_CodeExample">set(&nbsp;&quot;solar_resource&quot;&nbsp;,&nbsp;weather_file_list[3]&nbsp;);</span></p>
<p class="p_Text"><span class="f_Text">To add a folder to your solar resource library:</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">folder_list&nbsp;=&nbsp;get_settings(&nbsp;&quot;solar_data_paths&quot;&nbsp;);</span><br />
<span class="f_CodeExample">new_folder&nbsp;=&nbsp;choose_dir(&nbsp;cwd(),&nbsp;&quot;Choose&nbsp;Weather&nbsp;File&quot;&nbsp;);</span><br />
<span class="f_CodeExample">new_folder_list&nbsp;=&nbsp;folder_list&nbsp;+&nbsp;&quot;;&quot;&nbsp;+&nbsp;new_folder;</span><br />
<span class="f_CodeExample">set_settings(&nbsp;&quot;solar_data_paths&quot;&nbsp;,&nbsp;new_folder_list&nbsp;);</span><br />
<span class="f_CodeExample">rescanlibrary(&nbsp;&quot;solar&quot;&nbsp;);</span></p>
<p class="p_Text"><span class="f_Text">For a weather file that is not in your solar resource library, you can also use the </span><span class="f_CHCode">user_specified_weather_file</span><span class="f_Text"> variable:</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">set(&nbsp;&quot;use_specific_weather_file&quot;&nbsp;,&nbsp;1&nbsp;);</span><br />
<span class="f_CodeExample">weather_file&nbsp;=&nbsp;choose_file(&nbsp;cwd(),&nbsp;&quot;Choose&nbsp;Weather&nbsp;File&quot;,&nbsp;&quot;SAM&nbsp;CSV&nbsp;(*.csv)|*.csv&quot;&nbsp;);</span><br />
<span class="f_CodeExample">set(&nbsp;&quot;user_specified_weather_file&quot;&nbsp;,&nbsp;weather_file&nbsp;);</span></p>
<p class="p_Note"><span class="f_CHNote">Note.</span><span class="f_Note"> The </span><span class="f_CHCode">user_specified_weather_file</span><span class="f_Note"> and </span><span class="f_CHCode">use_specific_weather_file</span><span class="f_Note"> variables are not available on the Location and Resource input page. If you use these variables in a script to set the weather file and then go to the Location and Resource page, you should see the file listed as the current weather file for simulations along with a message with a button that you can use to add the weather file's folder to your solar resource library if you want to be able to access the file directly from the Solar Resource input page later.</span><br />
<span class="f_Note">&nbsp;</span><br />
<img alt="SS_SolarResource-user-variable" width="574" height="57" style="margin:0;width:574px;height:57px;border:none" src="ss_solarresource-user-variable.png"/></p>

</td></tr></table>

</body>
</html>
