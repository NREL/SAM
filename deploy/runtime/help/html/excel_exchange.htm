<!DOCTYPE HTML>
<html>
<head>
   <title>Excel Exchange</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   
   <meta http-equiv="X-UA-Compatible" content="IE=edge" />
   <link type="text/css" href="default.css" rel="stylesheet" />
   <style type="text/css">
     body { margin: 0px; background: #FFFFFF; }
   </style>
   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>

   <script type="text/javascript">
     HMSyncTOC("index.html", "excel_exchange.htm");
   </script>
   <script type="text/javascript" src="highlight.js"></script>
   <script type="text/javascript">
     $(document).ready(function(){highlight();});
   </script>
</head>
<body>


<table style="width:100%; border:none; border-spacing:0px; padding:5px; background:#FFFFFF; color:#0072C6;">
  <tr style="vertical-align:middle">
    <td style="text-align:left">
      <h1 class="p_Heading1"><span class="f_Heading1">Excel Exchange</span></h1>

    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table style="width:100%;border:none;border-spacing:0px"><tr style="vertical-align:top"><td style="text-align:left;padding:5px">
<p class="p_Text"><span class="f_Text">Excel Exchange allows you to link any input variable in SAM to a cell or range of cells in a Microsoft Excel workbook. This feature allows you to use an external spreadsheet-based model to generate values for SAM input variables. SAM can both import input variable values from an Excel worksheet and export input variable values to the worksheet.</span></p>
<p class="p_Text"><span class="f_Text">Using Excel Exchange involves the following steps:</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_List">Prepare an Excel workbook for the data exchange.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_List">In SAM, configure and turn on Excel Exchange.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 6px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_ListLast">In SAM, <a href="run_simulations.htm" class="topiclink">run simulations</a>. SAM exchanges data with the Excel workbook during simulations. </span></td></tr></table></div><p class="p_VariableName"><span class="f_VariableName">Excel Exchange Example</span></p>
<p class="p_VariableDescription"><span class="f_VariableDescription">For an example of SAM with Excel Exchange, download the files sam-excel-exchange-example.sam and sam-excel-exchange-example.xlsx from the <a href="https://sam.nrel.gov/Sample" target="_blank" class="weblink" title="https://sam.nrel.gov/Sample">Sample Files page</a> on the SAM website. To run it, place both files in the same folder on your computer, open the SAM file, and run simulations.</span></p>
<p class="p_Note"><span class="f_CHNote">Notes.</span><span class="f_Note"> </span><br />
<span class="f_Note">&nbsp;</span><br />
<span class="f_Note">Excel Exchange is designed to allow you to read values of SAM </span><span class="f_Emphasis" style="text-decoration: underline;">input</span><span class="f_Note"> variables from an Excel workbook. </span><span class="f_Emphasis" style="text-decoration: underline;">You cannot use Excel Exchange to write values of SAM results to a workbook.</span><span class="f_Note"> If you want to export results to Excel, you can use one of the options described in <a href="export_data.htm" class="topiclink">Export Data and Graphs</a>, or you can write a <a href="scripting.htm" class="topiclink">script</a> to export SAM results.</span><br />
<span class="f_Note">&nbsp;</span><br />
<span class="f_Note">Excel Exchange works in Windows and OS X, and requires that Microsoft Excel be installed on your computer. It will not work with other spreadsheet software.</span><br />
<span class="f_Note">&nbsp;</span><br />
<span class="f_Note">When SAM runs with Excel Exchange turned on, it exchanges data with a copy of the Excel file in computer memory that you cannot see. It does not modify the file stored on your computer's disk, so you will not see any changes in the workbook values.</span><br />
<span class="f_Note">&nbsp;</span><br />
<span class="f_Note">If the Excel workbook contains more than one worksheet, SAM can only exchange data with the first worksheet (the worksheet whose tab appears on the leftmost tab).</span></p>
<p class="p_TitleProcedure"><span class="f_TitleProcedure">To prepare an Excel workbook for Excel Exchange:</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_ProcedureStep">Create an Excel workbook with the calculations you want to perform in Excel. Use the first worksheet in the workbook for the data exchange.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_ProcedureStep">Identify the cells or cell ranges you plan to use for the data exchange. You can refer to them using either ranges (module_cost, NameplateCapacity, etc.) or cell references (A1, C15, etc.).</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 6px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_ProcedureStepLast">For SAM input variables with multiple values specified in SAM using an <a href="annual_schedules.htm" class="topiclink">annual schedule</a>, use the cell reference notation (A1:A12, B15:G15, etc.) rather than a named range. </span></td></tr></table></div><p class="p_TitleProcedure"><span class="f_TitleProcedure">To configure and turn on Excel Exchange:</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Segoe UI';color:#000000;">1.</span></td><td style="border:none"><span class="f_ProcedureStep">Create or open the SAM file you want to configure for Excel Exchange.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Segoe UI';color:#000000;">2.</span></td><td style="border:none"><span class="f_ProcedureStep">Save the file.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Segoe UI';color:#000000;">3.</span></td><td style="border:none"><span class="f_ProcedureStep">On the <a href="case_menu.htm" class="topiclink">case menu</a>, click </span><span class="f_CHInterfaceElement">Excel Exchange</span><span class="f_ProcedureStep">.</span></td></tr></table></div><p class="p_ProcedureStepNoNumber"><img src="ss_casemenu-excelexchange.gif" width="467" height="404" alt="SS_CaseMenu-ExcelExchange" style="border:none" /></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Segoe UI';color:#000000;">4.</span></td><td style="border:none"><span class="f_ProcedureStep">In the Excel Exchange Window, check </span><span class="f_CHInterfaceElement">Turn on Excel Exchange for the base case simulation</span><span class="f_ProcedureStep"> to active Excel Exchange. You can clear the check box to keep the Excel Exchange configuration without running the Exchange when you run simulations.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Segoe UI';color:#000000;">5.</span></td><td style="border:none"><span class="f_ProcedureStep">For </span><span class="f_CHInterfaceElement">Excel file</span><span class="f_ProcedureStep">, click the </span><img src="ss_button-ellipses.gif" width="30" height="19" alt="SS_Button-Ellipses" style="border:none" /> browse button and choose the Excel file you want to use for the exchange. You can remove the file path if you plan to keep the Excel and SAM files in the same folder.</td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Segoe UI';color:#000000;">6.</span></td><td style="border:none">In the <span class="f_CHInterfaceElement">Variables</span> list, add the SAM variables you want to use for the data exchange: Click <span class="f_CHInterfaceElement">Add</span> to open the input variable browser.</td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Segoe UI';color:#000000;">7.</span></td><td style="border:none">For each variable in the list, click its name, and</td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 48px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Segoe UI';color:#000000;">a.</span></td><td style="border:none">For <span class="f_CHInterfaceElement">Excel range</span>, type either the cell reference (A1, C10, etc.) or range name (module_cost, NameplateCapacity, etc.) of the workbook cell or range associated with the SAM variable. Do not enclose the references or names in quotes.</td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 48px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Segoe UI';color:#000000;">b.</span></td><td style="border:none">Click<br />
<span class="f_CHInterfaceElement">Send variable value to Excel</span> if you want to send that variable's value to the Excel workbook, or<br />
<span class="f_CHInterfaceElement">Capture variable value from Excel</span> if you want to read that variable's value from the Excel workbook.</td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Segoe UI';color:#000000;">8.</span></td><td style="border:none">Click <span class="f_CHInterfaceElement">OK</span>.</td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Segoe UI';color:#000000;">9.</span></td><td style="border:none">Click <span class="f_CHInterfaceElement">Simulate</span> to run simulations with Excel Exchange.</td></tr></table></div><p class="p_ProcedureStepNoNumber"><span class="f_ProcedureStepNoNumber">&nbsp;</span></p>
<p class="p_Text"><img src="ss_excelexchange.gif" width="626" height="358" alt="SS_ExcelExchange" style="border:none" /></p>
<h3 class="p_Heading3_atocs_" style="border-top: none; border-right: none; border-left: none;"><span class="f_Heading3_atocs_">Excel Data Exchange Reference</span></h3>
<p class="p_VariableName"><span class="f_VariableName">Turn on Excel Exchange for the base case simulation</span></p>
<p class="p_VariableDescription"><span class="f_VariableDescription">Check the box to turn on the data exchange. </span></p>
<p class="p_VariableDescription"><span class="f_VariableDescription">You can clear the box to keep the Excel Exchange configuration without exchanging data when you run simulations.</span></p>
<p class="p_VariableName"><span class="f_VariableName">Excel file</span></p>
<p class="p_VariableDescription"><span class="f_VariableDescription">The name of the Excel workbook for the data exchange.</span></p>
<p class="p_VariableDescription"><span class="f_VariableDescription">If you plan to keep the Excel file in the same folder as the SAM file (</span><span class="f_CHFileName">.sam</span><span class="f_VariableDescription">), you do not need to include a path in the file name. Use this option if you plan to share the file with someone else, or copy the files to different computers.</span></p>
<p class="p_VariableName"><img src="ss_button-ellipses.gif" width="30" height="19" alt="SS_Button-Ellipses" style="border:none" /> <span class="f_VariableName">Browse</span></p>
<p class="p_VariableDescription"><span class="f_VariableDescription">Browse your computer's folders to find the Excel workbook with which you want to exchange data. The workbook can be located in any folder on your computer.</span></p>
<p class="p_VariableName"><span class="f_VariableName">Add</span></p>
<p class="p_VariableDescription"><span class="f_VariableDescription">Add one or more input variable from the input pages. You can configure each variable to either send a value to an Excel range, or &quot;capture&quot; a value from an Excel range.</span></p>
<p class="p_VariableName"><span class="f_VariableName">Remove</span></p>
<p class="p_VariableDescription"><span class="f_VariableDescription">Delete the highlighted variable from the list.</span></p>
<p class="p_VariableName"><span class="f_VariableName">Clear All</span></p>
<p class="p_VariableDescription"><span class="f_VariableDescription">Delete all variables from the list.</span></p>
<p class="p_VariableName"><span class="f_VariableName">Excel Range</span></p>
<p class="p_VariableDescription"><span class="f_VariableDescription">The range name or cell reference identifying the cell or range of cells in the Excel workbook with which the highlighted variable will exchange data.</span></p>
<p class="p_VariableName"><span class="f_VariableName">Send Variable Value to Excel Range</span></p>
<p class="p_VariableDescription"><span class="f_VariableDescription">Configure the highlighted variable to send its value to the specified range in the Excel workbook.</span></p>
<p class="p_VariableName"><span class="f_VariableName">Capture Variable Value From Excel Range</span></p>
<p class="p_VariableDescription"><span class="f_VariableDescription">Configure the highlighted variable to capture its value from the specified Excel range.</span></p>

</td></tr></table>

</body>
</html>
