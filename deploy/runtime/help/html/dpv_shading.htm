<!DOCTYPE HTML>
<html>
<head>
   <title>Shading</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   
   <meta http-equiv="X-UA-Compatible" content="IE=edge" />
   <link type="text/css" href="default.css" rel="stylesheet" />
   <style type="text/css">
     body { margin: 0px; background: #FFFFFF; }
   </style>
   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>

   <script type="text/javascript">
     HMSyncTOC("index.html", "dpv_shading.htm");
   </script>
   <script type="text/javascript" src="highlight.js"></script>
   <script type="text/javascript">
     $(document).ready(function(){highlight();});
   </script>
</head>
<body>


<table style="width:100%; border:none; border-spacing:0px; padding:5px; background:#FFFFFF; color:#0072C6;">
  <tr style="vertical-align:middle">
    <td style="text-align:left">
      <h1 class="p_Heading1"><span class="f_Heading1">Shading</span></h1>

    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table style="width:100%;border:none;border-spacing:0px"><tr style="vertical-align:top"><td style="text-align:left;padding:5px">
<p class="p_Text"><span class="f_Text">SAM models two types of shading for photovoltaic systems:</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_List"><a href="dpv_shading.htm#arrayshading" class="topiclink">Array shading</a> affects the entire subarray (Flat Plate PV) or array (PVWatts) uniformly. SAM models array shading as a set of hourly shading factors that reduce the solar radiation incident on the array. The Flat Plate PV, PVWatts, and HCPV models each include a version of the array shading model.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 6px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_ListLast"><a href="dpv_system_design.htm#selfshading" class="topiclink">Self shading</a> where neighboring modules within the array shade each other. SAM models self shading as a set of DC derate factors that reduce the array's DC output. Self shading only works with the Flat Plate PV model for systems with one <a href="dpv_losses.htm" class="topiclink">PV subarray</a> and fixed tracking.</span></td></tr></table></div><p class="p_Text"><span class="f_Text">For the Flat Plate PV and PVWatts models, you can also <a href="dpv_shading.htm#importshadingdata" class="topiclink">import shading files</a> created by PVSyst, Solmetric Suneye, or Solar Pathfinder software. When you import these files, SAM converts the data they contain to shading factors for the array shading model.</span></p>
<p class="p_Note"><span class="f_CHNote">Notes.</span><span class="f_Note"> </span><br />
<span class="f_Note">&nbsp;</span><br />
<span class="f_Note">For the Flat Plate PV and HCPV models, the monthly soiling derate factors also reduce the radiation incident on the array.</span><br />
<span class="f_Note">&nbsp;</span><br />
<span class="f_Note">For the Flat Plate PV model, the self-shading model only works when the model option on the <a href="dpv_module.htm" class="topiclink">Module</a> page is either </span><span class="f_CHInterfaceElement">CEC Performance Model</span><span class="f_Note"> or </span><span class="f_CHInterfaceElement">Sandia PV Array Performance Model</span><span class="f_Note">. If the </span><span class="f_CHInterfaceElement">Simple Efficiency Module</span><span class="f_Note"> option is active, the self-shading parameters on the <a href="dpv_system_design.htm" class="topiclink">Array</a> page have no effect on simulation results.</span><br />
<span class="f_Note">&nbsp;</span><br />
<span class="f_Note">If you use the PVWatts array shading model, be sure to choose a DC to AC derate factor on the <a href="pvwatts_system_design.htm" class="topiclink">PVWatts Solar Array</a> page that does not include the effect of shading.</span></p>
<div style="text-align: left; text-indent: 0px; border-color: #0072c6; border-style: solid; border-width: 1px; background: #ebebeb; padding: 2px 2px 2px 2px; margin: 3px 0px 3px 0px;"><table style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:19px"><a id="arrayshading"></a><img id="TOGGLE0186A1_ICON" class="dropdown-toggle-icon" src="ico-minus-16x16.gif" width="16" height="16" alt="ico-minus-16x16" style="border:none" /></td><td style="border:none;padding:0"><span class="f_Heading2_atoc_"><a class="dropdown-toggle" style="font-size: 16pt; font-family: Arial; font-style: normal; font-weight: bold; color: #0072c6; background-color: transparent; text-decoration: none;" href="javascript:HMToggle('toggle','TOGGLE0186A1','TOGGLE0186A1_ICON')">Array Shading</a></span></td></tr></table></div><div id="TOGGLE0186A1" style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 6px 0px;"><table class="ToggleContentTable" style="width:100%; border:none; border-spacing:0px;">
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; padding:0px;"><p class="p_Text"><span class="f_Text">The array shading model calculates the effect of a reduction of the solar radiation incident on the array due to shadows on the array created by nearby objects such as trees and buildings.</span></p>
<p class="p_Text"><span class="f_Text">The array shading model assumes that the entire array is uniformly shaded.</span></p>
<h4 class="p_Heading4"><span class="f_Heading4">Array Shading in Results</span></h4>
<p class="p_Text"><span class="f_Text">To see the effect of shading factors on the radiation incident on the array, after running simulations, you can compare values in the hourly <a href="data.htm" class="topiclink">Tables</a> on the <a href="results_page.htm" class="topiclink">Results</a> page for nominal beam and diffuse, and incident beam and diffuse radiation. The &quot;nominal&quot; values are radiation values before SAM applies the shading and soiling factors, and the &quot;incident&quot; values are net radiation values SAM assumes is incident on the array.</span></p>
<h3 class="p_Heading3_atocs_" style="border-top: none; border-right: none; border-left: none;"><span class="f_Heading3_atocs_">Enabling and Disabling Array Shading</span></h3>
<p class="p_Text"><span class="f_Text">The Flat Plate PV and PVWatts models provide five options for importing shading data files, three options for specifying beam shading factors, and one option for specifying a sky diffuse factor.</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_List">You must choose at least one option.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 6px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_ListLast">SAM does not prevent you from enabling more than one option even if that results in an unrealistic shading model. Be sure to verify that you have enabled the set of options you intend before running simulations.</span></td></tr></table></div><p class="p_Text"><span class="f_Text">The HCPV model provides a single option to specify beam shading factors in an Azimuth by Altitude table. See <a href="dpv_shading.htm#azxalt" class="topiclink">Azimuth by Altitude</a> for details.</span></p>
<p class="p_TitleProcedure"><span class="f_TitleProcedure">To enable the array shading model for the Flat Plate PV or PVWatts model:</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Segoe UI';color:#000000;">1.</span></td><td style="border:none"><span class="f_ProcedureStep">Click </span><span class="f_CHInterfaceElement">Edit Shading.</span><span class="f_ProcedureStep"> The location of the Edit Shading button depends on the PV model:</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 48px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:13px"><span style="font-size:10pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_ProcedureStepNoNumber">Flat Plate PV: <a href="dpv_losses.htm" class="topiclink">PV Subarrays</a> page. You can specify different shading factors for each subarray.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 48px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:13px"><span style="font-size:10pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_ProcedureStepNoNumber">PVWatts: <a href="pvwatts_system_design.htm" class="topiclink">PVWatts Solar Array</a> page.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Segoe UI';color:#000000;">2.</span></td><td style="border:none"><span class="f_ProcedureStep">If you are working with a shading file from PVsyst, Solmetric Suneye, or Solar Pathfinder software, </span><span class="f_ProcedureStepNoNumber">click the appropriate button under</span><span class="f_CHInterfaceElement"> Import shading data from external tools</span><span class="f_ProcedureStepNoNumber"> to import the file. See <a href="dpv_shading.htm#importshadingdata" class="topiclink">Import Shading Files</a> for details.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Segoe UI';color:#000000;">3.</span></td><td style="border:none"><span class="f_ProcedureStep">If you are using a table to specify shading factors (you can type, import, or paste values into the table), check the appropriate </span><span class="f_CHInterfaceElement">Enable</span><span class="f_ProcedureStep"> box. Checking each box causes a table to expand. See <a href="dpv_shading.htm#beamfactors" class="topiclink">Beam Radiation Factors</a> for details.</span></td></tr></table></div><p class="p_Text"><span class="f_Text">&nbsp;</span></p>
<p class="p_Text"><img src="img_pvshading-enabledisable.gif" width="755" height="157" alt="IMG_PVShading-EnableDisable" style="border:none" /></p>
<h3 class="p_Heading3_atocs_" style="border-top: none; border-right: none; border-left: none;"><span class="f_Heading3_atocs_">Beam and Sky Diffuse Shading Factors</span></h3>
<p class="p_Text"><span class="f_Text">Each shading factor is a value between zero and one that represents the fraction of the solar radiation component (either beam or diffuse) allowed to reach the array. A shading factor of one represents no shading. A shading factor of zero represents complete blockage of either the beam or sky diffuse radiation from the array.</span></p>
<p class="p_Text"><span class="f_Text">The value of the shading factor in each hour depends on the method you use to specify the values.</span></p>
<p class="p_Text"><span class="f_Text">To calculate the effect of shading on the array, SAM adjusts the incident beam and diffuse radiation value that it calculates from the data in the weather file and solar angles in each hour as appropriate:</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_List">SAM multiplies the incident normal radiation in each hour by the beam shading factor for that hour. The incident normal radiation is the solar radiation that reaches the array in a straight line from the sun. </span></td></tr></table></div><p class="p_ListNoNumber"><span class="f_ListNoNumber">For example, for a beam shading factor of 0.90 for the 8 a.m. hour of December 20, SAM would multiply the beam radiation value in the weather file by 0.90 for that hour, and use that derated value to calculate the total incident radiation on the array for that hour.</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 6px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_ListLast">SAM multiplies the incident sky diffuse radiation for each hour by the sky diffuse shading factor. Sky diffuse radiation is radiation that reaches the array from the sun indirectly after being reflected by clouds and particles in the atmosphere. Sky diffuse radiation does not include diffuse radiation reflected from the ground. Note that you can only specify a single value that applies to all hours of the year for the sky diffuse shading factor.</span></td></tr></table></div><h3 class="p_Heading3_atocs_" style="border-top: none; border-right: none; border-left: none;"><a id="beamfactors"></a><span class="f_Heading3_atocs_">Beam Radiation Shading Factors</span></h3>
<p class="p_Text"><span class="f_Text">The Flat Plate PV and PVWatts models provide three options for specifying beam shading factors: Hourly 8760, Month by Hour, and Solar Azimuth by Altitude angle. The HCPV model provides only the Solar Azimuth by Altitude option.</span></p>
<p class="p_Text"><span class="f_Text">Typically, you would enable only one of the three options. However, if you enable more than one option, SAM multiplies the shading factors you enabled for each hour to calculate a total shading factor.</span></p>
<p class="p_Note"><span class="f_CHNote">Tip.</span><span class="f_Note"> If you plan to import hourly, month-by-hour, or azimuth-by-altitude shading data from text files, you can see the correct file format by exporting dummy data. SAM will create a text file in the correct format that you can use as an example for your data.</span></p>
<h4 class="p_Heading4"><span class="f_Heading4">Hourly 8760</span></h4>
<p class="p_Text"><span class="f_Text">The Hourly 8760 option allows you to use a set of hourly (8,760 hours/year) beam shading factors for the project location.</span></p>
<p class="p_Text"><span class="f_Text">The data's time convention should follow that of the <a href="weather_overview.htm#timeconvention" class="topiclink">weather file</a>. For the standard TMY files, Hour 1 is the hour ending at 1 a.m. on Monday, January 1.</span></p>
<p class="p_TitleProcedure"><span class="f_TitleProcedure">To specify hourly beam shading factors:</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Segoe UI';color:#000000;">1.</span></td><td style="border:none"><span class="f_ProcedureStep">Click </span><span class="f_CHInterfaceElement">Edit shading</span><span class="f_ProcedureStep"> on the <a href="dpv_losses.htm" class="topiclink">PV Subarrays</a> page or <a href="pvwatts_system_design.htm" class="topiclink">PVWatts Solar Array</a> page to open the Edit Shading Data window.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Segoe UI';color:#000000;">2.</span></td><td style="border:none"><span class="f_ProcedureStep">Check </span><span class="f_CHInterfaceElement">Enable hourly beam irradiance shading factors</span><span class="f_ProcedureStep">.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Segoe UI';color:#000000;">3.</span></td><td style="border:none"><span class="f_ProcedureStep">Click </span><span class="f_CHInterfaceElement">Edit Data</span><span class="f_ProcedureStep">.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Segoe UI';color:#000000;">4.</span></td><td style="border:none"><span class="f_ProcedureStep">To copy data from a spreadsheet, select and copy a column of 8,760 beam shading factors in the spreadsheet and click </span><span class="f_CHInterfaceElement">Paste</span><span class="f_ProcedureStep"> in the Edit Data window.</span></td></tr></table></div><p class="p_ProcedureStepNoNumber"><span class="f_ProcedureStepNoNumber">To import data from a text file, click </span><span class="f_CHInterfaceElement">Import</span><span class="f_ProcedureStepNoNumber"> and navigate to the file. The file must contain a single column of 8,761 rows: A header in the first row followed by 8,760 beam radiation values.</span></p>
<p class="p_ProcedureStepNoNumber"><span class="f_ProcedureStepNoNumber">To see an example of the correct file format, click </span><span class="f_CHInterfaceElement">Export</span><span class="f_ProcedureStepNoNumber"> to export the default shading table to a text file and open it with a text editor.</span></p>
<h4 class="p_Heading4"><span class="f_Heading4">Month by Hour</span></h4>
<p class="p_TitleProcedure"><span class="f_TitleProcedure">To specify month by hour shading factors:</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Segoe UI';color:#000000;">1.</span></td><td style="border:none"><span class="f_ProcedureStep">Click </span><span class="f_CHInterfaceElement">Edit shading</span><span class="f_ProcedureStep"> on the <a href="dpv_losses.htm" class="topiclink">PV Subarrays</a> page or <a href="pvwatts_system_design.htm" class="topiclink">PVWatts Solar Array</a> page to open the Edit Shading Data window.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 6px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Segoe UI';color:#000000;">2.</span></td><td style="border:none"><span class="f_ProcedureStepLast">Check </span><span class="f_CHInterfaceElement">Enable month by hour beam irradiance shading factors</span><span class="f_ProcedureStepLast">.</span></td></tr></table></div><p class="p_Text"><span class="f_Text">To the month-by-hour shading factor matrix is a 24-by-12 table containing a set of 24 hourly shading factors for each month of the year. The shading factor in a cell applies to a given hour for an entire month.</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_List">The data's time convention should follow that of the weather file. For the standard TMY files, the value in the first row and column is for the hour ending at 1 a.m. for all days in January.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_List">A red cell indicates a value of zero, or full shading (beam radiation completely blocked).</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_List">A white cell indicates a value of one, or no shading.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 6px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_ListLast">A dark shade of red indicates more shading (more beam radiation) than a light shade of red.</span></td></tr></table></div><p class="p_TitleProcedure"><span class="f_TitleProcedure">To define a shading factor for a single cell:</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_ProcedureStep">Click the cell and type the shading factor.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_ProcedureStep">To replace the value in a cell, click the cell and type a replacement value.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 6px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_ProcedureStepLast">To delete the value from a cell, double-click the cell and press the Delete key.</span></td></tr></table></div><p class="p_TitleProcedure"><span class="f_TitleProcedure">To define a single shading factor for multiple cells:</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_ProcedureStep">Use your mouse to select the cells to which you want to apply the shading factor.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_ProcedureStep">Type a value between zero and one.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 6px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_ProcedureStepLast">Press the Enter key or click </span><span class="f_CHInterfaceElement">Apply to selected cells</span><span class="f_ProcedureStepLast">.</span></td></tr></table></div><p class="p_TitleProcedure"><span class="f_TitleProcedure">To import or export month-by-hour beam shading factors:</span></p>
<p class="p_Text"><span class="f_Text">Solar Advisor allows you to import and export the shading factor matrix as a comma-delimited text file that contains 12 rows of 24 hourly shading factors separated by commas. The file should not have row or column headings.</span></p>
<p class="p_Text"><span class="f_Text">To see an example of the correct file format, export the default shading table to a text file and open it with a text editor.</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_ProcedureStep">To export the shading matrix as a text file, click </span><span class="f_CHInterfaceElement">Export</span><span class="f_ProcedureStep">. SAM saves the file with the </span><span class="f_Emphasis">.csv</span><span class="f_ProcedureStep"> extension.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_ProcedureStep">To import a data from a comma-delimited text file, click </span><span class="f_CHInterfaceElement">Import</span><span class="f_ProcedureStep">. You can open a correctly formatted text file with any extension, although SAM expects a </span><span class="f_Emphasis">.csv</span><span class="f_ProcedureStep"> file by default.</span></td></tr></table></div><h4 class="p_Heading4"><a id="azxalt"></a><span class="f_Heading4">Solar Azimuth by Altitude</span></h4>
<p class="p_Text"><span class="f_Text">The solar azimuth-by-altitude table is a two-dimensional look-up table of beam irradiance shading factors. For each hour in the simulation, SAM calculates the position of the sun as a set of solar azimuth and altitude angles and looks up the shading factor to use for that hour based on the solar position. SAM uses linear interpolation to estimate the value of the shading factor for solar angles that fall between values in the table row and column headings.</span></p>
<p class="p_Note"><span class="f_CHNote">Important Note:</span><span class="f_Note"> Azimuth values use the following convention: 0 = north, 90 = east, 180 = south, 270 = west.</span><br />
<span class="f_Note">&nbsp;</span><br />
<span class="f_Note">This differs from the convention in older versions of SAM. If you use the current version of SAM to open a file you saved with an older version, SAM should correctly convert the column heading values, but you should check the values before running simulations.</span></p>
<p class="p_TitleProcedure"><span class="f_TitleProcedure">To define the azimuth-altitude shading factor table by hand:</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Segoe UI';color:#000000;">1.</span></td><td style="border:none"><span class="f_ProcedureStep">Click </span><span class="f_CHInterfaceElement">Edit shading</span><span class="f_ProcedureStep"> on the <a href="dpv_losses.htm" class="topiclink">PV Subarrays</a> page or <a href="pvwatts_system_design.htm" class="topiclink">PVWatts Solar Array</a> page to open the Edit Shading Data window.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Segoe UI';color:#000000;">2.</span></td><td style="border:none"><span class="f_ProcedureStep">Click </span><span class="f_CHInterfaceElement">Enable solar azimuth by altitude beam irradiance shading factor table</span><span class="f_ProcedureStep">.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Segoe UI';color:#000000;">3.</span></td><td style="border:none"><span class="f_ProcedureStep">In </span><span class="f_CHInterfaceElement">Rows</span><span class="f_ProcedureStep"> and </span><span class="f_CHInterfaceElement">Cols</span><span class="f_ProcedureStep">, type the number of rows and columns in the table.</span></td></tr></table></div><p class="p_ProcedureStepNoNumber"><span class="f_ProcedureStepNoNumber">Specify a number of rows that is one greater than the number of azimuth values: For example for a table with ten rows of solar azimuth values, specify a </span><span class="f_CHInterfaceElement">Rows</span><span class="f_ProcedureStepNoNumber"> value of 11. Similarly, specify a </span><span class="f_CHInterfaceElement">Cols</span><span class="f_ProcedureStepNoNumber"> value that is one greater than the number of altitude values.</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Segoe UI';color:#000000;">4.</span></td><td style="border:none"><span class="f_ProcedureStep">In the top row (highlighted in blue), type a set of solar azimuth values between zero and 360 and increasing monotonically from left to right.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Segoe UI';color:#000000;">5.</span></td><td style="border:none"><span class="f_ProcedureStep">In the leftmost column (highlighted in blue), type a set of solar altitude between zero and 90 and increasing monotonically from top to bottom.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 6px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Segoe UI';color:#000000;">6.</span></td><td style="border:none"><span class="f_ProcedureStepLast">Type a beam shading factor value (between zero and one) in each cell of the table. A value of zero indicates that beam irradiance is fully blocked by a shading object. A value of one indicates that beam irradiance is not blocked.</span></td></tr></table></div><p class="p_TitleProcedure"><span class="f_TitleProcedure">To import or export azimuth-by-altitude beam shading factors:</span></p>
<p class="p_Text"><span class="f_Text">SAM allows you to import and export the azimuth-altitude lookup table as a comma-delimited text file that contains shading factors separated by commas. The file should include the row and column headings.</span></p>
<p class="p_Text"><span class="f_Text">To see an example of the correct file format, export the default shading table to a text file and open it with a text editor.</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_ProcedureStep">To export the shading matrix as a text file, click </span><span class="f_CHInterfaceElement">Export.</span><span class="f_ProcedureStep"> You can save the file with any file extension, including </span><span class="f_Emphasis">.txt</span><span class="f_ProcedureStep"> or </span><span class="f_Emphasis">.csv</span><span class="f_ProcedureStep">.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 6px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_ProcedureStepLast">To import data from a comma-delimited text file, click </span><span class="f_CHInterfaceElement">Import</span><span class="f_ProcedureStepLast">.</span></td></tr></table></div><h3 class="p_Heading3_atocs_" style="border-top: none; border-right: none; border-left: none;"><span class="f_Heading3_atocs_">Sky Diffuse Shading Factor</span></h3>
<p class="p_Text"><span class="f_Text">A shading factor for sky diffuse radiation may be used. This factor is applied to every hour in the year. This value is considered to be the fraction of the sky that is obstructed, and is therefore constant.</span></p>
<p class="p_TitleProcedure"><span class="f_TitleProcedure">To define a sky diffuse shading factor:</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Segoe UI';color:#000000;">1.</span></td><td style="border:none"><span class="f_ProcedureStep">Click </span><span class="f_CHInterfaceElement">Edit shading</span><span class="f_ProcedureStep"> on the <a href="dpv_losses.htm" class="topiclink">PV Subarrays</a> page or <a href="pvwatts_system_design.htm" class="topiclink">PVWatts Solar Array</a> page to open the Edit Shading Data window.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Segoe UI';color:#000000;">2.</span></td><td style="border:none"><span class="f_ProcedureStep">Click </span><span class="f_CHInterfaceElement">Enable sky diffuse shading factor (constant)</span><span class="f_ProcedureStep">.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 6px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Segoe UI';color:#000000;">3.</span></td><td style="border:none"><span class="f_ProcedureStepLast">Type a value for the shading factor.</span></td></tr></table></div></td>
</tr>
</table>
</div>
<div style="text-align: left; text-indent: 0px; border-color: #0072c6; border-style: solid; border-width: 1px; background: #ebebeb; padding: 2px 2px 2px 2px; margin: 3px 0px 3px 0px;"><table style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:19px"><a id="importshadingdata"></a><img id="TOGGLE0186A2_ICON" class="dropdown-toggle-icon" src="ico-minus-16x16.gif" width="16" height="16" alt="ico-minus-16x16" style="border:none" /></td><td style="border:none;padding:0"><span class="f_Heading2_atoc_"><a class="dropdown-toggle" style="font-size: 16pt; font-family: Arial; font-style: normal; font-weight: bold; color: #0072c6; background-color: transparent; text-decoration: none;" href="javascript:HMToggle('toggle','TOGGLE0186A2','TOGGLE0186A2_ICON')">Import Shading Files</a></span></td></tr></table></div><div id="TOGGLE0186A2" style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 6px 0px;"><table class="ToggleContentTable" style="width:100%; border:none; border-spacing:0px;">
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; padding:0px;"><p class="p_Text"><span class="f_Text">SAM allows you to import shading data from the following software:</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_List">PVsyst, photovoltaic system design software, <a href="http://www.pvsyst.com" target="_blank" class="weblink">http://www.pvsyst.com</a></span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_List">Solmetric SunEye, shading analysis device, <a href="http://www.solmetric.com" target="_blank" class="weblink">http://www.solmetric.com</a></span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 6px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_ListLast">Solar Pathfinder, shading analysis device, <a href="http://www.solarpathfinder.com" target="_blank" class="weblink">http://www.solarpathfinder.com</a></span></td></tr></table></div><h3 class="p_Heading3_atocs_" style="border-top: none; border-right: none; border-left: none;"><span class="f_Heading3_atocs_">Importing Data from PVsyst</span></h3>
<p class="p_Text"><span class="f_Text">You can import a &quot;Near Shadings&quot; table generated by PVsyst into SAM. SAM automatically imports data from the text file generated by PVsyst into the Solar Azimuth by Altitude Shading Factor table and the diffuse shading factor value.</span></p>
<p class="p_Note"><span class="f_CHNote">Notes.</span><span class="f_Note"> We have tested the following procedure with Version 5 of PVsyst.</span></p>
<p class="p_Text"><span class="f_Text">The &quot;Near Shadings&quot; table in PVsyst looks like this:</span></p>
<p class="p_Text"><img src="ss_pvshading-pvsyst-table.gif" width="575" height="238" alt="SS_PVShading-pvsyst-table" style="border:none" /></p>
<p class="p_Text"><span class="f_Text">The &quot;Near Shadings&quot; data exported to a text file looks like this (in this example with semicolon delimiters):</span></p>
<p class="p_Text"><img src="ss_pvshading-pvsyst-shadingtabletext.gif" width="680" height="123" alt="SS_PVShading-pvsyst-shadingtabletext" style="border:none" /></p>
<p class="p_TitleProcedure"><span class="f_TitleProcedure">To import a &quot;Near Shadings&quot; table from PVsyst:</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Segoe UI';color:#000000;">1.</span></td><td style="border:none"><span class="f_ProcedureStep">In PVsyst, follow the procedure to create and export a &quot;Near Shadings&quot; table. The table in PVsyst should look similar to the one below. SAM will recognize any of the delimiter options: tab, comma, or semicolon.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Segoe UI';color:#000000;">2.</span></td><td style="border:none"><span class="f_ProcedureStep">In SAM, click </span><span class="f_CHInterfaceElement">Edit shading</span><span class="f_ProcedureStep"> (on the <a href="dpv_losses.htm" class="topiclink">PV Subarrays</a> page or <a href="pvwatts_system_design.htm" class="topiclink">PVWatts Solar Array</a> page) to open the Edit Shading Data window, and click the </span><span class="f_CHInterfaceElement">PVsyst near shading</span><span class="f_ProcedureStep"> and navigate to the folder containing the shading file.</span></td></tr></table></div><p class="p_ProcedureStepNoNumber"><span class="f_ProcedureStepNoNumber">When SAM imports data from the file, it displays the message &quot;Azimuth-Altitude Table and Diffuse Factor update&quot; and populates the azimuth-altitude shading table, the sky diffuse shading factor, and enables both options.</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 6px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Segoe UI';color:#000000;">3.</span></td><td style="border:none"><span class="f_ProcedureStepLast">Disable any shading options that do not apply to your analysis.</span></td></tr></table></div><h3 class="p_Heading3_atocs_" style="border-top: none; border-right: none; border-left: none;"><span class="f_Heading3_atocs_">Importing from Solmetric SunEye</span></h3>
<p class="p_Text"><span class="f_Text">The Solmetric SunEye software generates shading data in two formats: The obstruction table, which characterizes shading using an altitude-azimuth angle table to indicate solar positions that are blocked by nearby obstructions, and the hourly shading file, which lists hourly beam radiation shading factors. SAM can read data from both tables.</span></p>
<p class="p_Text"><span class="f_Text">Use the obstruction table if you plan to model the system for different locations (assuming the same shading obstructions). Use the hourly shading factor table if you plan to model the system for a single location.</span></p>
<p class="p_Note"><span class="f_CHNote">Note.</span><span class="f_Note"> If you use the hourly shading factor table, be sure that the weather data specified on the <a href="climate_solar.htm" class="topiclink">Location and Resource page</a> is for the same location as the one where the SunEye measurements were made.</span></p>
<p class="p_TitleProcedure"><span class="f_TitleProcedure">To import a SunEye obstruction table:</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Segoe UI';color:#000000;">1.</span></td><td style="border:none"><span class="f_ProcedureStep">In the Solmetric SunEye software (not the PV Designer software), on the </span><span class="f_CHInterfaceElement">File</span><span class="f_ProcedureStep"> menu, click</span><span class="f_CHInterfaceElement"> Export Session Report and Data</span><span class="f_ProcedureStep">.</span></td></tr></table></div><p class="p_ProcedureStepNoNumber"><span class="f_ProcedureStepNoNumber">The SunEye software creates a set of files, and assigns a default name like </span><span class="f_Emphasis">Sky01ObstructionElevations.csv</span><span class="f_ProcedureStepNoNumber"> to the obstruction data file. By default, the files are in a folder named </span><span class="f_Emphasis">ExportedFiles</span><span class="f_ProcedureStepNoNumber"> in the exported report folder.</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Segoe UI';color:#000000;">2.</span></td><td style="border:none"><span class="f_ProcedureStep">In SAM, click </span><span class="f_CHInterfaceElement">Edit shading</span><span class="f_ProcedureStep"> (on the <a href="dpv_losses.htm" class="topiclink">PV Subarrays</a> page or <a href="pvwatts_system_design.htm" class="topiclink">PVWatts Solar Array</a> page) to open the Edit Shading Data window, and click </span><span class="f_CHInterfaceElement">Suneye obstructions table</span><span class="f_ProcedureStep">, and navigate to the folder containing the file you want to import.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Segoe UI';color:#000000;">3.</span></td><td style="border:none"><span class="f_ProcedureStep">Open the obstruction data file for any of the available skies (</span><span class="f_CHFileName">Sky01ObstructionElevations</span><span class="f_ProcedureStep">, </span><span class="f_CHFileName">Sky02ObstructionElevations</span><span class="f_ProcedureStep">, etc.). </span></td></tr></table></div><p class="p_ProcedureStepNoNumber"><span class="f_ProcedureStepNoNumber">If the average or worst case obstruction data from multiple skylines will be used, then an extra step is required. In a spreadsheet program, open the </span><span class="f_CHFileName">ObstructionElevation</span><span class="f_ProcedureStepNoNumber"> file containing the average and maximum values as well as all skylines in the SunEye session. Make sure that the desired data (average or maximum) is in the third column, delete the other columns, and save the file as .csv with a name like </span><span class="f_CHFileName">ObstructionElevationsAVG.csv</span><span class="f_ProcedureStepNoNumber">. Use this file as the obstruction data file in SAM.</span></p>
<p class="p_ProcedureStepNoNumber"><span class="f_ProcedureStepNoNumber">SAM displays the message &quot;Azimuth-Altitude Table updated,&quot; populates the azimuth-altitude shading factor table, and enables the </span><span class="f_CHInterfaceElement">Enable solar azimuth by altitude beam irradiance shading factor</span><span class="f_ProcedureStepNoNumber"> option.</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 6px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Segoe UI';color:#000000;">4.</span></td><td style="border:none"><span class="f_ProcedureStepLast">Be sure to enable and disable the other shading options as appropriate.</span></td></tr></table></div><p class="p_TitleProcedure"><span class="f_TitleProcedure">To import a SunEye hourly shading file:</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Segoe UI';color:#000000;">1.</span></td><td style="border:none"><span class="f_ProcedureStep">In the Solmetric SunEye software (not the PV Designer software), on the </span><span class="f_CHInterfaceElement">File</span><span class="f_ProcedureStep"> menu, click</span><span class="f_CHInterfaceElement"> Export Session Report and Data</span><span class="f_ProcedureStep">.</span></td></tr></table></div><p class="p_ProcedureStepNoNumber"><span class="f_ProcedureStepNoNumber">The SunEye software creates a set of files, and assigns a default name like </span><span class="f_Emphasis">Sky01Shading.csv</span><span class="f_ProcedureStepNoNumber"> to the hourly shading file. By default, the files are in a folder named </span><span class="f_Emphasis">ExportedFiles</span><span class="f_ProcedureStepNoNumber"> in the exported report folder.</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Segoe UI';color:#000000;">2.</span></td><td style="border:none"><span class="f_ProcedureStep">In SAM, click </span><span class="f_CHInterfaceElement">Edit shading</span><span class="f_ProcedureStep"> (on the <a href="dpv_losses.htm" class="topiclink">PV Subarrays</a> page or <a href="pvwatts_system_design.htm" class="topiclink">PVWatts Solar Array</a> page) to open the Edit Shading Data window, and click </span><span class="f_CHInterfaceElement">Suneye hourly shading</span><span class="f_ProcedureStep">, and navigate to the folder containing the shading file.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Segoe UI';color:#000000;">3.</span></td><td style="border:none"><span class="f_ProcedureStep">Open the shading file for any of the available skies (</span><span class="f_CHFileName">Sky01Shading</span><span class="f_ProcedureStep">, </span><span class="f_CHFileName">Sky02Shading</span><span class="f_ProcedureStep">, etc.). To use average shading for multiple skylines, open </span><span class="f_CHFileName">AverageShading.csv</span><span class="f_ProcedureStep">.</span></td></tr></table></div><p class="p_ProcedureStepNoNumber"><span class="f_ProcedureStepNoNumber">SAM displays the message &quot;Hourly Shading Factors for Beam Radiation updated,&quot; populates the hourly shading factor table, and enables the </span><span class="f_CHInterfaceElement">Enable Hourly Beam Shading Factors</span><span class="f_ProcedureStepNoNumber"> option.</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Segoe UI';color:#000000;">4.</span></td><td style="border:none"><span class="f_ProcedureStep">To see the hourly data, click </span><span class="f_CHInterfaceElement">Edit Data</span><span class="f_ProcedureStep"> under </span><span class="f_CHInterfaceElement">Hourly Shading Factors for Beam Radiation</span><span class="f_ProcedureStep">.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Segoe UI';color:#000000;">5.</span></td><td style="border:none"><span class="f_ProcedureStep">Be sure to enable and disable the other shading options as appropriate.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 6px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Segoe UI';color:#000000;">6.</span></td><td style="border:none"><span class="f_ProcedureStepLast">On the <a href="climate_solar.htm" class="topiclink">Location and Resource page</a>, choose a weather file for the same location represented by the SunEye shading data.</span></td></tr></table></div><h3 class="p_Heading3_atocs_" style="border-top: none; border-right: none; border-left: none;"><span class="f_Heading3_atocs_">Importing from SolarPathfinder Assistant</span></h3>
<p class="p_Text"><span class="f_Text">The SolarPathfinder Assistant software generates shading data in two formats: The obstruction table, which characterizes shading using an altitude-azimuth angle table to indicate solar positions that are blocked by nearby obstructions, and the hourly shading file, which lists hourly beam radiation shading factors. SAM can read data from both tables.</span></p>
<p class="p_Text"><span class="f_Text">Use the obstruction table if you plan to model the system for different locations (assuming the same shading obstructions). Use the hourly shading factor table if you plan to model the system for a single location.</span></p>
<p class="p_Note"><span class="f_CHNote">Note.</span><span class="f_Note"> If you use the month-by-hour shading factor table, be sure that the weather data specified on the Location and Resource page is for the same location as the one where the Solar Pathfinder measurements were made.</span></p>
<p class="p_TitleProcedure"><span class="f_TitleProcedure">To import a Solar Pathfinder obstruction table:</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Segoe UI';color:#000000;">1.</span></td><td style="border:none"><span class="f_ProcedureStep">In SolarPathfinder Assistant, on the File menu, click </span><span class="f_CHInterfaceElement">Export</span><span class="f_ProcedureStep">, </span><span class="f_CHInterfaceElement">Horizon Angles</span><span class="f_ProcedureStep">.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Segoe UI';color:#000000;">2.</span></td><td style="border:none"><span class="f_ProcedureStep">In the Save window, </span><span class="f_ProcedureStepNoNumber">specify the location and name of the data file.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Segoe UI';color:#000000;">3.</span></td><td style="border:none"><span class="f_ProcedureStep">In SAM, click </span><span class="f_CHInterfaceElement">Edit shading</span><span class="f_ProcedureStep"> (on the <a href="dpv_losses.htm" class="topiclink">PV Subarrays</a> page or <a href="pvwatts_system_design.htm" class="topiclink">PVWatts Solar Array</a> page) to open the Edit Shading Data window, and click </span><span class="f_CHInterfaceElement">Solar Pathfinder obstructions</span><span class="f_ProcedureStep">, and navigate to the folder containing the file you want to import.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Segoe UI';color:#000000;">4.</span></td><td style="border:none"><span class="f_ProcedureStep">Open the obstruction data file you saved in Step 2. </span></td></tr></table></div><p class="p_ProcedureStepNoNumber"><span class="f_ProcedureStepNoNumber">SAM displays the message &quot;Azimuth-Altitude Table updated,&quot; populates the azimuth-altitude shading factor table, and enables the Enable Azimuth-Altitude Shading Factors for Beam Radiation option.</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Segoe UI';color:#000000;">5.</span></td><td style="border:none"><span class="f_ProcedureStep">Be sure to enable and disable the other shading options as appropriate.</span></td></tr></table></div><p class="p_TitleProcedure"><span style="font-family: verdana; font-weight: bold;">To import a Solar Pathfinder Month by Hour shading file:</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Segoe UI';color:#000000;">1.</span></td><td style="border:none"><span class="f_ProcedureStep">In SolarPathfinder Assistant, on the File menu, click </span><span class="f_CHInterfaceElement">Export</span><span class="f_ProcedureStep">, </span><span class="f_CHInterfaceElement">Shading Data</span><span class="f_ProcedureStep">.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Segoe UI';color:#000000;">2.</span></td><td style="border:none"><span class="f_ProcedureStep">In the </span><span class="f_ProcedureStepNoNumber">Save window, specify the location and name of the data file.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Segoe UI';color:#000000;">3.</span></td><td style="border:none"><span class="f_ProcedureStep">In SAM, click </span><span class="f_CHInterfaceElement">Edit shading</span><span class="f_ProcedureStep"> (on the <a href="dpv_losses.htm" class="topiclink">PV Subarrays</a> page or <a href="pvwatts_system_design.htm" class="topiclink">PVWatts Solar Array</a> page) to open the Edit Shading Data window, and click</span><span class="f_CHInterfaceElement"> Solar Pathfinder month by hour shading</span><span class="f_ProcedureStep">, and navigate to the folder containing the shading file.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Segoe UI';color:#000000;">4.</span></td><td style="border:none"><span class="f_ProcedureStep">Open the shading file you saved in Step 2.</span></td></tr></table></div><p class="p_ProcedureStepNoNumber"><span class="f_ProcedureStepNoNumber">SAM displays the message &quot;Hourly Shading Factors for Beam Radiation updated,&quot; populates the hourly shading factor table, and enables the Enable Hourly Beam Irradiance Shading Factors option.</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Segoe UI';color:#000000;">5.</span></td><td style="border:none"><span class="f_ProcedureStep">To see the hourly data, click </span><span class="f_CHInterfaceElement">Edit Data</span><span class="f_ProcedureStep"> under </span><span class="f_CHInterfaceElement">Enable hourly beam irradiance shading factors</span><span class="f_ProcedureStep">.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Segoe UI';color:#000000;">6.</span></td><td style="border:none"><span class="f_ProcedureStep">Be sure to enable and disable the other shading options as appropriate.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 3px 24px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:24px"><span style="font-size:10pt; font-family: 'Segoe UI';color:#000000;">7.</span></td><td style="border:none"><span class="f_ProcedureStep">On the Location and Resource page, choose a weather file for the same location represented by the Solar Pathfinder shading data.</span></td></tr></table></div></td>
</tr>
</table>
</div>

</td></tr></table>

<script type="text/javascript">
HMInitToggle('TOGGLE0186A1_ICON','hm.type','dropdown','hm.state','0','hm.src0','ico-plus-16x16.gif','hm.src1','ico-minus-16x16.gif','onclick','HMToggle(\'toggle\',\'TOGGLE0186A1\',\'TOGGLE0186A1_ICON\')');
HMInitToggle('TOGGLE0186A1','hm.type','dropdown','hm.state','0');
HMInitToggle('TOGGLE0186A2_ICON','hm.type','dropdown','hm.state','0','hm.src0','ico-plus-16x16.gif','hm.src1','ico-minus-16x16.gif','onclick','HMToggle(\'toggle\',\'TOGGLE0186A2\',\'TOGGLE0186A2_ICON\')');
HMInitToggle('TOGGLE0186A2','hm.type','dropdown','hm.state','0');
</script>
</body>
</html>
