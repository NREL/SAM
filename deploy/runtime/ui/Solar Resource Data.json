{
    "Name": "Solar Resource Data",
    "Width": 894.0,
    "Height": 972.0,
    "FormObjects": {
        "GroupBox": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "GroupBox2"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 9.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 12.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 870.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 363.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "Solar Resource Library"
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 1.0
                }
            }
        },
        "Hyperlink": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "Hyperlink2"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 21.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 504.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 853.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 28.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "For locations not covered by the NSRDB, visit the SAM website Weather Page for links to other data sources."
                },
                "URL": {
                    "Type": 5.0,
                    "String": "https://sam.nrel.gov/weather-data"
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 0.0
                }
            }
        },
        "Numeric": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "annual_albedo"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 666.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 864.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 103.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Value": {
                    "Type": 1.0,
                    "Double": 0.0
                },
                "Mode": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Format": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "Decimals": {
                    "Type": 3.0,
                    "Integer": 3.0
                },
                "Prefix": {
                    "Type": 5.0,
                    "String": ""
                },
                "Suffix": {
                    "Type": 5.0,
                    "String": ""
                },
                "ThousandsSep": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": -1.0
                }
            }
        },
        "Numeric": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "annual_beam"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 198.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 849.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 103.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Value": {
                    "Type": 1.0,
                    "Double": 0.0
                },
                "Mode": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Format": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "Decimals": {
                    "Type": 3.0,
                    "Integer": 2.0
                },
                "Prefix": {
                    "Type": 5.0,
                    "String": ""
                },
                "Suffix": {
                    "Type": 5.0,
                    "String": ""
                },
                "ThousandsSep": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": -1.0
                }
            }
        },
        "Numeric": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "annual_diffuse"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 198.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 876.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 103.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Value": {
                    "Type": 1.0,
                    "Double": 0.0
                },
                "Mode": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Format": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "Decimals": {
                    "Type": 3.0,
                    "Integer": 2.0
                },
                "Prefix": {
                    "Type": 5.0,
                    "String": ""
                },
                "Suffix": {
                    "Type": 5.0,
                    "String": ""
                },
                "ThousandsSep": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": -1.0
                }
            }
        },
        "Numeric": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "annual_global"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 198.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 822.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 103.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Value": {
                    "Type": 1.0,
                    "Double": 0.0
                },
                "Mode": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Format": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "Decimals": {
                    "Type": 3.0,
                    "Integer": 2.0
                },
                "Prefix": {
                    "Type": 5.0,
                    "String": ""
                },
                "Suffix": {
                    "Type": 5.0,
                    "String": ""
                },
                "ThousandsSep": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": -1.0
                }
            }
        },
        "Numeric": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "annual_snow"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 666.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 837.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 103.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Value": {
                    "Type": 1.0,
                    "Double": 0.0
                },
                "Mode": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Format": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "Decimals": {
                    "Type": 3.0,
                    "Integer": 3.0
                },
                "Prefix": {
                    "Type": 5.0,
                    "String": ""
                },
                "Suffix": {
                    "Type": 5.0,
                    "String": ""
                },
                "ThousandsSep": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": -1.0
                }
            }
        },
        "Numeric": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "annual_tdry"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 198.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 903.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 103.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Value": {
                    "Type": 1.0,
                    "Double": 0.0
                },
                "Mode": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Format": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "Decimals": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Prefix": {
                    "Type": 5.0,
                    "String": ""
                },
                "Suffix": {
                    "Type": 5.0,
                    "String": ""
                },
                "ThousandsSep": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": -1.0
                }
            }
        },
        "Numeric": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "annual_wspd"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 198.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 930.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 103.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Value": {
                    "Type": 1.0,
                    "Double": 0.0
                },
                "Mode": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Format": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "Decimals": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Prefix": {
                    "Type": 5.0,
                    "String": ""
                },
                "Suffix": {
                    "Type": 5.0,
                    "String": ""
                },
                "ThousandsSep": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": -1.0
                }
            }
        },
        "Button": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "btn_add_file_to_library"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 714.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 567.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 153.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 30.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "Add file to library"
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 11.0
                }
            }
        },
        "Button": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "btn_add_remove_folders"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 621.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 306.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 252.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 30.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "Add/remove weather file folders..."
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 2.0
                }
            }
        },
        "Button": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "btn_download"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 651.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 474.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 223.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 28.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "Download and add to library..."
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 10.0
                }
            }
        },
        "Button": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "btn_refresh_library"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 621.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 336.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 252.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 30.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "Refresh library"
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 3.0
                }
            }
        },
        "Button": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "btn_view_data"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 715.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 609.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 153.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 30.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "View data..."
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 12.0
                }
            }
        },
        "Label": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "caption_library"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 18.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 63.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 855.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 36.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "SAM's default library comes with only a few weather files to help you get started. Use the download tools below to build a library of locations you frequently model. Once you build your library, it is available for all of your work in SAM."
                },
                "TextColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "FontSize": {
                    "Type": 3.0,
                    "Integer": -1.0
                },
                "WordWrap": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "AlignRight": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "AlignTop": {
                    "Type": 2.0,
                    "Boolean": 1.0
                }
            }
        },
        "Label": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "caption_techs"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 555.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 663.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 307.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 63.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": ""
                },
                "TextColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "FontSize": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "WordWrap": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "AlignRight": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "AlignTop": {
                    "Type": 2.0,
                    "Boolean": 1.0
                }
            }
        },
        "Label": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "download_weather_caption"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 18.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 393.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 855.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 51.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "The NSRDB is a database of thousands of weather files that you can download and add to your to your solar resource library: Download a default typical-year (TMY) file for most long-term cash flow analyses, or choose files to download for single-year or P50/P90 analyses. See Help for details."
                },
                "TextColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "FontSize": {
                    "Type": 3.0,
                    "Integer": -1.0
                },
                "WordWrap": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "AlignRight": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "AlignTop": {
                    "Type": 2.0,
                    "Boolean": 1.0
                }
            }
        },
        "Numeric": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "elev"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 108.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 750.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 103.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Value": {
                    "Type": 1.0,
                    "Double": 317.0
                },
                "Mode": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Format": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Decimals": {
                    "Type": 3.0,
                    "Integer": 3.0
                },
                "Prefix": {
                    "Type": 5.0,
                    "String": ""
                },
                "Suffix": {
                    "Type": 5.0,
                    "String": ""
                },
                "ThousandsSep": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 9.0
                }
            }
        },
        "Label": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "folder_caption"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 18.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 264.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 855.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 39.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "SAM scans the following folders on your computer for valid weather files and adds them to your Solar Resource library. To use weather files stored on your computer, click Add/remove Weather File Folders and add folders containing valid weather files."
                },
                "TextColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "FontSize": {
                    "Type": 3.0,
                    "Integer": -1.0
                },
                "WordWrap": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "AlignRight": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "AlignTop": {
                    "Type": 2.0,
                    "Boolean": 1.0
                }
            }
        },
        "Divider": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "group_optional"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 465.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 816.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 363.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 19.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Orientation": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "Colour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 120.0,
                        "Green": 120.0,
                        "Blue": 120.0,
                        "Alpha": 255.0
                    }
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "Optional Data"
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 1.0
                }
            }
        },
        "TextEntry": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "in_location"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 21.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 474.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 366.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 28.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Text": {
                    "Type": 5.0,
                    "String": ""
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 6.0
                }
            }
        },
        "StringArray": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "in_location_list"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 282.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 474.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 99.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Label": {
                    "Type": 5.0,
                    "String": "List of locations"
                },
                "Description": {
                    "Type": 5.0,
                    "String": "Type or import a list of addresses or lat,lon in decimal degrees"
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 7.0
                }
            }
        },
        "RadioChoice": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "in_location_options"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 21.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 447.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 261.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Selection": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "Items": {
                    "Type": 6.0,
                    "StringList": "One location|Multiple locations"
                },
                "ShowCaptions": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "Horizontal": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 4.0
                }
            }
        },
        "Choice": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "in_nsrdb_options"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 390.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 474.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 258.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 28.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Items": {
                    "Type": 6.0,
                    "StringList": "Default TMY file|Choose year|Download files for all years (P50/P90)"
                },
                "Selection": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 7.0
                }
            }
        },
        "RadioChoice": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "in_time_step"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 405.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 447.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 222.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Selection": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "Items": {
                    "Type": 6.0,
                    "StringList": "60-minute|30-minute"
                },
                "ShowCaptions": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "Horizontal": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 8.0
                }
            }
        },
        "CheckBox": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "is_advanced"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 660.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 447.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 215.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "Advanced download"
                },
                "State": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 9.0
                }
            }
        },
        "Numeric": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "lat"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 108.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 669.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 103.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Value": {
                    "Type": 1.0,
                    "Double": 1.1
                },
                "Mode": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Format": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Decimals": {
                    "Type": 3.0,
                    "Integer": 3.0
                },
                "Prefix": {
                    "Type": 5.0,
                    "String": ""
                },
                "Suffix": {
                    "Type": 5.0,
                    "String": ""
                },
                "ThousandsSep": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 10.0
                }
            }
        },
        "Label": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "library_caption6"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 18.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 30.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 855.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 33.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "The Solar Resource library is a list of weather files on your computer. Choose a file from the library and verify the weather data information below."
                },
                "TextColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "FontSize": {
                    "Type": 3.0,
                    "Integer": -1.0
                },
                "WordWrap": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "AlignRight": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "AlignTop": {
                    "Type": 2.0,
                    "Boolean": 1.0
                }
            }
        },
        "MultilineText": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "library_folder_list"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 18.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 306.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 588.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 60.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Text": {
                    "Type": 5.0,
                    "String": "List of Solar Resource library folders"
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": -1.0
                }
            }
        },
        "Numeric": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "lon"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 108.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 696.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 103.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Value": {
                    "Type": 1.0,
                    "Double": 1.2
                },
                "Mode": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Format": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Decimals": {
                    "Type": 3.0,
                    "Integer": 3.0
                },
                "Prefix": {
                    "Type": 5.0,
                    "String": ""
                },
                "Suffix": {
                    "Type": 5.0,
                    "String": ""
                },
                "ThousandsSep": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 11.0
                }
            }
        },
        "Divider": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "object 22"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 18.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 801.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 849.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 16.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Orientation": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "Colour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 120.0,
                        "Green": 120.0,
                        "Blue": 120.0,
                        "Alpha": 255.0
                    }
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "Annual Averages Calculated from Weather File  Data"
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 1.0
                }
            }
        },
        "Divider": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "object 2236"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 30.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 642.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 840.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 16.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Orientation": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "Colour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 120.0,
                        "Green": 120.0,
                        "Blue": 120.0,
                        "Alpha": 255.0
                    }
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "Header Data from Weather File"
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 1.0
                }
            }
        },
        "GroupBox": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "object 4"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 9.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 375.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 870.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 162.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "Download Weather Files"
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 1.0
                }
            }
        },
        "GroupBox": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "object 423"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 9.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 537.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 870.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 432.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "Weather Data Information"
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 1.0
                }
            }
        },
        "Label": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "object 7"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 291.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 732.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 570.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 60.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "For NSRDB data, the latitude and longitude shown here from the weather file header are the coordinates of the NSRDB grid cell and may be different from the values in the file name, which are the coordinates of the requested location."
                },
                "TextColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "FontSize": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "WordWrap": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "AlignRight": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "AlignTop": {
                    "Type": 2.0,
                    "Boolean": 1.0
                }
            }
        },
        "Label": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "object 735"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 393.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 930.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 222.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "*NaN indicates missing data."
                },
                "TextColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "FontSize": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "WordWrap": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "AlignRight": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "AlignTop": {
                    "Type": 2.0,
                    "Boolean": 0.0
                }
            }
        },
        "TextEntry": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "solar_data_file_name"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 318.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 609.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 390.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 28.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Text": {
                    "Type": 5.0,
                    "String": ""
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": -1.0
                }
            }
        },
        "TextEntry": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "solar_data_file_name_load"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 318.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 609.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 390.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Text": {
                    "Type": 5.0,
                    "String": ""
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": -1.0
                }
            }
        },
        "TextEntry": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "solar_data_source"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 369.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 696.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 183.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Text": {
                    "Type": 5.0,
                    "String": "src"
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 7.0
                }
            }
        },
        "Library": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "solar_resource"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 18.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 105.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 855.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 159.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Library": {
                    "Type": 5.0,
                    "String": "SolarResourceData"
                },
                "Fields": {
                    "Type": 5.0,
                    "String": "Name,Latitude,Longitude,Time zone,Elevation,Station ID,Source,Version"
                }
            }
        },
        "TextEntry": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "solar_resource_file"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 102.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 609.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 604.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 28.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Text": {
                    "Type": 5.0,
                    "String": ""
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 29.0,
                        "Green": 80.0,
                        "Blue": 173.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 222.0,
                        "Green": 233.0,
                        "Blue": 244.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": -1.0
                }
            }
        },
        "TextEntry": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "station_id"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 369.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 669.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 183.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Text": {
                    "Type": 5.0,
                    "String": "wban"
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 7.0
                }
            }
        },
        "Label": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "summary_caption"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 18.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 564.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 690.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 36.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": ""
                },
                "TextColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "FontSize": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "WordWrap": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "AlignRight": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "AlignTop": {
                    "Type": 2.0,
                    "Boolean": 1.0
                }
            }
        },
        "Numeric": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "tz"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 108.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 723.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 103.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Value": {
                    "Type": 1.0,
                    "Double": -7.5
                },
                "Mode": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Format": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Decimals": {
                    "Type": 3.0,
                    "Integer": 3.0
                },
                "Prefix": {
                    "Type": 5.0,
                    "String": "GMT "
                },
                "Suffix": {
                    "Type": 5.0,
                    "String": ""
                },
                "ThousandsSep": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 8.0
                }
            }
        },
        "Numeric": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "ui_step_minutes"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 108.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 777.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 103.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Value": {
                    "Type": 1.0,
                    "Double": 0.0
                },
                "Mode": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "Format": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "Decimals": {
                    "Type": 3.0,
                    "Integer": 3.0
                },
                "Prefix": {
                    "Type": 5.0,
                    "String": ""
                },
                "Suffix": {
                    "Type": 5.0,
                    "String": ""
                },
                "ThousandsSep": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": -1.0
                }
            }
        },
        "Numeric": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "use_specific_weather_file"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 618.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 609.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 90.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Value": {
                    "Type": 1.0,
                    "Double": 0.0
                },
                "Mode": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "Format": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "Decimals": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "Prefix": {
                    "Type": 5.0,
                    "String": ""
                },
                "Suffix": {
                    "Type": 5.0,
                    "String": ""
                },
                "ThousandsSep": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": -1.0
                }
            }
        },
        "TextEntry": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "user_specified_weather_file"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 318.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 609.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 390.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Text": {
                    "Type": 5.0,
                    "String": ""
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": -1.0
                }
            }
        }
    },
    "VarDatabase": {
        "annual_albedo": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Annual albedo",
            "Units": " ",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 8.0,
            "DefaultValue": 0.0,
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "annual_beam": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Direct normal (beam)",
            "Units": "kWh/m/day",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 4.0,
            "DefaultValue": 0.0,
            "UIObject": "Numeric",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "annual_diffuse": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Diffuse horizontal",
            "Units": "kWh/m/day",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 4.0,
            "DefaultValue": 0.0,
            "UIObject": "Numeric",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "annual_global": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Global horizontal",
            "Units": "kWh/m/day",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 20.0,
            "DefaultValue": 0.0,
            "UIObject": "Numeric",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "annual_snow": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Maximum snow depth",
            "Units": "cm",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 8.0,
            "DefaultValue": 0.0,
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "annual_tdry": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Average temperature",
            "Units": "C",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 4.0,
            "DefaultValue": 0.0,
            "UIObject": "Numeric",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "annual_wspd": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Average wind speed",
            "Units": "m/s",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 4.0,
            "DefaultValue": 0.0,
            "UIObject": "Numeric",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "city": {
            "Version": 4.0,
            "Type": 4.0,
            "Label": "City",
            "Units": " ",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 8.0,
            "DefaultValue": "<invalid>",
            "UIObject": "TextEntry",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "country": {
            "Version": 4.0,
            "Type": 4.0,
            "Label": "Country",
            "Units": " ",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 8.0,
            "DefaultValue": "<invalid>",
            "UIObject": "TextEntry",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "elev": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Elevation",
            "Units": "m",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 8.0,
            "DefaultValue": 0.0,
            "UIObject": "Numeric",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "file_name": {
            "Version": 4.0,
            "Type": 4.0,
            "Label": "Weather file name required by some SSC modules",
            "Units": " ",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 9.0,
            "DefaultValue": "",
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "in_location": {
            "Version": 4.0,
            "Type": 4.0,
            "Label": "Location input (address or lat/lon)",
            "Units": " ",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 1.0,
            "DefaultValue": "Type a street address or latitude, longitude (skip for advanced)",
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "in_location_list": {
            "Version": 4.0,
            "Type": 4.0,
            "Label": "List of locations",
            "Units": " ",
            "Group": "Location and Resource",
            "IndexLabels": "abc",
            "Flags": 0.0,
            "DefaultValue": "15458 Denver W Pkwy, Golden CO 804041|phoenix,az|45.5,-120.9|Manaus,Brazil",
            "UIObject": "StringArray",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "in_location_options": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Location options (0=one,1=multiple)",
            "Units": " ",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 1.0,
            "DefaultValue": 0.0,
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "in_nsrdb_options": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "NSRDB options",
            "Units": " ",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 1.0,
            "DefaultValue": 0.0,
            "UIObject": "Choice",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "in_time_step": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Time Step option (0=60 min,1=30 min)",
            "Units": " ",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 1.0,
            "DefaultValue": 0.0,
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "is_advanced": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Legacy and 30-minute data (advanced)",
            "Units": " ",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 1.0,
            "DefaultValue": 0.0,
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "lat": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Latitude",
            "Units": "degrees",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 8.0,
            "DefaultValue": 0.0,
            "UIObject": "Numeric",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "library_folder_list": {
            "Version": 4.0,
            "Type": 4.0,
            "Label": "Solar resource library folders",
            "Units": " ",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 5.0,
            "DefaultValue": "",
            "UIObject": "MultilineText",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "library_paths": {
            "Version": 4.0,
            "Type": 4.0,
            "Label": "Solar resource library file path list",
            "Units": " ",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 8.0,
            "DefaultValue": "",
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "lon": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Longitude",
            "Units": "degrees",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 8.0,
            "DefaultValue": 0.0,
            "UIObject": "Numeric",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "solar_data_file_name": {
            "Version": 4.0,
            "Type": 4.0,
            "Label": "Weather file name from solar resource library",
            "Units": " ",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 4.0,
            "DefaultValue": "",
            "UIObject": "TextEntry",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "solar_data_file_name_load": {
            "Version": 4.0,
            "Type": 4.0,
            "Label": "Weather file when user interface loaded",
            "Units": " ",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 4.0,
            "DefaultValue": "",
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "solar_data_source": {
            "Version": 4.0,
            "Type": 4.0,
            "Label": "Data Source",
            "Units": " ",
            "Group": " Location and Resource",
            "IndexLabels": "",
            "Flags": 8.0,
            "DefaultValue": "src",
            "UIObject": "TextEntry",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "solar_resource": {
            "Version": 4.0,
            "Type": 4.0,
            "Label": "Solar resource library current selection",
            "Units": " ",
            "Group": "Location and Resource",
            "IndexLabels": "SolarResourceData|0",
            "Flags": 19.0,
            "DefaultValue": "",
            "UIObject": "Library",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "solar_resource_file": {
            "Version": 4.0,
            "Type": 4.0,
            "Label": "Weather file",
            "Units": " ",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 0.0,
            "DefaultValue": "",
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "state": {
            "Version": 4.0,
            "Type": 4.0,
            "Label": "State",
            "Units": " ",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 8.0,
            "DefaultValue": "<invalid>",
            "UIObject": "TextEntry",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "station_id": {
            "Version": 4.0,
            "Type": 4.0,
            "Label": "Location",
            "Units": " ",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 8.0,
            "DefaultValue": "",
            "UIObject": "TextEntry",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "step": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Time step",
            "Units": "seconds",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 4.0,
            "DefaultValue": 3600.0,
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "tz": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Time zone",
            "Units": " ",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 8.0,
            "DefaultValue": 0.0,
            "UIObject": "Numeric",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "ui_step_minutes": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Time step",
            "Units": "minutes",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 8.0,
            "DefaultValue": 0.0,
            "UIObject": "Numeric",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "use_specific_weather_file": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Use weather file from script (legacy)",
            "Units": " ",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 6.0,
            "DefaultValue": 0.0,
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "user_specified_weather_file": {
            "Version": 4.0,
            "Type": 4.0,
            "Label": "Weather file specified from script 0 or 1 (legacy)",
            "Units": " ",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 6.0,
            "DefaultValue": "",
            "UIObject": "TextEntry",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "wf_nrecords": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Number of weather file records",
            "Units": " ",
            "Group": "Location and Resource",
            "IndexLabels": "",
            "Flags": 4.0,
            "DefaultValue": 8760.0,
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        }
    },
    "Equations": {
        "1": "equations{'solar_resource_file'} = define() {",
        "2": "\tif ( ${use_specific_weather_file} ) ",
        "3": "\t\t{ return ${user_specified_weather_file}; }",
        "4": "\telse ",
        "5": "\t\t{ return ${solar_data_file_name}; }// file name from solar resource library csv file",
        "6": "};",
        "7": "",
        "8": "equations{'file_name'} = define() {",
        "9": "\t// for compatibility with most SSC APIs",
        "10": "\treturn ${solar_resource_file};",
        "11": "};",
        "12": "",
        "13": "equations{'ui_step_minutes'} = define() {",
        "14": "\treturn(${step}/60);",
        "15": "};",
        "16": ""
    },
    "Callbacks": {
        "1": "on_load{'Solar Resource Data'} = define() {",
        "2": "\t//msgbox('on load');",
        "3": "\t//hide legacy data for 2020.2.29 Patch 3",
        "4": "\tshow('is_advanced',true);",
        "5": "\ton_change{'in_location_options'}();",
        "6": "\ton_change{'in_nsrdb_options'}();",
        "7": "\ton_change{'is_advanced'}();",
        "8": "\t// store value of current library item in case an LK script changes the selected library item",
        "9": "\tvalue('solar_data_file_name_load', value('solar_data_file_name'));",
        "10": "\t// UI updates do not work consistently if these variables do not have widgets. They are stacked under the solar_resource_file widget.",
        "11": "\tshow('use_specific_weather_file', false); // determines whether user_specified_weather_file is used instead of solar_data_file_name",
        "12": "\tshow('user_specified_weather_file', false); // requires use_specific_weather_file = 1, set by LK script",
        "13": "\tshow('solar_data_file_name_load', false); // stores weather file name when UI form loaded",
        "14": "\tshow('solar_data_file_name', false); // value from SolarResourceData CSV file",
        "15": "\tshow('in_time_step', value('in_nsrdb_options') != 0 ); ",
        "16": "\trefresh();",
        "17": "\tupdate_library_folders(''); // refresh list of library folders",
        "18": "\tupdate_info( 'on_load Solar Resource Data');",
        "19": "};",
        "20": "",
        "21": "// library list, this gets triggered before on_load",
        "22": "on_change{'solar_resource'} = define() {",
        "23": "\t// in case LK script changes library selection without setting use_specifc_weather_file to zero",
        "24": "\t//msgbox('on_change solar_resource');",
        "25": "\tif ( value('solar_data_file_name_load' ) != value('solar_data_file_name') )",
        "26": "\t{",
        "27": "\t\tvalue('use_specific_weather_file',0); ",
        "28": "\t}",
        "29": "\tupdate_info('on_change solar_resource');",
        "30": "};",
        "31": "",
        "32": "on_change{'use_specific_weather_file'} = define() {",
        "33": "\tif ( value('use_specific_weather_file') == 1 )",
        "34": "\t{",
        "35": "\t\tupdate_info('on_change use_specific_weather_file');",
        "36": "\t}",
        "37": "};",
        "38": "",
        "39": "on_change{ 'btn_add_file_to_library' } = define () {",
        "40": "\tf_name = value( 'solar_resource_file' );",
        "41": "\tf_name = slash_back_to_forward( f_name );",
        "42": "\tupdate_library_folders( path_only( f_name ) );",
        "43": "\tvalue( 'solar_resource', file_to_key( f_name ) );",
        "44": "};",
        "45": "",
        "46": "on_change{ 'in_location_options' } = define() {",
        "47": "\tshow('in_location_list',  value('in_location_options') == 1 && !value('is_advanced') );",
        "48": "\tshow('in_location',       value('in_location_options') == 0 && !value('is_advanced') );",
        "49": "\trefresh('');",
        "50": "};",
        "51": "",
        "52": "on_change{ 'in_nsrdb_options' } = define() {",
        "53": "\tshow('in_location_list',   value('in_location_options') == 1 && !value('is_advanced') );",
        "54": "\tshow('in_location',        value('in_location_options') == 0 && !value('is_advanced') );",
        "55": "\tshow('in_location_options', !value('is_advanced') );",
        "56": "\t// 30-minute data not available for tmy",
        "57": "\tshow('in_time_step', value('in_nsrdb_options') != 0 ); ",
        "58": "\trefresh('');",
        "59": "};",
        "60": "",
        "61": "on_change{ 'is_advanced' } = define() {",
        "62": "\tif ( value('is_advanced') ) {",
        "63": "\t\tproperty( 'download_weather_caption' , 'Caption' , 'Click the Download button to choose files from a complete list of files available from the NSRDB, including TMY, TGY, TDY for different years and subhourly data.');",
        "64": "\t\tproperty( 'download_weather_caption' , 'TextColour', 'black' );",
        "65": "\t}",
        "66": "\telse {",
        "67": "\t\tproperty( 'download_weather_caption' , 'Caption' , 'The NSRDB is a database of thousands of weather files that you can download and add to your to your solar resource library: Download a default typical-year (TMY) file for most long-term cash flow analyses, or choose files to download for single-year or P50/P90 analyses. See Help for details.' );",
        "68": "\t\tproperty( 'download_weather_caption' , 'TextColour', 'black' );",
        "69": "\t}",
        "70": "\tshow('in_location_list', ( value('in_location_options') && !value('is_advanced') ) );",
        "71": "\tshow('in_location', ( !value('in_location_options') && !value('is_advanced') ) );",
        "72": "\tshow('in_location_options', !value('is_advanced') );",
        "73": "\tshow('in_nsrdb_options', !value('is_advanced') );",
        "74": "\tshow('in_time_step', !value('is_advanced') && value('in_nsrdb_options') != 0 );",
        "75": "\trefresh('');",
        "76": "};",
        "77": "",
        "78": "on_change{'btn_refresh_library'} = define() {",
        "79": "\tupdate_library_folders('');",
        "80": "\tupdate_info('on_change btn_refesh_library');",
        "81": "};",
        "82": "",
        "83": "// add/remove weather file folders",
        "84": "on_change{'btn_add_remove_folders'} = define() {",
        "85": "\tif ( showsettings( 'solar' ) )",
        "86": "\t{",
        "87": "\t\tupdate_library_folders( '' );",
        "88": "\t}",
        "89": "};",
        "90": "",
        "91": "on_change{'btn_view_data'} = define() {",
        "92": "\tif ( dview_solar(value('solar_resource_file')) )",
        "93": "\t{\tmsgbox('Failed to read file!\\nThe data viewer was not able to open the weather file:\\n' + value('solar_resource_file') ); }",
        "94": "};",
        "95": "",
        "96": "on_change{'btn_download'} = define() {",
        "97": "\tif ( value( 'is_advanced' ) ) { nsrdb_all(); }",
        "98": "\telse { nsrdb_get(); }",
        "99": "\trescanlibrary( 'solar' );",
        "100": "\tupdate_library_folders( '' );",
        "101": "\trefresh('solar_resource');",
        "102": "};",
        "103": "",
        "104": "/////////////////////////////////////////////",
        "105": "// Functions",
        "106": "/////////////////////////////////////////////",
        "107": "",
        "108": "// attempt to determine if location string is valid lat/lon pair",
        "109": "// given a location string loc_in, return:",
        "110": "//  * loc_in if appears to be a location name or address",
        "111": "//  * comma separated lat/lon pair in Decimal Degrees if valid comma or space separated lat/lon pair ",
        "112": "//  * null if not a valid lat/lon pair",
        "113": "// also return msg string description if invalid",
        "114": "function test_decimal_degrees( loc_in ) ",
        "115": "{",
        "116": "\tarr = split( loc_in, ' ' ); ",
        "117": "\tis_space_delimited_pair = false;",
        "118": "\tis_space_delimited_address = false;",
        "119": "\tloc_out = null;",
        "120": "\tmsg = '';",
        "121": "\tif ( #arr == 2 && strpos(loc_in,',') < 0 ) // test for space-separated lat/lon, city/state, or city/country pair",
        "122": "\t{",
        "123": "\t\tmsg = '\\\"' + loc_in + '\\\"' + ' not recognized. Please use a comma to separate latitude and longitude values in Decimal Degrees, or to separate city and state/province or country names.';",
        "124": "\t\tis_space_delimited_pair = true;",
        "125": "\t}",
        "126": "\telseif ( #arr > 2 ) // test for street address with one comma",
        "127": "\t{",
        "128": "\t\tis_space_delimited_address = true;",
        "129": "\t}",
        "130": "\tstr = replace( loc_in, ', ', ',' ); // allow comma followed by space",
        "131": "\tarr = [];",
        "132": "\tarr = split( str, ',' );",
        "133": "\tif ( #arr == 2 && !is_space_delimited_pair && !is_space_delimited_address) // loc_in may be a lat/lon pair",
        "134": "\t{",
        "135": "\t\tlat = lower(arr[0]); ",
        "136": "\t\tlon = lower(arr[1]);",
        "137": "",
        "138": "\t\tis_nsew = false;",
        "139": "\t\tif ( (to_real(lat) !=0)  && (to_real(lon) != 0) ) // test for N, S, E, or W in string (not valid for decimal degrees)",
        "140": "\t\t{",
        "141": "\t\t\tis_nsew = ( ( strpos(lat,'n') > -1 || strpos(lat,'s') > -1 ) && ( strpos(lon,'w') > -1 || strpos(lon,'e') > -1 ) );",
        "142": "\t\t}",
        "143": "\t\tis_valid_range =  ( ( to_real(lat) >= -90 && to_real(lat) <= 90 ) || ( to_real(lon) >=-180 && to_real(lon) <= 180 ) );",
        "144": "\t\tis_string = ( to_real(lat) == 0 && to_real(lon) == 0 ); // assumes no one is modeling a system at 0,0",
        "145": "\t\tmsg = '';",
        "146": "\t\tif ( is_nsew )",
        "147": "\t\t{",
        "148": "\t\t\tmsg = '\\\"' + loc_in + '\\\"' + ' is not a valid lat/lon pair in Decimal Degrees (uses N/S, E/W). Please convert to Decimal Degrees.';",
        "149": "\t\t}",
        "150": "\t\telseif ( is_string )",
        "151": "\t\t{",
        "152": "\t\t\tloc_out = loc_in;",
        "153": "\t\t\tmsg = '\\\"' + loc_in + '\\\"' + ' appears to be a city/state pair.';",
        "154": "\t\t}",
        "155": "\t\telseif ( is_valid_range )",
        "156": "\t\t{",
        "157": "\t\t\tloc_out = lat + ',' + lon;",
        "158": "\t\t\tmsg = '\\\"' + loc_in + '\\\"' + ' appears to be a valid lat/lon pair in Decimal Degrees.';",
        "159": "\t\t}",
        "160": "\t\telse",
        "161": "\t\t{",
        "162": "\t\t\tmsg = '\\\"' + loc_in + '\\\"' + ' not recognized. Please enter a valid street address, location name, or latitude/longitude pair in Decimal Degrees (lat,lon).';",
        "163": "\t\t}",
        "164": "\t}",
        "165": "\telseif ( !is_space_delimited_pair ) // loc_in likely a location name",
        "166": "\t{",
        "167": "\t\tloc_out = loc_in;",
        "168": "\t\tmsg = '\\\"' + loc_in + '\\\"' + ' appears to be a street address or location name.';",
        "169": "\t}",
        "170": "\treturn [loc_out, msg ]; ",
        "171": "}",
        "172": "",
        "173": "function file_to_key( file ) ",
        "174": "{",
        "175": "\t\tkey = file_only( file );",
        "176": "\t\tkey = replace( key, '.' + ext_only( file ), '' );",
        "177": "\t\treturn key;",
        "178": "}",
        "179": "",
        "180": "function slash_back_to_forward( str )",
        "181": "{",
        "182": "\treturn replace( str, '\\\\', '/' );",
        "183": "}",
        "184": "",
        "185": "// given a key or file item from the library, return if exists t/f, key, file, and key for first item",
        "186": "// is_key = true if library key with no path or extension",
        "187": "// is_key = false if file name with full path and extension",
        "188": "// should also work with no parameters to return number of files in library and in deploy/solar_resource folder",
        "189": "function solar_library( item, is_key )",
        "190": "{",
        "191": "\tT = {};",
        "192": "\tlib_file = userlocaldatadir() + '/SolarResourceData.csv';",
        "193": "\tlib_data = csvread( lib_file, { 'table' = true } );",
        "194": "\tfiles = lib_data{'File name'}; files -@ 0; files -@ 0;",
        "195": "\tfor( i=0; i<#files; i++) { files[i] = lower(slash_back_to_forward(files[i])); }",
        "196": "\tkeys = lib_data{'Name'}; keys -@ 0; keys -@ 0;",
        "197": "\tif ( is_key ) { ii = keys ?@ item; }",
        "198": "\telse { ii = files ?@ lower(item); }",
        "199": "\tT{'is_in_library'} = false; ",
        "200": "\tT{'lib_key'} = null;",
        "201": "\tif ( ii > -1 ) ",
        "202": "\t{",
        "203": "\t\tT{'is_in_library'} = true; ",
        "204": "\t\tT{'lib_key'} = keys[ii];",
        "205": "\t\tT{'file_name'} = files[ii];",
        "206": "\t}",
        "207": "\tT{'num_files_in_library'} = #files;",
        "208": "\tstr = slash_back_to_forward( appdir() );",
        "209": "\tarr = split( str, '/' );",
        "210": "\tarr -@ #arr-1;",
        "211": "\tarr[#arr] = 'solar_resource';",
        "212": "\tdefault_path = '';",
        "213": "\tfor( i=0; i<#arr; i++ ) {default_path += arr[i] + '/'; }",
        "214": "\tdefault_files = dir_list( default_path, '*', false );",
        "215": "\tT{'num_default_files'} = #default_files;",
        "216": "\treturn T;",
        "217": "}",
        "218": "",
        "219": "// update weather file, annual summaries and summary text based on whether file is from library or user specified via LK script",
        "220": "// ctxt is for testing to see when function was called",
        "221": "function update_info( ctxt )",
        "222": "{",
        "223": "\twf = value('solar_resource_file'); ",
        "224": "\tL = strlen( value( 'library_folder_list' ) );",
        "225": "\t/*msgbox('Hello from update_info() in ' + ctxt + '!\\nsolar_resource_file = ' + value('solar_resource_file')",
        "226": "\t       + '\\nsolar_data_file_name = ' + value('solar_data_file_name')",
        "227": "\t       + '\\n\\nsolar_data_file_name_load = ' + value('solar_data_file_name_load')  ",
        "228": "\t       + '\\n\\nuser_specified_weather_file = ' + value('user_specified_weather_file')",
        "229": "\t       + '\\n\\nfile_name = ' + value('file_name') ",
        "230": "\t       + '\\n\\nsolar_resource = ' + value('solar_resource') ",
        "231": "\t       + '\\n\\nwf is in library = ' + solar_library(value('solar_resource_file'),false){'is_in_library'}",
        "232": "\t       + '\\n\\ncurrent selection is in library = ' + solar_library(value('solar_resource'),true){'is_in_library'} );*/",
        "233": "\t",
        "234": "\t//if selected library file is no longer in library reload library, and exit",
        "235": "\twf_ok = false;",
        "236": "\tif (!file_exists(wf) )",
        "237": "\t{",
        "238": "\t\tmsg_caption = 'Weather file does not exist. Please choose or download a different file above.';",
        "239": "\t\tmsg_color = 'red';",
        "240": "\t\tshow_button = false;",
        "241": "\t\trescanlibrary('solar'); // remove deleted file from library",
        "242": "\t}",
        "243": "\t// display message depending on whether file is in library or is a user-specified file",
        "244": "\telseif ( wf != value('solar_data_file_name') )",
        "245": "\t{",
        "246": "\t\tmsg_caption = 'The weather file is different from the file selected in the library because it was modified by an LK script. Click Add File to Library if you want the file to appear in the library list above.';",
        "247": "\t\tmsg_color = 'red';",
        "248": "\t\tshow_button = true;",
        "249": "\t}",
        "250": "\telseif ( strlen( value( 'library_folder_list' ) ) < L ) // ** this check should never be true, right???",
        "251": "\t{",
        "252": "\t\tmsg_caption = 'Weather file folder not in list? Please choose or download a different file above, or click Add file to library.';",
        "253": "\t\tmsg_color = 'red';",
        "254": "\t\tshow_button = true;",
        "255": "\t}",
        "256": "\telseif ( !solar_library(slash_back_to_forward(value('solar_resource')),true){'is_in_library'} )",
        "257": "\t{",
        "258": "\t\tmsg_caption = 'Weather file is not in library. Please choose or download a different file above, or click Add file to library.';",
        "259": "\t\tmsg_color = 'red';",
        "260": "\t\tshow_button = true;",
        "261": "\t}",
        "262": "\telse",
        "263": "\t{",
        "264": "\t\tmsg_caption = 'The following information describes the data in the highlighted weather file from the Solar Resource library above. This is the file SAM will use when you click Simulate.';",
        "265": "\t\tmsg_color = 'black';",
        "266": "\t\tshow_button = false;",
        "267": "\t\twf_ok = true;",
        "268": "\t}",
        "269": "",
        "270": "\t// show / hide PV only summary data",
        "271": "\tis_pv = ( technology() == 'Flat Plate PV' || technology() == 'PVWatts' );",
        "272": "\tproperty( 'summary_caption' , 'Caption' , msg_caption );",
        "273": "\tproperty( 'summary_caption' , 'TextColour' , msg_color );",
        "274": "\tshow('btn_add_file_to_library', show_button);",
        "275": "\tshow('group_optional', is_pv );",
        "276": "\tshow('annual_snow', is_pv );",
        "277": "\tshow('annual_albedo',is_pv );",
        "278": "\trefresh(''); // always refresh after calling show()",
        "279": "",
        "280": "\t// display message for new users if library contains only default files",
        "281": "\tproperty( 'caption_library', 'Caption', 'The default library comes with only a few weather files to help you get started. Use the download tools below to build a library of locations you frequently model. Once you build your library, it is available for all of your work in SAM.' );",
        "282": "\tproperty( 'caption_library', 'TextColour', 'black' );",
        "283": "\tlib = solar_library( 'dummy', false );",
        "284": "\tif ( lib{'num_files_in_library'} == lib{'num_default_files'} )",
        "285": "\t{",
        "286": "\t\tproperty( 'caption_library', 'Caption', 'You have not added any weather files to your library. To add files, use the download tools below to get weather files from the NSRDB, or click Add Remove Weather File folders to add files from your computer. The default library comes with only a few weather files to help you get started.' );",
        "287": "\t\tproperty( 'caption_library', 'TextColour', 'red' );",
        "288": "\t}",
        "289": "",
        "290": "\t// calculate and display annual summary data",
        "291": "\tif ( wf_ok )",
        "292": "\t{",
        "293": "\t\tobj = ssc_create();",
        "294": "\t\tssc_var( obj, 'file_name', wf );",
        "295": "\t\tresult = ssc_exec( obj, 'wfreader' );",
        "296": "\t\tif ( 0 == result )",
        "297": "\t\t{",
        "298": "\t\t\tvalue( 'annual_global', ssc_var(obj, 'annual_glob') );",
        "299": "\t\t\tvalue( 'annual_beam', ssc_var(obj, 'annual_beam') );",
        "300": "\t\t\tvalue( 'annual_diffuse', ssc_var(obj, 'annual_diff') );",
        "301": "\t\t\tvalue( 'annual_tdry', ssc_var(obj, 'annual_tdry') );",
        "302": "\t\t\tvalue( 'annual_wspd', ssc_var(obj, 'annual_wspd') );",
        "303": "\t\t\tvalue( 'annual_snow', ssc_var(obj, 'annual_snow') );",
        "304": "\t\t\tvalue( 'annual_albedo', ssc_var(obj, 'annual_albedo') );",
        "305": "\t\t\tvalue( 'step', ssc_var(obj, 'step') );",
        "306": "\t\t\trhum = ssc_var(obj, 'rhum');",
        "307": "\t\t\trhum_ok = true;",
        "308": "\t\t\tif ( isnan( rhum[0] ) ) { rhum_ok = false; }",
        "309": "\t\t\t// used for timestep calculation in editscene3d",
        "310": "\t\t\tvalue( 'wf_nrecords', ssc_var(obj, 'nrecords') );",
        "311": "\t\t}",
        "312": "\t\telse",
        "313": "\t\t{",
        "314": "\t\t\tmsgbox('Weather file reader failed!\\n' ",
        "315": "\t\t\t+ result",
        "316": "\t\t\t+ '\\n\\nTo avoid this message, remove  the following file from your weather file folders: \\n' + wf);",
        "317": "\t\t\tvalue( 'annual_global', nan() );",
        "318": "\t\t\tvalue( 'annual_beam', nan() );",
        "319": "\t\t\tvalue( 'annual_diffuse', nan() );",
        "320": "\t\t\tvalue( 'annual_tdry', nan() );",
        "321": "\t\t\tvalue( 'annual_wspd', nan() );",
        "322": "\t\t\tvalue( 'annual_snow', nan() );",
        "323": "\t\t\tvalue( 'annual_albedo', nan() );",
        "324": "\t\t\tvalue( 'wf_nrecords', nan() );",
        "325": "\t\t}",
        "326": "\t\tssc_free( obj );",
        "327": "\t}",
        "328": "\t",
        "329": "\tif ( librarygetcurrentselection('solar_resource') == '' )",
        "330": "\t{",
        "331": "\t\tlibrarynotifytext('solar_resource','Please choose a file. Nothing selected.');",
        "332": "\t}",
        "333": "\telseif ( !solar_library(slash_back_to_forward(value('solar_resource')),true){'is_in_library'} ) ",
        "334": "\t{",
        "335": "\t\tlibrarynotifytext('solar_resource', 'Please choose a file. Current selection not in library.');",
        "336": "\t}",
        "337": "\telseif (librarygetnumbermatches('solar_resource') < 1)",
        "338": "\t{",
        "339": "\t\tvalue('in_location', librarygetfiltertext('solar_resource'));",
        "340": "\t\tlibrarynotifytext('solar_resource', 'No match found. Try downloading a weather file below.');",
        "341": "\t}",
        "342": "\telseif ( librarygetcurrentselection('solar_resource') != file_to_key( value('solar_resource_file')) )",
        "343": "\t{",
        "344": "\t\tlibrarynotifytext('solar_resource','Current selection is different from weather file.');",
        "345": "\t}",
        "346": "\telse",
        "347": "\t{",
        "348": "\t\tlibrarynotifytext('solar_resource', ''); //'Everything is fine.'",
        "349": "\t\tvalue('in_location', 'Type a location name, street address, or lat,lon in decimal degrees');",
        "350": "\t}",
        "351": "\t",
        "352": "\t//msgbox('libraryget functions'+",
        "353": "\t//'\\nfiltertext = ' + librarygetfiltertext('solar_resource') ",
        "354": "\t//+ '\\nnumber matches = ' + librarygetnumbermatches('solar_resource') ",
        "355": "\t//+ '\\ncurrentselection = ' + librarygetcurrentselection('solar_resource'));",
        "356": "\t",
        "357": "\tdisplay_tech_message();",
        "358": "}",
        "359": "",
        "360": "// update ui list of library folders, and optionally add new path to library folders",
        "361": "function update_library_folders( new_path )",
        "362": "{",
        "363": "\t//msgbox('Hello from update_library_folders()');",
        "364": "\tx = get_settings('solar_data_paths');",
        "365": "\t// add new path if provided and it doesn't already exist in the library",
        "366": "\tif ( new_path != '' && dir_exists( new_path ) && ( strpos( x, new_path ) < 0 ) )",
        "367": "\t{",
        "368": "\t\tif ( x != '' ) { x += ';'; }",
        "369": "\t\tx += slash_back_to_forward( new_path );",
        "370": "\t}",
        "371": "\t// list of library folders files to display on separate lines",
        "372": "\tpaths = split( x, ';' );",
        "373": "\t// put solar download folder at top of list",
        "374": "\tclean_list = '';",
        "375": "\t// remove folders in list that no longer exist",
        "376": "\tfor (i = 0; i<#paths; i++ )",
        "377": "\t{",
        "378": "\t\tif ( dir_exists( paths[i] ) )",
        "379": "\t\t{",
        "380": "\t\t\tclean_list += paths[i];",
        "381": "\t\t\tif ( i < #paths-1 ) { clean_list += ';'; }",
        "382": "\t\t}\t",
        "383": "\t}\t\t",
        "384": "\t// update solar_data_paths used by library.cpp and nsrdb.cpp to cleaned list\t\t",
        "385": "\tset_settings('solar_data_paths', clean_list );",
        "386": "\t// update list to display",
        "387": "\tvalue( 'library_folder_list', get_settings('solar_download_path') + '\\n' ",
        "388": "\t       + replace( clean_list , ';' , '\\n' ) );",
        "389": "\trescanlibrary( 'solar' );        ",
        "390": "}",
        "391": "",
        "392": "function display_tech_message() ",
        "393": "{",
        "394": "\tstr = '';",
        "395": "\tstr_and = '';",
        "396": "\ttech = technology();",
        "397": "\tcsp_techs = ['Physical Trough','Empirical Trough','MSPT','DSPT','MSLF','DSLF','Dish Stirling','Generic CSP System'];",
        "398": "\tfor ( i=0; i<#csp_techs; i++ )",
        "399": "\t{",
        "400": "\t\tif ( tech == csp_techs[i] ) ",
        "401": "\t\t{",
        "402": "\t\t\tstr = 'CSP models use a different time convention than NREL NSRDB data. See Help for details.';",
        "403": "\t\t}\t",
        "404": "\t}",
        "405": "\tif ( tech == 'Biopower' )",
        "406": "\t{ ",
        "407": "\t\tif ( isnan( value('annual_global') ) || !rhum_ok )",
        "408": "\t\t{",
        "409": "\t\t\tstr = 'The Biopower model requires ';",
        "410": "\t\t}",
        "411": "\t\tif ( isnan( value('annual_global' ) ) ) ",
        "412": "\t\t{",
        "413": "\t\t\tstr += 'global horizontal irradiance data ';",
        "414": "\t\t\tstr_and = 'and ';",
        "415": "\t\t}\t",
        "416": "\t\tif ( !rhum_ok ) ",
        "417": "\t\t{",
        "418": "\t\tstr += str_and + 'relative humidity data. See Help for details.';",
        "419": "\t\t}\t",
        "420": "\t}",
        "421": "\tproperty( 'caption_techs' , 'Caption', str );\t\t",
        "422": "\tproperty( 'caption_techs' , 'TextColour', 'red' );",
        "423": "}",
        "424": "",
        "425": "// display window for advanced download",
        "426": "function nsrdb_all() ",
        "427": "{",
        "428": "\thash = nsrdbquery();",
        "429": "\t// meta data",
        "430": "\tif ( hash != '' )",
        "431": "\t{ ",
        "432": "\t\tfn = hash{'file'};",
        "433": "\t\tdn = hash{'folder'};",
        "434": "\t\taf = hash{'addfolder'};",
        "435": "\t\tif ( fn != '' )",
        "436": "\t\t{",
        "437": "\t\t\terror = wf_check( fn );",
        "438": "\t\t}\t",
        "439": "\t\tif (af == \"no\")",
        "440": "\t\t{",
        "441": "\t\t\tif ((fn != '') && (dn != ''))",
        "442": "\t\t\t{",
        "443": "\t\t\t\tvalue( 'use_specific_weather_file', 1 );",
        "444": "\t\t\t\tfn = replace(fn, '\\\\', '/');",
        "445": "\t\t\t\tvalue( 'user_specified_weather_file', fn );",
        "446": "\t\t\t}",
        "447": "\t\t}",
        "448": "\t\telse",
        "449": "\t\t{",
        "450": "\t\t\trescanlibrary( 'solar' );  //** is this necessary??",
        "451": "\t\t\tif (fn != '')",
        "452": "\t\t\t{",
        "453": "\t\t\t\tvalue( 'use_specific_weather_file', 0 );",
        "454": "\t\t\t\tvalue( 'solar_resource', file_to_key( fn ) );",
        "455": "\t\t\t}",
        "456": "\t\t}",
        "457": "\t}",
        "458": "}",
        "459": "",
        "460": "// clean up location string to use as file name",
        "461": "function clean_name( location )",
        "462": "{",
        "463": "\tname = location;",
        "464": "\tname = replace( name , ', ' , ',' );",
        "465": "\tname = replace( name , ',' , '_' );",
        "466": "\tname = replace( name , '  ' , ' ' );",
        "467": "\tname = replace( name , ' ' , '_' );",
        "468": "\treturn lower(name);",
        "469": "}",
        "470": "",
        "471": "// return a set of urls for valid datasets available for a location",
        "472": "function nsrdb( location, is_tmy )",
        "473": "{",
        "474": "\tname = '';",
        "475": "\turl = '';",
        "476": "\tyears = [];",
        "477": "\tmsg = '';",
        "478": "\tg = {'lat'=null,'lon'=null, tz=null, 'ok'=false};",
        "479": "\tgeocode_ok = false;",
        "480": "\tjson_ok = false;",
        "481": "\tlocation_ok = false;",
        "482": "\tis_suny = false;",
        "483": "\tif ( strpos(lower(location),'type a location name') > -1 )",
        "484": "\t{",
        "485": "\t\tmsg += 'Invalid location name: \\n\\n' + location + '\\n\\n';",
        "486": "\t}",
        "487": "\telse",
        "488": "\t{",
        "489": "\t\tloc_test = test_decimal_degrees( location );",
        "490": "\t\tmsg += loc_test[1] + '\\n\\n';",
        "491": "\t\tif (  loc_test[0] != null )",
        "492": "\t\t{",
        "493": "\t\t\tlocation_ok = true;",
        "494": "\t\t\tlocation = loc_test[0];",
        "495": "\t\t\tg = geocode( location );",
        "496": "\t\t\t// sometimes correct address fails but works on second try",
        "497": "\t\t\tif ( !g.ok ) { g = geocode( location ); }",
        "498": "\t\t\tif ( g.ok ) { geocode_ok = true; }",
        "499": "\t\t}",
        "500": "\t}",
        "501": "\tif ( geocode_ok )",
        "502": "\t{",
        "503": "\t\turl = webapi( 'nsrdb_query' );",
        "504": "\t\turl = replace( url, '<LAT>', g.lat );",
        "505": "\t\turl = replace( url, '<LON>', g.lon );",
        "506": "\t\t//url = replace( url, '<LAT>', 'xxx' );",
        "507": "\t\t//url = replace( url, '<LON>', 'yyy' );",
        "508": "\t\tjson_str = curl( url );",
        "509": "\t\tmsg += 'Latitude / longitude for NSRDB Data Query: ' + g.lat + ',' + g.lon +  '\\n\\n';",
        "510": "\t\tmsg += 'URL for NSRDB Data Query: ' + url + '\\n\\n';",
        "511": "\t\tvar = json_read( json_str );",
        "512": "\t\tif ( typeof( var ) == 'table' )",
        "513": "\t\t{",
        "514": "\t\t\tif ( var.errors != null)",
        "515": "\t\t\t{",
        "516": "\t\t\t\tif ( #var.errors > 0 )",
        "517": "\t\t\t\t{",
        "518": "\t\t\t\t\tmsg += 'Message from NSRDB Data Query: ' + var.errors[0] + '.\\nStatus = ' + var.status;",
        "519": "\t\t\t\t}",
        "520": "\t\t\t\telse { json_ok = true; }\t",
        "521": "\t\t\t}",
        "522": "\t\t\telseif ( var.error != null )",
        "523": "\t\t\t{",
        "524": "\t\t\t\tif ( #@var.error > 0 )",
        "525": "\t\t\t\t{",
        "526": "\t\t\t\t\tmsg += 'NSRDB Data Query Error: ' + var.error.message + '.\\nCode = ' + var.error.code;",
        "527": "\t\t\t\t\tif ( strpos( lower(var.code), 'api' ) > -1 ) { msg += 'See private.h to set API keys.'; }",
        "528": "\t\t\t\t}\t",
        "529": "\t\t\t}",
        "530": "\t\t\telseif ( var.outputs == null )",
        "531": "\t\t\t{",
        "532": "\t\t\t\tmsg += 'NSRDB Data Query returns no data for \\\"' + location + '\\\" (outputs = null).\\nSee https://sam.nrel.gov/weather for links to other data sources.\\n';",
        "533": "\t\t\t}",
        "534": "\t\t\telseif ( var.outputs == [] )",
        "535": "\t\t\t{",
        "536": "\t\t\t\tmsg += 'NSRDB Data Query returns no data for \\\"' + location + '\\\" (outputs = []).\\nSee https://sam.nrel.gov/weather for links to other data sources.\\n';",
        "537": "\t\t\t}",
        "538": "\t\t\telse",
        "539": "\t\t\t{",
        "540": "\t\t\t\tjson_ok = true;",
        "541": "\t\t\t}\t",
        "542": "\t\t}",
        "543": "\t\telse",
        "544": "\t\t{",
        "545": "\t\t\tmsg += 'NSRDB Data Query did not return valid JSON string:\\n';",
        "546": "\t\t\tmsg += json_str;",
        "547": "\t\t}",
        "548": "\t\tif ( json_ok )",
        "549": "\t\t{",
        "550": "\t\t\tavailable_datasets = var.outputs;",
        "551": "\t\t\t// list of datasets that don't require advanced download",
        "552": "\t\t\t// not all datasets work with SAM, for example spectral-india-tmy",
        "553": "\t\t\tvalid_datasets = 'psm3,psm3-tmy,msg-iodc,suny-india,suny-india-tmy'; ",
        "554": "\t\t\tfor ( i=0; i<#available_datasets; i++ )",
        "555": "\t\t\t{",
        "556": "\t\t\t\tavailable_names[i] = available_datasets[i].name;",
        "557": "\t\t\t\tif ( strpos(available_datasets[i].name, 'suny') > -1 ) { is_suny = true;}",
        "558": "\t\t\t}",
        "559": "\t\t\ti_dataset = -1;",
        "560": "\t\t\tfor ( i=0; i<#available_datasets; i++ )",
        "561": "\t\t\t{",
        "562": "\t\t\t\tif ( strpos(valid_datasets,available_datasets[i].name) > - 1 )",
        "563": "\t\t\t\t{",
        "564": "\t\t\t\t\tif ( is_tmy && (available_datasets[i].name == 'psm3-tmy' || available_datasets[i].name == 'suny-india-tmy') )",
        "565": "\t\t\t\t\t{",
        "566": "\t\t\t\t\t\ti_dataset = i;",
        "567": "\t\t\t\t\t}",
        "568": "\t\t\t\t\telseif ( !is_tmy && ( available_datasets[i].name == 'suny-india' || available_datasets[i].name == 'psm3' ) )",
        "569": "\t\t\t\t\t{",
        "570": "\t\t\t\t\t\ti_dataset = i;",
        "571": "\t\t\t\t\t}",
        "572": "\t\t\t\t\telseif ( !is_tmy && !is_suny && available_datasets[i].name == 'msg-iodc' )",
        "573": "\t\t\t\t\t{",
        "574": "\t\t\t\t\t\ti_dataset = i;",
        "575": "\t\t\t\t\t}",
        "576": "\t\t\t\t}",
        "577": "\t\t\t}\t",
        "578": "\t\t\tif ( i_dataset == -1 )",
        "579": "\t\t\t{",
        "580": "\t\t\t\tstr_tmy = '';",
        "581": "\t\t\t\tif ( is_tmy ) { str_tmy = 'TMY'; }",
        "582": "\t\t\t\tmsg += 'No ' + str_tmy + ' file available for \\\"' + location + '\\\". (Avalaible datasets: ' + available_names + ')\\n\\n';",
        "583": "\t\t\t\tmsg += 'Try the Advanced Download option or see https://sam.nrel.gov/weather for other sources of data.\\n';",
        "584": "\t\t\t\tdataset_ok = false;",
        "585": "\t\t\t}",
        "586": "\t\t\telse",
        "587": "\t\t\t{",
        "588": "\t\t\t\tname = var.outputs[i_dataset].name;",
        "589": "\t\t\t\turl = var.outputs[i_dataset].apiUrl+'.csv';",
        "590": "\t\t\t\tyears = var.outputs[i_dataset].availableYears;",
        "591": "\t\t\t\tdataset_ok = true;",
        "592": "\t\t\t}",
        "593": "\t\t}",
        "594": "\t\t//else { msg += 'JSON tests failed. There may be a problem with the service.'; }",
        "595": "\t}",
        "596": "\telse",
        "597": "\t{",
        "598": "\t\tgeocode_ok = false;",
        "599": "\t\tmsg += 'Geocoding failed: Could not connect to service or failed to recognize \\\"' + location + '\\\" \\n';",
        "600": "\t}",
        "601": "\tok_test = ( ( geocode_ok == true ) && ( json_ok == true ) && ( dataset_ok == true ) && ( location_ok == true ) );",
        "602": "\treturn { 'name' = name , 'msg' = msg , 'is_suny' = is_suny, 'url' = url, 'years' = years , 'ok' = ok_test , 'lat' = g.lat, 'lon' = g.lon };",
        "603": "}",
        "604": "",
        "605": "function wf_check( wf )",
        "606": "{",
        "607": "\tif ( file_exists( wf ) )",
        "608": "\t{",
        "609": "\t\tssc = ssc_create();",
        "610": "\t\tssc_var( ssc, 'input_file', wf );",
        "611": "\t\tresult = ssc_exec( ssc, 'wfcheck', {'show_dialog'=false} );",
        "612": "\t\tresult = to_string( result );",
        "613": "\t\tssc_free( ssc );",
        "614": "\t}",
        "615": "\telse",
        "616": "\t{",
        "617": "\t\tresult = 'Weather file checker could not find file: ' + wf ;",
        "618": "\t}",
        "619": "\treturn result;",
        "620": "}",
        "621": "",
        "622": "// returns a weather file for the current NSRDB data available for a location",
        "623": "function nsrdb_get()",
        "624": "{",
        "625": "\tenum { TMY, SINGLE_YEAR, ALL_YEARS };",
        "626": "\tenum { ONE_LOCATION, MULTIPLE_LOCATIONS };",
        "627": "\tenum { HOURLY, HALF_HOURLY };",
        "628": "\tmsg = '';",
        "629": "\tdownload_ok = true;",
        "630": "\tlocation_ok = true;",
        "631": "\tfolder = slash_back_to_forward( wfdownloaddir() );",
        "632": "\tlog_file = folder + '/sam_nsrdb_download_log.txt';",
        "633": "\tif ( file_exists( log_file ) ) { flog = open( log_file , 'a' ); }",
        "634": "\telse { flog = open( log_file, 'w' ); }",
        "635": "\twrite_line( flog, 'NSRDB Download ' + date_time());",
        "636": "\twrite_line( flog, '==========================================================\\n');\t",
        "637": "\tif ( value( 'in_location_options' ) == ONE_LOCATION )",
        "638": "\t{\t",
        "639": "\t\tlocation = [ value('in_location') ];",
        "640": "\t}",
        "641": "\telse",
        "642": "\t{",
        "643": "\t\tlocation_list = value('in_location_list'); // string with '|' delimiter",
        "644": "\t\tlocation_list = replace( location_list, '\\\"', '' ); // files from spreadsheets may use quotes for strings",
        "645": "\t\tlocation = split(location_list, '|');",
        "646": "\t}",
        "647": "\tdownload_option = value('in_nsrdb_options');",
        "648": "\tif ( value( 'in_time_step' ) == HOURLY || download_option == TMY ) // tmy is always hourly",
        "649": "\t{\t",
        "650": "\t\ttime_step = '60'; ",
        "651": "\t}",
        "652": "\telse",
        "653": "\t{",
        "654": "\t\ttime_step = '30'; ",
        "655": "\t}",
        "656": "\twrite_line( flog, 'Requested location(s): ' + location + '\\n');",
        "657": "\tpb_locations = progressbar( { 'title' = 'Download Progress' , 'message' = 'Starting download.' , 'cancelbutton' = false , 'closebutton' = false , 'time' = false , 'max' = #location } );",
        "658": "\tfor ( n=0; n<#location; n++ )",
        "659": "\t{",
        "660": "\t\twrite_line( flog, 'Location ' + to_string(n+1) + ' of ' + #location + ': \\\"' + location[n]  + '\\\"');",
        "661": "\t\twrite_line( flog, '----------------------------------------------------------\\n');\t",
        "662": "\t\tprogressbar( pb_locations, { 'message' = 'Getting download information for \\\"' + location[n] + '\\\".' , 'value' = 1+n } );",
        "663": "\t\tdataset[n] = nsrdb( location[n], download_option == TMY );",
        "664": "\t\tprogressbar( pb_locations, { 'message' = 'Processing download information for \\\"' + location[n] + '\\\".' , 'value' = 1+n } );",
        "665": "\t\tif ( !dataset[n].ok )",
        "666": "\t\t{",
        "667": "\t\t\tdownload_ok = false;",
        "668": "\t\t\twrite_line( flog, dataset[n].msg + '\\n');",
        "669": "\t\t\tmsg += dataset[n].msg + '\\n';",
        "670": "\t\t\tcontinue;",
        "671": "\t\t}\t",
        "672": "\t\tif ( download_option == TMY ) // this needs to work for both psm3-tmy and suny-india-tmy",
        "673": "\t\t{\t",
        "674": "\t\t\ttype = ['tmy']; // should get newest TMY file for psm3-tmy, or tmy for suny-india-tmy",
        "675": "\t\t}",
        "676": "\t\telseif ( download_option == SINGLE_YEAR ) ",
        "677": "\t\t{",
        "678": "\t\t\tif ( dataset[n].is_suny && time_step != '60' )",
        "679": "\t\t\t{",
        "680": "\t\t\t\tmsgbox('Only 60-minute data is available for suny-india dataset.\\nTry the Advanced Download option to see of other datasets are available for this location.');",
        "681": "\t\t\t\tdownload_ok = false;",
        "682": "\t\t\t\twrite_line( flog, 'Only 60-minute data available for suny-india dataset.\\n' );",
        "683": "\t\t\t\tcontinue;",
        "684": "\t\t\t}",
        "685": "\t\t\ty = choose_from_list( dataset[n].years, 'Choose a year', 'Available Years for \\\"' + location[n] +'\\\"', 0 ); ",
        "686": "\t\t\tif (y == '')",
        "687": "\t\t\t{",
        "688": "\t\t\t\tdownload_ok = false;",
        "689": "\t\t\t\twrite_line( flog, 'Year not valid: Selection cancelled by user.\\n' );",
        "690": "\t\t\t\tcontinue;",
        "691": "\t\t\t}",
        "692": "\t\t\telse\t",
        "693": "\t\t\t{\t",
        "694": "\t\t\t\ttype = [to_int( y )]; ",
        "695": "\t\t\t}",
        "696": "\t\t}",
        "697": "\t\telse // all years",
        "698": "\t\t{\t",
        "699": "\t\t\ttype = dataset[n].years; ",
        "700": "\t\t}",
        "701": "\t\twrite_line( flog, 'Requested year(s): ' + type );",
        "702": "\t\tif ( dataset[n].ok )",
        "703": "\t\t{ ",
        "704": "\t\t\tbase_url = dataset[n].url;",
        "705": "\t\t\tbase_url += '?api_key=<SAMAPIKEY>';",
        "706": "\t\t\tbase_url += '&full_name=sam_user';",
        "707": "\t\t\tbase_url += '&email=<USEREMAIL>';",
        "708": "\t\t\tbase_url += '&affiliation=unknown'; ",
        "709": "\t\t\tbase_url += '&mailing_list=false';",
        "710": "\t\t\tbase_url += '&reason=SAM';",
        "711": "\t\t\tbase_url += '&interval=' + time_step;",
        "712": "\t\t\tbase_url += '&utc=false';",
        "713": "\t\t\tbase_url += '&leap_day=false';",
        "714": "",
        "715": "\t\t\t// create folder for multiple years to facilitate",
        "716": "\t\t\t// p50 p90 and add to library folders list",
        "717": "\t\t\t// do not put tmy file in multiple year folder",
        "718": "\t\t\t// use default folder if mdkir() fails",
        "719": "\t\t\tdefault_download_path = slash_back_to_forward( folder );",
        "720": "\t\t\ttmy_path = slash_back_to_forward( default_download_path );",
        "721": "\t\t\tpath = slash_back_to_forward( default_download_path );",
        "722": "\t\t\tif ( #type > 1 )",
        "723": "\t\t\t{",
        "724": "\t\t\t\tpath = path + '/' + clean_name( location[n] ) ;",
        "725": "\t\t\t\tif ( !dir_exists( path ) )",
        "726": "\t\t\t\t{",
        "727": "\t\t\t\t\tif ( !mkdir( path, false ) )",
        "728": "\t\t\t\t\t{\tpath = default_download_path; }",
        "729": "\t\t\t\t}",
        "730": "\t\t\t\tif ( path != default_download_path /*&& i == 0*/)",
        "731": "\t\t\t\t{\tupdate_library_folders( path ); }",
        "732": "\t\t\t}",
        "733": "\t\t\t",
        "734": "\t\t\tpb_years = progressbar( { 'title' = 'Download Progress for ' + location[n] , 'message' = 'Downloading, please wait...', 'cancelbutton' = false , 'closebutton' = false , 'time' = false , 'max' = #type } );",
        "735": "\t\t\t\t",
        "736": "\t\t\t// for each year",
        "737": "\t\t\tbase = base_url;",
        "738": "\t\t\tfor( i=0; i<#type; i++ )",
        "739": "\t\t\t{",
        "740": "\t\t\t\tbase_url = base;",
        "741": "\t\t\t\tprogressbar( pb_years, { 'message' = 'Preparing file ' + to_string(i+1) + ' of ' + #type + '.' , 'value' = 1+i } );",
        "742": "\t\t\t\tfile_skipped = false;",
        "743": "\t\t\t\tno_current_data = false;",
        "744": "\t\t\t\t// only get attributes SAM needs for simulations",
        "745": "\t\t\t\t// otherwise default is to get all attributes",
        "746": "\t\t\t\t// https://developer.nrel.gov/docs/solar/nsrdb/",
        "747": "\t\t\t\tif ( dataset[n].name == 'psm3')",
        "748": "\t\t\t\t{",
        "749": "\t\t\t\t\tbase_url += '&attributes=dni,dhi,ghi,dew_point,air_temperature,surface_pressure,relative_humidity,wind_direction,wind_speed,surface_albedo';",
        "750": "\t\t\t\t}",
        "751": "\t\t\t\telseif ( dataset[n].name == 'psm3-tmy')",
        "752": "\t\t\t\t{",
        "753": "\t\t\t\t\tbase_url += '&attributes=dni,dhi,ghi,dew_point,air_temperature,surface_pressure,wind_direction,wind_speed,surface_albedo';",
        "754": "\t\t\t\t}",
        "755": "\t\t\t\telseif ( dataset[n].name == 'suny-india' )",
        "756": "\t\t\t\t{",
        "757": "\t\t\t\t\tbase_url += '&attributes=dni,dhi,ghi,dew_point,surface_temperature,surface_pressure,relative_humidity,wdir,wspd,snow_depth';",
        "758": "\t\t\t\t}",
        "759": "\t\t\t\telseif ( dataset[n].name == 'suny-india-tmy' )",
        "760": "\t\t\t\t{",
        "761": "\t\t\t\t\tbase_url += '&attributes=dni,dhi,ghi,dew_point,air_temperature,surface_pressure,wind_direction,wind_speed';",
        "762": "\t\t\t\t}",
        "763": "\t\t\t\telseif ( dataset[n].name == 'msg-iodc' )",
        "764": "\t\t\t\t{",
        "765": "\t\t\t\t\tbase_url += '&attributes=dni,dhi,ghi,dew_point,air_temperature,surface_pressure,relative_humidity,wind_direction,wind_speed,surface_albedo';",
        "766": "\t\t\t\t}",
        "767": "\t\t\t\twrite_line( flog, '\\nFile ' + to_string(i+1) + ' of ' + #type + ': ' + type[i]);",
        "768": "\t\t\t\twrite_line( flog, '----------------------------------------------------------\\n');\t",
        "769": "\t\t\t\turl = base_url + '&names=' + to_string(type[i]);",
        "770": "\t\t\t\turl += '&wkt=POINT(' + dataset[n].lon + '%20' + dataset[n].lat + ')';",
        "771": "\t\t\t\twrite_line( flog, url + '\\n');",
        "772": "\t\t\t\tfname = path + '/' + clean_name( location[n] ) + '_' + dataset[n].lat + '_' + dataset[n].lon + '_' + dataset[n].name + '_' + time_step + '_' + type[i] + '.csv';",
        "773": "\t\t\t\tif ( type[i] == 'tmy' ) ",
        "774": "\t\t\t\t{",
        "775": "\t\t\t\t\tfname = replace( fname, path, tmy_path ); ",
        "776": "\t\t\t\t\tfname_tmy = fname;",
        "777": "\t\t\t\t}",
        "778": "\t\t\t\tif ( solar_library( fname, false ){'is_in_library'} )",
        "779": "\t\t\t\t{",
        "780": "\t\t\t\t\tfile_skipped = true;",
        "781": "\t\t\t\t\tstr = 'File skipped, already exists: ' + fname + '\\n';",
        "782": "\t\t\t\t\twrite_line( flog, str );",
        "783": "\t\t\t\t\tmsg += str + '\\n';",
        "784": "\t\t\t\t\tif ( #location == 1 )",
        "785": "\t\t\t\t\t{",
        "786": "\t\t\t\t\t\tvalue( 'solar_resource', file_to_key( fname ) );",
        "787": "\t\t\t\t\t}\t",
        "788": "\t\t\t\t}",
        "789": "\t\t\t\telse // elseif ( !no_current_data )\t",
        "790": "\t\t\t\t{",
        "791": "\t\t\t\t\twf_error = '';",
        "792": "\t\t\t\t\tstart = start_timer();",
        "793": "\t\t\t\t\tprogressbar( pb_years, { 'message' = 'Downloading file ' + to_string(i+1) + ' of ' + #type + '.' , 'value' = 1+i } );",
        "794": "\t\t\t\t\tcurl_ok = curl( url , { 'file'= fname } ); // curl() should replace <SAMAPI> from private.h and <USEREMAIL > from registry",
        "795": "\t\t\t\t\ttime = elapsed_time() / 1000;",
        "796": "\t\t\t\t\twrite_line( flog, 'Download time: ' + time + ' seconds.\\n' );",
        "797": "\t\t\t\t\tprogressbar( pb_years, { 'message' = 'Checking file ' + to_string(i+1) + ' of ' + #type + '.' , 'value' = 1+i } );",
        "798": "\t\t\t\t\tif ( !curl_ok )",
        "799": "\t\t\t\t\t{",
        "800": "\t\t\t\t\t\tdownload_ok = false;",
        "801": "\t\t\t\t\t\twrite_line( flog, 'Failed to download file from NSRDB: cURL failed.');",
        "802": "\t\t\t\t\t\tmsg += ('Failed to download weather file ' + fname + '\\n');",
        "803": "\t\t\t\t\t}",
        "804": "\t\t\t\t\telse",
        "805": "\t\t\t\t\t{",
        "806": "\t\t\t\t\t\twf_error = wf_check( fname );",
        "807": "\t\t\t\t\t\tif ( wf_error != \"0\" ) // usually indicates NSRDB returned a file containing error message instead of weather data",
        "808": "\t\t\t\t\t\t{",
        "809": "\t\t\t\t\t\t\tdownload_ok = false;",
        "810": "\t\t\t\t\t\t\twrite_line( flog, 'Weather file test failed, ' + wf_error + ': ' + fname + '.\\n');",
        "811": "\t\t\t\t\t\t\tfile_text = read_text_file( fname );",
        "812": "\t\t\t\t\t\t\tif ( #file_text < 1000 ) // probably JSON returned by NSRDB",
        "813": "\t\t\t\t\t\t\t{ ",
        "814": "\t\t\t\t\t\t\t\tvar_err = json_read( file_text );",
        "815": "\t\t\t\t\t\t\t\tif ( strpos( var_err, 'json-error') > -1 ) // JSON not valid (could be HTML message from server)",
        "816": "\t\t\t\t\t\t\t\t{",
        "817": "\t\t\t\t\t\t\t\t\tmsg += 'Expected JSON from NSRDB is not valid. This could indicate that the NSRDB service is down.';",
        "818": "\t\t\t\t\t\t\t\t\tif ( strpos( file_text, '<html>') > -1 )",
        "819": "\t\t\t\t\t\t\t\t\t{",
        "820": "\t\t\t\t\t\t\t\t\t\thtml_dialog( file_text, 'Message from NSRDB' );",
        "821": "\t\t\t\t\t\t\t\t\t}",
        "822": "\t\t\t\t\t\t\t\t}",
        "823": "\t\t\t\t\t\t\t\telse // valid JSON with error message",
        "824": "\t\t\t\t\t\t\t\t{",
        "825": "\t\t\t\t\t\t\t\t\tmsg += 'Error message from NSRDB: \\n' + var_err.errors[0] +'\\n\\n';",
        "826": "\t\t\t\t\t\t\t\t}",
        "827": "\t\t\t\t\t\t\t\twrite_line( flog, 'Text from file:\\n' +  file_text );",
        "828": "\t\t\t\t\t\t\t}",
        "829": "\t\t\t\t\t\t\tmsg += 'Weather file test failed for ' + file_only( fname ) + '.\\n';",
        "830": "\t\t\t\t\t\t\tfname_new = replace( fname, '.csv' , '_bad.txt' ); // rename file so next download attempt won't detect existing file",
        "831": "\t\t\t\t\t\t\tok = rename_file( fname , fname_new );",
        "832": "\t\t\t\t\t\t\tif ( ok )",
        "833": "\t\t\t\t\t\t\t{ ",
        "834": "\t\t\t\t\t\t\t\twrite_line( flog, '* File renamed to: ' + fname_new + '.\\n' );",
        "835": "\t\t\t\t\t\t\t}",
        "836": "\t\t\t\t\t\t\telse",
        "837": "\t\t\t\t\t\t\t{",
        "838": "\t\t\t\t\t\t\t\twrite_line( flog, '* Failed to rename ' + fname + '.\\n' );\t",
        "839": "\t\t\t\t\t\t\t}\t",
        "840": "\t\t\t\t\t\t}",
        "841": "\t\t\t\t\t\t// set library to last file that was downloaded and passed weather file test",
        "842": "\t\t\t\t\t\telseif ( i == #type - 1 ) ",
        "843": "\t\t\t\t\t\t{",
        "844": "\t\t\t\t\t\t\trescanlibrary('solar');",
        "845": "\t\t\t\t\t\t\tfn = fname;",
        "846": "\t\t\t\t\t\t\tvalue( 'solar_resource', file_to_key( fn ) );",
        "847": "\t\t\t\t\t\t\twrite_line( flog, 'Weather file test passed: ' + fname + '.\\n');",
        "848": "\t\t\t\t\t\t}\t",
        "849": "\t\t\t\t\t}",
        "850": "\t\t\t\t}",
        "851": "\t\t\t}\t",
        "852": "\t\t\tprogressbar( pb_years );",
        "853": "\t\t}\t",
        "854": "\t\telse",
        "855": "\t\t{",
        "856": "\t\t\tdownload_ok = false;",
        "857": "\t\t\twrite_line( flog, dataset[n].msg + '\\n');",
        "858": "\t\t}",
        "859": "\t}",
        "860": "\tprogressbar( pb_locations );",
        "861": "\tclose ( flog );",
        "862": "\tif ( download_ok && #type > 1 ) // multiple years",
        "863": "\t{",
        "864": "\t\tstr = 'Download complete!\\n';",
        "865": "\t\tstr += 'Multiple single-year files downloaded to:\\n  ' + path + '\\n\\n';",
        "866": "\t\tstr += 'Do you want to show instructions for running a P50/P90 analysis now?';",
        "867": "\t\tif ( yesno( str ) )",
        "868": "\t\t{",
        "869": "\t\t\tfolder = path;",
        "870": "\t\t\tp50p90_text = 'Instructions for running P50/P90 simulations:\\n\\n'",
        "871": "\t\t\t+ '1. Click P50 / P90 at the bottom left of the main SAM window.\\n\\n'",
        "872": "\t\t\t+ '2. Click the ellipses (...) to the right of the Select Weather File Folder box.\\n\\n'",
        "873": "\t\t\t+ '3. Navigate to ' + folder + '.\\n\\n'",
        "874": "\t\t\t+ '4. Click \"Run P50/P90 simulations\".\\n'",
        "875": "\t\t\t+ '\\nIf you want to set a custom P value in addition to P10, P50 and P90, you can type a value for \"Custom Px\" before running the simulations.'",
        "876": "\t\t\t+ '\\n\\nTo remove this note window, delete all of its contents and close the window.';",
        "877": "\t\t\tpagenote( p50p90_text );",
        "878": "\t\t}",
        "879": "\t}",
        "880": "\telseif ( download_ok && !file_skipped && !no_current_data )",
        "881": "\t{",
        "882": "\t\tstr = 'Download complete!\\n';",
        "883": "\t\tstr += 'Weather file(s) downloaded to:\\n' + path + '.\\n';",
        "884": "\t\tstr += '\\nOpen log file?';",
        "885": "\t\tshow_log = yesno( str );",
        "886": "\t\tif ( show_log ) { browse( log_file ); }",
        "887": "\t}",
        "888": "\telseif ( download_ok && file_skipped )",
        "889": "\t{",
        "890": "\t\tstr = 'File already in library.\\n Download skipped.\\n\\n' + fname;",
        "891": "\t\tmsgbox( str );",
        "892": "\t}",
        "893": "\telse ",
        "894": "\t{",
        "895": "\t\tshow_log = yesno( 'Download Messages\\n' + msg + '\\nOpen log file?');",
        "896": "\t\tif ( show_log ) { browse( log_file ); }",
        "897": "\t}",
        "898": "}"
    }
}