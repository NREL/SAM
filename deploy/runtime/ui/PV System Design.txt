PV System Design
893
1029
107
GroupBox

1
8
Name
5
9
GroupBox1
X
3
306
Y
3
6
Width
3
575
Height
3
160
Tool Tip
5
0
Caption
5
14
Sizing Summary
Bold
2
1
GroupBox

1
8
Name
5
10
GroupBox11
X
3
9
Y
3
6
Width
3
293
Height
3
160
Tool Tip
5
0
Caption
5
9
AC Sizing
Bold
2
1
GroupBox

1
8
Name
5
9
GroupBox2
X
3
9
Y
3
168
Width
3
872
Height
3
764
Tool Tip
5
0
Caption
5
27
DC Sizing and Configuration
Bold
2
1
GroupBox

1
8
Name
5
9
GroupBox7
X
3
9
Y
3
933
Width
3
872
Height
3
89
Tool Tip
5
0
Caption
5
30
Estimate of Overall Land Usage
Bold
2
1
Divider

1
10
Name
5
6
HLine1
X
3
12
Y
3
783
Width
3
802
Height
3
18
Tool Tip
5
0
Orientation
3
0
Colour
4
120
120
120
255
Caption
5
29
Electrical Sizing Information
Bold
2
1
Divider

1
10
Name
5
8
HLine111
X
3
12
Y
3
255
Width
3
802
Height
3
18
Tool Tip
5
0
Orientation
3
0
Colour
4
120
120
120
255
Caption
5
24
Electrical Configuration
Bold
2
1
Divider

1
10
Name
5
7
HLine12
X
3
12
Y
3
450
Width
3
802
Height
3
24
Tool Tip
5
0
Orientation
3
0
Colour
4
120
120
120
255
Caption
5
22
Tracking & Orientation
Bold
2
1
Label

1
13
Name
5
9
Label1123
X
3
66
Y
3
399
Width
3
218
Height
3
21
Tool Tip
5
0
Caption
5
38
String Vmp at reference conditions (V)
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Label

1
13
Name
5
9
Label1124
X
3
66
Y
3
375
Width
3
218
Height
3
21
Tool Tip
5
0
Caption
5
38
String Voc at reference conditions (V)
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Label

1
13
Name
5
9
Label1133
X
3
66
Y
3
348
Width
3
218
Height
3
21
Tool Tip
5
0
Caption
5
29
Number of modules in subarray
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Label

1
13
Name
5
9
Label1145
X
3
66
Y
3
324
Width
3
218
Height
3
21
Tool Tip
5
0
Caption
5
31
Strings in parallel in subarray
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Label

1
13
Name
5
9
Label1146
X
3
66
Y
3
300
Width
3
218
Height
3
21
Tool Tip
5
0
Caption
5
30
Modules per string in subarray
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Label

1
13
Name
5
8
Label122
X
3
66
Y
3
711
Width
3
218
Height
3
21
Tool Tip
5
0
Caption
5
12
Backtracking
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Label

1
13
Name
5
10
Label12283
X
3
66
Y
3
687
Width
3
218
Height
3
21
Tool Tip
5
0
Caption
5
28
Tracker rotation limit (deg)
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Label

1
13
Name
5
10
Label12284
X
3
66
Y
3
639
Width
3
218
Height
3
21
Tool Tip
5
0
Caption
5
13
Azimuth (deg)
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Label

1
13
Name
5
7
Label13
X
3
66
Y
3
615
Width
3
218
Height
3
21
Tool Tip
5
0
Caption
5
10
Tilt (deg)
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Label

1
13
Name
5
6
Label2
X
3
24
Y
3
879
Width
3
300
Height
3
49
Tool Tip
5
0
Caption
5
89
Voltage and capacity ratings are at module reference conditions shown on the Module page.
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
4294967295
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Label

1
13
Name
5
8
Label213
X
3
12
Y
3
186
Width
3
860
Height
3
56
Tool Tip
5
0
Caption
5
285
To model a system with one array, specify properties for Subarray 1 and disable Subarrays 2, 3, and 4.  To model a sytem with up to four subarrays connected in parallel to a single bank of inverters, for each subarray, check Enable and specify a number of strings and other properties.
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Label

1
13
Name
5
8
Label214
X
3
330
Y
3
945
Width
3
533
Height
3
66
Tool Tip
5
0
Caption
5
169
SAM uses the total land area only when you specify a $/acre cost on the System Costs page: Total land area = total module area ÷ GCR × 0.0002471 (1 m² = 0.0002471 acre).
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
4294967295
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Label

1
13
Name
5
6
Label4
X
3
420
Y
3
240
Width
3
110
Height
3
21
Tool Tip
5
0
Caption
5
10
Subarray 2
TextColour
4
0
0
0
255
Bold
2
1
FontSize
3
0
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
Label

1
13
Name
5
7
Label41
X
3
555
Y
3
240
Width
3
110
Height
3
21
Tool Tip
5
0
Caption
5
10
Subarray 3
TextColour
4
0
0
0
255
Bold
2
1
FontSize
3
0
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
Label

1
13
Name
5
8
Label411
X
3
690
Y
3
240
Width
3
110
Height
3
21
Tool Tip
5
0
Caption
5
10
Subarray 4
TextColour
4
0
0
0
255
Bold
2
1
FontSize
3
0
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
Label

1
13
Name
5
9
Label4111
X
3
288
Y
3
240
Width
3
110
Height
3
21
Tool Tip
5
0
Caption
5
10
Subarray 1
TextColour
4
0
0
0
255
Bold
2
1
FontSize
3
0
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
Label

1
13
Name
5
6
Label5
X
3
288
Y
3
276
Width
3
110
Height
3
21
Tool Tip
5
0
Caption
5
16
(always enabled)
TextColour
4
128
128
128
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
Image

1
8
Name
5
8
Picture1
X
3
33
Y
3
483
Width
3
190
Height
3
102
Tool Tip
5
0
Image
7
PV System Design_Picture1.png
Centered
2
1
Numeric

1
17
Name
5
14
batt_max_power
X
3
492
Y
3
108
Width
3
82
Height
3
21
Tool Tip
5
0
Value
1
9999
Mode
3
1
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
14
Button

1
8
Name
5
17
btn_set_subarrays
X
3
18
Y
3
273
Width
3
252
Height
3
24
Tool Tip
5
0
Caption
5
31
Set subarrays for multiple MPPT
TabOrder
3
4294967295
Numeric

1
17
Name
5
21
calculated_dcac_ratio
X
3
177
Y
3
60
Width
3
82
Height
3
21
Tool Tip
5
0
Value
1
1.1
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
3
Numeric

1
17
Name
5
18
desired_dcac_ratio
X
3
177
Y
3
108
Width
3
82
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
12
desired_size
X
3
177
Y
3
84
Width
3
82
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
CheckBox

1
9
Name
5
16
enable_auto_size
X
3
15
Y
3
138
Width
3
268
Height
3
24
Tool Tip
5
0
Caption
5
33
Estimate Subarray 1 configuration
State
2
1
TabOrder
3
4294967295
Label

1
13
Name
5
8
gcr_info
X
3
21
Y
3
738
Width
3
795
Height
3
45
Tool Tip
5
0
Caption
5
258
Ground coverage ratio is used (1) to determine when a one-axis tracking system will backtrack, (2) in self-shading calculations for fixed tilt or one-axis tracking systems on the Shading page, and (3) in the total land area calculation. See Help for details.
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
4294967295
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Label

1
13
Name
5
9
gcr_label
X
3
84
Y
3
663
Width
3
200
Height
3
21
Tool Tip
5
0
Caption
5
27
Ground coverage ratio (GCR)
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Numeric

1
17
Name
5
14
inverter_count
X
3
177
Y
3
36
Width
3
82
Height
3
21
Tool Tip
5
0
Value
1
1
Mode
3
0
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
16
MultilineText

1
11
Name
5
14
layout_warning
X
3
327
Y
3
804
Width
3
478
Height
3
108
Tool Tip
5
0
Text
5
0
Editable
2
0
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
21
Label

1
13
Name
5
14
lbl_multi_mppt
X
3
66
Y
3
423
Width
3
218
Height
3
21
Tool Tip
5
0
Caption
5
32
Inverter MPPT input for subarray
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Numeric

1
17
Name
5
16
mppt_hi_inverter
X
3
204
Y
3
855
Width
3
82
Height
3
21
Tool Tip
5
0
Value
1
9999
Mode
3
1
Format
3
0
Decimals
3
1
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
19
Numeric

1
17
Name
5
17
mppt_low_inverter
X
3
204
Y
3
831
Width
3
82
Height
3
21
Tool Tip
5
0
Value
1
9999
Mode
3
1
Format
3
0
Decimals
3
1
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
18
Numeric

1
17
Name
5
17
num_strings_total
X
3
771
Y
3
60
Width
3
82
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
0
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
22
Label

1
13
Name
5
19
sizing_instructions
X
3
15
Y
3
84
Width
3
283
Height
3
52
Tool Tip
5
0
Caption
5
78
Size the system using modules per string and strings in parallel inputs below.
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Numeric

1
17
Name
5
17
subarray1_azimuth
X
3
288
Y
3
639
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
27
CheckBox

1
9
Name
5
19
subarray1_backtrack
X
3
288
Y
3
711
Width
3
101
Height
3
21
Tool Tip
5
0
Caption
5
6
Enable
State
2
0
TabOrder
3
25
Numeric

1
17
Name
5
13
subarray1_gcr
X
3
288
Y
3
663
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
27
Numeric

1
17
Name
5
28
subarray1_modules_per_string
X
3
288
Y
3
300
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
0
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
23
MonthlyFactor

1
8
Name
5
22
subarray1_monthly_tilt
X
3
288
Y
3
612
Width
3
87
Height
3
24
Tool Tip
5
0
Description
5
0
TabOrder
3
4294967295
Numeric

1
17
Name
5
20
subarray1_mppt_input
X
3
288
Y
3
423
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
0
Format
3
0
Decimals
3
0
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
18
subarray1_nmodules
X
3
288
Y
3
348
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
0
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
23
Numeric

1
17
Name
5
18
subarray1_nstrings
X
3
288
Y
3
324
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
0
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
23
Numeric

1
17
Name
5
16
subarray1_rotlim
X
3
288
Y
3
687
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
27
Numeric

1
17
Name
5
20
subarray1_string_vmp
X
3
288
Y
3
399
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
1
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
23
Numeric

1
17
Name
5
20
subarray1_string_voc
X
3
288
Y
3
375
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
1
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
23
Numeric

1
17
Name
5
14
subarray1_tilt
X
3
288
Y
3
615
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
26
CheckBox

1
9
Name
5
21
subarray1_tilt_eq_lat
X
3
288
Y
3
591
Width
3
119
Height
3
21
Tool Tip
5
0
Caption
5
13
Tilt=latitude
State
2
0
TabOrder
3
25
RadioChoice

1
11
Name
5
20
subarray1_track_mode
X
3
288
Y
3
474
Width
3
113
Height
3
119
Tool Tip
5
0
Selection
3
4294967295
Items
6
5
Fixed
1-Axis
2-Axis
Azimuth Axis
Seasonal Tilt
ShowCaptions
2
1
Horizontal
2
0
TabOrder
3
24
Numeric

1
17
Name
5
17
subarray2_azimuth
X
3
420
Y
3
639
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
34
CheckBox

1
9
Name
5
19
subarray2_backtrack
X
3
420
Y
3
711
Width
3
101
Height
3
21
Tool Tip
5
0
Caption
5
6
Enable
State
2
0
TabOrder
3
32
CheckBox

1
9
Name
5
16
subarray2_enable
X
3
420
Y
3
276
Width
3
101
Height
3
21
Tool Tip
5
0
Caption
5
6
Enable
State
2
0
TabOrder
3
29
Numeric

1
17
Name
5
13
subarray2_gcr
X
3
420
Y
3
663
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
34
Numeric

1
17
Name
5
28
subarray2_modules_per_string
X
3
420
Y
3
300
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
0
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
30
MonthlyFactor

1
8
Name
5
22
subarray2_monthly_tilt
X
3
420
Y
3
612
Width
3
87
Height
3
24
Tool Tip
5
0
Description
5
0
TabOrder
3
4294967295
Numeric

1
17
Name
5
20
subarray2_mppt_input
X
3
420
Y
3
423
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
0
Format
3
0
Decimals
3
0
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
18
subarray2_nmodules
X
3
420
Y
3
348
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
0
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
30
Numeric

1
17
Name
5
18
subarray2_nstrings
X
3
420
Y
3
324
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
0
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
30
Numeric

1
17
Name
5
16
subarray2_rotlim
X
3
420
Y
3
687
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
34
Numeric

1
17
Name
5
20
subarray2_string_vmp
X
3
420
Y
3
399
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
1
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
30
Numeric

1
17
Name
5
20
subarray2_string_voc
X
3
420
Y
3
375
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
1
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
30
Numeric

1
17
Name
5
14
subarray2_tilt
X
3
420
Y
3
615
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
33
CheckBox

1
9
Name
5
21
subarray2_tilt_eq_lat
X
3
420
Y
3
591
Width
3
113
Height
3
21
Tool Tip
5
0
Caption
5
13
Tilt=latitude
State
2
0
TabOrder
3
32
RadioChoice

1
11
Name
5
20
subarray2_track_mode
X
3
420
Y
3
474
Width
3
113
Height
3
119
Tool Tip
5
0
Selection
3
4294967295
Items
6
5
Fixed
1-Axis
2-Axis
Azimuth Axis
Seasonal tilt
ShowCaptions
2
1
Horizontal
2
0
TabOrder
3
31
Numeric

1
17
Name
5
17
subarray3_azimuth
X
3
555
Y
3
639
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
41
CheckBox

1
9
Name
5
19
subarray3_backtrack
X
3
555
Y
3
711
Width
3
98
Height
3
21
Tool Tip
5
0
Caption
5
6
Enable
State
2
0
TabOrder
3
39
CheckBox

1
9
Name
5
16
subarray3_enable
X
3
555
Y
3
276
Width
3
98
Height
3
21
Tool Tip
5
0
Caption
5
6
Enable
State
2
0
TabOrder
3
36
Numeric

1
17
Name
5
13
subarray3_gcr
X
3
555
Y
3
663
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
41
Numeric

1
17
Name
5
28
subarray3_modules_per_string
X
3
555
Y
3
300
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
0
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
37
MonthlyFactor

1
8
Name
5
22
subarray3_monthly_tilt
X
3
555
Y
3
612
Width
3
87
Height
3
24
Tool Tip
5
0
Description
5
0
TabOrder
3
4294967295
Numeric

1
17
Name
5
20
subarray3_mppt_input
X
3
555
Y
3
423
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
0
Format
3
0
Decimals
3
0
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
18
subarray3_nmodules
X
3
555
Y
3
348
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
0
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
37
Numeric

1
17
Name
5
18
subarray3_nstrings
X
3
555
Y
3
324
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
0
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
37
Numeric

1
17
Name
5
16
subarray3_rotlim
X
3
555
Y
3
687
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
41
Numeric

1
17
Name
5
20
subarray3_string_vmp
X
3
555
Y
3
399
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
1
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
37
Numeric

1
17
Name
5
20
subarray3_string_voc
X
3
555
Y
3
375
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
1
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
37
Numeric

1
17
Name
5
14
subarray3_tilt
X
3
555
Y
3
615
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
40
CheckBox

1
9
Name
5
21
subarray3_tilt_eq_lat
X
3
555
Y
3
591
Width
3
116
Height
3
21
Tool Tip
5
0
Caption
5
13
Tilt=latitude
State
2
0
TabOrder
3
39
RadioChoice

1
11
Name
5
20
subarray3_track_mode
X
3
555
Y
3
474
Width
3
113
Height
3
119
Tool Tip
5
0
Selection
3
4294967295
Items
6
5
Fixed
1-Axis
2-Axis
Azimuth Axis
Seasonal tilt
ShowCaptions
2
1
Horizontal
2
0
TabOrder
3
38
Numeric

1
17
Name
5
17
subarray4_azimuth
X
3
690
Y
3
639
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
48
CheckBox

1
9
Name
5
19
subarray4_backtrack
X
3
690
Y
3
711
Width
3
101
Height
3
21
Tool Tip
5
0
Caption
5
6
Enable
State
2
0
TabOrder
3
46
CheckBox

1
9
Name
5
16
subarray4_enable
X
3
690
Y
3
276
Width
3
98
Height
3
21
Tool Tip
5
0
Caption
5
6
Enable
State
2
0
TabOrder
3
43
Numeric

1
17
Name
5
13
subarray4_gcr
X
3
690
Y
3
663
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
48
Numeric

1
17
Name
5
28
subarray4_modules_per_string
X
3
690
Y
3
300
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
0
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
44
MonthlyFactor

1
8
Name
5
22
subarray4_monthly_tilt
X
3
690
Y
3
612
Width
3
87
Height
3
24
Tool Tip
5
0
Description
5
0
TabOrder
3
4294967295
Numeric

1
17
Name
5
20
subarray4_mppt_input
X
3
690
Y
3
423
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
0
Format
3
0
Decimals
3
0
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
18
subarray4_nmodules
X
3
690
Y
3
348
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
0
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
44
Numeric

1
17
Name
5
18
subarray4_nstrings
X
3
690
Y
3
324
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
0
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
44
Numeric

1
17
Name
5
16
subarray4_rotlim
X
3
690
Y
3
687
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
48
Numeric

1
17
Name
5
20
subarray4_string_vmp
X
3
690
Y
3
399
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
1
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
44
Numeric

1
17
Name
5
20
subarray4_string_voc
X
3
690
Y
3
375
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
1
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
44
Numeric

1
17
Name
5
14
subarray4_tilt
X
3
690
Y
3
615
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
47
CheckBox

1
9
Name
5
21
subarray4_tilt_eq_lat
X
3
690
Y
3
591
Width
3
113
Height
3
21
Tool Tip
5
0
Caption
5
13
Tilt=latitude
State
2
0
TabOrder
3
46
RadioChoice

1
11
Name
5
20
subarray4_track_mode
X
3
690
Y
3
474
Width
3
113
Height
3
119
Tool Tip
5
0
Selection
3
4294967295
Items
6
5
Fixed
1-Axis
2-Axis
Azimuth Axis
Seasonal tilt
ShowCaptions
2
1
Horizontal
2
0
TabOrder
3
45
Numeric

1
17
Name
5
15
system_capacity
X
3
492
Y
3
36
Width
3
82
Height
3
21
Tool Tip
5
0
Value
1
9999
Mode
3
1
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
7
Numeric

1
17
Name
5
10
total_area
X
3
771
Y
3
84
Width
3
82
Height
3
21
Tool Tip
5
0
Value
1
9999
Mode
3
1
Format
3
0
Decimals
3
1
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
11
Numeric

1
17
Name
5
26
total_dc_inverter_capacity
X
3
492
Y
3
84
Width
3
82
Height
3
21
Tool Tip
5
0
Value
1
9999
Mode
3
1
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
15
Numeric

1
17
Name
5
23
total_inverter_capacity
X
3
492
Y
3
60
Width
3
82
Height
3
21
Tool Tip
5
0
Value
1
9999
Mode
3
1
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
14
Numeric

1
17
Name
5
15
total_land_area
X
3
144
Y
3
981
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
9999
Mode
3
1
Format
3
0
Decimals
3
1
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
52
Numeric

1
17
Name
5
17
total_module_area
X
3
144
Y
3
957
Width
3
99
Height
3
21
Tool Tip
5
0
Value
1
9999
Mode
3
1
Format
3
0
Decimals
3
1
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
13
total_modules
X
3
771
Y
3
36
Width
3
82
Height
3
21
Tool Tip
5
0
Value
1
99999
Mode
3
0
Format
3
0
Decimals
3
0
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
8
Numeric

1
17
Name
5
15
vdcmax_inverter
X
3
204
Y
3
807
Width
3
82
Height
3
21
Tool Tip
5
0
Value
1
9999
Mode
3
1
Format
3
0
Decimals
3
1
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
17

81
array_area
3
1
Array Land Area
m2
PV System Design
0
8
1
1
1
1
0
Default
batt_max_power
3
1
Battery maximum power
kWdc
Battery
0
8
1
1
1
1
0
Numeric
calculated_dcac_ratio
3
1
DC to AC ratio
 
PV System Design
0
8
1
1
1
1
1.1
Numeric
desired_dcac_ratio
3
1
Desired DC to AC Ratio
 
PV System Design
0
2
1
1
1
1
1.1
Numeric
desired_size
3
1
Desired array size
kWdc
PV System Design
0
2
1
1
1
1
100
Numeric
enable_auto_size
3
1
Sizing Mode: Auto or Manual
 
PV System Design
0
1
1
1
1
1
0
Default
inv_num_mppt
3
1
Number of inverter MPPT inputs
 
PV System Design
0
8
1
1
1
1
1
Default
inverter_count
3
1
Number of inverters
 
PV System Design
15
=\pv_size_array
2
1
1
1
1
1
Numeric
layout_warning
3
4
PV layout warning message
 
PV System Design
0
5
1
4
0
MultilineText
mppt_hi_inverter
3
1
Maximum MPPT voltage
Vdc
PV System Design
0
8
1
1
1
1
0
Numeric
mppt_low_inverter
3
1
Minimum MPPT voltage
Vdc
PV System Design
0
8
1
1
1
1
0
Numeric
num_enabled
3
1
Number of enabled subarrays
 
PV System Design
0
8
1
1
1
1
0
Default
num_strings_total
3
1
Number of strings
 
PV System Design
32
=${pv.array.strings_in_parallel}
8
1
1
1
1
0
Numeric
offset
3
1
Row offset
m
PV System Design
0
0
1
1
1
1
0
Default
subarray1_azimuth
3
1
Azimuth 1
deg
PV System Design
0
3
1
1
1
1
180
Numeric
subarray1_backtrack
3
1
Enable backtracking 1
 
PV System Design
0
3
1
1
1
1
0
CheckBox
subarray1_gcr
3
1
Ground coverage ratio 1
 
PV System Design
0
3
1
1
1
1
0.3
Default
subarray1_modules_per_string
3
1
Subarray 1 modules per string
 
PV System Design
15
=\pv_size_array
3
1
1
1
1
10
Numeric
subarray1_monthly_tilt
3
2
Subarray 1 monthly tilt input for seasonal tilt arrays
degrees
PV System Design
0
1
1
2
1
12
0 40 40 20 20 20 20 20 20 40 40 40 

MonthlyFactor
subarray1_mppt_input
3
1
Subarray 1 inverter MPPT input
 
PV System Design
0
1
1
1
1
1
1
Numeric
subarray1_nmodules
3
1
Subarray 1 number of modules
 
PV System Design
0
9
1
1
1
1
0
Numeric
subarray1_nstrings
3
1
Number of parallel strings 1
 
PV System Design
215
=${pv.array.strings_in_parallel}
    - ?${pv.subarray2.enable}[0|${pv.subarray2.num_strings}]
    - ?${pv.subarray3.enable}[0|${pv.subarray3.num_strings}]
    - ?${pv.subarray4.enable}[0|${pv.subarray4.num_strings}]
3
1
1
1
1
1
Numeric
subarray1_rotlim
3
1
Tracker rotation limit 1
degrees
PV System Design
0
3
1
1
1
1
45
Numeric
subarray1_string_vmp
3
1
Subarray 2 string Vmp
V
PV System Design
0
9
1
1
1
1
0
Numeric
subarray1_string_voc
3
1
Subarray 1 string Voc
V
PV System Design
0
9
1
1
1
1
0
Numeric
subarray1_tilt
3
1
Tilt 1
deg
PV System Design
0
3
1
1
1
1
0
Numeric
subarray1_tilt_eq_lat
3
1
Set tilt to latitude 1
 
PV System Design
0
3
1
1
1
1
0
CheckBox
subarray1_track_mode
3
1
Tracking mode 1
 
PV System Design
46
Fixed|1 Axis|2 Axis|Azimuth Axis|Seasonal Tilt
3
1
1
1
1
0
RadioChoice
subarray2_azimuth
3
1
Azimuth 2
deg
PV System Design
0
3
1
1
1
1
180
Numeric
subarray2_backtrack
3
1
Enable backtracking 2
 
PV System Design
0
3
1
1
1
1
0
CheckBox
subarray2_enable
3
1
Enable subarray 2
 
PV System Design
0
3
1
1
1
1
0
CheckBox
subarray2_gcr
3
1
Ground coverage ratio 2
 
PV System Design
0
3
1
1
1
1
0.3
Default
subarray2_modules_per_string
3
1
Subarray 2 modules per string
 
PV System Design
0
3
1
1
1
1
1
Numeric
subarray2_monthly_tilt
3
2
Subarray 2 monthly tilt input for seasonal tilt arrays
degrees
PV System Design
0
1
1
2
1
12
0 40 40 20 20 20 20 20 20 40 40 40 

Default
subarray2_mppt_input
3
1
Subarray 2 inverter MPPT input
 
PV System Design
0
1
1
1
1
1
1
Numeric
subarray2_nmodules
3
1
Subarray 2 number of modules
 
PV System Design
0
9
1
1
1
1
0
Numeric
subarray2_nstrings
3
1
Number of parallel strings 2
 
PV System Design
0
3
1
1
1
1
1
Numeric
subarray2_rotlim
3
1
Tracker rotation limit 2
degrees
PV System Design
0
3
1
1
1
1
45
Numeric
subarray2_string_vmp
3
1
Subarray 2 string Vmp
V
PV System Design
0
9
1
1
1
1
0
Numeric
subarray2_string_voc
3
1
Subarray 2 string Voc
V
PV System Design
0
9
1
1
1
1
0
Numeric
subarray2_tilt
3
1
Tilt 2
deg
PV System Design
0
3
1
1
1
1
20
Numeric
subarray2_tilt_eq_lat
3
1
Set tilt to latitude 2
 
PV System Design
0
3
1
1
1
1
0
CheckBox
subarray2_track_mode
3
1
Tracking mode 2
 
PV System Design
46
Fixed|1 Axis|2 Axis|Azimuth Axis|Seasonal Tilt
3
1
1
1
1
0
RadioChoice
subarray3_azimuth
3
1
Azimuth 3
deg
PV System Design
0
3
1
1
1
1
180
Numeric
subarray3_backtrack
3
1
Enable backtracking 3
 
PV System Design
0
3
1
1
1
1
0
CheckBox
subarray3_enable
3
1
Enable subarray 3
 
PV System Design
0
3
1
1
1
1
0
CheckBox
subarray3_gcr
3
1
Ground coverage ratio 3
 
PV System Design
0
3
1
1
1
1
0.3
Default
subarray3_modules_per_string
3
1
Subarray 3 modules per string
 
PV System Design
0
3
1
1
1
1
1
Numeric
subarray3_monthly_tilt
3
2
Subarray 3 monthly tilt input for seasonal tilt arrays
degrees
PV System Design
0
1
1
2
1
12
0 40 40 20 20 20 20 20 20 40 40 40 

Default
subarray3_mppt_input
3
1
Subarray 3 inverter MPPT input
 
PV System Design
0
1
1
1
1
1
1
Numeric
subarray3_nmodules
3
1
Subarray 3 number of modules
 
PV System Design
0
9
1
1
1
1
0
Numeric
subarray3_nstrings
3
1
Number of parallel strings 3
 
PV System Design
0
3
1
1
1
1
1
Numeric
subarray3_rotlim
3
1
Tracker rotation limit 3
degrees
PV System Design
0
3
1
1
1
1
45
Numeric
subarray3_string_vmp
3
1
Subarray 3 string Vmp
V
PV System Design
0
9
1
1
1
1
0
Numeric
subarray3_string_voc
3
1
Subarray 3 string Voc
V
PV System Design
0
9
1
1
1
1
0
Numeric
subarray3_tilt
3
1
Tilt 3
deg
PV System Design
0
3
1
1
1
1
20
Numeric
subarray3_tilt_eq_lat
3
1
Set tilt to latitude 3
 
PV System Design
0
3
1
1
1
1
0
CheckBox
subarray3_track_mode
3
1
Tracking mode 3
 
PV System Design
46
Fixed|1 Axis|2 Axis|Azimuth Axis|Seasonal Tilt
3
1
1
1
1
0
RadioChoice
subarray4_azimuth
3
1
Azimuth 4
deg
PV System Design
0
3
1
1
1
1
180
Numeric
subarray4_backtrack
3
1
Enable backtracking 4
 
PV System Design
0
3
1
1
1
1
0
CheckBox
subarray4_enable
3
1
Enable subarray 4
 
PV System Design
0
3
1
1
1
1
0
CheckBox
subarray4_gcr
3
1
Ground coverage ratio 4
 
PV System Design
0
3
1
1
1
1
0.3
Default
subarray4_modules_per_string
3
1
Subarray 4 modules per string
 
PV System Design
0
3
1
1
1
1
1
Numeric
subarray4_monthly_tilt
3
2
Subarray 4 monthly tilt input for seasonal tilt arrays
degrees
PV System Design
0
1
1
2
1
12
0 40 40 20 20 20 20 20 20 40 40 40 

Default
subarray4_mppt_input
3
1
Subarray 4 inverter MPPT input
 
PV System Design
0
1
1
1
1
1
1
Numeric
subarray4_nmodules
3
1
Subarray 4 number of modules
 
PV System Design
0
9
1
1
1
1
0
Numeric
subarray4_nstrings
3
1
Number of parallel strings 4
 
PV System Design
0
3
1
1
1
1
1
Numeric
subarray4_rotlim
3
1
Tracker rotation limit 4
degrees
PV System Design
0
3
1
1
1
1
45
Numeric
subarray4_string_vmp
3
1
Subarray 4 string Vmp
V
PV System Design
0
9
1
1
1
1
0
Numeric
subarray4_string_voc
3
1
Subarray 4 string Voc
V
PV System Design
0
9
1
1
1
1
0
Numeric
subarray4_tilt
3
1
Tilt 4
deg
PV System Design
0
3
1
1
1
1
20
Numeric
subarray4_tilt_eq_lat
3
1
Set tilt to latitude 4
 
PV System Design
0
3
1
1
1
1
0
CheckBox
subarray4_track_mode
3
1
Tracking mode 4
 
PV System Design
46
Fixed|1 Axis|2 Axis|Azimuth Axis|Seasonal Tilt
3
1
1
1
1
0
RadioChoice
system_capacity
3
1
Nameplate DC capacity
kWdc
PV System Design
0
8
1
1
1
1
0
Numeric
total_area
3
1
Total module area
m²
PV System Design
0
8
1
1
1
1
0
Numeric
total_dc_inverter_capacity
3
1
Total inverter DC capacity
kWdc
PV System Design
0
8
1
1
1
1
0
Numeric
total_inverter_capacity
3
1
Total AC capacity
kWac
PV System Design
0
8
1
1
1
1
0
Numeric
total_land_area
3
1
Total land area
acres
PV System Design
0
8
1
1
1
1
0
Numeric
total_module_area
3
1
Total module area
m²
PV System Design
0
8
1
1
1
1
0
Numeric
total_modules
3
1
Number of modules
 
PV System Design
0
8
1
1
1
1
0
Numeric
vdcmax_inverter
3
1
Maximum DC voltage
Vdc
PV System Design
0
8
1
1
1
1
0
Numeric

11400
equations{ '$MIMO$ pv_size_array' } = define()
{
	if (${enable_auto_size}==1)
	{
		//disable subarrays 2-4- this only works for a single subarray
		${subarray2_enable} = 0;
		${subarray3_enable} = 0;
		${subarray4_enable} = 0;
		
		//Now size subarray 1 only
		/* Sizing rules
		1. Voc < Vdcmax
		2. Vmp > Vmin
		3. Vmp < Vmax
		4. num series * num_parallel is about desired array size (num_parallel = desired / (num series * mod_power)
		5. num inverters is about desired array size (num_inv = num_series * num_parallel * mod_power) / inv_power
		*/
			
		// module parameters
		mod_vmp= ?${module_model} [	${spe_vmp},${cec_v_mp_ref},${6par_vmp},${snl_ref_vmp},${sd11par_Vmp0}];
		mod_voc= ?${module_model} [	${spe_voc},${cec_v_oc_ref},${6par_voc},${snl_ref_voc},${sd11par_Voc0}];
		mod_power= ?${module_model} [${spe_power}, ${cec_p_mp_ref}, ${6par_pmp}, ${snl_ref_pmp},${sd11par_Pmp0}];

		// inverter parameters
		inv_vmin= ?${inverter_model} [${inv_snl_mppt_low}, ${inv_ds_mppt_low}, ${inv_pd_mppt_low},${inv_cec_cg_mppt_low}];
		inv_vdcmax= ?${inverter_model} [${inv_snl_vdcmax}, ${inv_ds_vdcmax}, ${inv_pd_vdcmax},${inv_cec_cg_vdcmax}];
		inv_vmax= ?${inverter_model} [${inv_snl_mppt_hi}, ${inv_ds_mppt_hi}, ${inv_pd_mppt_hi},${inv_cec_cg_mppt_hi}];
		inv_power= ?${inverter_model} [${inv_snl_paco}, ${inv_ds_paco}, ${inv_pd_paco},${inv_cec_cg_paco}];
		
		// DC-connected battery parameters (assumed to use common inverter)
		batt_max_power_dc = 0; // TO DO is this used?
		if ( technology() == 'PV Battery' )
		{
			if (${batt_ac_or_dc} == 0) 
			{
				batt_max_power_dc = ${batt_max_power};
			}
		}
		
		// calculations
		if(mod_vmp>0)
		{
			num_series= 0.5 * (inv_vmin + inv_vmax)/mod_vmp;}
			if(inv_vdcmax > 0){
				while ((num_series > 0) && ((num_series*mod_voc) > inv_vdcmax)){
					num_series= num_series -1;
				}
			}
		if (num_series < 1) num_series= 1;
		num_series= round(num_series);
		num_parallel= ${desired_size} * 1000 /(num_series * mod_power);
		if (num_parallel < 1) num_parallel= 1;
		num_parallel= round(num_parallel);
		if (${desired_dcac_ratio} > 0)
		{ 	inverters = ((num_series * num_parallel * mod_power) /* + batt_max_power_dc */) / (${desired_dcac_ratio} * inv_power);
			//round inverters for best DC-AC ratio
			if((inverters - floor(inverters)) < 0.5)
			{	num_inverters = floor(inverters); }
			else
			{	num_inverters = ceil(inverters); }
		}				
		else
		{ num_inverters = ceil(((num_series * num_parallel * mod_power) /* + batt_max_power_dc */) / inv_power);}
		if (num_inverters < 1)
		{ num_inverters = 1;}
		
		//check that the sizing was close to the desired sizes, otherwise, error out if more than 10% away
		proposed_size = num_series * num_parallel * mod_power / 1000; //convert W to kW
		proposed_ratio = proposed_size / (num_inverters * inv_power / 1000); //convert inverter W to kW
		if (abs(proposed_size - ${desired_size}) / ${desired_size} > 0.2) // || abs(proposed_ratio - ${desired_dcac_ratio}) / ${desired_dcac_ratio} > 0.1)
		{
			num_series = 0;
			num_parallel = 0;
			inverter_count = 0;
			msgbox('SAM was not able to automatically size the system close enough to your desired size. Please size the system manually, or enter another size.');
		}	
		
		//assign the final calculated numbers
		${subarray1_modules_per_string} = num_series;
		${subarray1_nstrings} = num_parallel;
		${inverter_count} = num_inverters;
	}

};

equations{ 'total_modules' } = define() {
	a = ${subarray1_modules_per_string} * ${subarray1_nstrings}
		+ (${subarray2_modules_per_string} * ${subarray2_nstrings}) * ${subarray2_enable}
		+ (${subarray3_modules_per_string} * ${subarray3_nstrings}) * ${subarray3_enable}
		+ (${subarray4_modules_per_string} * ${subarray4_nstrings}) * ${subarray4_enable};

	return a; };

equations{ 'system_capacity' } = define() {
	return ?${module_model}
[
	${spe_power},
	${cec_p_mp_ref},
	${6par_pmp},
	${snl_ref_pmp},
	${sd11par_Pmp0}
] 
	* ${total_modules} / 1000; };
	
equations{ 'total_area' } = define() {
	return ?${module_model}
[
	${spe_area},
	${cec_area},
	${6par_area},
	${snl_area},
	${sd11par_area}
] 
	* ${total_modules}; };

equations{ 'total_module_area' } = define() {
	return ${total_area};
};

equations{ 'calculated_dcac_ratio' } = define() {
	return ${system_capacity} /${total_inverter_capacity} ;
};

equations{ 'inv_num_mppt' } = define() {
	return ?${inverter_model}
	[
		${inv_snl_num_mppt},
		${inv_ds_num_mppt}, 
		${inv_pd_num_mppt}, 
		${inv_cec_cg_num_mppt}
	] ;
};

equations{ 'subarray1_string_voc' } = define() {
	return ?${module_model}
[
	${spe_voc},
	${cec_v_oc_ref},
	${6par_voc},
	${snl_voco},
	${sd11par_Voc0}
]
	* ${subarray1_modules_per_string}; };
	
equations{ 'subarray2_string_voc' } = define() {
	return ?${module_model}
[
	${spe_voc},
	${cec_v_oc_ref},
	${6par_voc},
	${snl_voco},
	${sd11par_Voc0}
]
	* ${subarray2_modules_per_string}; };
	
equations{ 'subarray3_string_voc' } = define() {
	return ?${module_model}
[
	${spe_voc},
	${cec_v_oc_ref},
	${6par_voc},
	${snl_voco},
	${sd11par_Voc0}
]
	* ${subarray3_modules_per_string}; };
	
equations{ 'subarray4_string_voc' } = define() {
	return ?${module_model}
[
	${spe_voc},
	${cec_v_oc_ref},
	${6par_voc},
	${snl_voco},
	${sd11par_Voc0}
]
	* ${subarray4_modules_per_string}; };
	
equations{ 'subarray1_string_vmp' } = define() {
	return ?${module_model}
[
	${spe_vmp},
	${cec_v_mp_ref},
	${6par_vmp},
	${snl_ref_vmp},
	${sd11par_Vmp0}
]
	* ${subarray1_modules_per_string}; };
	
equations{ 'subarray2_string_vmp' } = define() {
	return ?${module_model}
[
	${spe_vmp},
	${cec_v_mp_ref},
	${6par_vmp},
	${snl_ref_vmp},
	${sd11par_Vmp0}
]
	* ${subarray2_modules_per_string}; };
	
equations{ 'subarray3_string_vmp' } = define() {
	return ?${module_model}
[
	${spe_vmp},
	${cec_v_mp_ref},
	${6par_vmp},
	${snl_ref_vmp},
	${sd11par_Vmp0}
]
	* ${subarray3_modules_per_string}; };
	
equations{ 'subarray4_string_vmp' } = define() {
	return ?${module_model}
[
	${spe_vmp},
	${cec_v_mp_ref},
	${6par_vmp},
	${snl_ref_vmp},
	${sd11par_Vmp0}
]
	* ${subarray4_modules_per_string}; };

equations{ 'total_inverter_capacity' } = define() {
	return ?${inverter_model} 
[ 
	${inv_snl_paco},
	${inv_ds_paco}, 
	${inv_pd_paco}, 
	${inv_cec_cg_paco}
] 
	* ${inverter_count} /1000; };

equations{ 'total_dc_inverter_capacity' } = define() {
	return ?${inverter_model} 
[ 
	${inv_snl_pdco},
	${inv_ds_pdco}, 
	${inv_pd_pdco}, 
	${inv_cec_cg_pdco}
] 
	* ${inverter_count} /1000; };
	
equations{ 'vdcmax_inverter' } = define() {
	return ?${inverter_model}
[
	${inv_snl_vdcmax},
	${inv_ds_vdcmax},
	${inv_pd_vdcmax},
	${inv_cec_cg_vdcmax}
]; };

equations{ 'mppt_low_inverter' } = define() {
	return ?${inverter_model} 
[ 	
	${inv_snl_mppt_low}, 
	${inv_ds_mppt_low}, 
	${inv_pd_mppt_low},
	${inv_cec_cg_mppt_low}	
]; };

equations{ 'mppt_hi_inverter' } = define() {
	return ?${inverter_model} 
[ 
	${inv_snl_mppt_hi}, 
	${inv_ds_mppt_hi},
	${inv_pd_mppt_hi},
	${inv_cec_cg_mppt_hi}
]; };

equations{ 'num_enabled' } = define() {
	return 1+${subarray2_enable}+${subarray3_enable}+${subarray4_enable}; };

equations{ 'num_strings_total' } = define() {
	return ${subarray1_nstrings} 
		+ (?${subarray2_enable}[0,${subarray2_nstrings}])
		+ (?${subarray3_enable}[0,${subarray3_nstrings}])
		+ (?${subarray4_enable}[0,${subarray4_nstrings}]) ; };

equations{ 'total_land_area' } = define() {
	area = ?${module_model}
	[
		${spe_area},
		${cec_area},
		${6par_area},
		${snl_area},
		${sd11par_area}
	] ;
	land = area *
		(${subarray1_modules_per_string}*${subarray1_nstrings}/${subarray1_gcr} +
		 ${subarray2_enable}*${subarray2_modules_per_string}*${subarray2_nstrings}/${subarray2_gcr} + 
		 ${subarray3_enable}*${subarray3_modules_per_string}*${subarray3_nstrings}/${subarray3_gcr} +
		 ${subarray4_enable}*${subarray4_modules_per_string}*${subarray4_nstrings}/${subarray4_gcr});
	return land	* 0.0002471; }; //convert to acres

equations{ 'array_area' } = define() {
	return ${total_area}; };

equations{ 'layout_warning'} = define(){

	message = '';
	
	// DC-connected battery parameters (assumed to use common inverter)
	//dc_connected_battery = false; TO DO remove?
	if (technology() == 'PV Battery')
	{
		if (${batt_ac_or_dc} == 0) // dc connected battery
		{
			x = (${system_capacity} + ${batt_max_power})/${total_inverter_capacity};
			x_no_batt = (${system_capacity})/${total_inverter_capacity};
			message += ('PV array DC to inverter AC capacity ratio is ' + sprintf('%.2f', x_no_batt) + '.\nPV array + battery DC to inverter AC capacity ratio is ' +  sprintf('%.2f', x) + '.\n');
			//dc_connected_battery = true;
		}
	}
	
	//string voltage information	
	mod_vmp= ?${module_model} [	${spe_vmp},${cec_v_mp_ref},${6par_vmp},${snl_ref_vmp},${sd11par_Vmp0}];
	mod_voc= ?${module_model} [	${spe_voc},${cec_v_oc_ref},${6par_voc},${snl_ref_voc},${sd11par_Voc0}];

	min_modules = ceil(${mppt_low_inverter} / mod_vmp);
	max_modules = floor(${mppt_hi_inverter} / mod_voc);
	if ( ${mppt_low_inverter} == 0 || ${mppt_hi_inverter} == 0 )
	{
		message +='This inverter does not have data for MPPT voltage limits, so SAM cannot calculate MPPT clipping.\n';
	}
	elseif (max_modules < min_modules)
	{
		message += 'For this combination of module and inverter, it is not possible to size the string to keep string Voc and Vmp within the MPPT voltage limits. ';
		message += 'To avoid inverter MPPT clipping, try a different module or inverter.\n';
	}
	else 
	{
		//string voc & vmp
		voc = [${subarray1_string_voc}, ${subarray2_enable} * ${subarray2_string_voc}, ${subarray3_enable} * ${subarray3_string_voc}, ${subarray4_enable} * ${subarray4_string_voc}];
		vmp = [${subarray1_string_vmp}, ${subarray2_enable} * ${subarray2_string_vmp}, ${subarray3_enable} * ${subarray3_string_vmp}, ${subarray4_enable} * ${subarray4_string_vmp}];

		for (i=0; i<4; i++)
		{
			if (voc[i] != 0 && (voc[i] < ${mppt_low_inverter} || vmp[i] < ${mppt_low_inverter}))
				message += 'Subarray ' + to_string(i+1) + ' string voltage is below the inverter minimum MPPT voltage at reference conditions. Consider using more modules per string.\n';
			else if (voc[i] != 0 && (voc[i] > ${vdcmax_inverter} || vmp[i] > ${vdcmax_inverter}))
				message += 'Subarray ' + to_string(i+1) + ' string voltage exceeds the inverter maximum rated voltage at reference conditions. Consider using fewer modules per string.\n';
			else if (voc[i] != 0 && (voc[i] > ${mppt_hi_inverter} || vmp[i] > ${mppt_hi_inverter}))
				message += 'Subarray ' + to_string(i+1) + ' string voltage exceeds the inverter maximum MPPT voltage at reference conditions. Consider using fewer modules per string.\n';
		}
	}

	if (message == '')
		message = 'No system sizing messages.';
	return message; 
};

equations{ 'subarray1_nmodules' } = define() 
{
	return ${subarray1_modules_per_string} * ${subarray1_nstrings};
};

equations{ 'subarray2_nmodules' } = define() 
{
	return ${subarray2_enable} * ${subarray2_modules_per_string} * ${subarray2_nstrings};
};

equations{ 'subarray3_nmodules' } = define() 
{
	return ${subarray3_enable} * ${subarray3_modules_per_string} * ${subarray3_nstrings};
};

equations{ 'subarray4_nmodules' } = define() 
{
	return ${subarray4_enable} * ${subarray4_modules_per_string} * ${subarray4_nstrings};
};

equations{ 'batt_max_power' } = define() 
{
	max_power = 0;
	if ( technology() == 'PV Battery') 
	{
		max_power = ${batt_power_discharge_max_kwdc};
	}
	return max_power;
};

8110
// NOTE: This form is used for both Flat Plate PV
// and PV Battery configurations

//show warning if azimuth value is out of range
//to avoid triggering simulation message
function azimuth_warning(az,n_sub)
{
	if ( az < 0 || az > 359.9 ) //max in ssc vartable is 359.9
	{
		msgbox('Azimuth value out of range!\nThe azimuth value must be between 0 and 359.9 degrees. Resetting Subarray ' + n_sub + ' Azimuth value to default value of 180.');
		value('subarray'+n_sub+'_azimuth',180);
	}
}
//show warning about MPPT input number
function mppt_warning()
{
	msg = '';
	for (i = 1; i <=4; i++)
	{
		en = true;
		if ( i != 1)
			en = value('subarray' + to_string(i) + '_enable');
		var = 'subarray' + to_string(i) + '_mppt_input';
		if (en && value(var) > value('inv_num_mppt'))
		{
			msg = 'Inverter MPPT Input Error!\nSubarray ' + i + ' is enabled with inverter MPPT input for subarray set to ' + value(var) + ', which exceeds the number of inverter MPPT inputs, ' + value('inv_num_mppt') + '.';
			msg += '\n\nEither change the number of MPPT inputs on the Inverter input page, or correct the inverter MPPT input for the subarray.';
		}	
	}
	if (msg!='') msgbox(msg);
}

// enable subarrays and assign mppt input number
// based on number of mppt inputs from inverter page
function mppt_enable_subarrays()
{
	num_mppt = value('inv_num_mppt');
	if ( num_mppt < 1 || num_mppt > 4 )
	{
		msgbox( 'Number of MPPT Inputs Error!\nThe number of MPPT inputs is ' + num_mppt + '. It must be between 1 and 4.\n\nTo fix the problem, on the Inverter page, change the Number of MPPT Inputs value.' );
		return;
	}
	if ( num_mppt > 1 )
		for ( i=0; i<4; i++ )
		{
			if ( i > 0 && i < num_mppt )
			{
				value( 'subarray' + to_string(i+1) + '_enable' , 1 );
				value( 'subarray' + to_string(i+1) + '_mppt_input' , i+1 );
			}
			elseif ( i > 0 )
				value( 'subarray' + to_string(i+1) + '_enable' , 0 );
		}
}

//shows or hides all subarray inputs, to be used when subarrays are enabled or disabled
function sysdesign_show_hide_subarray_inputs( isub, en)
{
	auto_size = (value('enable_auto_size') == 1);
	prefix = "subarray" + to_string(isub) + "_";
	all_subarray_variables = [		
		"azimuth",
		"backtrack",
		"gcr",
		"modules_per_string",
		"monthly_tilt", 
		"mppt_input", 
		"nmodules",
		"nstrings",
		"rotlim",
		"string_vmp",
		"string_voc",
		"tilt",
		"tilt_eq_lat",
		"track_mode" ];
		
	//hide all subarray related inputs if the subarray is disabled
	if (!en)
	{
		for (i=0;i<#all_subarray_variables;i++)
			show( prefix + all_subarray_variables[i], 0 );
	}
	
	//if subarray is enabled, then need to show all inputs, then fix tracking inputs
	else
	{
		//show all inputs
		for (i=0;i<#all_subarray_variables;i++)
			show( prefix + all_subarray_variables[i], 1 );
			
		//number of modules per string and number of strings only show up if auto-size is off
		enable(prefix + 'modules_per_string', !auto_size);
		enable(prefix + 'nstrings', !auto_size);

		//MPPT inputs only show up if multi-MPPT inverter specified
		multi_mppt = ( value('inv_num_mppt') > 1 );
		if (!multi_mppt) //set mppt input back to 1 if not multi-mppt so that simulation will run correctly
			value(prefix + 'mppt_input', 1);
		show( prefix + "mppt_input", multi_mppt);
		
		//Tracking inputs
		tracking = value(prefix + "track_mode");
		//seasonal tilt vs normal tilts
		seasonal = (tracking == 4);
		show(prefix + "monthly_tilt", seasonal);
		show(prefix + "tilt_eq_lat", !seasonal);
		show(prefix + "tilt", !seasonal);
		//tilt=lat checkbox: subarray must be enabled and tracking mode must be fixed, 1-axis, or A-axis	
		enable(prefix + "tilt_eq_lat", (tracking == 0 || tracking == 1 || tracking == 3));	
		//tilt: subarray must be enabled, tracking mode must be fixed, 1-axis, or A-axis, and tilt=lat must not be checked
		tel = value(prefix+"tilt_eq_lat");
		enable(prefix + "tilt", (tel==0) && (tracking == 0 || tracking == 1 || tracking == 3));
		//azimuth: subarray must be enabled, tracking mode must be fixed, 1-axis, or seasonal
		enable( prefix+"azimuth", (tracking == 1 || tracking == 0 || tracking == 4) );	
		//tracker rotation limit and backtracking: subarray must be enabled, tracking mode must be 1-axis
		enable( prefix+"rotlim", (tracking == 1) );
		enable( prefix+"backtrack", (tracking==1) );	
	}
	
	refresh();
}

function show_hide_inputs_auto_size() 
{
	if (value('enable_auto_size') == 0)
	{
		enable('inverter_count', 1);
		show('sizing_instructions', 1);
		show('desired_size', 0);
		show('desired_dcac_ratio', 0);
		enable('subarray2_enable', 1);
		enable('subarray3_enable', 1);
		enable('subarray4_enable', 1);
		sysdesign_show_hide_subarray_inputs(1, 1);
		sysdesign_show_hide_subarray_inputs(2, value('subarray2_enable'));
		sysdesign_show_hide_subarray_inputs(3, value('subarray3_enable'));
		sysdesign_show_hide_subarray_inputs(4, value('subarray4_enable'));
	}
	else
	{
		enable('inverter_count', 0);
		show('sizing_instructions', 0);
		show('desired_size', 1);
		show('desired_dcac_ratio', 1);
		enable('subarray2_enable', 0);
		enable('subarray3_enable', 0);
		enable('subarray4_enable', 0);
		sysdesign_show_hide_subarray_inputs(1, 1);
		sysdesign_show_hide_subarray_inputs(2, 0);
		sysdesign_show_hide_subarray_inputs(3, 0);
		sysdesign_show_hide_subarray_inputs(4, 0);
	}
	
	refresh();
}

on_load{'PV System Design'} = define()
{
	// show/hide/enable/disable inputs for all subarrays
	show_hide_inputs_auto_size();
	/*sysdesign_show_hide_subarray_inputs(1, 1);
	sysdesign_show_hide_subarray_inputs(2, value('subarray2_enable'));
	sysdesign_show_hide_subarray_inputs(3, value('subarray3_enable'));
	sysdesign_show_hide_subarray_inputs(4, value('subarray4_enable'));
	*/// show/hide label for multiple MPPT inputs
	multi_mppt = ( value('inv_num_mppt') > 1 );
	show('lbl_multi_mppt', multi_mppt);
	show('btn_set_subarrays', multi_mppt);
	// show/hide battery max power input
	show('batt_max_power', (technology() == 'PV Battery') );
	// warning for MPPT input > number of inverter inputs
	if (multi_mppt)	{ mppt_warning(); }
	refresh();
};

on_change{'btn_set_subarrays'} = define() { mppt_enable_subarrays(); };

on_change{'enable_auto_size'} = define() { show_hide_inputs_auto_size(); };

on_change{'subarray2_enable'} = define() { sysdesign_show_hide_subarray_inputs( 2, value('subarray2_enable') ); };
on_change{'subarray3_enable'} = define() { sysdesign_show_hide_subarray_inputs( 3, value('subarray3_enable') ); };
on_change{'subarray4_enable'} = define() { sysdesign_show_hide_subarray_inputs( 4, value('subarray4_enable') ); };

on_change{'subarray1_tilt_eq_lat'} = define() { sysdesign_show_hide_subarray_inputs( 1, 1 ); };
on_change{'subarray2_tilt_eq_lat'} = define() { sysdesign_show_hide_subarray_inputs( 2, value('subarray2_enable') ); };
on_change{'subarray3_tilt_eq_lat'} = define() { sysdesign_show_hide_subarray_inputs( 3, value('subarray3_enable') ); };
on_change{'subarray4_tilt_eq_lat'} = define() { sysdesign_show_hide_subarray_inputs( 4, value('subarray4_enable')); };

on_change{'subarray1_track_mode'} = define() {  sysdesign_show_hide_subarray_inputs( 1, 1 );  };
on_change{'subarray2_track_mode'} = define() {  sysdesign_show_hide_subarray_inputs( 2, value('subarray2_enable') );  };
on_change{'subarray3_track_mode'} = define() {  sysdesign_show_hide_subarray_inputs( 3, value('subarray3_enable') );  };
on_change{'subarray4_track_mode'} = define() {  sysdesign_show_hide_subarray_inputs( 4, value('subarray4_enable') );  };

on_change{'subarray1_mppt_input'} = define() {  mppt_warning();  };
on_change{'subarray2_mppt_input'} = define() {  mppt_warning();  };
on_change{'subarray3_mppt_input'} = define() {  mppt_warning();  };
on_change{'subarray4_mppt_input'} = define() {  mppt_warning();  };

on_change{'subarray1_azimuth'} = define() { azimuth_warning(value('subarray1_azimuth'),1); };
on_change{'subarray2_azimuth'} = define() { azimuth_warning(value('subarray2_azimuth'),2); };
on_change{'subarray3_azimuth'} = define() { azimuth_warning(value('subarray3_azimuth'),3); };
on_change{'subarray4_azimuth'} = define() { azimuth_warning(value('subarray4_azimuth'),4); };
