Wind Farm Costs
793
483
35
Numeric

1
17
Name
5
14
bos_cost_fixed
X
3
459
Y
3
279
Width
3
117
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
1
$
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
15
bos_cost_per_kw
X
3
171
Y
3
279
Width
3
114
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
1
$
Suffix
5
3
/kW
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
20
bos_cost_per_turbine
X
3
306
Y
3
279
Width
3
132
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
1
$
Suffix
5
8
/turbine
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
14
bos_cost_total
X
3
600
Y
3
279
Width
3
129
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
1
$
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Button

1
8
Name
5
16
btn_est_bos_cost
X
3
27
Y
3
162
Width
3
264
Height
3
24
Tool Tip
5
0
Caption
5
36
Estimate balance of system costs now
TabOrder
3
4294967295
Button

1
8
Name
5
20
btn_est_turbine_cost
X
3
27
Y
3
135
Width
3
264
Height
3
24
Tool Tip
5
0
Caption
5
26
Estimate turbine costs now
TabOrder
3
4294967295
RadioChoice

1
11
Name
5
12
install_type
X
3
27
Y
3
87
Width
3
222
Height
3
48
Tool Tip
5
0
Selection
3
0
Items
6
2
Land-based installation
Offshore installation
ShowCaptions
2
1
Horizontal
2
0
TabOrder
3
4294967295
Divider

1
10
Name
5
9
object 22
X
3
24
Y
3
390
Width
3
708
Height
3
16
Tool Tip
5
0
Orientation
3
0
Colour
4
120
120
120
255
Caption
5
10
Total Cost
Bold
2
1
Divider

1
10
Name
5
11
object 2219
X
3
24
Y
3
336
Width
3
708
Height
3
16
Tool Tip
5
0
Orientation
3
0
Colour
4
120
120
120
255
Caption
5
9
Sales Tax
Bold
2
1
GroupBox

1
8
Name
5
8
object 4
X
3
6
Y
3
207
Width
3
779
Height
3
270
Tool Tip
5
0
Caption
5
13
Capital Costs
Bold
2
1
GroupBox

1
8
Name
5
10
object 424
X
3
6
Y
3
12
Width
3
780
Height
3
186
Tool Tip
5
0
Caption
5
19
Capital Cost Models
Bold
2
1
Label

1
13
Name
5
8
object 7
X
3
303
Y
3
96
Width
3
456
Height
3
96
Tool Tip
5
0
Caption
5
371
Turbine and/or balance of system (BOS) costs may be able to be estimated for some systems by using the buttons to the left to access various NREL cost models. If your system is not eligible for the cost models available, or you wish to input your own cost data, costs for either category may be entered directly in the "Capital Costs" section below. See Help for details.
TextColour
4
255
128
0
255
Bold
2
0
FontSize
3
4294967295
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Label

1
13
Name
5
10
object 721
X
3
12
Y
3
279
Width
3
156
Height
3
24
Tool Tip
5
0
Caption
5
22
Balance of System cost
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Label

1
13
Name
5
10
object 722
X
3
12
Y
3
54
Width
3
747
Height
3
30
Tool Tip
5
0
Caption
5
125
Please ensure that the installation type below matches the resource file you have selected if you plan to estimate any costs.
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
4294967295
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Label

1
13
Name
5
10
object 726
X
3
315
Y
3
225
Width
3
114
Height
3
24
Tool Tip
5
0
Caption
5
16
Cost per turbine
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
Label

1
13
Name
5
10
object 727
X
3
78
Y
3
252
Width
3
90
Height
3
24
Tool Tip
5
0
Caption
5
12
Turbine cost
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Label

1
13
Name
5
10
object 728
X
3
12
Y
3
27
Width
3
207
Height
3
24
Tool Tip
5
0
Caption
5
32
Your current wind resource file:
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
Label

1
13
Name
5
10
object 729
X
3
468
Y
3
225
Width
3
66
Height
3
24
Tool Tip
5
0
Caption
5
10
Fixed Cost
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
Label

1
13
Name
5
10
object 730
X
3
291
Y
3
225
Width
3
12
Height
3
24
Tool Tip
5
0
Caption
5
1
+
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
Label

1
13
Name
5
10
object 731
X
3
444
Y
3
225
Width
3
12
Height
3
24
Tool Tip
5
0
Caption
5
1
+
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
Label

1
13
Name
5
10
object 732
X
3
582
Y
3
225
Width
3
12
Height
3
24
Tool Tip
5
0
Caption
5
1
=
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
Label

1
13
Name
5
10
object 733
X
3
609
Y
3
225
Width
3
36
Height
3
24
Tool Tip
5
0
Caption
5
5
Total
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
Label

1
13
Name
5
10
object 734
X
3
177
Y
3
225
Width
3
90
Height
3
24
Tool Tip
5
0
Caption
5
11
Cost per kW
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
Numeric

1
17
Name
5
18
reference_capacity
X
3
171
Y
3
306
Width
3
63
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
0
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
25
reference_number_turbines
X
3
390
Y
3
306
Width
3
48
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
0
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
TextEntry

1
11
Name
5
23
reference_resource_file
X
3
222
Y
3
27
Width
3
558
Height
3
24
Tool Tip
5
0
Text
5
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
27
reference_sales_tax_percent
X
3
519
Y
3
360
Width
3
66
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
1
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
15
sales_tax_basis
X
3
330
Y
3
360
Width
3
90
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
0
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
15
sales_tax_total
X
3
600
Y
3
360
Width
3
129
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
1
$
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
20
total_installed_cost
X
3
600
Y
3
411
Width
3
129
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
1
$
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
27
total_installed_cost_per_kw
X
3
600
Y
3
438
Width
3
129
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
1
$
Suffix
5
3
/kW
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
18
turbine_cost_fixed
X
3
459
Y
3
252
Width
3
117
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
1
$
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
19
turbine_cost_per_kw
X
3
171
Y
3
252
Width
3
114
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
1
$
Suffix
5
3
/kW
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
24
turbine_cost_per_turbine
X
3
306
Y
3
252
Width
3
132
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
1
$
Suffix
5
8
/turbine
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
18
turbine_cost_total
X
3
600
Y
3
252
Width
3
129
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
1
$
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295

21
bos_cost_fixed
3
1
BOS fixed costs
$
Wind Farm Costs
0
3
1
1
1
1
0
Default
bos_cost_per_kw
3
1
BOS cost per kW
$/kW
Wind Farm Costs
0
3
1
1
1
1
0
Default
bos_cost_per_turbine
3
1
BOS cost per turbine
$/turbine
Wind Farm Costs
0
3
1
1
1
1
0
Default
bos_cost_total
3
1
Total BOS cost
$
Wind Farm Costs
0
9
1
1
1
1
0
Default
est_bos_cost
3
0
 
 
Wind Farm Costs
0
0
1
0
Default
est_turbine_cost
3
1
 
 
Wind Farm Costs
0
0
1
1
1
1
0
Default
install_type
3
1
Land based or offshore installation
 
Wind Farm Costs
0
1
1
1
1
1
0
Default
reference_capacity
3
1
Wind farm capacity
kW
Wind Farm Costs
0
8
1
1
1
1
0
Default
reference_number_turbines
3
1
Number of turbines
 
Wind Farm Costs
0
8
1
1
1
1
0
Default
reference_resource_file
3
4
 
 
Wind Farm Costs
0
8
1
4
2
""
Default
reference_sales_tax_percent
3
1
Sales tax rate
%
Wind Farm Costs
0
8
1
1
1
1
0
Default
sales_tax_basis
3
1
Sales tax basis, % of total equipment costs
%
Wind Farm Costs
0
2
1
1
1
1
0
Default
sales_tax_total
3
1
Total sales tax amount
$
Wind Farm Costs
0
9
1
1
1
1
0
Default
system_use_lifetime_output
3
1
 
 
Wind Farm Costs
0
0
1
1
1
1
0
Default
system_use_recapitalization
3
1
 
 
Wind Farm Costs
0
8
1
1
1
1
0
Default
total_installed_cost
3
1
Total installed cost
 
Wind Farm Costs
0
8
1
1
1
1
0
Default
total_installed_cost_per_kw
3
1
Total installed cost per kW
 
Wind Farm Costs
0
8
1
1
1
1
0
Default
turbine_cost_fixed
3
1
Turbine fixed costs
$
Wind Farm Costs
0
3
1
1
1
1
0
Default
turbine_cost_per_kw
3
1
Turbine cost per kW
$/kW
Wind Farm Costs
0
3
1
1
1
1
0
Default
turbine_cost_per_turbine
3
1
Turbine cost per turbine
$/turbine
Wind Farm Costs
0
3
1
1
1
1
0
Default
turbine_cost_total
3
1
Total turbine cost
$
Wind Farm Costs
0
9
1
1
1
1
0
Default

1271
equations{ 'reference_capacity' } = define() {
	return ${system_capacity};
};

equations{ 'reference_number_turbines' } = define() {
	return ${wind_farm_num_turbines};
};

equations{ 'turbine_cost_total' } = define() {
	return ${turbine_cost_per_kw} * ${reference_capacity} 
	+ ${turbine_cost_per_turbine} * ${reference_number_turbines} 
	+ ${turbine_cost_fixed};
};

equations{ 'bos_cost_total' } = define() {
	return ${bos_cost_per_kw} * ${reference_capacity} 
	+ ${bos_cost_per_turbine} * ${reference_number_turbines} 
	+ ${bos_cost_fixed};
};

equations{ 'total_installed_cost' } = define() {
	return ${turbine_cost_total} + ${bos_cost_total} + ${sales_tax_total};
};

equations{ 'total_installed_cost_per_kw' } = define() {
	return ${total_installed_cost} / ${reference_capacity};
};

equations{ 'reference_resource_file' } = define() {
	return ${wind_resource_filename};
};

equations { 'system_use_lifetime_output' } = define () {
	return 0;};
equations { 'system_use_recapitalization' } = define () {
	return 0;};
	
equations { 'reference_sales_tax_percent' } = define() {
	return ${sales_tax_rate};
};

equations { 'sales_tax_total' } = define() {
	return (${turbine_cost_total} + ${bos_cost_total}) * 0.01 * 
		${sales_tax_basis} * 0.01 * ${sales_tax_rate};
};

14149
on_change{'install_type'} = define()
{
	if (value('wind.turbine.radio_list_or_design') == 0) // library turbine
	{
		kw_rating = value('wind_turbine_kw_rating');
		if ( kw_rating >= 1000) //utility scale onshore turbine, 1 MW or greater
		{
			if (value('install_type') == 1)
				value('om_capacity',  [144]);
			else
				value('om_capacity', [44]);
		}
	}
};

on_change{'btn_est_turbine_cost'} = define() 
{
	if (value('install_type') == 1) //offshore installation
	{
		value('turbine_cost_per_kw', 1557);
		value('turbine_cost_per_turbine', 0);
		value('turbine_cost_fixed', 0);
		value('sales_tax_basis', 0);
		msgbox('Average 2017 installed cost of an offshore turbine applied to the turbine cost inputs.');
		return;
	}

	turbine_choice = value('wind.turbine.radio_list_or_design');
	if (turbine_choice == 0) // library turbine
	{
		kw_rating = value('wind_turbine_kw_rating');
		if ( kw_rating >= 1000) //utility scale onshore turbine, 1 MW or greater
		{
			value('turbine_cost_per_kw', 1094);
			value('turbine_cost_per_turbine', 0);
			value('turbine_cost_fixed', 0);
			value('sales_tax_basis', 0);
			msgbox('Average 2017 installed cost of a land-based utility scale turbine (1 MW or greater) applied to the turbine cost inputs.');
			return;
		}
		else if (kw_rating >= 100) // commerical scale onshore turbine, 100kw - 1MW
		{
			value('turbine_cost_per_kw',  4393);
			value('turbine_cost_per_turbine', 0);
			value('turbine_cost_fixed', 0);
			value('sales_tax_basis', 0);
			msgbox('Average 2017 installed cost of a land-based commercial scale wind turbine (100kW to 1MW) applied to the turbine cost inputs.');
			return;
		}
		else 
		{
			value('turbine_cost_per_kw',  4410);
			value('turbine_cost_per_turbine', 0);
			value('turbine_cost_fixed', 0);
			value('sales_tax_basis', 0);
			msgbox('Average 2017 installed cost of a land-based small wind turbine (less than 100 kW) applied to the turbine cost inputs.');
			return;
		}
	}		
	else {
		turbine_cost_estimate = wind_cost_scaling_model_ssc();
		msgbox('Estimated cost using the NREL wind Cost and Scaling model.');
		value('turbine_cost_per_kw', 0);
		value('turbine_cost_per_turbine', turbine_cost_estimate);
		value('turbine_cost_fixed', 0);
		value('sales_tax_basis', 0);
	}
	return;
};

on_change{'btn_est_bos_cost'} = define() 
{
	install_type = value('install_type');
	if(install_type == 1) //offshore
	{
		if (value('reference_number_turbines') == 1)
		{
			value('bos_cost_per_kw', 2289);
			value('turbine_cost_per_turbine', 0);
			value('turbine_cost_fixed', 0);
			value('sales_tax_basis', 0);
			msgbox('Average 2017 installed cost of an offshore single wind turbine applied to the turbine cost inputs.');
			return;
		}
		else
		{
			value('wind_bos_shown', false); //hide the inputs for the onshore model
			value('wind_obos_shown', true); //show the inputs for the offshore model
			//value('bos_cost_per_kw', 2277);
			//value('bos_cost_per_turbine', 0);
			//value('bos_cost_fixed', 0);
			//msgbox('A Balance of System cost model is not currently available for offshore installations. '
				//+ 'The average 2014 installed balance of system costs for an offshore turbine has been applied to the balance of system cost inputs.');
			msgbox('Please enter the inputs in the Offshore Balance of System Cost Model section below and click Apply BOS Estimate.');
		}
		return;
	}
	//onshore
	value('wind_bos_shown', true); //show the inputs
	value('wind_obos_shown', false); //hide the offshore inputs
	msg = '';
	if (value('reference_capacity') < 20000)
	{
		kw_rating = value('wind_turbine_kw_rating');
		if (kw_rating >= 1000) //utility turbine, small system
		{
			value('bos_cost_per_kw', 360);
			value('bos_cost_per_turbine', 0);
			value('bos_cost_fixed', 0);
			value('sales_tax_basis', 0);
			msg = msg +'Warning: this Balance of System model is intended for systems that are 20MW or greater. The model may estimate higher BOS costs than are actually likely. '
				+'Average 2017 installed balance of system costs for land-based utility scale turbines (1 MW or greater) have been applied to the balance of system cost inputs. '
				+'To use these numbers in your analysis, click Ok and ignore the instructions below. Otherwise, ';
		}
		else if ( kw_rating >= 100) // commercial scale turbine, 100kW-1MW
		{
			value('bos_cost_per_kw', 2996);
			value('bos_cost_per_turbine', 0);
			value('bos_cost_fixed', 0);
			value('sales_tax_basis', 0);
			msg = msg + 'Warning: This Balance of System model is intended for systems that are 20MW or greater. The model may estimate higher BOS costs than are actually likely. '
				+'Average 2017 installed balance of system costs for commercial scale land-based turbines have been applied to the balance of system cost inputs. '
				+ 'To use these numbers in your analysis, click Ok and ignore the instructions below. Otherwise, ';
		}
		else
		{
			value('bos_cost_per_kw', 7543);
			value('bos_cost_per_turbine', 0);
			value('bos_cost_fixed', 0);
			value('sales_tax_basis', 0);
			msg = msg + 'Warning: This Balance of System model is intended for systems that are 20MW or greater. The model may estimate higher BOS costs than are actually likely. '
				+'Average 2017 installed balance of system costs for small land-based turbines have been applied to the balance of system cost inputs. '
				+ 'To use these numbers in your analysis, click Ok and ignore the instructions below. Otherwise, ';
		}
	}
	msg = msg + 'Please enter inputs in the Land-Based Balance of System Cost Model section below and click Apply BOS Estimate.'; //prompt user to fill in inputs
	msgbox(msg);
};


function wind_cost_scaling_model_ssc()
{
	turbine_rating_kw = ${wind_turbine_kw_rating};			
	rotor_diam = ${wind_turbine_rotor_diameter};			
	hub_height = ${wind_turbine_hub_ht};				
	M_PI = 3.1415926535897932384626433832795;
	max_tip_speed = ${wind.turbine.max_tip_speed};		
	rotor_speed = (max_tip_speed)/((rotor_diam/2)*(M_PI/30.0));
	rotor_torque = turbine_rating_kw/(rotor_speed*(M_PI/30.0))*1000.0;

	obj = ssc_create();
	ssc_var( obj, 'machine_rating',  turbine_rating_kw);
	ssc_var( obj, 'turbine_rotor_diameter',  rotor_diam);
	ssc_var( obj, 'rotor_torque',  rotor_torque);
	ssc_var( obj, 'hub_height',  hub_height);
	// optional	
	ssc_var( obj, 'turbine_class',  0);
	ssc_var( obj, 'turbine_user_exponent',  2.5);
	ssc_var( obj, 'turbine_carbon_blades',  0);
	ssc_var( obj, 'onbard_crane',  0);
	ssc_var( obj, 'num_blades',  3);
	ssc_var( obj, 'num_bearings',  2);
	
	turbine_cost = nan();
	if ( 0 == ssc_exec( obj, 'windcsm' ) )
	{
		turbine_cost = ssc_var(obj, 'turbine_cost');
	}
	ssc_free( obj );

	return turbine_cost;	
}


function wind_cost_scaling_model()
{
	turbine_rating_kw = ${wind_turbine_kw_rating};				// C6
	rotor_diam = ${wind_turbine_rotor_diameter};				// D6 - meters
	hub_height = ${wind_turbine_hub_ht};						// E6
	bBladeBaseline = (${wind.turbine.blade_design} == 0);		// F6
	bTowerBaseline = (${wind.turbine.tower_design} == 0);		// G6
	drive_train_type = ${wind.turbine.drive_train};				// H6 - 0 to 3
	max_tip_speed = ${wind.turbine.max_tip_speed};				// I6
	//double max_cp = syms->DVal("wind.turbine.max_cp");
	iTechnologyType = 1;// ${windfarm.cost.tech_type}+1; // 1=on shore; 2=off shore shallow (<30m); 3=off shore deep (>30)
	M_PI = 3.1415926535897932384626433832795;


	single_blade_cost_current=0;
	single_blade_mass=0;
	if (bBladeBaseline)
	{
		single_blade_cost_current = ((0.401937581*pow(rotor_diam/2.0,3.0)-955.2426731)*1.051335788+(2.7445*pow(rotor_diam/2.0, 2.5025))*1.09718173)/(1.0-0.28);
		single_blade_mass =  0.1452*pow(rotor_diam/2, 2.9158);
	}
	else
	{
		single_blade_cost_current = ((0.401937581*pow(rotor_diam/2.0,3.0)-21051.04598)*1.089117105+(2.7445*pow(rotor_diam/2.0, 2.5025))*1.09718173)/(1.0-0.28);
		single_blade_mass = 0.4948*pow(rotor_diam/2, 2.53);
	}
	blades_total_mass = 3 * single_blade_mass;
	blades_total_cost_current = 3.0 * single_blade_cost_current;

	// hub mass and cost
	hub_mass = 0.954025373 * single_blade_mass + 5680.272238;
	hub_cost_current = 1.293545535 * hub_mass * 4.25;
	
	// pitch control, bearings
	pitch_mass1 =  (0.1295*blades_total_mass) + 491.31;
	pitch_mass = pitch_mass1 + (pitch_mass1*0.328)+555;
	pitch_bearing_cost = 0.2106 * pow(rotor_diam, 2.6576);
	pitch_bearing_cost_current = 1.331714097*(pitch_bearing_cost+(pitch_bearing_cost*1.28) );

	// spinner, nose cone
	nose_cone_mass = (18.5 * rotor_diam) -520.5;
	nose_cone_cost_current = nose_cone_mass * 5.57 * 1.05560501;

	// total rotor cost (1 of 5 in total turbine cost)
	rotor_cost_current = blades_total_cost_current + hub_cost_current + pitch_bearing_cost_current + nose_cone_cost_current;
	

	// low speed shaft
	low_speed_shaft_cost_current = (0.0998 * pow(rotor_diam, 2.8873) ) * 1.546536039;

	// bearings
	bearing_mass = 0.000122667 * pow(rotor_diam,3.5) + -0.0003036 * pow(rotor_diam, 2.5);
	bearing_cost = bearing_mass * 17.6;
	housing_cost = bearing_cost;
	bearings_cost_current = 1.31678487 * (bearing_cost + housing_cost);

	// gearbox
	gearbox_cost = 0;
	if (drive_train_type==0)
		gearbox_cost = 16.45 * pow(turbine_rating_kw, 1.2491);
	else if (drive_train_type==1)
		gearbox_cost = 74.101 * pow( turbine_rating_kw, 1.002 );
	else if (drive_train_type==2)
		gearbox_cost = 15.25697015 * pow( turbine_rating_kw, 1.2491 );
	else if (drive_train_type==3)
		gearbox_cost = 0 * pow( turbine_rating_kw, 0 );

	gearbox_cost_current = gearbox_cost * 1.350484262;

	// mechanical brake, high speed coupling
	mech_brake_coupling_cost = 1.9894 * turbine_rating_kw - 0.1141;
	mech_brake_coupling_current_cost = mech_brake_coupling_cost * 1.028116214;

	// generator
	generator_cost = 0;
	if (drive_train_type==0)
		generator_cost = 65 * turbine_rating_kw;
	else if (drive_train_type==1)
		generator_cost = 54.72533333 * turbine_rating_kw;
	else if (drive_train_type==2)
		generator_cost = 48.02962963 * turbine_rating_kw;
	else if (drive_train_type==3)
		generator_cost = 219.3333333 * turbine_rating_kw;
	
	generator_current_cost = generator_cost * 1.285203717;

	// variable speed power electronics
	power_electronics_cost = turbine_rating_kw * 79.32;
	power_electronics_current_cost = power_electronics_cost * 1.274084125;

	// yaw system - drive and bearing
	yaw_system_cost = 2*(0.0339 * pow(rotor_diam, 2.9637) );
	yaw_system_current_cost = yaw_system_cost * 1.360598317;

	// main frame
	main_frame_mass = 0;
	if (drive_train_type == 1)
		main_frame_mass = 1.2949 * pow( rotor_diam, 1.9525 );
	else if (drive_train_type == 2)
		main_frame_mass = 1.720804162 * pow( rotor_diam, 1.9525 );
	else
	{
		bedplate_wt_factor =  2.86;

		// mass from torque
		rotor_speed = (max_tip_speed)/((rotor_diam/2)*(M_PI/30.0));
		rotor_torque = turbine_rating_kw/(rotor_speed*(M_PI/30.0))*1000.0;
		mass_torque = bedplate_wt_factor *0.00368 * rotor_torque;

		// mass from thrust
		rated_wind_speed = ${wind_turbine_rated_wind_speed}; // has to be calculated on turbine input page
		tower_top_diameter = (12.29*rotor_diam+2648.0)/1000.0;
		max_thrust = 1.25 * 0.5 * M_PI * pow(rotor_diam,2.0) * pow(rated_wind_speed,2.0)/8.0;
		mass_thrust = 0.00158 * bedplate_wt_factor * max_thrust * tower_top_diameter;

		// mass from rotor weight
		rotor_mass_total = single_blade_mass*3.0 + hub_mass + pitch_mass + nose_cone_mass;
		mass_rotor_weight = 0.015*bedplate_wt_factor * rotor_mass_total * tower_top_diameter;

		// mass from area
		bed_plate_length = 1.5874 * 0.052 * rotor_diam;
		mass_area = 100*bedplate_wt_factor*(pow(bed_plate_length,2.0)/2.0);
		
		main_frame_mass = mass_torque + mass_thrust + mass_rotor_weight + mass_area;
		
		
		if (drive_train_type == 3)
			main_frame_mass = main_frame_mass * 0.55;
	}


	main_frame_cost = 0;
	if (drive_train_type==0)
		main_frame_cost = 9.4885 * pow( rotor_diam, 1.9525 );
	else if (drive_train_type==1)
		main_frame_cost = 303.96 * pow( rotor_diam, 1.0669 );
	else if (drive_train_type==2)
		main_frame_cost = 17.923 * pow( rotor_diam, 1.6716 );
	else if (drive_train_type==3)
		main_frame_cost = 627.28 * pow( rotor_diam, 0.85 );
	
	service_crane_cost = 12000;
	main_frame_all_components_cost = main_frame_cost + ((0.125*main_frame_mass)*8.7) + service_crane_cost + (0.7*main_frame_cost);
	main_frame_current_cost = main_frame_all_components_cost * 1.293545535;

	// electrical connections
	elec_connect_cost_current = 1.525668264 * (40*turbine_rating_kw);

	// hydrolic cooling system cost
	hydrolic_cooling_system_current_cost = 1.338235294*(12*turbine_rating_kw);

	// nacelle cover
	nacelle_cover_current_cost = 1.05560501 * (11.537*turbine_rating_kw + 3849.7);

	// total drive train & nacelle cost (2 of 5 in total turbine cost)
	drive_train_nacelle_cost = low_speed_shaft_cost_current + bearings_cost_current + gearbox_cost_current + mech_brake_coupling_current_cost + generator_current_cost + 
									  power_electronics_current_cost + yaw_system_current_cost + main_frame_current_cost + elec_connect_cost_current + 
									  hydrolic_cooling_system_current_cost + nacelle_cover_current_cost;
	


	// control, safety system, and condition monitoring cost (3 of 5 in total turbine cost)
	control_system_cost = (iTechnologyType == 1) ? 35000 : 55900;
	control_system_cost_current = 1.22342457 * control_system_cost;

	// tower cost (4 of 5 in total turbine cost)
	tower_mass_slope = (bTowerBaseline) ? 0.397251148 : 0.269380169;
	tower_mass_intercept = (bTowerBaseline) ? -1414.381881 : 1779.328183;
	tower_mass = tower_mass_slope * M_PI * pow(rotor_diam/2, 2) * hub_height + tower_mass_intercept;
	tower_cost_current = 1.56207483 * (tower_mass * 1.5);

	// total of all components
	turbine_component_total = rotor_cost_current + drive_train_nacelle_cost + control_system_cost_current + tower_cost_current;

	// marinization cost (5 of 5 in total turbine cost)
	marinization_cost = 0;
	if (iTechnologyType != 1) marinization_cost = 0.1 * (turbine_component_total);


	// total turbine cost **********************************************************************************************************************************************
	turbine_cost = turbine_component_total + marinization_cost;
	return turbine_cost;
}