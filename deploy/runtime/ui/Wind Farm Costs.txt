Wind Farm Costs
826
471
34
Numeric

1
17
Name
5
14
bos_cost_fixed
X
3
462
Y
3
267
Width
3
117
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
1
$
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
9
Numeric

1
17
Name
5
15
bos_cost_per_kw
X
3
180
Y
3
267
Width
3
114
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
1
$
Suffix
5
3
/kW
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
7
Numeric

1
17
Name
5
20
bos_cost_per_turbine
X
3
309
Y
3
267
Width
3
132
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
1
$
Suffix
5
8
/turbine
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
8
Numeric

1
17
Name
5
14
bos_cost_total
X
3
603
Y
3
267
Width
3
129
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
1
$
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Button

1
8
Name
5
16
btn_est_bos_cost
X
3
423
Y
3
144
Width
3
348
Height
3
24
Tool Tip
5
0
Caption
5
47
Go to balance-of-system (BOS) cost model inputs
TabOrder
3
3
Button

1
8
Name
5
20
btn_est_turbine_cost
X
3
30
Y
3
144
Width
3
348
Height
3
24
Tool Tip
5
0
Caption
5
26
Estimate turbine costs now
TabOrder
3
2
RadioChoice

1
11
Name
5
12
install_type
X
3
30
Y
3
48
Width
3
222
Height
3
48
Tool Tip
5
0
Selection
3
0
Items
6
2
Land-based installation
Offshore installation
ShowCaptions
2
1
Horizontal
2
0
TabOrder
3
1
Divider

1
10
Name
5
9
object 22
X
3
27
Y
3
378
Width
3
708
Height
3
16
Tool Tip
5
0
Orientation
3
0
Colour
4
120
120
120
255
Caption
5
10
Total Cost
Bold
2
1
Divider

1
10
Name
5
11
object 2219
X
3
27
Y
3
324
Width
3
708
Height
3
16
Tool Tip
5
0
Orientation
3
0
Colour
4
120
120
120
255
Caption
5
9
Sales Tax
Bold
2
1
GroupBox

1
8
Name
5
8
object 4
X
3
9
Y
3
195
Width
3
812
Height
3
270
Tool Tip
5
0
Caption
5
13
Capital Costs
Bold
2
1
GroupBox

1
8
Name
5
10
object 424
X
3
9
Y
3
3
Width
3
812
Height
3
183
Tool Tip
5
0
Caption
5
19
Capital Cost Models
Bold
2
1
Label

1
13
Name
5
8
object 7
X
3
15
Y
3
99
Width
3
801
Height
3
39
Tool Tip
5
0
Caption
5
228
You can either enter capital costs yourself using the inputs below, or use the Estimate buttons to automatically populate those inputs using NREL cost models for turbine and balance-of-system capital costs. See Help for details.
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
4294967295
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Label

1
13
Name
5
10
object 721
X
3
12
Y
3
267
Width
3
165
Height
3
24
Tool Tip
5
0
Caption
5
22
Balance of system cost
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Label

1
13
Name
5
10
object 722
X
3
18
Y
3
21
Width
3
795
Height
3
24
Tool Tip
5
0
Caption
5
73
Choose land-based or offshore installation based on the project location.
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
4294967295
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Label

1
13
Name
5
10
object 726
X
3
318
Y
3
213
Width
3
114
Height
3
24
Tool Tip
5
0
Caption
5
16
Cost per turbine
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
Label

1
13
Name
5
10
object 727
X
3
87
Y
3
240
Width
3
90
Height
3
24
Tool Tip
5
0
Caption
5
12
Turbine cost
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Label

1
13
Name
5
10
object 729
X
3
471
Y
3
213
Width
3
66
Height
3
24
Tool Tip
5
0
Caption
5
10
Fixed Cost
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
Label

1
13
Name
5
10
object 730
X
3
294
Y
3
213
Width
3
12
Height
3
24
Tool Tip
5
0
Caption
5
1
+
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
Label

1
13
Name
5
10
object 731
X
3
447
Y
3
213
Width
3
12
Height
3
24
Tool Tip
5
0
Caption
5
1
+
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
Label

1
13
Name
5
10
object 732
X
3
585
Y
3
213
Width
3
12
Height
3
24
Tool Tip
5
0
Caption
5
1
=
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
Label

1
13
Name
5
10
object 733
X
3
612
Y
3
213
Width
3
36
Height
3
24
Tool Tip
5
0
Caption
5
5
Total
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
Label

1
13
Name
5
10
object 734
X
3
180
Y
3
213
Width
3
90
Height
3
24
Tool Tip
5
0
Caption
5
11
Cost per kW
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
Numeric

1
17
Name
5
18
reference_capacity
X
3
174
Y
3
294
Width
3
63
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
0
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
25
reference_number_turbines
X
3
432
Y
3
294
Width
3
48
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
0
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
TextEntry

1
11
Name
5
23
reference_resource_file
X
3
375
Y
3
51
Width
3
438
Height
3
24
Tool Tip
5
0
Text
5
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
27
reference_sales_tax_percent
X
3
522
Y
3
348
Width
3
66
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
1
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
15
sales_tax_basis
X
3
315
Y
3
348
Width
3
90
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
0
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
10
Numeric

1
17
Name
5
15
sales_tax_total
X
3
603
Y
3
348
Width
3
129
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
1
$
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
20
total_installed_cost
X
3
603
Y
3
399
Width
3
129
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
1
$
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
27
total_installed_cost_per_kw
X
3
603
Y
3
426
Width
3
129
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
1
$
Suffix
5
3
/kW
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
18
turbine_cost_fixed
X
3
462
Y
3
240
Width
3
117
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
1
$
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
6
Numeric

1
17
Name
5
19
turbine_cost_per_kw
X
3
180
Y
3
240
Width
3
114
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
1
$
Suffix
5
3
/kW
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4
Numeric

1
17
Name
5
24
turbine_cost_per_turbine
X
3
309
Y
3
240
Width
3
132
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
1
$
Suffix
5
8
/turbine
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
5
Numeric

1
17
Name
5
18
turbine_cost_total
X
3
603
Y
3
240
Width
3
129
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
1
$
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295

20
bos_cost_fixed
3
1
BOS fixed costs
$
Wind Capital Costs
0
3
1
1
1
1
0
Default
bos_cost_per_kw
3
1
BOS cost per kW
$/kW
Wind Capital Costs
0
3
1
1
1
1
0
Default
bos_cost_per_turbine
3
1
BOS cost per turbine
$/turbine
Wind Capital Costs
0
3
1
1
1
1
0
Default
bos_cost_total
3
1
Total BOS cost
$
Wind Capital Costs
0
9
1
1
1
1
0
Default
est_bos_cost
3
1
 
 
Wind Capital Costs
0
0
1
1
1
1
0
Default
est_turbine_cost
3
1
 
 
Wind Capital Costs
0
0
1
1
1
1
0
Default
install_type
3
1
Land based or offshore installation
 
Wind Capital Costs
0
1
1
1
1
1
0
Default
reference_capacity
3
1
Wind farm capacity
kW
Wind Capital Costs
0
8
1
1
1
1
0
Default
reference_number_turbines
3
1
Number of turbines
 
Wind Capital Costs
0
8
1
1
1
1
0
Default
reference_resource_file
3
4
Wind resource file
 
Wind Capital Costs
0
8
1
4
2
""
Default
reference_sales_tax_percent
3
1
Sales tax rate
%
Wind Capital Costs
0
8
1
1
1
1
0
Default
sales_tax_basis
3
1
Sales tax basis, % of total equipment costs
%
Wind Capital Costs
0
2
1
1
1
1
0
Default
sales_tax_total
3
1
Total sales tax amount
$
Wind Capital Costs
0
9
1
1
1
1
0
Default
system_use_recapitalization
3
1
 
 
Wind Capital Costs
0
8
1
1
1
1
0
Default
total_installed_cost
3
1
Total installed cost
 
Wind Capital Costs
0
8
1
1
1
1
0
Default
total_installed_cost_per_kw
3
1
Total installed cost per kW
 
Wind Capital Costs
0
8
1
1
1
1
0
Default
turbine_cost_fixed
3
1
Turbine fixed costs
$
Wind Capital Costs
0
3
1
1
1
1
0
Default
turbine_cost_per_kw
3
1
Turbine cost per kW
$/kW
Wind Capital Costs
0
3
1
1
1
1
0
Default
turbine_cost_per_turbine
3
1
Turbine cost per turbine
$/turbine
Wind Capital Costs
0
3
1
1
1
1
0
Default
turbine_cost_total
3
1
Total turbine cost
$
Wind Capital Costs
0
9
1
1
1
1
0
Default

1200
equations{ 'reference_capacity' } = define() {
	return ${system_capacity};
};

equations{ 'reference_number_turbines' } = define() {
	return ${wind_farm_num_turbines};
};

equations{ 'turbine_cost_total' } = define() {
	return ${turbine_cost_per_kw} * ${reference_capacity} 
	+ ${turbine_cost_per_turbine} * ${reference_number_turbines} 
	+ ${turbine_cost_fixed};
};

equations{ 'bos_cost_total' } = define() {
	return ${bos_cost_per_kw} * ${reference_capacity} 
	+ ${bos_cost_per_turbine} * ${reference_number_turbines} 
	+ ${bos_cost_fixed};
};

equations{ 'total_installed_cost' } = define() {
	return ${turbine_cost_total} + ${bos_cost_total} + ${sales_tax_total};
};

equations{ 'total_installed_cost_per_kw' } = define() {
	return ${total_installed_cost} / ${reference_capacity};
};

equations{ 'reference_resource_file' } = define() {
	return ${wind_resource_filename};
};

equations { 'reference_sales_tax_percent' } = define() {
	return ${sales_tax_rate};
};

equations { 'sales_tax_total' } = define() {
	return (${turbine_cost_total} + ${bos_cost_total}) * 0.01 * 
		${sales_tax_basis} * 0.01 * ${sales_tax_rate};
};

equations { 'system_use_recapitalization' } = define () {
	return 0;};

14090
on_load{'Wind Farm Costs'} = define()
{
	if ( value('wind_resource_model_choice') == 0 )
	{
		show('reference_resource_file',true);
	}
	else
	{
		show('reference_resource_file',false);
	}
};

on_change{'install_type'} = define()
{
	if (value('wind.turbine.radio_list_or_design') == 0) // library turbine
	{
		kw_rating = value('wind_turbine_kw_rating');
		if ( kw_rating >= 1000) //utility scale onshore turbine, 1 MW or greater
		{
			if (value('install_type') == 1)
				value('om_capacity',  [144]);
			else
				value('om_capacity', [44]);
		}
	}
};

on_change{'btn_est_turbine_cost'} = define() 
{
	// Average 2017 costs in $/kW
	offshore_turbine_cost = 1557;
	land_utility_turbine_cost = 1094;
	land_commercial_turbine_cost = 4393;
	land_small_turbine_cost = 4410;
	
	turbine_cost = 0;
	turbine_type = '';
	turbine_choice = value('wind.turbine.radio_list_or_design');
	if (value('install_type') == 1) //offshore installation
	{
		turbine_cost = offshore_turbine_cost;
		turbine_type = 'offshore';
	}
	elseif (turbine_choice == 0) // library turbine
	{
		kw_rating = value('wind_turbine_kw_rating');
		if ( kw_rating >= 1000) //utility scale onshore turbine, 1 MW or greater
		{
			turbine_cost = land_utility_turbine_cost;
			turbine_type = 'land-based utility-scale';
		}
		else if (kw_rating >= 100) // commerical scale onshore turbine, 100kw - 1MW
		{
			turbine_cost = land_commercial_turbine_cost;
			turbine_type = 'land-based commercial-scale';
		}
		else 
		{
			turbine_cost = land_small_turbine_cost;
			turbine_type = 'land-based small';
		}
	}		
	else // turbine design characteristics option
	{
		turbine_cost = wind_cost_scaling_model_ssc();
		turbine_type = 'custom design';
	}
	if (yesno('Replace turbine cost?\nClick Yes to replace turbine cost inputs with an average 2017 installed cost estimate of ' + sprintf('$%,/kW',turbine_cost) + ' for ' + turbine_type + ' wind turbines. This will set the $/turbine and $ turbine costs to zero. It also sets the sales tax basis to zero because the cost estimate includes sales tax.'))
	{
		value('turbine_cost_per_kw', turbine_cost);
		value('turbine_cost_per_turbine', 0);
		value('turbine_cost_fixed', 0);
		value('sales_tax_basis', 0);
	}
};

on_change{'btn_est_bos_cost'} = define() 
{
	install_type = value('install_type');
	if(install_type == 1) //offshore
	{
		if (value('reference_number_turbines') == 1)
		{
			value('bos_cost_per_kw', 2289);
			value('turbine_cost_per_turbine', 0);
			value('turbine_cost_fixed', 0);
			value('sales_tax_basis', 0);
			msgbox('Average 2017 installed cost of an offshore single wind turbine applied to the turbine cost inputs.');
			return;
		}
		else
		{
			value('wind_bos_shown', false); //hide the inputs for the onshore model
			value('wind_obos_shown', true); //show the inputs for the offshore model
			//value('bos_cost_per_kw', 2277);
			//value('bos_cost_per_turbine', 0);
			//value('bos_cost_fixed', 0);
			//msgbox('A Balance of System cost model is not currently available for offshore installations. '
				//+ 'The average 2014 installed balance of system costs for an offshore turbine has been applied to the balance of system cost inputs.');
			msgbox('Please enter the inputs in the Offshore Balance of System Cost Model section below and click Apply BOS Estimate.');
		}
		return;
	}
	//onshore
	value('wind_bos_shown', true); //show the inputs
	value('wind_obos_shown', false); //hide the offshore inputs
	msg = '';
	if (value('reference_capacity') < 20000)
	{
		kw_rating = value('wind_turbine_kw_rating');
		if (kw_rating >= 1000) //utility turbine, small system
		{
			value('bos_cost_per_kw', 360);
			value('bos_cost_per_turbine', 0);
			value('bos_cost_fixed', 0);
			value('sales_tax_basis', 0);
			msg = msg +'Warning: this Balance of System model is intended for systems that are 20MW or greater. The model may estimate higher BOS costs than are actually likely. '
				+'Average 2017 installed balance of system costs for land-based utility scale turbines (1 MW or greater) have been applied to the balance of system cost inputs. '
				+'To use these numbers in your analysis, click Ok and ignore the instructions below. Otherwise, ';
		}
		else if ( kw_rating >= 100) // commercial scale turbine, 100kW-1MW
		{
			value('bos_cost_per_kw', 2996);
			value('bos_cost_per_turbine', 0);
			value('bos_cost_fixed', 0);
			value('sales_tax_basis', 0);
			msg = msg + 'Warning: This Balance of System model is intended for systems that are 20MW or greater. The model may estimate higher BOS costs than are actually likely. '
				+'Average 2017 installed balance of system costs for commercial scale land-based turbines have been applied to the balance of system cost inputs. '
				+ 'To use these numbers in your analysis, click Ok and ignore the instructions below. Otherwise, ';
		}
		else
		{
			value('bos_cost_per_kw', 7543);
			value('bos_cost_per_turbine', 0);
			value('bos_cost_fixed', 0);
			value('sales_tax_basis', 0);
			msg = msg + 'Warning: This Balance of System model is intended for systems that are 20MW or greater. The model may estimate higher BOS costs than are actually likely. '
				+'Average 2017 installed balance of system costs for small land-based turbines have been applied to the balance of system cost inputs. '
				+ 'To use these numbers in your analysis, click Ok and ignore the instructions below. Otherwise, ';
		}
	}
	msg = msg + 'Please enter inputs in the Land-Based Balance of System Cost Model section below and click Apply BOS Estimate.'; //prompt user to fill in inputs
	msgbox(msg);
};


function wind_cost_scaling_model_ssc()
{
	turbine_rating_kw = ${wind_turbine_kw_rating};			
	rotor_diam = ${wind_turbine_rotor_diameter};			
	hub_height = ${wind_turbine_hub_ht};				
	M_PI = 3.1415926535897932384626433832795;
	max_tip_speed = ${wind.turbine.max_tip_speed};		
	rotor_speed = (max_tip_speed)/((rotor_diam/2)*(M_PI/30.0));
	rotor_torque = turbine_rating_kw/(rotor_speed*(M_PI/30.0))*1000.0;

	obj = ssc_create();
	ssc_var( obj, 'machine_rating',  turbine_rating_kw);
	ssc_var( obj, 'turbine_rotor_diameter',  rotor_diam);
	ssc_var( obj, 'rotor_torque',  rotor_torque);
	ssc_var( obj, 'hub_height',  hub_height);
	// optional	
	ssc_var( obj, 'turbine_class',  0);
	ssc_var( obj, 'turbine_user_exponent',  2.5);
	ssc_var( obj, 'turbine_carbon_blades',  0);
	ssc_var( obj, 'onbard_crane',  0);
	ssc_var( obj, 'num_blades',  3);
	ssc_var( obj, 'num_bearings',  2);
	
	turbine_cost = nan();
	if ( 0 == ssc_exec( obj, 'windcsm' ) )
	{
		turbine_cost = ssc_var(obj, 'turbine_cost');
	}
	ssc_free( obj );

	return turbine_cost;	
}


function wind_cost_scaling_model()
{
	turbine_rating_kw = ${wind_turbine_kw_rating};				// C6
	rotor_diam = ${wind_turbine_rotor_diameter};				// D6 - meters
	hub_height = ${wind_turbine_hub_ht};						// E6
	bBladeBaseline = (${wind.turbine.blade_design} == 0);		// F6
	bTowerBaseline = (${wind.turbine.tower_design} == 0);		// G6
	drive_train_type = ${wind.turbine.drive_train};				// H6 - 0 to 3
	max_tip_speed = ${wind.turbine.max_tip_speed};				// I6
	//double max_cp = syms->DVal("wind.turbine.max_cp");
	iTechnologyType = 1;// ${windfarm.cost.tech_type}+1; // 1=on shore; 2=off shore shallow (<30m); 3=off shore deep (>30)
	M_PI = 3.1415926535897932384626433832795;


	single_blade_cost_current=0;
	single_blade_mass=0;
	if (bBladeBaseline)
	{
		single_blade_cost_current = ((0.401937581*pow(rotor_diam/2.0,3.0)-955.2426731)*1.051335788+(2.7445*pow(rotor_diam/2.0, 2.5025))*1.09718173)/(1.0-0.28);
		single_blade_mass =  0.1452*pow(rotor_diam/2, 2.9158);
	}
	else
	{
		single_blade_cost_current = ((0.401937581*pow(rotor_diam/2.0,3.0)-21051.04598)*1.089117105+(2.7445*pow(rotor_diam/2.0, 2.5025))*1.09718173)/(1.0-0.28);
		single_blade_mass = 0.4948*pow(rotor_diam/2, 2.53);
	}
	blades_total_mass = 3 * single_blade_mass;
	blades_total_cost_current = 3.0 * single_blade_cost_current;

	// hub mass and cost
	hub_mass = 0.954025373 * single_blade_mass + 5680.272238;
	hub_cost_current = 1.293545535 * hub_mass * 4.25;
	
	// pitch control, bearings
	pitch_mass1 =  (0.1295*blades_total_mass) + 491.31;
	pitch_mass = pitch_mass1 + (pitch_mass1*0.328)+555;
	pitch_bearing_cost = 0.2106 * pow(rotor_diam, 2.6576);
	pitch_bearing_cost_current = 1.331714097*(pitch_bearing_cost+(pitch_bearing_cost*1.28) );

	// spinner, nose cone
	nose_cone_mass = (18.5 * rotor_diam) -520.5;
	nose_cone_cost_current = nose_cone_mass * 5.57 * 1.05560501;

	// total rotor cost (1 of 5 in total turbine cost)
	rotor_cost_current = blades_total_cost_current + hub_cost_current + pitch_bearing_cost_current + nose_cone_cost_current;
	

	// low speed shaft
	low_speed_shaft_cost_current = (0.0998 * pow(rotor_diam, 2.8873) ) * 1.546536039;

	// bearings
	bearing_mass = 0.000122667 * pow(rotor_diam,3.5) + -0.0003036 * pow(rotor_diam, 2.5);
	bearing_cost = bearing_mass * 17.6;
	housing_cost = bearing_cost;
	bearings_cost_current = 1.31678487 * (bearing_cost + housing_cost);

	// gearbox
	gearbox_cost = 0;
	if (drive_train_type==0)
		gearbox_cost = 16.45 * pow(turbine_rating_kw, 1.2491);
	else if (drive_train_type==1)
		gearbox_cost = 74.101 * pow( turbine_rating_kw, 1.002 );
	else if (drive_train_type==2)
		gearbox_cost = 15.25697015 * pow( turbine_rating_kw, 1.2491 );
	else if (drive_train_type==3)
		gearbox_cost = 0 * pow( turbine_rating_kw, 0 );

	gearbox_cost_current = gearbox_cost * 1.350484262;

	// mechanical brake, high speed coupling
	mech_brake_coupling_cost = 1.9894 * turbine_rating_kw - 0.1141;
	mech_brake_coupling_current_cost = mech_brake_coupling_cost * 1.028116214;

	// generator
	generator_cost = 0;
	if (drive_train_type==0)
		generator_cost = 65 * turbine_rating_kw;
	else if (drive_train_type==1)
		generator_cost = 54.72533333 * turbine_rating_kw;
	else if (drive_train_type==2)
		generator_cost = 48.02962963 * turbine_rating_kw;
	else if (drive_train_type==3)
		generator_cost = 219.3333333 * turbine_rating_kw;
	
	generator_current_cost = generator_cost * 1.285203717;

	// variable speed power electronics
	power_electronics_cost = turbine_rating_kw * 79.32;
	power_electronics_current_cost = power_electronics_cost * 1.274084125;

	// yaw system - drive and bearing
	yaw_system_cost = 2*(0.0339 * pow(rotor_diam, 2.9637) );
	yaw_system_current_cost = yaw_system_cost * 1.360598317;

	// main frame
	main_frame_mass = 0;
	if (drive_train_type == 1)
		main_frame_mass = 1.2949 * pow( rotor_diam, 1.9525 );
	else if (drive_train_type == 2)
		main_frame_mass = 1.720804162 * pow( rotor_diam, 1.9525 );
	else
	{
		bedplate_wt_factor =  2.86;

		// mass from torque
		rotor_speed = (max_tip_speed)/((rotor_diam/2)*(M_PI/30.0));
		rotor_torque = turbine_rating_kw/(rotor_speed*(M_PI/30.0))*1000.0;
		mass_torque = bedplate_wt_factor *0.00368 * rotor_torque;

		// mass from thrust
		rated_wind_speed = ${wind_turbine_rated_wind_speed}; // has to be calculated on turbine input page
		tower_top_diameter = (12.29*rotor_diam+2648.0)/1000.0;
		max_thrust = 1.25 * 0.5 * M_PI * pow(rotor_diam,2.0) * pow(rated_wind_speed,2.0)/8.0;
		mass_thrust = 0.00158 * bedplate_wt_factor * max_thrust * tower_top_diameter;

		// mass from rotor weight
		rotor_mass_total = single_blade_mass*3.0 + hub_mass + pitch_mass + nose_cone_mass;
		mass_rotor_weight = 0.015*bedplate_wt_factor * rotor_mass_total * tower_top_diameter;

		// mass from area
		bed_plate_length = 1.5874 * 0.052 * rotor_diam;
		mass_area = 100*bedplate_wt_factor*(pow(bed_plate_length,2.0)/2.0);
		
		main_frame_mass = mass_torque + mass_thrust + mass_rotor_weight + mass_area;
		
		
		if (drive_train_type == 3)
			main_frame_mass = main_frame_mass * 0.55;
	}


	main_frame_cost = 0;
	if (drive_train_type==0)
		main_frame_cost = 9.4885 * pow( rotor_diam, 1.9525 );
	else if (drive_train_type==1)
		main_frame_cost = 303.96 * pow( rotor_diam, 1.0669 );
	else if (drive_train_type==2)
		main_frame_cost = 17.923 * pow( rotor_diam, 1.6716 );
	else if (drive_train_type==3)
		main_frame_cost = 627.28 * pow( rotor_diam, 0.85 );
	
	service_crane_cost = 12000;
	main_frame_all_components_cost = main_frame_cost + ((0.125*main_frame_mass)*8.7) + service_crane_cost + (0.7*main_frame_cost);
	main_frame_current_cost = main_frame_all_components_cost * 1.293545535;

	// electrical connections
	elec_connect_cost_current = 1.525668264 * (40*turbine_rating_kw);

	// hydrolic cooling system cost
	hydrolic_cooling_system_current_cost = 1.338235294*(12*turbine_rating_kw);

	// nacelle cover
	nacelle_cover_current_cost = 1.05560501 * (11.537*turbine_rating_kw + 3849.7);

	// total drive train & nacelle cost (2 of 5 in total turbine cost)
	drive_train_nacelle_cost = low_speed_shaft_cost_current + bearings_cost_current + gearbox_cost_current + mech_brake_coupling_current_cost + generator_current_cost + 
									  power_electronics_current_cost + yaw_system_current_cost + main_frame_current_cost + elec_connect_cost_current + 
									  hydrolic_cooling_system_current_cost + nacelle_cover_current_cost;
	


	// control, safety system, and condition monitoring cost (3 of 5 in total turbine cost)
	control_system_cost = (iTechnologyType == 1) ? 35000 : 55900;
	control_system_cost_current = 1.22342457 * control_system_cost;

	// tower cost (4 of 5 in total turbine cost)
	tower_mass_slope = (bTowerBaseline) ? 0.397251148 : 0.269380169;
	tower_mass_intercept = (bTowerBaseline) ? -1414.381881 : 1779.328183;
	tower_mass = tower_mass_slope * M_PI * pow(rotor_diam/2, 2) * hub_height + tower_mass_intercept;
	tower_cost_current = 1.56207483 * (tower_mass * 1.5);

	// total of all components
	turbine_component_total = rotor_cost_current + drive_train_nacelle_cost + control_system_cost_current + tower_cost_current;

	// marinization cost (5 of 5 in total turbine cost)
	marinization_cost = 0;
	if (iTechnologyType != 1) marinization_cost = 0.1 * (turbine_component_total);


	// total turbine cost **********************************************************************************************************************************************
	turbine_cost = turbine_component_total + marinization_cost;
	return turbine_cost;
}