PVWatts Advanced Inputs
883
679
22
GroupBox

1
8
Name
5
9
GroupBox1
X
3
9
Y
3
6
Width
3
872
Height
3
668
Tool Tip
5
0
Caption
5
19
Advanced Parameters
Bold
2
1
LossAdjustment

1
7
Name
5
6
adjust
X
3
66
Y
3
600
Width
3
294
Height
3
66
Tool Tip
5
0
TabOrder
3
8
Button

1
8
Name
5
13
edit_3d_scene
X
3
321
Y
3
390
Width
3
210
Height
3
30
Tool Tip
5
0
Caption
5
27
Open 3D shade calculator...
TabOrder
3
6
CheckBox

1
9
Name
5
11
en_snowloss
X
3
36
Y
3
492
Width
3
173
Height
3
24
Tool Tip
5
0
Caption
5
20
Estimate snow losses
State
2
1
TabOrder
3
7
CheckBox

1
9
Name
5
18
module_is_bifacial
X
3
36
Y
3
69
Width
3
135
Height
3
24
Tool Tip
5
0
Caption
5
18
Module is bifacial
State
2
0
TabOrder
3
1
Label

1
13
Name
5
18
msg_pvwatts_albedo
X
3
549
Y
3
159
Width
3
303
Height
3
48
Tool Tip
5
0
Caption
5
0
TextColour
4
255
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Label

1
13
Name
5
16
msg_pvwatts_snow
X
3
213
Y
3
492
Width
3
336
Height
3
48
Tool Tip
5
0
Caption
5
0
TextColour
4
255
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Divider

1
10
Name
5
9
object 22
X
3
15
Y
3
24
Width
3
837
Height
3
19
Tool Tip
5
0
Orientation
3
0
Colour
4
120
120
120
255
Caption
5
11
Bifaciality
Bold
2
1
Divider

1
10
Name
5
11
object 2211
X
3
15
Y
3
102
Width
3
837
Height
3
19
Tool Tip
5
0
Orientation
3
0
Colour
4
120
120
120
255
Caption
5
6
Albedo
Bold
2
1
Divider

1
10
Name
5
11
object 2215
X
3
15
Y
3
555
Width
3
837
Height
3
19
Tool Tip
5
0
Orientation
3
0
Colour
4
120
120
120
255
Caption
5
19
System Availability
Bold
2
1
Divider

1
10
Name
5
13
object 222823
X
3
15
Y
3
207
Width
3
837
Height
3
20
Tool Tip
5
0
Orientation
3
0
Colour
4
120
120
120
255
Caption
5
7
Soiling
Bold
2
1
Divider

1
10
Name
5
14
object 2228233
X
3
15
Y
3
327
Width
3
837
Height
3
20
Tool Tip
5
0
Orientation
3
0
Colour
4
120
120
120
255
Caption
5
25
Shading by Nearby Objects
Bold
2
1
Label

1
13
Name
5
12
object 73132
X
3
24
Y
3
120
Width
3
825
Height
3
36
Tool Tip
5
0
Caption
5
223
Albedo is a measure of ground reflectance. Valid values are greater than zero (non-reflective surface) and less than one (completely reflective). Invalid values are replaced by internal default values. See Help for details.
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Label

1
13
Name
5
13
object 731321
X
3
24
Y
3
351
Width
3
825
Height
3
36
Tool Tip
5
0
Caption
5
235
Shading losses are for shading by nearby objects. This loss is in addition to any shading losses included in System Losses above. (Note that PVWatts calculates self-shading losses based on the system design and tracking options above.)
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Label

1
13
Name
5
14
object 7313218
X
3
24
Y
3
453
Width
3
825
Height
3
36
Tool Tip
5
0
Caption
5
149
If you are using a weather file with snow depth data in centimeters, you can enable the snow model to estimate losses due to snow covering the array.
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Label

1
13
Name
5
13
object 731324
X
3
24
Y
3
228
Width
3
825
Height
3
36
Tool Tip
5
0
Caption
5
239
Monthly soiling losses apply to total solar irradiance incident on the array. This loss is in addition to any soiling loss inlcuded in the System Losses above as a DC power loss. Valid values are 0 (no soiling) to 100% (completely soiled).
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Label

1
13
Name
5
14
object 7313247
X
3
24
Y
3
42
Width
3
825
Height
3
24
Tool Tip
5
0
Caption
5
87
Bifacial modules convert light on both the front and back of the module to electricity.
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Label

1
13
Name
5
14
object 7313248
X
3
24
Y
3
573
Width
3
825
Height
3
24
Tool Tip
5
0
Caption
5
96
System availability losses reduce the system output to represent system outages or other events.
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
ShadingFactors

1
9
Name
5
7
shading
X
3
177
Y
3
390
Width
3
135
Height
3
30
Tool Tip
5
0
ShowDBOptions
2
0
Description
5
0
TabOrder
3
5
MonthlyFactor

1
8
Name
5
7
soiling
X
3
177
Y
3
270
Width
3
135
Height
3
30
Tool Tip
5
0
Description
5
27
Soiling losses by month (%)
TabOrder
3
4
RadioChoice

1
11
Name
5
13
use_wf_albedo
X
3
36
Y
3
159
Width
3
236
Height
3
44
Tool Tip
5
0
Selection
3
0
Items
6
2
Use albedo input
Use albedo from weather file
ShowCaptions
2
1
Horizontal
2
0
TabOrder
3
4294967295
Numeric

1
17
Name
5
30
user_specified_constant_albedo
X
3
393
Y
3
159
Width
3
90
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
3

10
adjust
3
5
Performance adjustment factors
 
PVWatts Advanced
0
1
1
5
1
0
Default
albedo
3
2
User-specified albedo
 
PVWatts Advanced
0
8
1
2
1
1
0
Default
bifaciality
3
1
Module bifaciality factor
 
PVWatts Advanced
0
8
1
1
1
1
0
Default
en_snowloss
3
1
Estimate losses from snow
 
PVWatts Advanced
0
3
1
1
1
1
0
Default
module_is_bifacial
3
1
Module is bifacial
 
PVWatts Advanced
0
3
1
1
1
1
0
Default
shading
3
5
Edit shading losses
 
PVWatts Advanced
0
2
1
5
1
0
Default
shading_3d_scene
3
6
3D shading scene
 
PVWatts Advanced
0
0
1
6
0
 
soiling
3
2
Monthly soiling losses
 
PVWatts Advanced
0
2
1
2
1
12
0 0 0 0 0 0 0 0 0 0 0 0 

MonthlyFactor
use_wf_albedo
3
1
Albedo input option
 
PVWatts Advanced
45
Use albedo input|Use albedo from weather file
3
1
1
1
1
1
Default
user_specified_constant_albedo
3
1
Albedo input
 
PVWatts Advanced
0
2
1
1
1
1
0.2
Default

421
equations{'bifaciality'} = define() {
	if (${module_is_bifacial}) return 0.65;
	else return 0;
};

equations{'albedo'} = define() {
	// pvwattsv8 accepts single value, monthly array
	// or time series array for albedo value
	// set to monthly array so if user changes model
	// albedo is valid for detailed pv model
	alb = [];
	for ( i=0; i<12; i++ )
	{
		alb[i] = ${user_specified_constant_albedo};
	}	
	return alb;
};


2630

on_load{'PVWatts Advanced Inputs'} = define() {
	snow_loss_checks();
	albedo_check();
};

on_change{'en_snowloss'} = define() {
	snow_loss_checks();	
};

on_change{'loss_snow'} = define() {
	snow_loss_checks();
};

on_change{'user_specified_constant_albedo'} = define() {
	albedo_check();
};

on_change{'use_wf_albedo'} = define() {
	albedo_check();
};

on_change{'edit_3d_scene'} = define() {
	minute_step = 60;
	if (varinfo("wf_nrecords"))
	{
		nrec = value("wf_nrecords");
		if (!isnan(nrec) && (nrec > 0))
		{
			minute_step = 60 * 8760 / nrec;
		}
	}

	x = editscene3d( 'shading_3d_scene', 
		value('lat'), value('lon'), value('tz'), 
		value('city') + ', ' + value('state')  , minute_step);
// update 60 to timestep from weather file.	
	if ( x.ierr == 0 )
	{	
		timestep = x.losses;
//		msgbox("timestep = " + to_string(timestep));
//		msgbox("x = " + to_string(x));
		if (yesno('Update timeseries and diffuse shading losses with calculated values from 3D scene?'))
		{
			shad = value('shading');
			shad.en_timestep = true;
			shad.timestep = timestep;
			// diffuse
			shad.en_diff = true;
			shad.diff = x.diffuse[0];

			value('shading', shad );	
		}
	}
	else
	{
		msgbox('Internal error: ' + x.message);
	}
};

function snow_loss_checks () {
	msg_snow = '';
	if ( isnan(value('annual_snow')) == true && value('en_snowloss') == 1 ) 
	{
		msg_snow = 'Weather file does not have snow depth data required to model snow losses. See Help for details.';
	}

	elseif ( value('annual_snow') > 0 && value('en_snowloss') == 0 ) 
	{
		msg_snow = 'Weather file has snow depth data. You may want to consider enabling Estimate Snow Losses to model the effect of snow covering the array. See Help for details.';
	}	
	property('msg_pvwatts_snow','Caption',msg_snow);
	
	if ( value('en_snowloss') == 1 && 
	     value('loss_snow') !=0 && 
	     isnan(value('annual_snow')) == false && 
	     value('en_user_spec_losses') == 0 )
	{
		msgbox('Snow loss warning!\nThe snow loss model is enabled and the Snow input is set to ' + value('loss_snow') + '%. Set Snow to zero to avoid double-counting snow losses. Ignore this message to include losses from both the snow model and the Snow input value.');
	}
}

	
function albedo_check() {
	enable('user_specified_constant_albedo',!value('use_wf_albedo'));
	msg_albedo = '';
	alb = value('user_specified_constant_albedo');
	if ( (alb <= 0 || alb >= 1) && !value('use_wf_albedo') )
	{
		msg_albedo = 'Albedo must be greater than 0 and less than 1. PVWatts uses default albedo for time steps with invalid albedo. See Help for details.';
	}
	property('msg_pvwatts_albedo','Caption',msg_albedo);

}