Physical Trough Collector Header
800
252
4
Library

1
8
Name
5
17
collector_library
X
3
18
Y
3
30
Width
3
768
Height
3
147
Tool Tip
5
0
Library
5
26
Physical Trough Collectors
Fields
5
309
Name,Reflective aperture area,Aperture width  total structure,Length of collector assembly,Number of modules per assembly,Average surface to focus path length,Piping distance between assemblies,IAM F0,IAM F1,IAM F2,IAM F3,Tracking error,Geometry effects,Mirror reflectance,Dirt on mirror,General optical error
TextEntry

1
11
Name
5
19
collectors_in_field
X
3
258
Y
3
183
Width
3
525
Height
3
24
Tool Tip
5
0
Text
5
0
Editable
2
0
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Label

1
13
Name
5
12
header_label
X
3
6
Y
3
222
Width
3
175
Height
3
24
Tool Tip
5
0
Caption
5
16
Collector Type 1
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
3
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
GroupBox

1
8
Name
5
8
object 4
X
3
6
Y
3
6
Width
3
791
Height
3
213
Tool Tip
5
0
Caption
5
17
Collector Library
Bold
2
1

50
A_aperture
3
2
Reflective aperture area array
 
Physical Trough Collector Library
0
12
1
2
1
4
470.3 470.3 470.3 470.3 

Default
Ave_Focal_Length
3
2
Average focal length array
 
Physical Trough Collector Library
0
12
1
2
1
4
1.8 1.8 1.8 1.8 

Default
ColperSCA
3
2
Number of modules per assembly array
 
Physical Trough Collector Library
0
12
1
2
1
1
12
Default
Dirt_mirror
3
2
Dirt on mirror array
 
Physical Trough Collector Library
0
12
1
2
1
4
0.95 0.95 0.95 0.95 

Default
Distance_SCA
3
2
Piping distance between assemblies array
 
Physical Trough Collector Library
0
12
1
2
1
1
1
Default
Error
3
2
General optical error array
 
Physical Trough Collector Library
0
12
1
2
1
4
0.99 0.99 0.99 0.99 

Default
GeomEffects
3
2
Geometry effects array
 
Physical Trough Collector Library
0
12
1
2
1
4
0.98 0.98 0.98 0.98 

Default
IAM_matrix
3
3
 
 
 
0
8
1
3
1
1
0
Default
L_SCA
3
2
Length of collector assembly array
 
Physical Trough Collector Library
0
12
1
2
1
1
100
Default
L_aperture
3
2
Length of single module array
 
Physical Trough Collector Library
0
12
1
2
1
1
8.5
Default
Rho_mirror_clean
3
2
Mirror reflectance array
 
Physical Trough Collector Library
0
12
1
2
1
4
0.935 0.935 0.935 0.935 

Default
TrackingError
3
2
Tracking error array
 
Physical Trough Collector Library
0
12
1
2
1
4
0.994 0.994 0.994 0.994 

Default
W_aperture
3
2
Aperature width array
 
Physical Trough Collector Library
0
12
1
2
1
4
5 5 5 5 

Default
arr_collectors_in_loop
3
2
Collector types in loop array
 
Physical Trough Collector Library
0
12
1
2
1
1
0
Default
collector_library
3
4
Collector library
 
Physical Trough Collector Library
28
Physical Trough Collectors|0
17
1
4
16
Solargenix SGX-1
Library
collectors_in_field
3
4
Collector types in loop configuration 
 
Physical Trough Collector Library
0
8
1
4
1
0
Default
lib_A_aperture
3
1
Aperture area from library
 
Physical Trough Collector Library
0
12
1
1
1
1
0
Default
lib_Ave_Focal_Length
3
1
Average focal length from library
 
Physical Trough Collector Library
0
12
1
1
1
1
0
Default
lib_ColperSCA
3
1
Number of modules per assembly from library
 
Physical Trough Collector Library
0
12
1
1
1
1
0
Default
lib_Dirt_mirror
3
1
Dirt on mirror from library
 
Physical Trough Collector Library
0
12
1
1
1
1
0
Default
lib_Distance_SCA
3
1
Piping distance between assemblies from library
 
Physical Trough Collector Library
0
12
1
1
1
1
0
Default
lib_Error
3
1
General optical error from library
 
Physical Trough Collector Library
0
12
1
1
1
1
0
Default
lib_GeomEffects
3
1
Geometry effects from library
 
Physical Trough Collector Library
0
12
1
1
1
1
0
Default
lib_IamF0
3
1
Incidence angle modifier coef F0 from library
 
Physical Trough Collector Library
0
12
1
1
1
1
0
Default
lib_IamF1
3
1
Incidence angle modifier coef F1 from library
 
Physical Trough Collector Library
0
12
1
1
1
1
0
Default
lib_IamF2
3
1
Incidence angle modifier coef F2 from library
 
Physical Trough Collector Library
0
12
1
1
1
1
0
Default
lib_IamF3
3
1
Incidence angle modifier coef F3 from library
 
Physical Trough Collector Library
0
12
1
1
1
1
0
Default
lib_L_SCA
3
1
Length of collector assembly from library
 
Physical Trough Collector Library
0
12
1
1
1
1
0
Default
lib_Rho_mirror_clean
3
1
Mirror reflectance from library
 
Physical Trough Collector Library
0
12
1
1
1
1
0
Default
lib_TrackingError
3
1
Tracking error from library
 
Physical Trough Collector Library
0
12
1
1
1
1
0
Default
lib_W_aperture
3
1
Aperature width from library
 
Physical Trough Collector Library
0
12
1
1
1
1
0
Default
lib_collector_description
3
4
Collector type description from library
 
Physical Trough Collector Library
0
12
1
4
9
<invalid>
Default
max_collector_width
3
1
Width of widest collector in loop
 
Physical Trough Collector Library
0
12
1
1
1
1
0
Default
nColt
3
1
Number of collector types
 
Physical Trough Collector Library
0
13
1
1
1
1
4
Default
ui_A_aperture
3
1
ui_A_aperture
Aperture area UI variable
Physical Trough Collector Library
0
12
1
1
1
1
0
Numeric
ui_Ave_Focal_length
3
1
Average focal length UI variable
 
Physical Trough Collector Library
0
12
1
1
1
1
0
Default
ui_ColperSCA
3
1
Number of modules per assembly UI variable
 
Physical Trough Collector Library
0
12
1
1
1
1
0
Default
ui_Dirt_mirror
3
1
Dirt on mirror UI variable
 
Physical Trough Collector Library
0
12
1
1
1
1
0
Default
ui_Distance_SCA
3
1
Piping distance between assemblies
m
Physical Trough Collector Library
0
12
1
1
1
1
0
Default
ui_Error
3
1
General optical error UI variable
 
Physical Trough Collector Library
0
12
1
1
1
1
0
Default
ui_GeomEffects
3
1
Geometry effects UI variable
 
Physical Trough Collector Library
0
12
1
1
1
1
0
Default
ui_IamF0
3
1
Incidence angle modifier coef F0 UI variable
 
Physical Trough Collector Library
0
12
1
1
1
1
0
Default
ui_IamF1
3
1
Incidence angle modifier coef F1 UI variable
 
Physical Trough Collector Library
0
12
1
1
1
1
0
Default
ui_IamF2
3
1
Incidence angle modifier coef F2 UI variable
 
Physical Trough Collector Library
0
12
1
1
1
1
0
Default
ui_IamF3
3
1
Incidence angle modifier coef F2 UI variable
 
Physical Trough Collector Library
0
12
1
1
1
1
0
Default
ui_L_SCA
3
1
Length of collector assembly UI variable
 
Physical Trough Collector Library
0
12
1
1
1
1
0
Default
ui_Rho_mirror_clean
3
1
Mirror reflectance UI variable
 
Physical Trough Collector Library
0
12
1
1
1
1
0
Default
ui_TrackingError
3
1
Tracking error UI variable
 
Physical Trough Collector Library
0
12
1
1
1
1
0
Default
ui_W_aperture
3
1
Aperature width UI variable
 
Physical Trough Collector Library
0
12
1
1
1
1
0
Default
ui_collector_description
3
4
Collector type description UI variable
 
Physical Trough Collector Library
0
12
1
4
9
<invalid>
Default

4591
equations{ '$MIMO$ collectors in field' } = define () {
  arr = ${SCAInfoArray};
  n = ${nColt};
  str = "Cold - "; 
  for ( i=0; i<#arr; i++ ) // number of collector assemblies in loop
    for ( j=0; j<n; j++ ) 
      if ( arr[i][0] == j+1 ) { // collector type number for UI display (1-4)
        c[i] = j; // collector type number for max width calculation in MIMO below (0-3)
        s[j] = to_string(j+1);
        str = str + s[j] + " - ";
	  }
  ${collectors_in_field} = str + "Hot";
  ${arr_collectors_in_loop} = c;
};

equations{ '$MIMO$ collector constants' } = define() {
	// value of nColt must match the number of collector types allowed
	// Each array calculated below must have nColt values in it
	${nColt} = 4;
	
	// these were constants in SAMwx
	//${OptCharType} = [1,1,1,1];
	//${CollectorType} = [1,1,1,1];
	//${reflectivity} = [1,1,1,1];
};

equations{ '$MIMO$ get values from pages' } = define() {
	acollector[0] = ${csp_dtr_sca_w_profile_1};
	acollector[1] = ${csp_dtr_sca_w_profile_2};
	acollector[2] = ${csp_dtr_sca_w_profile_3};
	acollector[3] = ${csp_dtr_sca_w_profile_4};
	${W_aperture} = acollector;

	//for land area equation on solar field page:
	arr = ${arr_collectors_in_loop};
	n = #arr;
	for ( i=0; i<n; i++ ) widths[i] = acollector[arr[i]];
	${max_collector_width} = max(widths);

	acollector[0] = ${csp_dtr_sca_aperture_1};
	acollector[1] = ${csp_dtr_sca_aperture_2};
	acollector[2] = ${csp_dtr_sca_aperture_3};
	acollector[3] = ${csp_dtr_sca_aperture_4};
	${A_aperture} = acollector;
	
	/*
	acollector[0] = ${csp_dtr_sca_iam0_1};
	acollector[1] = ${csp_dtr_sca_iam0_2};
	acollector[2] = ${csp_dtr_sca_iam0_3};
	acollector[3] = ${csp_dtr_sca_iam0_4};
	${IamF0} = acollector;
	
	acollector[0] = ${csp_dtr_sca_iam1_1};
	acollector[1] = ${csp_dtr_sca_iam1_2};
	acollector[2] = ${csp_dtr_sca_iam1_3};
	acollector[3] = ${csp_dtr_sca_iam1_4};
	${IamF1} = acollector;

	acollector[0] = ${csp_dtr_sca_iam2_1};
	acollector[1] = ${csp_dtr_sca_iam2_2};
	acollector[2] = ${csp_dtr_sca_iam2_3};
	acollector[3] = ${csp_dtr_sca_iam2_4};
	${IamF2} = acollector;
	*/

	acollector[0] = ${csp_dtr_sca_tracking_error_1};
	acollector[1] = ${csp_dtr_sca_tracking_error_2};
	acollector[2] = ${csp_dtr_sca_tracking_error_3};
	acollector[3] = ${csp_dtr_sca_tracking_error_4};
	${TrackingError} = acollector;

	acollector[0] = ${csp_dtr_sca_geometry_effects_1};
	acollector[1] = ${csp_dtr_sca_geometry_effects_2};
	acollector[2] = ${csp_dtr_sca_geometry_effects_3};
	acollector[3] = ${csp_dtr_sca_geometry_effects_4};
	${GeomEffects} = acollector;

	acollector[0] = ${csp_dtr_sca_clean_reflectivity_1};
	acollector[1] = ${csp_dtr_sca_clean_reflectivity_2};
	acollector[2] = ${csp_dtr_sca_clean_reflectivity_3};
	acollector[3] = ${csp_dtr_sca_clean_reflectivity_4};
	${Rho_mirror_clean} = acollector;

	acollector[0] = ${csp_dtr_sca_mirror_dirt_1};
	acollector[1] = ${csp_dtr_sca_mirror_dirt_2};
	acollector[2] = ${csp_dtr_sca_mirror_dirt_3};
	acollector[3] = ${csp_dtr_sca_mirror_dirt_4};
	${Dirt_mirror} = acollector;

	acollector[0] = ${csp_dtr_sca_general_error_1};
	acollector[1] = ${csp_dtr_sca_general_error_2};
	acollector[2] = ${csp_dtr_sca_general_error_3};
	acollector[3] = ${csp_dtr_sca_general_error_4};
	${Error} = acollector;

	acollector[0] = ${csp_dtr_sca_ave_focal_len_1};
	acollector[1] = ${csp_dtr_sca_ave_focal_len_2};
	acollector[2] = ${csp_dtr_sca_ave_focal_len_3};
	acollector[3] = ${csp_dtr_sca_ave_focal_len_4};
	${Ave_Focal_Length} = acollector;

	acollector[0] = ${csp_dtr_sca_length_1};
	acollector[1] = ${csp_dtr_sca_length_2};
	acollector[2] = ${csp_dtr_sca_length_3};
	acollector[3] = ${csp_dtr_sca_length_4};
	${L_SCA} = acollector;

	acollector[0] = ${csp_dtr_sca_ap_length_1};
	acollector[1] = ${csp_dtr_sca_ap_length_2};
	acollector[2] = ${csp_dtr_sca_ap_length_3};
	acollector[3] = ${csp_dtr_sca_ap_length_4};
	${L_aperture} = acollector;

	acollector[0] = ${csp_dtr_sca_ncol_per_sca_1};
	acollector[1] = ${csp_dtr_sca_ncol_per_sca_2};
	acollector[2] = ${csp_dtr_sca_ncol_per_sca_3};
	acollector[3] = ${csp_dtr_sca_ncol_per_sca_4};
	${ColperSCA} = acollector;

	acollector[0] = ${csp_dtr_sca_piping_dist_1};
	acollector[1] = ${csp_dtr_sca_piping_dist_2};
	acollector[2] = ${csp_dtr_sca_piping_dist_3};
	acollector[3] = ${csp_dtr_sca_piping_dist_4};
	${Distance_SCA} = acollector;

};

equations{ 'IAM_matrix' } = define() {

	base_matrix[0] = ${IAMs_1};
	base_matrix[1] = ${IAMs_2};
	base_matrix[2] = ${IAMs_3};
	base_matrix[3] = ${IAMs_4};
	
	// #array for length of array
	// #matrix[0] for length of 1st array in 
	
	return base_matrix;
	
};

1038
on_load{ 'Physical Trough Collector Header' } = define() {
	on_change{ 'collector_library' }();
};

on_change{'collector_library'} = define() {
    
    value( 'ui_collector_description', value('lib_collector_description') );
    value( 'ui_A_aperture', value('lib_A_aperture') );
    value( 'ui_W_aperture', value('lib_W_aperture') );
    value( 'ui_L_SCA', value('lib_L_SCA') );
    value( 'ui_ColperSCA', value('lib_ColperSCA') );
    value( 'ui_Ave_Focal_length', value('lib_Ave_Focal_Length') );
    value( 'ui_Distance_SCA', value('lib_Distance_SCA') );
	
    value( 'ui_IamF0', value('lib_IamF0') );
    value( 'ui_IamF1', value('lib_IamF1') );
    value( 'ui_IamF2', value('lib_IamF2') );
    value( 'ui_IamF3', value('lib_IamF3') );
    value( 'ui_TrackingError', value('lib_TrackingError') );
    value( 'ui_GeomEffects', value('lib_GeomEffects') );
    value( 'ui_Rho_mirror_clean', value('lib_Rho_mirror_clean') );
    value( 'ui_Dirt_mirror', value('lib_Dirt_mirror') );
    value( 'ui_Error', value('lib_Error') );
    
};

