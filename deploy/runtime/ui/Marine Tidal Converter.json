{
    "Name": "Marine Tidal Converter",
    "Width": 940.0,
    "Height": 1038.0,
    "FormObjects": {
        "GroupBox": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "GroupBox1"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 12.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 6.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 920.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 1023.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "Tidal Energy Converter"
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 1.0
                }
            }
        },
        "Numeric": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "device_rated_power"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 540.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 243.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 100.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 21.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Value": {
                    "Type": 1.0,
                    "Double": 1500.0
                },
                "Mode": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Format": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Decimals": {
                    "Type": 3.0,
                    "Integer": 3.0
                },
                "Prefix": {
                    "Type": 5.0,
                    "String": ""
                },
                "Suffix": {
                    "Type": 5.0,
                    "String": ""
                },
                "ThousandsSep": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 27.0
                }
            }
        },
        "Library": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "lib_tidal_device"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 18.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 904.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 166.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Library": {
                    "Type": 5.0,
                    "String": "Tidal Energy Converters"
                },
                "Fields": {
                    "Type": 5.0,
                    "String": "Name,Technology Type,PTO Type,TEC Architype,Unballasted Structural Mass,Foundation Type,Mooring Type,Primary Structure Material"
                }
            }
        },
        "DataMatrix": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "lib_tidal_power_curve"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 240.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 300.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 775.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "PasteAppendRows": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "PasteAppendCols": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "ShowButtons": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "ShowRows": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "ShowRowLabels": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "RowLabels": {
                    "Type": 5.0,
                    "String": ""
                },
                "ShadeR0C0": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "VerticalLabel": {
                    "Type": 5.0,
                    "String": ""
                },
                "HorizontalLabel": {
                    "Type": 5.0,
                    "String": ""
                },
                "ShadeC0": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "ShowCols": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "ShowColLabels": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "ColLabels": {
                    "Type": 5.0,
                    "String": "Velocity (m/s),Power (kW)"
                },
                "NumRowsLabel": {
                    "Type": 5.0,
                    "String": "Rows:"
                },
                "NumColsLabel": {
                    "Type": 5.0,
                    "String": "Cols:"
                },
                "Layout": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "ChoiceColumn": {
                    "Type": 3.0,
                    "Integer": -1.0
                },
                "Choices": {
                    "Type": 5.0,
                    "String": "Choice1,Choice2"
                },
                "HideColumn": {
                    "Type": 3.0,
                    "Integer": -1.0
                },
                "ShowColumn": {
                    "Type": 3.0,
                    "Integer": -1.0
                },
                "ColorMap": {
                    "Type": 2.0,
                    "Boolean": 0.0
                }
            }
        },
        "Label": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "tidal_design_label"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 546.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 36.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 342.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 63.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": ""
                },
                "TextColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "FontSize": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "WordWrap": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "AlignRight": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "AlignTop": {
                    "Type": 2.0,
                    "Boolean": 0.0
                }
            }
        },
        "Plot": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "tidal_power_curve_plot"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 333.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 276.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 540.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 380.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                }
            }
        },
        "Label": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "user_entered"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 18.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 120.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 800.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 117.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "The TEC power curve is an array of device electrical output power in kW for a range of tidal velocity in m/s with bins that match the velocity bins on the Tidal Resource page. You can type values into the array by hand, import data from a comma-separated (CSV) text file, or paste data from your computer's clipboard. See Help for details."
                },
                "TextColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "FontSize": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "WordWrap": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "AlignRight": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "AlignTop": {
                    "Type": 2.0,
                    "Boolean": 1.0
                }
            }
        }
    },
    "VarDatabase": {
        "device_foundation": {
            "Version": 4.0,
            "Type": 4.0,
            "Label": " ",
            "Units": " ",
            "Group": "ME Tidal Converter",
            "IndexLabels": "",
            "Flags": 8.0,
            "DefaultValue": "<invalid>",
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "device_mass": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": " ",
            "Units": " ",
            "Group": "ME Tidal Converter",
            "IndexLabels": "",
            "Flags": 8.0,
            "DefaultValue": 0.0,
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "device_material": {
            "Version": 4.0,
            "Type": 4.0,
            "Label": " ",
            "Units": " ",
            "Group": "ME Tidal Converter",
            "IndexLabels": "",
            "Flags": 8.0,
            "DefaultValue": "<invalid>",
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "device_mooring": {
            "Version": 4.0,
            "Type": 4.0,
            "Label": " ",
            "Units": " ",
            "Group": "ME Tidal Converter",
            "IndexLabels": "",
            "Flags": 8.0,
            "DefaultValue": "<invalid>",
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "device_pto_type": {
            "Version": 4.0,
            "Type": 4.0,
            "Label": " ",
            "Units": " ",
            "Group": "ME Tidal Converter",
            "IndexLabels": "",
            "Flags": 8.0,
            "DefaultValue": "<invalid>",
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "device_rated_power": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Device Rated Power",
            "Units": "kW",
            "Group": "ME Tidal Converter",
            "IndexLabels": "",
            "Flags": 8.0,
            "DefaultValue": 100.0,
            "UIObject": "Numeric",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "device_tec_architype": {
            "Version": 4.0,
            "Type": 4.0,
            "Label": " ",
            "Units": " ",
            "Group": "ME Tidal Converter",
            "IndexLabels": "",
            "Flags": 8.0,
            "DefaultValue": "<invalid>",
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "device_tech_type": {
            "Version": 4.0,
            "Type": 4.0,
            "Label": " ",
            "Units": " ",
            "Group": "ME Tidal Converter",
            "IndexLabels": "",
            "Flags": 8.0,
            "DefaultValue": "<invalid>",
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "lib_tidal_device": {
            "Version": 4.0,
            "Type": 4.0,
            "Label": " Tidal device library",
            "Units": " ",
            "Group": "ME Tidal Converter",
            "IndexLabels": "Tidal Energy Converters|0",
            "Flags": 17.0,
            "DefaultValue": "RM1",
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "lib_tidal_power_curve": {
            "Version": 4.0,
            "Type": 3.0,
            "Label": " ",
            "Units": " ",
            "Group": "ME Tidal Converter",
            "IndexLabels": "",
            "Flags": 0.0,
            "DefaultValue": [
                [
                    0.0
                ]
            ],
            "UIObject": "DataMatrix",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "library_or_input_tidal": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": " ",
            "Units": " ",
            "Group": "ME Tidal Converter",
            "IndexLabels": "",
            "Flags": 0.0,
            "DefaultValue": 0.0,
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "tidal_power_curve": {
            "Version": 4.0,
            "Type": 3.0,
            "Label": "Tidal power curve",
            "Units": " ",
            "Group": "ME Tidal Converter",
            "IndexLabels": "",
            "Flags": 8.0,
            "DefaultValue": [
                [
                    0.0,
                    0.0
                ],
                [
                    0.1,
                    0.0
                ],
                [
                    0.2,
                    0.0
                ],
                [
                    0.3,
                    0.0
                ],
                [
                    0.4,
                    0.0
                ],
                [
                    0.5,
                    0.0
                ],
                [
                    0.6,
                    10.4211
                ],
                [
                    0.7,
                    20.8423
                ],
                [
                    0.8,
                    39.9689
                ],
                [
                    0.9,
                    59.0956
                ],
                [
                    1.0,
                    89.2016
                ],
                [
                    1.1,
                    119.308
                ],
                [
                    1.2,
                    160.886
                ],
                [
                    1.3,
                    202.464
                ],
                [
                    1.4,
                    259.292
                ],
                [
                    1.5,
                    316.12
                ],
                [
                    1.6,
                    392.673
                ],
                [
                    1.7,
                    469.226
                ],
                [
                    1.8,
                    570.306
                ],
                [
                    1.9,
                    671.386
                ],
                [
                    2.0,
                    802.908
                ],
                [
                    2.1,
                    934.43
                ],
                [
                    2.2,
                    1024.71
                ],
                [
                    2.3,
                    1115.0
                ],
                [
                    2.4,
                    1115.0
                ],
                [
                    2.5,
                    1115.0
                ],
                [
                    2.6,
                    1115.0
                ],
                [
                    2.7,
                    1115.0
                ],
                [
                    2.8,
                    1115.0
                ],
                [
                    2.9,
                    1115.0
                ],
                [
                    3.0,
                    1115.0
                ],
                [
                    3.1,
                    1115.0
                ],
                [
                    3.2,
                    1085.37
                ],
                [
                    3.3,
                    1055.73
                ]
            ],
            "UIObject": "DataMatrix",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "user_tidal_power_curve": {
            "Version": 4.0,
            "Type": 3.0,
            "Label": " ",
            "Units": " ",
            "Group": "ME Tidal Converter",
            "IndexLabels": "",
            "Flags": 0.0,
            "DefaultValue": [
                [
                    0.0
                ]
            ],
            "UIObject": "DataMatrix",
            "sscVariableName": "",
            "sscVariableValue": ""
        }
    },
    "Equations": [
        "equations{ 'device_rated_power' } = define () ",
        "{",
        "\tmax_power = 0;",
        "\tmat = ${tidal_power_curve};",
        "\tfor (r=0;r<#mat; r++)",
        "\t\t//the power column is the second in the matrix, so use column=1",
        "\t\tif (mat[r][1] > max_power) max_power = mat[r][1];",
        "\treturn max_power;",
        "};",
        "",
        "equations{ 'tidal_power_curve' } = define()",
        "{",
        "\tif (${library_or_input_tidal}==1)",
        "\t\treturn ${user_tidal_power_curve};\r",
        "\telse if (${library_or_input_tidal} == 2) {\r",
        "\t\t//esource = ${tidal_resource};\r",
        "\t\tspeeds = ${tidal_turbine_powercurve_tidalspeeds};\r",
        "\t\tpower = ${tidal_turbine_powercurve_powerout};\r",
        "\t\ttidal_power_curve = [[]];\r",
        "\t\tfor (i = 0; i < #speeds; i++) {\r",
        "\t\t\r",
        "\t\t\ttidal_power_curve[i][0] = speeds[i];\r",
        "\t\t\ttidal_power_curve[i][1] = power[i];\r",
        "\t\t}\r",
        "\t\treturn tidal_power_curve;\r",
        "\t}",
        "\telse",
        "\t\treturn ${lib_tidal_power_curve};",
        "};",
        ""
    ],
    "Callbacks": [
        "function plot_device_curve()",
        "{",
        "\tsetplot('tidal_power_curve_plot');",
        "\tclearplot('tidal_power_curve_plot');",
        "\tplotopt( {'title'='Tidal device power curve','backcolor'=[255,255,255], 'popup'=true, 'legend'=false, 'legendpos'=[75,10]}  );",
        "\t",
        "//\tws_all = ${tidal_resource_definition};",
        "\tpc_all = ${tidal_power_curve};",
        "\tws=alloc(#pc_all);",
        "\tpc=alloc(#pc_all);",
        "\tfor (i=0;i<#pc_all;i++)",
        "\t{",
        "\t\tws[i] = pc_all[i][0];",
        "\t\tpc[i] = pc_all[i][1];",
        "\t}",
        "\tplot( ws, pc, {'thick'=10, 'scale'=true,  'series'='Device Output', 'type'='bar', 'color'=[111,164,196]});",
        "\t",
        "\thigh = max( ws );",
        "\tlow = min( ws );",
        "\tpad = 0;",
        "\taxis( 'x1', {'label'='Velocity (m/s)', 'min'=floor(low-pad), 'max'=ceil(high+pad) });",
        "\t",
        "\thigh = max( pc );",
        "\tlow = min( pc );",
        "\tpad = (high - low) * 0.02;",
        "\taxis( 'y1', {'label'='Power (kW)', 'min'=floor(low-pad), 'max'=ceil(high+pad) });",
        "",
        "}",
        "",
        "on_change{'tidal_power_curve'}=define()",
        "{",
        "\tplot_device_curve();",
        "};",
        "",
        "on_change{'lib_tidal_power_curve'} = define() {",
        "\tplot_device_curve();",
        "\trefresh('lib_tidal_power_curve');",
        "};",
        "",
        "on_change{'user_tidal_power_curve'} = define() {",
        "\tplot_device_curve();",
        "\trefresh('user_tidal_power_curve');",
        "};",
        "",
        "on_load{'Marine Tidal Converter'}=define()",
        "{",
        "\tupdate_controls();\r",
        "\ttidal_design_label();",
        "\tplot_device_curve();",
        "};",
        "",
        "function update_controls()",
        "{",
        "\tinput_tidal = (value(\"library_or_input_tidal\") == 1);",
        "\tshow(\"user_tidal_power_curve\", input_tidal);",
        "\tshow(\"lib_tidal_device\", !input_tidal);",
        "\tshow(\"lib_tidal_power_curve\", !input_tidal);\r",
        "\tenable('user_tidal_power_curve', value('library_or_input_tidal') != 2);\r",
        "\tenable('lib_tidal_power_curve', value('library_or_input_tidal') != 2);\r",
        "\tenable('device_rated_power', value('library_or_input_tidal') != 2);\r",
        "\tenable('lib_tidal_device', value('library_or_input_tidal') != 2);\r",
        "\tif (value('library_or_input_tidal') == 2) {\r",
        "\t\tvalue('tidal_turbine_design_shown', 1);\r",
        "\t}\r",
        "\t",
        "\t/*",
        "\tshow('device_mooring', !input_wec);",
        "\tshow('device_foundation', !input_wec);",
        "\tshow('device_pto_type', !input_wec);",
        "\tshow('device_mass', !input_wec);",
        "\tshow('device_characteristic_diameter', !input_wec);",
        "\tshow('device_material', !input_wec);",
        "\tshow('device_tech_type', !input_wec);",
        "\t*/",
        "\trefresh();",
        "}",
        "/*",
        "on_change{'library_or_input_tidal'} = define()",
        "{",
        "\tupdate_controls();\r",
        "\ttidal_design_label();",
        "};",
        "*/",
        "/*",
        "on_change{'lib_tidal_device'} = define()",
        "{",
        "\tif( librarygetcurrentselection( 'lib_tidal_device' ) != '' )",
        "\t{",
        "\t\tvalue( 'wave_device_name', value('lib_wave_device') );",
        "\t}",
        "};*/",
        "function tidal_design_label()\r",
        "{\r",
        "\tcheck = value('library_or_input_tidal');\r",
        "\tif (check == 2) {\r",
        "\t\tproperty('tidal_design_label','Caption',\"See tidal design module at bottom of page.\");\r",
        "\t\tproperty('tidal_design_label','TextColour', 'red');\r",
        "\t}\r",
        "\telse {\r",
        "\t\tproperty('tidal_design_label','Caption',\"\");\r",
        "\t}\r",
        "\r",
        "\t\t\r",
        "}\r",
        ""
    ]
}