Inverter CEC Coefficient Generator
1265
974
28
GroupBox

1
8
Name
5
9
GroupBox2
X
3
9
Y
3
906
Width
3
1250
Height
3
66
Tool Tip
5
0
Caption
5
16
Save / Load Data
Bold
2
1
GroupBox

1
8
Name
5
9
GroupBox4
X
3
9
Y
3
570
Width
3
1250
Height
3
332
Tool Tip
5
0
Caption
5
46
Results - Efficiency Curve and Characteristics
Bold
2
1
GroupBox

1
8
Name
5
11
GroupBox420
X
3
9
Y
3
3
Width
3
1250
Height
3
500
Tool Tip
5
0
Caption
5
28
Coefficient Generator Inputs
Bold
2
1
GroupBox

1
8
Name
5
11
GroupBox421
X
3
9
Y
3
504
Width
3
1250
Height
3
62
Tool Tip
5
0
Caption
5
19
Array Sizing Inputs
Bold
2
1
Button

1
8
Name
5
19
btnCalcCoefficients
X
3
792
Y
3
21
Width
3
164
Height
3
28
Tool Tip
5
0
Caption
5
22
Calculate Coefficients
TabOrder
3
4294967295
Button

1
8
Name
5
17
btnLoadCECInvData
X
3
192
Y
3
930
Width
3
153
Height
3
28
Tool Tip
5
0
Caption
5
22
Load data from file...
TabOrder
3
4294967295
Button

1
8
Name
5
17
btnSaveCECInvData
X
3
30
Y
3
930
Width
3
153
Height
3
28
Tool Tip
5
0
Caption
5
20
Save data to file...
TabOrder
3
4294967295
Numeric

1
17
Name
5
13
inv_cec_cg_c0
X
3
984
Y
3
657
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
2
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
10
Numeric

1
17
Name
5
13
inv_cec_cg_c1
X
3
984
Y
3
681
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
2
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
11
Numeric

1
17
Name
5
13
inv_cec_cg_c2
X
3
984
Y
3
705
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
2
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
12
Numeric

1
17
Name
5
13
inv_cec_cg_c3
X
3
984
Y
3
729
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
2
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
13
Numeric

1
17
Name
5
18
inv_cec_cg_eff_cec
X
3
876
Y
3
600
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
10
Plot

1
6
Name
5
20
inv_cec_cg_eff_curve
X
3
24
Y
3
594
Width
3
625
Height
3
297
Tool Tip
5
0
Numeric

1
17
Name
5
19
inv_cec_cg_eff_euro
X
3
876
Y
3
624
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
10
TextEntry

1
11
Name
5
19
inv_cec_cg_filename
X
3
375
Y
3
930
Width
3
864
Height
3
28
Tool Tip
5
0
Text
5
0
Editable
2
0
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
17
inv_cec_cg_idcmax
X
3
432
Y
3
531
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
1
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
9
Numeric

1
17
Name
5
18
inv_cec_cg_mppt_hi
X
3
846
Y
3
531
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
1
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
16
Numeric

1
17
Name
5
19
inv_cec_cg_mppt_low
X
3
633
Y
3
531
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
1
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
14
Numeric

1
17
Name
5
19
inv_cec_cg_num_mppt
X
3
1146
Y
3
531
Width
3
90
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
0
Format
3
0
Decimals
3
0
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Choice

1
9
Name
5
22
inv_cec_cg_num_samples
X
3
654
Y
3
24
Width
3
90
Height
3
24
Tool Tip
5
0
Items
6
10
1
2
3
4
5
6
7
8
9
10
Selection
3
4294967295
TabOrder
3
4294967295
Numeric

1
17
Name
5
15
inv_cec_cg_paco
X
3
204
Y
3
24
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4
Numeric

1
17
Name
5
15
inv_cec_cg_pdco
X
3
771
Y
3
666
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
5
Numeric

1
17
Name
5
14
inv_cec_cg_pnt
X
3
48
Y
3
531
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
7
Numeric

1
17
Name
5
15
inv_cec_cg_psco
X
3
771
Y
3
696
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
6
Choice

1
9
Name
5
29
inv_cec_cg_sample_power_units
X
3
429
Y
3
24
Width
3
90
Height
3
24
Tool Tip
5
0
Items
6
2
W
kW
Selection
3
4294967295
TabOrder
3
4294967295
DataMatrix

1
27
Name
5
23
inv_cec_cg_test_samples
X
3
24
Y
3
54
Width
3
1220
Height
3
442
Tool Tip
5
0
PasteAppendRows
2
1
PasteAppendCols
2
1
ShowButtons
2
1
ShowRows
2
0
ShowRowLabels
2
1
RowLabels
5
164
Vmin 10%,Vmin 20%,Vmin 30%,Vmin 50%,Vmin 75%,Vmin 100%,Vnom 10%,Vnom 20%,Vnom 30%,Vnom 50%,Vnom 75%,Vnom 100%,Vmax 10%,Vmax 20%,Vmax 30%,Vmax 50%,Vmax 75%,Vmax 100%
ShadeR0C0
2
0
VerticalLabel
5
0
HorizontalLabel
5
0
ShadeC0
2
0
ShowCols
2
0
ShowColLabels
2
1
ColLabels
5
319
Power out,Voltage in,Efficiency,Power out,Voltage in,Efficiency,Power out,Voltage in,Efficiency,Power out,Voltage in,Efficiency,Power out,Voltage in,Efficiency,Power out,Voltage in,Efficiency,Power out,Voltage in,Efficiency,Power out,Voltage in,Efficiency,Power out,Voltage in,Efficiency,Power out,Voltage in,Efficiency
NumRowsLabel
5
5
Rows:
NumColsLabel
5
5
Cols:
Layout
3
0
ChoiceColumn
3
4294967295
Choices
5
15
Choice1,Choice2
HideColumn
3
4294967295
ShowColumn
3
4294967295
ColorMap
2
0
Numeric

1
17
Name
5
17
inv_cec_cg_vdcmax
X
3
243
Y
3
531
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
1
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
8
Numeric

1
17
Name
5
15
inv_cec_cg_vdco
X
3
771
Y
3
723
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
15

20
inv_cec_cg_c0
3
1
C0
1/W
PV Inverter (CEC Coefficient Generator)
0
8
1
1
1
1
0
Numeric
inv_cec_cg_c1
3
1
C1
1/V
PV Inverter (CEC Coefficient Generator)
0
8
1
1
1
1
0
Numeric
inv_cec_cg_c2
3
1
C2
1/V
PV Inverter (CEC Coefficient Generator)
0
8
1
1
1
1
0
Numeric
inv_cec_cg_c3
3
1
C3
1/V
PV Inverter (CEC Coefficient Generator)
0
8
1
1
1
1
0
Numeric
inv_cec_cg_eff_cec
3
1
CEC efficiency
 
PV Inverter (CEC Coefficient Generator)
0
8
1
1
1
1
0
Numeric
inv_cec_cg_eff_euro
3
1
European efficiency
 
PV Inverter (CEC Coefficient Generator)
0
8
1
1
1
1
0
Numeric
inv_cec_cg_filename
3
4
Inverter data filename
 
PV Inverter (CEC Coefficient Generator)
0
9
1
4
0
TextEntry
inv_cec_cg_idcmax
3
1
Idcmax
Adc
PV Inverter (CEC Coefficient Generator)
0
0
1
1
1
1
0
Numeric
inv_cec_cg_mppt_hi
3
1
MPPT High
Vdc
PV Inverter (CEC Coefficient Generator)
0
0
1
1
1
1
0
Numeric
inv_cec_cg_mppt_low
3
1
MPPT Low
Vdc
PV Inverter (CEC Coefficient Generator)
0
0
1
1
1
1
0
Numeric
inv_cec_cg_num_mppt
3
1
Number of MPPT inputs
 
PV Inverter (CEC Coefficient Generator)
0
0
1
1
1
1
1
Default
inv_cec_cg_num_samples
3
1
Number samples
 
PV Inverter (CEC Coefficient Generator)
0
0
1
1
1
1
0
Choice
inv_cec_cg_paco
3
1
Maximum AC power
Wac
PV Inverter (CEC Coefficient Generator)
0
0
1
1
1
1
0
Numeric
inv_cec_cg_pdco
3
1
Pdco
Wdc
PV Inverter (CEC Coefficient Generator)
0
8
1
1
1
1
0
Numeric
inv_cec_cg_pnt
3
1
Pnt
W
PV Inverter (CEC Coefficient Generator)
0
0
1
1
1
1
0
Numeric
inv_cec_cg_psco
3
1
Pso
W
PV Inverter (CEC Coefficient Generator)
0
8
1
1
1
1
0
Numeric
inv_cec_cg_sample_power_units
3
1
Power units
 
PV Inverter (CEC Coefficient Generator)
0
0
1
1
1
1
0
Choice
inv_cec_cg_test_samples
3
3
Test sample data
 
PV Inverter (CEC Coefficient Generator)
0
1
1
3
2
30
10210 283.89 87.28 10210 283.39 87.29 10200 284.19 87.29 10200 284.42 87.29 10210 283.79 87.21 10200 283.45 87.15 10200 284.09 87.27 98050 284.34 83.81 10200 283.62 87.34 10190 283.41 87.35 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 

DataMatrix
inv_cec_cg_vdcmax
3
1
Vdcmax
Vdc
PV Inverter (CEC Coefficient Generator)
0
0
1
1
1
1
0
Numeric
inv_cec_cg_vdco
3
1
Vdco
Vdc
PV Inverter (CEC Coefficient Generator)
0
8
1
1
1
1
0
Numeric

1804
equations{ '$MIMO$ CEC_CG_InverterEfficiencies' } = define()
{
	//assign specs
	vdco = ${inv_cec_cg_vdco}; pdco = ${inv_cec_cg_pdco}; pso = ${inv_cec_cg_psco}; paco = ${inv_cec_cg_paco};
	c0= ${inv_cec_cg_c0}; c1= ${inv_cec_cg_c1}; c2= ${inv_cec_cg_c2}; c3= ${inv_cec_cg_c3};
	
	if(pdco <= 0) {return 0;} //prevents division by zero
	
	//calculate intermediate values
	pdc5 = 0.05 * pdco;
	pac5 = snlinverter(pdc5,vdco,vdco,pdco,pso,paco,c0,c1,c2,c3);
	pdc10 = 0.1 * pdco;
	pac10 = snlinverter(pdc10,vdco,vdco,pdco,pso,paco,c0,c1,c2,c3);
	pdc20 = 0.2 * pdco;
	pac20 = snlinverter(pdc20,vdco,vdco,pdco,pso,paco,c0,c1,c2,c3);
	pdc30 = 0.3 * pdco;
	pac30 = snlinverter(pdc30,vdco,vdco,pdco,pso,paco,c0,c1,c2,c3);
	pdc50 = 0.5 * pdco;
	pac50 = snlinverter(pdc50,vdco,vdco,pdco,pso,paco,c0,c1,c2,c3);
	pdc75 = 0.75 * pdco;
	pac75 = snlinverter(pdc75,vdco,vdco,pdco,pso,paco,c0,c1,c2,c3);
	pdc100 = pdco;
	pac100 = snlinverter(pdc100,vdco,vdco,pdco,pso,paco,c0,c1,c2,c3);

	//cec efficiency coefficients
	cec_F1 = 0.00; cec_F2 = 0.04; cec_F3 = 0.05; cec_F4 = 0.12;
	cec_F5 = 0.21; cec_F6 = 0.53; cec_F7 = 0.05;
	
	//euro efficiency coefficients
	euro_F1 = 0.03; euro_F2 = 0.06; euro_F3 = 0.13; euro_F4 = 0.10;
	euro_F5 = 0.48; euro_F6 = 0.00; euro_F7 = 0.20;
	
	//calculate efficiencies
	cec_eff = cec_F1 * pac5 / pdc5 
			+ cec_F2 * pac10 / pdc10 
			+ cec_F3 * pac20 / pdc20 
			+ cec_F4 * pac30 / pdc30 
			+ cec_F5 * pac50 / pdc50 
			+ cec_F6 * pac75 / pdc75 
			+ cec_F7 * pac100 / pdc100 ; 
			
	euro_eff = euro_F1 * pac5 / pdc5 
			+ euro_F2 * pac10 / pdc10 
			+ euro_F3 * pac20 / pdc20 
			+ euro_F4 * pac30 / pdc30 
			+ euro_F5 * pac50 / pdc50 
			+ euro_F6 * pac75 / pdc75 
			+ euro_F7 * pac100 / pdc100 ; 
			
	${inv_cec_cg_eff_cec} = cec_eff * 100;
	${inv_cec_cg_eff_euro} = euro_eff * 100;
};

5801
function calc_coefficients()
{
	//call inv_cec_cg module
	obj = ssc_create();
	ssc_var(obj, 'inv_cec_cg_paco', value("inv_cec_cg_paco"));
	ssc_var(obj, 'inv_cec_cg_sample_power_units', value("inv_cec_cg_sample_power_units"));
	ssc_var(obj, 'inv_cec_cg_test_samples', value("inv_cec_cg_test_samples"));
	result= ssc_exec(obj, 'inv_cec_cg', {'show_dialog'=false, 'hold_dialog'=false} );
	if(result != 0)
	{
		msgbox('Failed to solve for inverter coefficients. Please check your inputs.');
		return;
	}
	
	Pdco = ssc_var(obj, 'Pdco');
	Vdco = ssc_var(obj, 'Vdco');
	Pso = ssc_var(obj, 'Pso');
	c0 = ssc_var(obj, 'c0');
	c1 = ssc_var(obj, 'c1');
	c2 = ssc_var(obj, 'c2');
	c3 = ssc_var(obj, 'c3');
	
	ssc_free(obj);
	
	value("inv_cec_cg_pdco",Pdco);
	value("inv_cec_cg_vdco",Vdco);
	value("inv_cec_cg_psco",Pso);
	value("inv_cec_cg_c0",c0);
	value("inv_cec_cg_c1",c1);
	value("inv_cec_cg_c2",c2);
	value("inv_cec_cg_c3",c3);
	
	plot_cec_inverter_curve();	
}

function plot_cec_inverter_curve()
{
	//assign specs
	vdco = ${inv_cec_cg_vdco}; pdco = ${inv_cec_cg_pdco}; pso = ${inv_cec_cg_psco}; paco = ${inv_cec_cg_paco};
	mppt_low = ${inv_cec_cg_mppt_low}; mppt_hi = ${inv_cec_cg_mppt_hi};
	c0= ${inv_cec_cg_c0}; c1= ${inv_cec_cg_c1}; c2= ${inv_cec_cg_c2}; c3= ${inv_cec_cg_c3};
	
	//don't show mppt_low and mppt_high curves if blank or zero
	bolShowmppt_low = (value('inv_cec_cg_mppt_low') != 0);
	bolShowmppt_hi = (value('inv_cec_cg_mppt_hi') != 0);
	
	//don't show mppt curves if C0,C1,C2,C3 are zero
	if ((c0==0) && (c1==0) && (c2==0) && (c3==0))
	{
		bolShowmppt_low = false; bolShowmppt_hi = false;
	}
	
	//assign initial values
	i = 0; pdc = 0; pac = 0;
	
	//arrays in which to store points
	array_size= 201;
	x= alloc(array_size); xlow= alloc(array_size); xhi= alloc(array_size);
	y= alloc(array_size); ylow= alloc(array_size); yhi= alloc(array_size);
	
	//FIRST POINT
	x[i] = pdc; y[i] = 0;
	if (bolShowmppt_low) {xlow[i] = pdc; ylow[i] = 0;}
	if (bolShowmppt_hi) {xhi[i] = pdc; yhi[i] = 0;}
	i=i+1;
	
	//INTERMEDIATE POINTS
	while(i<200)
	{
		pdc = pdco * i/200; //increment in 200 even partitions
		pac = snlinverter(pdc,vdco,vdco,pdco,pso,paco,c0,c1,c2,c3);
		x[i] = (pdc/pdco*100); //percentage of rated power
		y[i] = (pac/pdc*100); //efficiency
		if (bolShowmppt_low)
		{
			pac = snlinverter(pdc,mppt_low,vdco,pdco,pso,paco,c0,c1,c2,c3);
			xlow[i] = (pdc/pdco*100); //percentage of rated power
			ylow[i] = (pac/pdc*100); //efficiency
		}
		if (bolShowmppt_hi)
		{
			pac = snlinverter(pdc,mppt_hi,vdco,pdco,pso,paco,c0,c1,c2,c3);
			xhi[i] = (pdc/pdco*100); //percentage of rated power
			yhi[i] = (pac/pdc*100); //efficiency
		}
		i = i + 1;
	}
	
	//LAST POINT
	pdc = pdco;
	pac = snlinverter(pdc,vdco,vdco,pdco,pso,paco,c0,c1,c2,c3);
	x[i] = (pdc/pdco*100); //percentage of rated power
	y[i] = (pac/pdc*100); //efficiency
	if (bolShowmppt_low)
	{
		pac = snlinverter(pdc,mppt_low,vdco,pdco,pso,paco,c0,c1,c2,c3);
		xlow[i] = (pdc/pdco*100); //percentage of rated power
		ylow[i] = (pac/pdc*100); //efficiency
	}
	if (bolShowmppt_hi)
	{
		pac = snlinverter(pdc,mppt_hi,vdco,pdco,pso,paco,c0,c1,c2,c3);
		xhi[i] = (pdc/pdco*100); //percentage of rated power
		yhi[i] = (pac/pdc*100); //efficiency
	}
	
	//MAKE THE PLOT	
	setplot("inv_cec_cg_eff_curve");
	clearplot("inv_cec_cg_eff_curve");
	plotopt({"title"="Efficiency Curve","popup"=true,"backcolor"=[255,255,255],"legend"=true, "legendpos"=[65,60]});
	plot(x,y,{"thick"=1.5, "scale"=true,"color"=[100,200,100], "series"="Vdco"});
	if(bolShowmppt_low){
		plot(xlow,ylow,{"thick"=1.5, "scale"=true, "color"=[100,100,200], "series"="Mppt-low"});
	}
	if(bolShowmppt_hi){
		plot(xhi,yhi,{"thick"=1.5, "scale"=true, "color"=[200,100,100], "series"="Mppt-hi"});
	}
	axis('x1', {'label'='% of Rated Output Power', 'min'=0, 'max'=100});
	axis('y1', {'label'='Efficiency (%)', 'min'=70, 'max'=100});
}

on_change{'inv_cec_cg_test_samples'} = define() {
	x = value('inv_cec_cg_test_samples');
	numcols = #x[2]; 
	ndx_new = numcols / 3 - 1;
	ndx = value('inv_cec_cg_num_samples');
	if (ndx_new != ndx) 
	{
		value('inv_cec_cg_num_samples',ndx_new);
		calc_coefficients();
	}
};

on_change{'inv_cec_cg_paco'} = define() {
	calc_coefficients();
};

on_change{'inv_cec_cg_sample_power_units'} = define() {
	calc_coefficients();
};

on_change{'inv_cec_cg_num_samples'} = define() {
	x = value('inv_cec_cg_test_samples');
	ndx = value('inv_cec_cg_num_samples');
	numcols = (ndx+1) * 3;
	if (numcols != #x[2])
	{
		y = alloc(18, numcols);
		// copy existing data
		nc=min(#x[2],numcols);
		for (ir=0;ir<18;ir++)
		{
			for (ic=0;ic<nc;ic++)
			{
				y[ir][ic] = x[ir][ic];
			}
		}
		value('inv_cec_cg_test_samples',y);
		calc_coefficients();
	}
};

on_change{'btnCalcCoefficients'} = define() {
	calc_coefficients();
};


on_change{'btnSaveCECInvData'} = define() {
	logmsg('running btnSaveCECInvData');
	file = choose_file( '', 'Save CEC Inverter Data As', 
		'Data Files (*.csv)|*.csv', true);
		
	if ( file != '' ) {
		file = replace(file, '\\', '/');
		if (group_write('PV Inverter (CEC Coefficient Generator)',file))
		{	
			value( 'inv_cec_cg_filename', file );
			msgbox("Data saved! \n");
		}
		else
		{
			value( 'inv_cec_cg_filename', "" );
			msgbox("Data save failed! \n");
		}
	}
};

on_change{'btnLoadCECInvData'} = define() {
	logmsg('running btnLoadCECInvData');
	file = choose_file( '', 'Open CEC Inverter Data File', 
		'Data Files (*.csv)|*.csv');
		
	if ( file != '' ) {
		file = replace(file, '\\', '/');
		if (group_read('PV Inverter (CEC Coefficient Generator)',file))
		{	
			value( 'inv_cec_cg_filename', file );
			msgbox("Data loaded! \n");
		}
		else
		{
			value( 'inv_cec_cg_filename', "" );
			msgbox("Data load failed! \n");
		}
	}
};

on_load{"Inverter CEC Coefficient Generator"} = define()
{
	calc_coefficients();
};
