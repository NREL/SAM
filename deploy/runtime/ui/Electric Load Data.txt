Electric Load Data
837
577
71
GroupBox

1
8
Name
5
9
GroupBox1
X
3
6
Y
3
6
Width
3
824
Height
3
566
Tool Tip
5
0
Caption
5
18
Electric Load Data
Bold
2
1
Label

1
13
Name
5
6
Label1
X
3
483
Y
3
231
Width
3
68
Height
3
21
Tool Tip
5
0
Caption
5
3
Jan
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Label

1
13
Name
5
7
Label11
X
3
483
Y
3
255
Width
3
68
Height
3
21
Tool Tip
5
0
Caption
5
3
Feb
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Label

1
13
Name
5
8
Label111
X
3
483
Y
3
279
Width
3
68
Height
3
21
Tool Tip
5
0
Caption
5
3
Mar
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Label

1
13
Name
5
9
Label1111
X
3
483
Y
3
303
Width
3
68
Height
3
21
Tool Tip
5
0
Caption
5
3
Apr
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Label

1
13
Name
5
10
Label11111
X
3
483
Y
3
327
Width
3
68
Height
3
21
Tool Tip
5
0
Caption
5
3
May
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Label

1
13
Name
5
11
Label111111
X
3
483
Y
3
351
Width
3
68
Height
3
21
Tool Tip
5
0
Caption
5
3
Jun
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Label

1
13
Name
5
12
Label1111111
X
3
483
Y
3
375
Width
3
68
Height
3
21
Tool Tip
5
0
Caption
5
3
Jul
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Label

1
13
Name
5
13
Label11111111
X
3
483
Y
3
399
Width
3
68
Height
3
21
Tool Tip
5
0
Caption
5
3
Aug
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Label

1
13
Name
5
14
Label111111111
X
3
483
Y
3
423
Width
3
68
Height
3
21
Tool Tip
5
0
Caption
5
3
Sep
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Label

1
13
Name
5
15
Label1111111111
X
3
483
Y
3
447
Width
3
68
Height
3
21
Tool Tip
5
0
Caption
5
3
Oct
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Label

1
13
Name
5
16
Label11111111111
X
3
483
Y
3
471
Width
3
68
Height
3
21
Tool Tip
5
0
Caption
5
3
Nov
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Label

1
13
Name
5
17
Label111111111111
X
3
483
Y
3
528
Width
3
68
Height
3
21
Tool Tip
5
0
Caption
5
6
Annual
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Label

1
13
Name
5
19
Label11111111111138
X
3
483
Y
3
495
Width
3
68
Height
3
21
Tool Tip
5
0
Caption
5
3
Dec
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Label

1
13
Name
5
6
Label2
X
3
498
Y
3
207
Width
3
137
Height
3
21
Tool Tip
5
0
Caption
5
12
Energy (kWh)
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Label

1
13
Name
5
9
Label2129
X
3
636
Y
3
207
Width
3
80
Height
3
21
Tool Tip
5
0
Caption
5
9
Peak (kW)
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Numeric

1
17
Name
5
11
annual_crit
X
3
729
Y
3
528
Width
3
79
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
0
Numeric

1
17
Name
5
11
annual_peak
X
3
636
Y
3
528
Width
3
79
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
0
Numeric

1
17
Name
5
6
crit_1
X
3
729
Y
3
231
Width
3
79
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
0
Numeric

1
17
Name
5
7
crit_10
X
3
729
Y
3
447
Width
3
79
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
0
Numeric

1
17
Name
5
7
crit_11
X
3
729
Y
3
471
Width
3
79
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
0
Numeric

1
17
Name
5
7
crit_12
X
3
729
Y
3
495
Width
3
79
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
0
Numeric

1
17
Name
5
6
crit_2
X
3
729
Y
3
255
Width
3
79
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
0
Numeric

1
17
Name
5
6
crit_3
X
3
729
Y
3
279
Width
3
79
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
0
Numeric

1
17
Name
5
6
crit_4
X
3
729
Y
3
303
Width
3
79
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
0
Numeric

1
17
Name
5
6
crit_5
X
3
729
Y
3
327
Width
3
79
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
0
Numeric

1
17
Name
5
6
crit_6
X
3
729
Y
3
351
Width
3
79
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
0
Numeric

1
17
Name
5
6
crit_7
X
3
729
Y
3
375
Width
3
79
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
0
Numeric

1
17
Name
5
6
crit_8
X
3
729
Y
3
399
Width
3
79
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
0
Numeric

1
17
Name
5
6
crit_9
X
3
729
Y
3
423
Width
3
79
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
0
Label

1
13
Name
5
14
critical_label
X
3
729
Y
3
207
Width
3
80
Height
3
21
Tool Tip
5
0
Caption
5
14
Critical (kWh)
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Numeric

1
17
Name
5
8
energy_1
X
3
555
Y
3
231
Width
3
79
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
0
Numeric

1
17
Name
5
9
energy_10
X
3
555
Y
3
447
Width
3
79
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
0
Numeric

1
17
Name
5
9
energy_11
X
3
555
Y
3
471
Width
3
79
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
0
Numeric

1
17
Name
5
9
energy_12
X
3
555
Y
3
495
Width
3
79
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
0
Numeric

1
17
Name
5
8
energy_2
X
3
555
Y
3
255
Width
3
79
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
0
Numeric

1
17
Name
5
8
energy_3
X
3
555
Y
3
279
Width
3
79
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
0
Numeric

1
17
Name
5
8
energy_4
X
3
555
Y
3
303
Width
3
79
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
0
Numeric

1
17
Name
5
8
energy_5
X
3
555
Y
3
327
Width
3
79
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
0
Numeric

1
17
Name
5
8
energy_6
X
3
555
Y
3
351
Width
3
79
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
0
Numeric

1
17
Name
5
8
energy_7
X
3
555
Y
3
375
Width
3
79
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
0
Numeric

1
17
Name
5
8
energy_8
X
3
555
Y
3
399
Width
3
79
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
0
Numeric

1
17
Name
5
8
energy_9
X
3
555
Y
3
423
Width
3
79
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
0
SchedNumeric

1
12
Name
5
18
escal_input_hourly
X
3
261
Y
3
168
Width
3
119
Height
3
24
Tool Tip
5
0
Label
5
18
Load Growth (%/yr)
UseSchedule
2
0
ScheduleOnly
2
0
FixedLength
3
4294967295
Description
5
110
Type a load growth rate (%) for each year. Each year's growth rate applies to the total annual load in Year 1.
TabOrder
3
3
Numeric

1
17
Name
5
17
load_annual_total
X
3
555
Y
3
528
Width
3
79
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
0
DataArray

1
10
Name
5
14
load_user_data
X
3
261
Y
3
111
Width
3
119
Height
3
28
Tool Tip
5
58
Click Edit Array to import time series electric load data.
Mode
3
1
Label
5
15
Load Power (kW)
Description
5
156
The electric load power is the average power over the time interval.  For hourly load data, this is equivalent to entering energy usage in each hour in kWh.
TabOrder
3
1
Label

1
13
Name
5
23
monthly_summary_message
X
3
471
Y
3
144
Width
3
357
Height
3
60
Tool Tip
5
0
Caption
5
118
These monthly and annual values are calculated from the hourly or subhourly load profile and shown here for reference.
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
CheckBox

1
9
Name
5
25
normalize_to_utility_bill
X
3
69
Y
3
267
Width
3
312
Height
3
24
Tool Tip
5
0
Caption
5
44
Scale electric load profile to monthly usage
State
2
1
TabOrder
3
4
Divider

1
10
Name
5
9
object 22
X
3
54
Y
3
246
Width
3
390
Height
3
24
Tool Tip
5
0
Orientation
3
0
Colour
4
120
120
120
255
Caption
5
36
Adjust Load Profile to Monthly Usage
Bold
2
1
Divider

1
10
Name
5
11
object 2211
X
3
465
Y
3
123
Width
3
360
Height
3
24
Tool Tip
5
0
Orientation
3
0
Colour
4
120
120
120
255
Caption
5
20
Monthly Load Summary
Bold
2
1
Divider

1
10
Name
5
10
object 228
X
3
54
Y
3
90
Width
3
390
Height
3
24
Tool Tip
5
0
Orientation
3
0
Colour
4
120
120
120
255
Caption
5
32
Hourly or Subhourly Load Profile
Bold
2
1
Label

1
13
Name
5
10
object 714
X
3
30
Y
3
24
Width
3
798
Height
3
48
Tool Tip
5
0
Caption
5
275
Electric load data describes the electricity usage of a building or facility for electricity bill calculations. Enter or import an hourly or subhourly load profile and use the adjustment options to scale the profile or to account for annual load growth. See Help for details.
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Numeric

1
17
Name
5
6
peak_1
X
3
636
Y
3
231
Width
3
79
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
0
Numeric

1
17
Name
5
7
peak_10
X
3
636
Y
3
447
Width
3
79
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
0
Numeric

1
17
Name
5
7
peak_11
X
3
636
Y
3
471
Width
3
79
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
0
Numeric

1
17
Name
5
7
peak_12
X
3
636
Y
3
495
Width
3
79
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
0
Numeric

1
17
Name
5
6
peak_2
X
3
636
Y
3
255
Width
3
79
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
0
Numeric

1
17
Name
5
6
peak_3
X
3
636
Y
3
279
Width
3
79
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
0
Numeric

1
17
Name
5
6
peak_4
X
3
636
Y
3
303
Width
3
79
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
0
Numeric

1
17
Name
5
6
peak_5
X
3
636
Y
3
327
Width
3
79
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
0
Numeric

1
17
Name
5
6
peak_6
X
3
636
Y
3
351
Width
3
79
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
0
Numeric

1
17
Name
5
6
peak_7
X
3
636
Y
3
375
Width
3
79
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
0
Numeric

1
17
Name
5
6
peak_8
X
3
636
Y
3
399
Width
3
79
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
0
Numeric

1
17
Name
5
6
peak_9
X
3
636
Y
3
423
Width
3
79
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
0
Numeric

1
17
Name
5
12
scale_factor
X
3
261
Y
3
141
Width
3
119
Height
3
24
Tool Tip
5
89
Type a fixed scaling factor to adjust the hourly load profile. Type a '1' for no scaling.
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
2
ToolTipCtrl

1
8
Name
5
12
tt_load_data
X
3
414
Y
3
111
Width
3
24
Height
3
24
Tool Tip
5
0
Tips
5
55
Type a tip here or define in runtime/help/tooltips.json
TipTitle
5
61
Type a tip title here or define in runtime/help/tooltips.json
ToolTipCtrl

1
8
Name
5
14
tt_load_growth
X
3
414
Y
3
168
Width
3
24
Height
3
24
Tool Tip
5
0
Tips
5
55
Type a tip here or define in runtime/help/tooltips.json
TipTitle
5
61
Type a tip title here or define in runtime/help/tooltips.json
ToolTipCtrl

1
8
Name
5
21
tt_load_scale_monthly
X
3
414
Y
3
294
Width
3
24
Height
3
24
Tool Tip
5
0
Tips
5
55
Type a tip here or define in runtime/help/tooltips.json
TipTitle
5
61
Type a tip title here or define in runtime/help/tooltips.json
ToolTipCtrl

1
8
Name
5
15
tt_load_scaling
X
3
414
Y
3
141
Width
3
24
Height
3
24
Tool Tip
5
0
Tips
5
55
Type a tip here or define in runtime/help/tooltips.json
TipTitle
5
61
Type a tip title here or define in runtime/help/tooltips.json
MonthlyFactor

1
8
Name
5
17
utility_bill_data
X
3
279
Y
3
294
Width
3
102
Height
3
28
Tool Tip
5
0
Description
5
26
Monthly energy usage (kWh)
TabOrder
3
5
Button

1
8
Name
5
19
visualize_load_data
X
3
543
Y
3
90
Width
3
224
Height
3
28
Tool Tip
5
0
Caption
5
17
View load data...
TabOrder
3
6

46
annual_crit
3
1
Annual critical electric load
kWh
Electric Load
0
9
1
1
1
1
0
Default
annual_peak
3
1
Annual peak electric load power
kW
Electric Load
0
9
1
1
1
1
0
Default
crit_1
3
1
 
 
Electric Load
0
8
1
1
1
1
0
Default
crit_10
3
1
 
 
Electric Load
0
8
1
1
1
1
0
Default
crit_11
3
1
 
 
Electric Load
0
8
1
1
1
1
0
Default
crit_12
3
1
 
 
Electric Load
0
8
1
1
1
1
0
Default
crit_2
3
1
 
 
Electric Load
0
8
1
1
1
1
0
Default
crit_3
3
1
 
 
Electric Load
0
8
1
1
1
1
0
Default
crit_4
3
1
 
 
Electric Load
0
8
1
1
1
1
0
Default
crit_5
3
1
 
 
Electric Load
0
8
1
1
1
1
0
Default
crit_6
3
1
 
 
Electric Load
0
8
1
1
1
1
0
Default
crit_7
3
1
 
 
Electric Load
0
8
1
1
1
1
0
Default
crit_8
3
1
 
 
Electric Load
0
8
1
1
1
1
0
Default
crit_9
3
1
 
 
Electric Load
0
8
1
1
1
1
0
Default
energy_1
3
1
 
 
Electric Load
0
8
1
1
1
1
0
Default
energy_10
3
1
 
 
Electric Load
0
8
1
1
1
1
0
Default
energy_11
3
1
 
 
Electric Load
0
8
1
1
1
1
0
Default
energy_12
3
1
 
 
Electric Load
0
8
1
1
1
1
0
Default
energy_2
3
1
 
 
Electric Load
0
8
1
1
1
1
0
Default
energy_3
3
1
 
 
Electric Load
0
8
1
1
1
1
0
Default
energy_4
3
1
 
 
Electric Load
0
8
1
1
1
1
0
Default
energy_5
3
1
 
 
Electric Load
0
8
1
1
1
1
0
Default
energy_6
3
1
 
 
Electric Load
0
8
1
1
1
1
0
Default
energy_7
3
1
 
 
Electric Load
0
8
1
1
1
1
0
Default
energy_8
3
1
 
 
Electric Load
0
8
1
1
1
1
0
Default
energy_9
3
1
 
 
Electric Load
0
8
1
1
1
1
0
Default
escal_input_hourly
3
2
Electric load annual growth rate
%/yr
Electric Load
0
2
1
2
1
1
0
Default
load
3
2
Scaled electric load power
kW
Electric Load
0
8
1
2
1
1
0
Default
load_annual_total
3
1
Annual electric load
kWh
Electric Load
0
9
1
1
1
1
0
Default
load_user_data
3
2
Electric load power
kW
Electric Load
0
0
1
2
1
1
0
DataArray
mpeak
3
2
Monthly electric load peak power
kW
Electric load
0
8
1
2
1
1
0
Default
normalize_to_utility_bill
3
1
Scale monthly electric load to monthly usage
 
Electric Load
0
1
1
1
1
1
0
Default
peak_1
3
1
 
 
Electric Load
0
8
1
1
1
1
0
Default
peak_10
3
1
 
 
Electric Load
0
8
1
1
1
1
0
Default
peak_11
3
1
 
 
Electric Load
0
8
1
1
1
1
0
Default
peak_12
3
1
 
 
Electric Load
0
8
1
1
1
1
0
Default
peak_2
3
1
 
 
Electric Load
0
8
1
1
1
1
0
Default
peak_3
3
1
 
 
Electric Load
0
8
1
1
1
1
0
Default
peak_4
3
1
 
 
Electric Load
0
8
1
1
1
1
0
Default
peak_5
3
1
 
 
Electric Load
0
8
1
1
1
1
0
Default
peak_6
3
1
 
 
Electric Load
0
8
1
1
1
1
0
Default
peak_7
3
1
 
 
Electric Load
0
8
1
1
1
1
0
Default
peak_8
3
1
 
 
Electric Load
0
8
1
1
1
1
0
Default
peak_9
3
1
 
 
Electric Load
0
8
1
1
1
1
0
Default
scale_factor
3
1
Electric load scaling factor (optional)
 
Electric Load
0
2
1
1
1
1
1
Default
utility_bill_data
3
2
Monthly electricity usage for scaling
kWh
Electric Load
0
0
1
2
1
12
300 300 300 300 300 400 500 500 400 300 300 300 

Default

4970
equations{ 'escal_other' } = define() {
	return ${escal_input_hourly};
};

equations{ '$MIMO$ elecload' } = define() {

	const nday = [31,28,31,30,31,30,31,31,30,31,30,31];
	const calc_monthly = define( load, crit_ts, crit_pct, mload, mpeak, mcrit, is_crit )	
	{
		// load is in kW
		// one of crit_ts(kW) and crit_pct (%) must be 0
		// mload is kWh
		// mpeak is kW
		// mcrit is kWh
	
		if ( is_crit )
		{
			crit_use_ts = false;
			if (crit_ts != 0)
			{
				crit_use_ts = true;
			}
			else
			{
				crit_pct = crit_pct / 100.;
			}
		}
		nsub = #load/8760; // number of subhourly steps per hour
		tshr = 1.0/nsub; // timestep in hours
		
		//CALCULATE MONTHLY SUMS AND PEAKS
		c=0;
		for (m=0;m<12;m++)
		{
			mpeak[m]=0.0;
			mload[m]=0.0;
			mcrit[m]=0.0;
			for (d=0;d<nday[m];d++)
			{
				for (h=0;h<24;h++)
				{
					for (jj=0;jj<nsub;jj++ )
					{
						mload[m] += load[c] * tshr;
						
						if (load[c] > mpeak[m])
							mpeak[m] = load[c];
							
						if (is_crit && crit_use_ts)
						{
							mcrit[m] += crit_ts[c] * tshr;
						}
						c++;
					}
				}			
			}
			if (is_crit && !crit_use_ts)
			{
				mcrit[m] = mload[m] * crit_pct;
			}
		}
	};

	// not ideal, but need a way to check for critical load when Grid Outage Critical Load page is not in configuration
	tech = technology();
	is_critical_load_tech = ( tech == 'PV Battery' || tech == 'Standalone Battery' || tech == 'Generic Battery' || tech == 'Fuel Cell' );
		
	// arrays for monthly load (kWh) and peak (kW)
	mload = alloc(12);
	mpeak = alloc(12);
	mcrit = alloc(12);
	
	//STOP HERE IF NOT ENTERING  DATA- EITHER NO LOAD OR CALCULATED BY BELPE
	if( ${load_model} != 1 ) //exclusive var from startup page
	{
		${load} = alloc(8760); // zero load, 8760 array
		${load_annual_total} = 0;
		${annual_peak} = 0;
		${annual_crit} = 0;
		return;
	}

	// READ IN USER SUPPLIED DATA (8760 or multiple of 8760)
	load = ${load_user_data};
	len = #load;
	nsub = len/8760;
	tshr = 1.0/nsub; // timestep in hours
	
	if(mod(len, 8760) != 0 )
	{
		msgbox('Hourly electric load data must be a multiple of 8760.'
		' Current load length = %d\n', len);
		return false;
	}

	//APPLY MONTHLY LOAD SCALING- WILL OVERWRITE SCALING FACTOR	
	if ( ${normalize_to_utility_bill} )
	{
		// determine monthly load, no need for critical load calcs
		// mcrit should be array of zeros if no critical load
		calc_monthly( load, 0, 0, mload, mpeak, mcrit, is_critical_load_tech );
		
		scale = alloc(12);
		ubd = ${utility_bill_data};
		//compute the scaling factor necessary for each month
		for (m=0; m<12; m++)
		{
			if (mload[m] > 0) //error checking
			{
				scale[m] = ubd[m] / mload[m];
			}	
		}
			
		// apply monthly scaling factors
		c=0;
		for (m=0;m<12;m++)
		{
			for (d=0;d<nday[m];d++)
			{
				for (h=0;h<24;h++)
				{
					for( jj=0;jj<nsub;jj++ )
					{
						load[c] *= scale[m];
						c++;
					}
				}
			}
		}		
	}
	else
	{
		// scale load profile with value provided by user
		scale = ${scale_factor};
		for (i=0;i<len;i++)
		{
			load[i] *= scale;
		}	
	}
	
	// get the critical load 
	crit_ts = 0;
	crit_pct = 0; 
	if ( is_critical_load_tech )
	{
		crit_type = ${crit_load_type};
		if (crit_type == 1)
		{
			crit_ts = ${crit_load_user_data};
			clen = #crit_ts;
			// not sure how this state could happen
			if ( mod(clen, 8760) != 0 )
			{
				//msgbox('Hourly critical electric load data must be a multiple of 8760.');
				return false;
			}
			${crit_load} = crit_ts;
		}
		else
		{
			crit_pct = ${crit_load_pct};
			crit_ratio = crit_pct / 100;
			crit_load = alloc(#load);
			for (i = 0; i < #load; i++)
			{
				crit_load[i] = load[i] * crit_ratio;
			}
			${crit_load} = crit_load;
		}
	}
	
	// determine monthly loads and peaks from
	// preprocessed load array (load)
	calc_monthly( load, crit_ts, crit_pct, mload, mpeak, mcrit, is_critical_load_tech );		
	
	// save outputs to variables in UI
	// critical load data should be set to zero if no critical load
	${energy_1} = mload[0];
	${peak_1} = mpeak[0];
	${crit_1} = mcrit[0];
	${energy_2} = mload[1];
	${peak_2} = mpeak[1];
	${crit_2} = mcrit[1];
	${energy_3} = mload[2];
	${peak_3} = mpeak[2];
	${crit_3} = mcrit[2];
	${energy_4} = mload[3];
	${peak_4} = mpeak[3];
	${crit_4} = mcrit[3];
	${energy_5} = mload[4];
	${peak_5} = mpeak[4];
	${crit_5} = mcrit[4];
	${energy_6} = mload[5];
	${peak_6} = mpeak[5];
	${crit_6} = mcrit[5];
	${energy_7} = mload[6];
	${peak_7} = mpeak[6];
	${crit_7} = mcrit[6];
	${energy_8} = mload[7];
	${peak_8} = mpeak[7];
	${crit_8} = mcrit[7];
	${energy_9} = mload[8];
	${peak_9} = mpeak[8];
	${crit_9} = mcrit[8];
	${energy_10} = mload[9];
	${peak_10} = mpeak[9];
	${crit_10} = mcrit[9];
	${energy_11} = mload[10];
	${peak_11} = mpeak[10];
	${crit_11} = mcrit[10];
	${energy_12} = mload[11];
	${peak_12} = mpeak[11];
	${crit_12} = mcrit[11];
	${mpeak} = mpeak;
	${load} = load;
	${load_annual_total} = sum(load)*tshr;
	${annual_peak} = max(load);
	${annual_crit} = sum(mcrit);

	return 0;
};
1885
on_load{'Electric Load Data'} = define() {
	property('escal_input_hourly','FixedLength',${analysis_period});
	on_change{'normalize_to_utility_bill'}();
	show_crit(${annual_crit}>0);
	monthly_load_message();
};

on_change{'normalize_to_utility_bill'} = define() {
	norm = ${normalize_to_utility_bill};
	enable( 'utility_bill_data', norm );
	enable( 'scale_factor', !norm);
};

on_change{'visualize_load_data'} = define() {
	sc = ${scale_factor};
	norm = ${normalize_to_utility_bill};
	
	L = ${load};
	ts = 1.0/(#L / 8760); // timestep in hours
	
	if ( sc == 1.0 && !norm )
	{
		if (${annual_crit}>0) 
		{
			crit_load_ts = ${crit_load};
			dview( 2, ts, "Electric Load", 
			"Load power", "kW", 1.0, ${load},
			"Critical load power", "kW", 1.0, crit_load_ts);
		}
		else
		{
			dview( 1, ts, "Electric Load", 
			"Load power", "kW", 1.0, ${load});
		}
	}
	else
	{
		if (${annual_crit}>0) 
		{
			crit_load_ts = ${crit_load};
			dview( 3, ts, "Electric Load",
			"User-entered load power", "kW", 1.0, ${load_user_data},
			"Scaled load power", "kW", 1.0, ${load},
			"Critical load power", "kW", 1.0, crit_load_ts );
		}
		else
		{
			dview( 2, ts, "Electric Load",
			"User-entered load power", "kW", 1.0, ${load_user_data},
			"Scaled load power", "kW", 1.0, ${load} );
		}
			
	}
};

function show_crit(show_bool) 
{
	for (i = 1; i < 13; i++) {
		name = 'crit_' + to_string(i);
		show(name, show_bool);
	}
	show('annual_crit', show_bool);
	show('critical_label', show_bool);
	refresh();
}

function monthly_load_message()
{
	msg = 'These monthly and annual values are calculated from the hourly or subhourly load profile and shown here for reference.';
	clr = 'Black';
	if ( ${annual_crit}>0 )
	{
		msg = msg + ' Critical load data is from the Grid Outage page.';
	}
	property( 'monthly_summary_message', 'Caption', msg );
	property( 'monthly_summary_message', 'TextColour', clr );
}