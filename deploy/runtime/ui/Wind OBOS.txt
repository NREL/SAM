Wind OBOS
828
592
34
Choice

1
9
Name
5
6
anchor
X
3
213
Y
3
87
Width
3
132
Height
3
24
Tool Tip
5
0
Items
6
2
Drag embedment
Suction pile
Selection
3
0
TabOrder
3
2
Button

1
8
Name
5
14
btn_obos_apply
X
3
12
Y
3
546
Width
3
192
Height
3
24
Tool Tip
5
0
Caption
5
18
Apply BOS Estimate
TabOrder
3
27
Numeric

1
17
Name
5
9
buryDepth
X
3
213
Y
3
168
Width
3
90
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
1
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
5
CheckBox

1
9
Name
5
14
cableOptimizer
X
3
213
Y
3
195
Width
3
90
Height
3
24
Tool Tip
5
0
Caption
5
3
Use
State
2
0
TabOrder
3
6
TableData

1
9
Name
5
22
detailed_obos_assembly
X
3
573
Y
3
375
Width
3
90
Height
3
24
Tool Tip
5
0
Description
5
15
Table of values
Fields
6
0
TabOrder
3
24
TableData

1
9
Name
5
25
detailed_obos_development
X
3
573
Y
3
429
Width
3
90
Height
3
24
Tool Tip
5
0
Description
5
15
Table of values
Fields
6
0
TabOrder
3
26
TableData

1
9
Name
5
24
detailed_obos_electrical
X
3
267
Y
3
429
Width
3
90
Height
3
24
Tool Tip
5
0
Description
5
15
Table of values
Fields
6
0
TabOrder
3
23
TableData

1
9
Name
5
21
detailed_obos_general
X
3
267
Y
3
375
Width
3
90
Height
3
24
Tool Tip
5
0
Description
5
15
Table of values
Fields
6
0
TabOrder
3
21
TableData

1
9
Name
5
18
detailed_obos_port
X
3
573
Y
3
402
Width
3
90
Height
3
24
Tool Tip
5
0
Description
5
15
Table of values
Fields
6
0
TabOrder
3
25
TableData

1
9
Name
5
26
detailed_obos_substructure
X
3
267
Y
3
402
Width
3
90
Height
3
24
Tool Tip
5
0
Description
5
15
Table of values
Fields
6
0
TabOrder
3
22
Numeric

1
17
Name
5
8
distAtoS
X
3
687
Y
3
114
Width
3
90
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
0
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
13
Numeric

1
17
Name
5
12
distInterCon
X
3
687
Y
3
168
Width
3
90
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
0
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
15
Numeric

1
17
Name
5
8
distPort
X
3
687
Y
3
87
Width
3
90
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
0
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
12
Numeric

1
17
Name
5
8
distPtoA
X
3
687
Y
3
141
Width
3
90
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
0
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
14
Numeric

1
17
Name
5
9
distShore
X
3
687
Y
3
60
Width
3
90
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
1
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
11
Numeric

1
17
Name
5
8
elecCont
X
3
687
Y
3
222
Width
3
90
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
17
Choice

1
9
Name
5
15
installStrategy
X
3
213
Y
3
222
Width
3
132
Height
3
24
Tool Tip
5
0
Items
6
2
Primary vessel
Feeder barge
Selection
3
0
TabOrder
3
7
Numeric

1
17
Name
5
12
interConVolt
X
3
213
Y
3
303
Width
3
90
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
0
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
10
Numeric

1
17
Name
5
9
moorLines
X
3
213
Y
3
141
Width
3
90
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
0
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4
Numeric

1
17
Name
5
22
number_install_seasons
X
3
687
Y
3
195
Width
3
90
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
0
Format
3
0
Decimals
3
0
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
16
GroupBox

1
8
Name
5
8
object 4
X
3
6
Y
3
468
Width
3
816
Height
3
117
Tool Tip
5
0
Caption
5
45
Offshore Balance of System Cost Model Results
Bold
2
1
GroupBox

1
8
Name
5
10
object 410
X
3
6
Y
3
354
Width
3
816
Height
3
108
Tool Tip
5
0
Caption
5
53
Detailed Offshore Balance of System Cost Model Inputs
Bold
2
1
Label

1
13
Name
5
8
object 7
X
3
207
Y
3
546
Width
3
600
Height
3
30
Tool Tip
5
0
Caption
5
75
Replace SAM balance of system cost input with estimate from BOS cost model.
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
4294967295
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
GroupBox

1
8
Name
5
14
obos_group_box
X
3
6
Y
3
42
Width
3
816
Height
3
306
Tool Tip
5
0
Caption
5
44
Offshore Balance of System Cost Model Inputs
Bold
2
1
MultilineText

1
11
Name
5
12
obos_warning
X
3
504
Y
3
486
Width
3
303
Height
3
57
Tool Tip
5
0
Text
5
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
8
scrapVal
X
3
687
Y
3
303
Width
3
90
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
20
Numeric

1
17
Name
5
13
substructCont
X
3
687
Y
3
276
Width
3
90
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
19
Choice

1
9
Name
5
12
substructure
X
3
213
Y
3
60
Width
3
132
Height
3
24
Tool Tip
5
0
Items
6
4
Monopile
Jacket
Spar
Semisubmersible
Selection
3
0
TabOrder
3
1
Numeric

1
17
Name
5
15
total_obos_cost
X
3
315
Y
3
489
Width
3
120
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
1
$
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
22
total_obos_cost_per_kw
X
3
315
Y
3
516
Width
3
120
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Choice

1
9
Name
5
18
towerInstallMethod
X
3
213
Y
3
276
Width
3
132
Height
3
24
Tool Tip
5
0
Items
6
2
One piece
Two piece
Selection
3
0
TabOrder
3
9
Numeric

1
17
Name
5
8
turbCont
X
3
687
Y
3
249
Width
3
90
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
18
Choice

1
9
Name
5
17
turbInstallMethod
X
3
213
Y
3
249
Width
3
132
Height
3
24
Tool Tip
5
0
Items
6
3
Individual
Bunny ears
Rotor assembled
Selection
3
0
TabOrder
3
8
Numeric

1
17
Name
5
6
waterD
X
3
213
Y
3
114
Width
3
90
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
1
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
3

29
anchor
3
1
Anchor type
 
Wind OBOS
0
0
1
1
1
1
0
Default
buryDepth
3
1
Electical cable burial depth
m
Wind OBOS
0
0
1
1
1
1
2
Default
cableOptimizer
3
1
Electrical cable cost optimizer
 
Wind OBOS
0
0
1
1
1
1
0
Default
detailed_obos_assembly
3
5
Assembly & Installation
 
Wind OBOS
2608
anchor_mooring_water_depth_time_factor|anchor_mooring_loadout_time|survey_mooring_lines_anchor_positions_time|prepare_inshore_assembly_area_for_turbine_installation|prepare_spar_for_tow_to_inshore_assembly_area|upend_and_ballast_spar|prepare_semi_submersible_for_turbine_installation|prepare_and_fasten_turbine_for_transport|lift_and_bolt_tower_section|lift_and_bolt_nacelle_individual_components_method|lift_and_bolt_nacelle_bunny_ears_method|lift_and_bolt_nacelle_fully_assembled_rotor_method|lift_and_bolt_blade_individual_components_method|lift_and_bolt_blade_bunny_ears_method|lift_and_bolt_rotor_fully_assembled_rotor_method|vessel_positioning_time_turbine_installation|vessel_positioning_time_jacket_installation|vessel_positioning_time_monopile_installation|vessel_positioning_time_offshore_substation_installation|prepare_and_fasten_monopile_for_transport|prepare_and_fasten_jacket_for_transport|prepare_monopile_gripper_and_upender|prepare_jacket_gripper_and_upender|place_jacket_piles|prepare_hammer_for_monopile_installation|prepare_hammer_for_jacket_piles_installation|remove_hammer_for_monopile_installation|remove_hammer_for_jacket_piles_installation|place_jacket_pile_template_on_seabed|place_jacket_main_lattice_onto_piles|level_jacket_main_lattice|pile_hammer_rate|lift_and_place_monopile_for_hammering|install_scour_protection_around_monopile_base|place_transition_piece_onto_monopile|grout_transition_piece_monopile_interface|install_transition_piece_cover|prepare_floating_substructure_for_tow_to_site|connect_mooring_lines_to_spar|connect_mooring_lines_to_semi_submersible|survey_spar_mooring_lines_and_connections|survey_semi_submersible_mooing_lines_and_connections|ballast_semi_submersible|cable_surface_lay_rate|array_cable_pull_in_to_interfaces|cable_termination_and_testing|array_cable_loadout_for_installation|cable_burial_rate|cable_pull_in_to_offshore_substation|cable_pull_in_to_onshore_infrastructure|onshore_infrastructure_construction|export_cable_loadout_for_installation|offshore_substation_loadout_for_installation|lift_and_place_offshore_substation_topside|number_of_feeder_barges|piling_spread_day_rate|piling_spread_mobilization_cost|grouting_spread_day_rate|grouting_spread_mobilization_cost|suction_pile_anchor_spread_day_rate|suction_pile_anchor_spread_mobilization_cost|component_racks_cost|cable_route_survey_cost|horizontal_drilling_distance_for_cable_landfall|cost_rate_for_horizontal_drilling|mpv_rental_day_rate|cable_landfall_dive_team_day_rate|cable_landfall_winch_day_rate|onshore_infrastructure_civil_work_cost|onshore_infrastructure_electrical_work_cost
0
1
5
1
0
TableData
detailed_obos_development
3
5
Development
 
Wind OBOS
1119
pre_feed_study_cost|feed_study_cost|state_leasing_and_permitting_cost|outer_continental_shelf_lease_cost|site_assessment_plan_cost|construction_operations_plan_cost|nepa_environmental_impact_statement_met_tower_cost|physical_resource_study_met_tower_cost|biological_resource_study_met_tower_cost|socioeconomic_and_land_use_study_met_tower_cost|navigation_and_transport_study_met_tower_cost|nepa_environmental_impact_study_project_cost|physical_resource_study_project_cost|biological_resource_study_porject_cost|socioeconomic_and_land_use_study_project_cost|navigation_and_transport_study_project_cost|coastal_zone_management_act_compliance_cost|rivers_harbors_act_section_10_compliance_cost|clean_water_act_section_402_compliance_cost|clean_water_act_section_404_compliance_cost|federal_aviation_administration_plans_mitigation_cost|endangered_species_act_compliance_cost|marine_mammal_protection_act_compliance_cost|migratory_bird_treaty_compliance_cost|national_historic_preservation_act_compliance_cost|additional_state_and_local_permitting_cost|mmet_tower_fabrication_install_cost|decommissioning_cost_discount_rate
0
1
5
1
0
TableData
detailed_obos_electrical
3
5
Electrical infrastructure
 
Wind OBOS
571
power_transfer_efficiency_factor|cable_burial_depth_factor|catenary_cable_length_factor|excess_cable_factor|offshore_substation_fabrication_cost|offshore_substation_design_cost|offshore_substation_land_based_assembly_factor|offshore_substation_jacket_lattice_cost_rate|offshore_substation_jacket_pile_cost_rate|dynamic_cable_cost_premium_factor|shunt_reactor_cost_rate|high_voltage_switchgear_cost|medium_voltage_switchgear_cost|back_up_diesel_generator_cost|offshore_substation_workspace_accommodations_cost|other_ancillary_systems_costs|main_power_transformer_cost_rate
0
1
5
1
0
TableData
detailed_obos_general
3
5
General
 
Wind OBOS
132
project_economic_life_years|inspection_clearance_meters|plant_commissioning_cost_factor|estimated_engineering_management_cost_factor
0
1
5
1
0
TableData
detailed_obos_port
3
5
Port & Staging
 
Wind OBOS
309
number_of_600_tonne_crawler_cranes|number_of_1000_tonne_crawler_cranes|day_rate_600_tonne_crawler_crane|day_rate_1000_tonne_crawler_crane|port_crane_mobilization_demobilization_cost|port_entrance_and_exit_cost_rate|quayside_docking_cost_rate|wharf_loading_and_unloading_cost_rate|laydown_and_storage_cost_rate
0
1
5
1
0
TableData
detailed_obos_substructure
3
5
Substructure & foundation
 
Wind OBOS
638
monopile_cost_rate|monopile_transition_piece_cost_rate|monopile_diameter|monopile_length|monopile_embedment_length|jacket_main_lattice_cost_rate|jacket_transition_piece_cost_rate|jacket_pile_cost_rate|jacket_main_lattice_footprint_area|jacket_pile_length|jacket_pile_diameter|spar_stiffened_column_cost_rate|spar_tapered_column_cost_rate|floating_ballast_cost_rate|fixed_mooring_length_for_drag_embedment_anchors|semisubmersible_stiffened_column_cost_rate|semisubmersible_truss_cost_rate|semisubmersible_heave_plate_cost_rate|secondary_outfitting_steel_cost_rate|mooring_line_diameter|mooring_line_cost_rate|scour_protection_material_cost
0
1
5
1
0
TableData
distAtoS
3
1
Distance from inshore assembly area to site
km
Wind OBOS
0
0
1
1
1
1
90
Default
distInterCon
3
1
Distance over land to grid interconnect
mi
Wind OBOS
0
0
1
1
1
1
3
Default
distPort
3
1
Distance from installation port to site
km
Wind OBOS
0
0
1
1
1
1
90
Default
distPtoA
3
1
Distance from installation port to inshore assembly area
km
Wind OBOS
0
0
1
1
1
1
90
Default
distShore
3
1
Distance to landfall
km
Wind OBOS
0
0
1
1
1
1
90
Default
elecCont
3
1
Electrical install weather contingency
%
Wind OBOS
0
0
1
1
1
1
0.3
Default
installStrategy
3
1
Installation vessel strategy
 
Wind OBOS
0
0
1
1
1
1
0
Default
interConVolt
3
1
Grid interconnect voltage
kV
Wind OBOS
0
0
1
1
1
1
345
Default
moorLines
3
1
Number of mooring lines
 
Wind OBOS
0
0
1
1
1
1
3
Default
number_install_seasons
3
1
Number of installation seasons
 
Wind OBOS
0
0
1
1
1
1
1
Default
obos_warning
3
4
 
 
Wind OBOS
0
5
1
4
0
Label
scrapVal
3
1
Total scrap value of decommissioned components
$
Wind OBOS
0
0
1
1
1
1
0
Default
substructCont
3
1
Substructure install weather contingency
%
Wind OBOS
0
0
1
1
1
1
0.3
Default
substructure
3
1
Substructure type
 
Wind OBOS
0
0
1
1
1
1
0
Default
total_obos_cost
3
1
Total Offshore Balance of System Cost
 
Wind OBOS
0
8
1
1
1
1
0
Default
total_obos_cost_per_kw
3
1
Total Offshore Balance of System Cost per kW
$/kW
Wind OBOS
0
8
1
1
1
1
0
Default
towerInstallMethod
3
1
Tower installation method
 
Wind OBOS
0
0
1
1
1
1
0
Default
turbCont
3
1
Turbine install weather contingency
%
Wind OBOS
0
0
1
1
1
1
0.3
Default
turbInstallMethod
3
1
Turbine installation method
 
Wind OBOS
0
0
1
1
1
1
0
Default
waterD
3
1
Maximum water depth
m
Wind OBOS
0
0
1
1
1
1
30
Default

18117

equations{ 'total_obos_cost_per_kw' } = define() {
	return ${total_obos_cost} / ${system_capacity};
};

equations{ '$MIMO$ OBOS calculations' } = define() {
	${obos_warning} = '';
	if (${wind_farm_num_turbines} < 2)
	{
		${obos_warning} = 'Offshore BOS model requires a minimum of 2 turbines.';
		${total_obos_cost} = 0;
	//	return;
	}
	if (${wind_farm_num_turbines} > 200)
	{
		${obos_warning} = 'Offshore BOS model maximum number of turbines is 200.';
		${total_obos_cost} = 0;
	//	return;
	}	
	if (${wind_turbine_kw_rating} < 1000) //min 1 MW turbine
	{
		${obos_warning} = 'Offshore BOS model requires a minimum turbine size of 1 MW.';
		${total_obos_cost} = 0;
	//	return;
	}	
	if (${wind_turbine_kw_rating} > 15000) //max 10 MW turbine
	{
		${obos_warning} = 'Offshore BOS model maximum turbine size is 15 MW.';
		${total_obos_cost} = 0;
	//	return;
	}

 //   if (${obos_warning} == '')
 //   {
	obj = ssc_create();
	
	//from turbine design page
	ssc_var(obj, 'nTurb', ${wind_farm_num_turbines});
	ssc_var(obj, 'turbR', ${wind_turbine_kw_rating} / 1000); //in MW
	ssc_var(obj, 'rotorD', ${wind_turbine_rotor_diameter});
	ssc_var(obj, 'hubH', ${wind_turbine_hub_ht});
	//from wind farm design page
	//THESE AREN'T VALID if laid out from a file... then what????????????????
	ssc_var(obj, 'arrayY', ${windfarm.farm.turbine_spacing}); //units are in rotor diameters
	ssc_var(obj, 'arrayX', ${windfarm.farm.row_spacing}); //units are in rotor diameters
	//from other costs page
	turb_cost_per_kw = ${turbine_cost_total} / ${system_capacity};
	ssc_var(obj, 'turbCapEx', turb_cost_per_kw);
	//OBOS inputs
	ssc_var(obj, 'waterD', ${waterD});
	ssc_var(obj, 'distShore', ${distShore});
	ssc_var(obj, 'distPort', ${distPort});
	ssc_var(obj, 'distPtoA', ${distPtoA});
	ssc_var(obj, 'distAtoS', ${distAtoS});
	ssc_var(obj, 'substructure', ${substructure});
	ssc_var(obj, 'anchor', ${anchor});
	ssc_var(obj, 'turbInstallMethod', ${turbInstallMethod});
	ssc_var(obj, 'towerInstallMethod', ${towerInstallMethod});
	ssc_var(obj, 'installStrategy', ${installStrategy});
	ssc_var(obj, 'cableOptimizer', ${cableOptimizer});
	ssc_var(obj, 'moorLines', ${moorLines});
	ssc_var(obj, 'buryDepth', ${buryDepth});
	ssc_var(obj, 'substructCont', ${substructCont});
	ssc_var(obj, 'turbCont', ${turbCont});
	ssc_var(obj, 'elecCont', ${elecCont});
	ssc_var(obj, 'interConVolt', ${interConVolt});
	ssc_var(obj, 'distInterCon', ${distInterCon});
	ssc_var(obj, 'scrapVal', ${scrapVal});
	ssc_var(obj, 'number_install_seasons', ${number_install_seasons});
	
	//Detailed general inputs, engineering & management input
	general = ${detailed_obos_general};
	ssc_var(obj, 'projLife', general.project_economic_life_years);
	ssc_var(obj, 'inspectClear', general.inspection_clearance_meters);
	ssc_var(obj, 'plantComm', general.plant_commissioning_cost_factor);
	ssc_var(obj, 'procurement_contingency', general.procurement_contingency);
	ssc_var(obj, 'install_contingency', general.install_contingency);
	ssc_var(obj, 'construction_insurance', general.insurance_during_construction);
	ssc_var(obj, 'capital_cost_year_0', general.capital_cost_year_0);
	ssc_var(obj, 'capital_cost_year_1', general.capital_cost_year_1);
	ssc_var(obj, 'capital_cost_year_2', general.capital_cost_year_2);
	ssc_var(obj, 'capital_cost_year_3', general.capital_cost_year_3);
	ssc_var(obj, 'capital_cost_year_4', general.capital_cost_year_4);
	ssc_var(obj, 'capital_cost_year_5', general.capital_cost_year_5);
	ssc_var(obj, 'tax_rate', general.tax_rate);
	ssc_var(obj, 'interest_during_construction', general.interest_during_construction);
	ssc_var(obj, 'estEnMFac', general.estimated_engineering_management_cost_factor);
	
	//Substructure & Foundation inputs
	substructure = ${detailed_obos_substructure};
	ssc_var(obj, 'mpileCR', substructure.monopile_cost_rate);
	ssc_var(obj, 'mtransCR', substructure.monopile_transition_piece_cost_rate);
	ssc_var(obj, 'mpileD', substructure.monopile_diameter);
	ssc_var(obj, 'mpileL', substructure.monopile_length);
	ssc_var(obj, 'mpEmbedL', substructure.monopile_embedment_length);
	ssc_var(obj, 'jlatticeCR', substructure.jacket_main_lattice_cost_rate);
	ssc_var(obj, 'jtransCR', substructure.jacket_transition_piece_cost_rate);
	ssc_var(obj, 'jpileCR', substructure.jacket_pile_cost_rate);
	ssc_var(obj, 'jlatticeA', substructure.jacket_main_lattice_footprint_area);
	ssc_var(obj, 'jpileL', substructure.jacket_pile_length);
	ssc_var(obj, 'jpileD', substructure.jacket_pile_diameter);
	ssc_var(obj, 'spStifColCR', substructure.spar_stiffened_column_cost_rate);
	ssc_var(obj, 'spTapColCR', substructure.spar_tapered_column_cost_rate);
	ssc_var(obj, 'ballCR', substructure.floating_ballast_cost_rate);
	ssc_var(obj, 'deaFixLeng', substructure.fixed_mooring_length_for_drag_embedment_anchors);
	ssc_var(obj, 'ssStifColCR', substructure.semisubmersible_stiffened_column_cost_rate);
	ssc_var(obj, 'ssTrussCR', substructure.semisubmersible_truss_cost_rate);
	ssc_var(obj, 'ssHeaveCR', substructure.semisubmersible_heave_plate_cost_rate);
	ssc_var(obj, 'sSteelCR', substructure.secondary_outfitting_steel_cost_rate);
	ssc_var(obj, 'moorDia', substructure.mooring_line_diameter);
	ssc_var(obj, 'moorCR', substructure.mooring_line_cost_rate);
	ssc_var(obj, 'scourMat', substructure.scour_protection_material_cost);
	//Electrical inputs
	electrical = ${detailed_obos_electrical};
	ssc_var(obj, 'pwrFac', electrical.power_transfer_efficiency_factor);
	ssc_var(obj, 'buryFac', electrical.cable_burial_depth_factor);
	ssc_var(obj, 'catLengFac', electrical.catenary_cable_length_factor);
	ssc_var(obj, 'exCabFac', electrical.excess_cable_factor);
	ssc_var(obj, 'subsTopFab', electrical.offshore_substation_fabrication_cost);
	ssc_var(obj, 'subsTopDes', electrical.offshore_substation_design_cost);
	ssc_var(obj, 'topAssemblyFac', electrical.offshore_substation_land_based_assembly_factor);
	ssc_var(obj, 'subsJackCR', electrical.offshore_substation_jacket_lattice_cost_rate);
	ssc_var(obj, 'subsPileCR', electrical.offshore_substation_jacket_pile_cost_rate);
	ssc_var(obj, 'dynCabFac', electrical.dynamic_cable_cost_premium_factor);
	ssc_var(obj, 'shuntCR', electrical.shunt_reactor_cost_rate);
	ssc_var(obj, 'highVoltSG', electrical.high_voltage_switchgear_cost);
	ssc_var(obj, 'medVoltSG', electrical.medium_voltage_switchgear_cost);
	ssc_var(obj, 'backUpGen', electrical.back_up_diesel_generator_cost);
	ssc_var(obj, 'workSpace', electrical.offshore_substation_workspace_accommodations_cost);
	ssc_var(obj, 'otherAncillary', electrical.other_ancillary_systems_costs);
	ssc_var(obj, 'mptCR', electrical.main_power_transformer_cost_rate);
	ssc_var(obj, 'arrVoltage',electrical.array_cable_voltage);
	ssc_var(obj, 'cab1CR',electrical.array_cable_1_Cost_Rate);
	ssc_var(obj, 'cab2CR',electrical.array_cable_2_Cost_Rate);
	ssc_var(obj, 'cab1CurrRating',electrical.array_cable_1_current_rating);
	ssc_var(obj, 'cab2CurrRating',electrical.array_cable_2_current_rating);
	ssc_var(obj, 'arrCab1Mass',electrical.array_cable_1_mass);
	ssc_var(obj, 'arrCab2Mass',electrical.array_cable_2_mass);
	ssc_var(obj, 'cab1TurbInterCR',electrical.cable_1_turbine_interface_cost);
	ssc_var(obj, 'cab2TurbInterCR',electrical.cable_2_turbine_interface_cost);
	ssc_var(obj, 'cab2SubsInterCR',electrical.cable_2_substation_interface_cost);
	ssc_var(obj, 'expVoltage',electrical.export_cable_voltage);
	ssc_var(obj, 'expCurrRating',electrical.export_cable_current_rating);
	ssc_var(obj, 'expCabMass',electrical.export_cable_mass);
	ssc_var(obj, 'expCabCR',electrical.export_cable_cost_rate);
	ssc_var(obj, 'expSubsInterCR', electrical.export_cable_substation_interface_cost);
	//Assembly & Installation inputs
	assembly = ${detailed_obos_assembly};
	ssc_var(obj, 'moorTimeFac', assembly.anchor_mooring_water_depth_time_factor);
	ssc_var(obj, 'moorLoadout', assembly.anchor_mooring_loadout_time);
	ssc_var(obj, 'moorSurvey', assembly.survey_mooring_lines_anchor_positions_time);
	ssc_var(obj, 'prepAA', assembly.prepare_inshore_assembly_area_for_turbine_installation);
	ssc_var(obj, 'prepSpar', assembly.prepare_spar_for_tow_to_inshore_assembly_area);
	ssc_var(obj, 'upendSpar', assembly.upend_and_ballast_spar);
	ssc_var(obj, 'prepSemi', assembly.prepare_semi_submersible_for_turbine_installation);
	ssc_var(obj, 'turbFasten', assembly.prepare_and_fasten_turbine_for_transport);
	ssc_var(obj, 'boltTower', assembly.lift_and_bolt_tower_section);
	ssc_var(obj, 'boltNacelle1', assembly.lift_and_bolt_nacelle_individual_components_method);
	ssc_var(obj, 'boltNacelle2', assembly.lift_and_bolt_nacelle_bunny_ears_method);
	ssc_var(obj, 'boltNacelle3', assembly.lift_and_bolt_nacelle_fully_assembled_rotor_method);
	ssc_var(obj, 'boltBlade1', assembly.lift_and_bolt_blade_individual_components_method);
	ssc_var(obj, 'boltBlade2', assembly.lift_and_bolt_blade_bunny_ears_method);
	ssc_var(obj, 'boltRotor', assembly.lift_and_bolt_rotor_fully_assembled_rotor_method);
	ssc_var(obj, 'vesselPosTurb', assembly.vessel_positioning_time_turbine_installation);
	ssc_var(obj, 'vesselPosJack', assembly.vessel_positioning_time_jacket_installation);
	ssc_var(obj, 'vesselPosMono', assembly.vessel_positioning_time_monopile_installation);
	ssc_var(obj, 'subsVessPos', assembly.vessel_positioning_time_offshore_substation_installation);
	ssc_var(obj, 'monoFasten', assembly.prepare_and_fasten_monopile_for_transport);
	ssc_var(obj, 'jackFasten', assembly.prepare_and_fasten_jacket_for_transport);
	ssc_var(obj, 'prepGripperMono', assembly.prepare_monopile_gripper_and_upender);
	ssc_var(obj, 'prepGripperJack', assembly.prepare_jacket_gripper_and_upender);
	ssc_var(obj, 'placePiles', assembly.place_jacket_piles);
	ssc_var(obj, 'prepHamMono', assembly.prepare_hammer_for_monopile_installation);
	ssc_var(obj, 'prepHamJack', assembly.prepare_hammer_for_jacket_piles_installation);
	ssc_var(obj, 'removeHamMono', assembly.remove_hammer_for_monopile_installation);
	ssc_var(obj, 'removeHamJack', assembly.remove_hammer_for_jacket_piles_installation);
	ssc_var(obj, 'placeTemplate', assembly.place_jacket_pile_template_on_seabed);
	ssc_var(obj, 'placeJack', assembly.place_jacket_main_lattice_onto_piles);
	ssc_var(obj, 'levJack', assembly.level_jacket_main_lattice);
	ssc_var(obj, 'hamRate', assembly.pile_hammer_rate);
	ssc_var(obj, 'placeMP', assembly.lift_and_place_monopile_for_hammering);
	ssc_var(obj, 'instScour', assembly.install_scour_protection_around_monopile_base);
	ssc_var(obj, 'placeTP', assembly.place_transition_piece_onto_monopile);
	ssc_var(obj, 'groutTP', assembly.grout_transition_piece_monopile_interface);
	ssc_var(obj, 'tpCover', assembly.install_transition_piece_cover);
	ssc_var(obj, 'prepTow', assembly.prepare_floating_substructure_for_tow_to_site);
	ssc_var(obj, 'spMoorCon', assembly.connect_mooring_lines_to_spar);
	ssc_var(obj, 'ssMoorCon', assembly.connect_mooring_lines_to_semi_submersible);
	ssc_var(obj, 'spMoorCheck', assembly.survey_spar_mooring_lines_and_connections);
	ssc_var(obj, 'ssMoorCheck', assembly.survey_semi_submersible_mooing_lines_and_connections);
	ssc_var(obj, 'ssBall', assembly.ballast_semi_submersible);
	ssc_var(obj, 'surfLayRate', assembly.cable_surface_lay_rate);
	ssc_var(obj, 'cabPullIn', assembly.array_cable_pull_in_to_interfaces);
	ssc_var(obj, 'cabTerm', assembly.cable_termination_and_testing);
	ssc_var(obj, 'cabLoadout', assembly.array_cable_loadout_for_installation);
	ssc_var(obj, 'buryRate', assembly.cable_burial_rate);
	ssc_var(obj, 'subsPullIn', assembly.cable_pull_in_to_offshore_substation);
	ssc_var(obj, 'shorePullIn', assembly.cable_pull_in_to_onshore_infrastructure);
	ssc_var(obj, 'landConstruct', assembly.onshore_infrastructure_construction);
	ssc_var(obj, 'expCabLoad', assembly.export_cable_loadout_for_installation);
	ssc_var(obj, 'subsLoad', assembly.offshore_substation_loadout_for_installation);
	ssc_var(obj, 'placeTop', assembly.lift_and_place_offshore_substation_topside);
//	ssc_var(obj, 'nfeederbarge', assembly.number_of_feeder_barges);
	ssc_var(obj, 'pileSpreadDR', assembly.piling_spread_day_rate);
	ssc_var(obj, 'pileSpreadMob', assembly.piling_spread_mobilization_cost);
	ssc_var(obj, 'groutSpreadDR', assembly.grouting_spread_day_rate);
	ssc_var(obj, 'groutSpreadMob', assembly.grouting_spread_mobilization_cost);
	ssc_var(obj, 'seaSpreaddr', assembly.suction_pile_anchor_spread_day_rate);
	ssc_var(obj, 'seaSpreadMob', assembly.suction_pile_anchor_spread_mobilization_cost);
	ssc_var(obj, 'compRacks', assembly.component_racks_cost);
	ssc_var(obj, 'cabSurveyCR', assembly.cable_route_survey_cost);
	ssc_var(obj, 'cabDrillDist', assembly.horizontal_drilling_distance_for_cable_landfall);
	ssc_var(obj, 'cabDrillCR', assembly.cost_rate_for_horizontal_drilling);
	ssc_var(obj, 'mpvRentalDR', assembly.mpv_rental_day_rate);
	ssc_var(obj, 'diveTeamDR', assembly.cable_landfall_dive_team_day_rate);
	ssc_var(obj, 'winchDR', assembly.cable_landfall_winch_day_rate);
	ssc_var(obj, 'civilWork', assembly.onshore_infrastructure_civil_work_cost);
	ssc_var(obj, 'elecWork', assembly.onshore_infrastructure_electrical_work_cost);
	//Port and Staging detailed inputs
	port = ${detailed_obos_port};
	ssc_var(obj, 'nCrane600', port.number_of_600_tonne_crawler_cranes);
	ssc_var(obj, 'nCrane1000', port.number_of_1000_tonne_crawler_cranes);
	ssc_var(obj, 'crane600DR', port.day_rate_600_tonne_crawler_crane);
	ssc_var(obj, 'crane1000DR', port.day_rate_1000_tonne_crawler_crane);
	ssc_var(obj, 'craneMobDemob', port.port_crane_mobilization_demobilization_cost);
	ssc_var(obj, 'entranceExitRate', port.port_entrance_and_exit_cost_rate);
	ssc_var(obj, 'dockRate', port.quayside_docking_cost_rate);
	ssc_var(obj, 'wharfRate', port.wharf_loading_and_unloading_cost_rate);
	ssc_var(obj, 'laydownCR', port.laydown_and_storage_cost_rate);
	//Development inputs
	dev = ${detailed_obos_development};
	ssc_var(obj, 'preFEEDStudy', dev.pre_feed_study_cost);
	ssc_var(obj, 'feedStudy', dev.feed_study_cost);
	ssc_var(obj, 'stateLease', dev.state_leasing_and_permitting_cost);
	ssc_var(obj, 'outConShelfLease', dev.outer_continental_shelf_lease_cost);
	ssc_var(obj, 'saPlan', dev.site_assessment_plan_cost);
	ssc_var(obj, 'conOpPlan', dev.construction_operations_plan_cost);
	ssc_var(obj, 'nepaEisMet', dev.nepa_environmental_impact_statement_met_tower_cost);
	ssc_var(obj, 'physResStudyMet', dev.physical_resource_study_met_tower_cost);
	ssc_var(obj, 'bioResStudyMet', dev.biological_resource_study_met_tower_cost);
	ssc_var(obj, 'socEconStudyMet', dev.socioeconomic_and_land_use_study_met_tower_cost);
	ssc_var(obj, 'navStudyMet', dev.navigation_and_transport_study_met_tower_cost);
	ssc_var(obj, 'nepaEisProj', dev.nepa_environmental_impact_study_project_cost);
	ssc_var(obj, 'physResStudyProj', dev.physical_resource_study_project_cost);
	ssc_var(obj, 'bioResStudyProj', dev.biological_resource_study_project_cost);
	ssc_var(obj, 'socEconStudyProj', dev.socioeconomic_and_land_use_study_project_cost);
	ssc_var(obj, 'navStudyProj', dev.navigation_and_transport_study_project_cost);
	ssc_var(obj, 'coastZoneManAct', dev.coastal_zone_management_act_compliance_cost);
	ssc_var(obj, 'rivsnHarbsAct', dev.rivers_harbors_act_section_10_compliance_cost);
	ssc_var(obj, 'cleanWatAct402', dev.clean_water_act_section_402_compliance_cost);
	ssc_var(obj, 'cleanWatAct404', dev.clean_water_act_section_404_compliance_cost);
	ssc_var(obj, 'faaPlan', dev.federal_aviation_administration_plans_mitigation_cost);
	ssc_var(obj, 'endSpecAct', dev.endangered_species_act_compliance_cost);
	ssc_var(obj, 'marMamProtAct', dev.marine_mammal_protection_act_compliance_cost);
	ssc_var(obj, 'migBirdAct', dev.migratory_bird_treaty_compliance_cost);
	ssc_var(obj, 'natHisPresAct', dev.national_historic_preservation_act_compliance_cost);
	ssc_var(obj, 'addLocPerm', dev.additional_state_and_local_permitting_cost);
	ssc_var(obj, 'metTowCR', dev.met_tower_fabrication_install_cost);
	ssc_var(obj, 'decomDiscRate', dev.decommissioning_cost_discount_rate);

	//run the model
	success = ssc_exec( obj, 'wind_obos' );
	if (success !=0)
	{
		${obos_warning} = 'Offshore BOS cost model failed with error: ' + success;
		${total_obos_cost} = 0;
//		return true;
	}
	else
		${total_obos_cost} = ssc_var(obj, 'total_bos_cost');	
	ssc_free( obj );
	
/*	
	//Debugging Messages
	msgbox(
	'nTurb' + ${wind_farm_num_turbines} + '\n' + 
	'turbR' + ${wind_turbine_kw_rating} / 1000 + '\n' +  
	'hubH' + ${wind_turbine_hub_ht} + '\n' + 
	'arrayY' + ${windfarm.farm.turbine_spacing} + '\n' +  
	'arrayX' + ${windfarm.farm.row_spacing} + '\n' +  
	'turbCapEx' + turb_cost_per_kw 
	);
		
	msgbox(	
	 'waterD' + ${waterD} + '\n' +
	 'distShore' + ${distShore} + '\n' +
	 'distPort' + ${distPort} + '\n' +
	 'distPtoA' + ${distPtoA} + '\n' +
	 'distAtoS' + ${distAtoS} + '\n' +
	 'substructure' + ${substructure} + '\n' +
	 'anchor' + ${anchor} + '\n' +
	 'turbInstallMethod' + ${turbInstallMethod} + '\n' +
	 'towerInstallMethod' + ${towerInstallMethod} + '\n' +
	 'installStrategy' + ${installStrategy} + '\n' +
	 'cableOptimizer' + ${cableOptimizer} + '\n' +
	 'moorLines' + ${moorLines} + '\n' +
	 'buryDepth' + ${buryDepth} + '\n' +
	 'substructCont' + ${substructCont} + '\n' +
	 'turbCont' + ${turbCont} + '\n' +
	 'elecCont' + ${elecCont} + '\n' +
	 'interConVolt' + ${interConVolt} + '\n' +
	 'distInterCon' + ${distInterCon} + '\n' +
	 'scrapVal' + ${scrapVal} + '\n' +
	 'number_install_seasons' + ${number_install_seasons}
	 );

	
	farm = ssc_var(obj, 'nTurb') * ssc_var(obj, 'turbR') * 1000;
	msgbox(farm + '\n' + 
	ssc_var(obj, 'totDevCost')/farm  + '\n' + 
	ssc_var(obj, 'totEnMCost')/farm  + '\n' + 
	ssc_var(obj, 'totPnSCost')/farm  + '\n' + 
	ssc_var(obj, 'subTotCost')/farm  + '\n' + 
	ssc_var(obj, 'totElecCost')/farm  + '\n' + 
	ssc_var(obj, 'totAnICost')/farm  + '\n' + 
	ssc_var(obj, 'commissioning')/farm + '\n' + 
	ssc_var(obj, 'subTotCost')/farm + '\n' + 
	ssc_var(obj, 'soft_costs')/farm + '\n' + 
	ssc_var(obj, 'totalBOScost') + '\n' + 
	ssc_var(obj, 'totalBOScost')/farm); 
*/	
	
//	${total_obos_cost} = ssc_var(obj, 'totalBOScost');	
//	${total_obos_cost} = ssc_var(obj, 'total_bos_cost');	
//	ssc_free( obj );
//	return true;
//	}
};
1807
on_change{"btn_obos_apply"} = define()
{
	install_type = value('install_type');
	if (install_type == 0)
	{
		msgbox('This Balance of System cost model is only meant to be applied to offshore installations.');
		return;
	}
	if ( ${obos_warning} != '')
	{	
		msgbox('Please fix any errors before proceeding: ' + ${obos_warning});
		return;
	}
	if (financing() == 'Residential' ||
		financing() == 'Commercial')
	{
		msgbox('This Balance of System cost model is only meant to be applied to utility installations.');
		return;
	}
	value('bos_cost_fixed', 0);
	value('bos_cost_per_kw', value('total_obos_cost_per_kw'));
	value('bos_cost_per_turbine', 0);
	value('sales_tax_basis', 0);
	msgbox('The total cost estimate of $' + value('total_obos_cost_per_kw') +
		' was applied to the Balance of System cost per kW input. ' +
		'The Balance of System fixed cost and cost per turbine inputs were zeroed.');
	//account for the fact that construction financing is included in this model
	construction_financing = false;
	if (value('const_per_percent1') > 0 || value('const_per_percent2') > 0 || 
		value('const_per_percent3') > 0 || value('const_per_percent4') > 0 || 
		value('const_per_percent5') > 0 )
	{
		overwrite = yesno('The calculated Offshore BOS cost includes the cost of construction financing.' + 
		' Would you like to change the construction financing inputs on the Financial Parameters page to zero now?');
		if (overwrite)
		{
			value('const_per_percent1', 0);
			value('const_per_percent2', 0);
			value('const_per_percent3', 0);
			value('const_per_percent4', 0);
			value('const_per_percent5', 0);
		}
		else
			msgbox('Using both the Offshore BOS model and the construction financing inputs on the Financial Parameters page is likely double-counting the cost of construction financing.');
	}
};
