Marine Losses
604
827
20
GroupBox

1
8
Name
5
9
GroupBox1
X
3
12
Y
3
681
Width
3
576
Height
3
130
Tool Tip
5
0
Caption
5
12
Total Losses
Bold
2
1
GroupBox

1
8
Name
5
11
GroupBox119
X
3
12
Y
3
279
Width
3
576
Height
3
130
Tool Tip
5
0
Caption
5
19
Transmission Losses
Bold
2
1
GroupBox

1
8
Name
5
11
GroupBox120
X
3
12
Y
3
144
Width
3
576
Height
3
130
Tool Tip
5
0
Caption
5
30
Resource Overprediction Losses
Bold
2
1
GroupBox

1
8
Name
5
11
GroupBox121
X
3
12
Y
3
9
Width
3
576
Height
3
130
Tool Tip
5
0
Caption
5
20
Array Spacing Losses
Bold
2
1
GroupBox

1
8
Name
5
10
GroupBox14
X
3
12
Y
3
546
Width
3
576
Height
3
130
Tool Tip
5
0
Caption
5
17
Additional Losses
Bold
2
1
GroupBox

1
8
Name
5
14
downtime_group
X
3
12
Y
3
417
Width
3
576
Height
3
130
Tool Tip
5
0
Caption
5
28
Array/Device Downtime Losses
Bold
2
1
Numeric

1
17
Name
5
15
loss_additional
X
3
297
Y
3
636
Width
3
90
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
0
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
18
loss_array_spacing
X
3
297
Y
3
102
Width
3
90
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
0
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
13
loss_downtime
X
3
297
Y
3
504
Width
3
90
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
0
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
28
loss_resource_overprediction
X
3
297
Y
3
234
Width
3
90
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
0
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
10
loss_total
X
3
297
Y
3
762
Width
3
90
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
0
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
17
loss_transmission
X
3
297
Y
3
369
Width
3
90
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
0
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Label

1
13
Name
5
9
object 71
X
3
39
Y
3
702
Width
3
539
Height
3
52
Tool Tip
5
0
Caption
5
53
Total loss applied to the annual output of the array.
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Label

1
13
Name
5
10
object 716
X
3
39
Y
3
444
Width
3
539
Height
3
52
Tool Tip
5
0
Caption
5
129
Availability losses which reduce the system output during system outages, operations and maintenance activities, or other events.
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Label

1
13
Name
5
10
object 717
X
3
39
Y
3
306
Width
3
539
Height
3
61
Tool Tip
5
0
Caption
5
185
Related to the efficiency of the electrical infrastructure for the array, such as inter-device cabling, export cabling, substations, and onshore transmission up to grid interconnection.
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Label

1
13
Name
5
10
object 718
X
3
39
Y
3
171
Width
3
539
Height
3
61
Tool Tip
5
0
Caption
5
217
Reduction from resource uncertainty associated with installing the device in waters at a depth or distance outside parameters of resource file (e.g. shallow waters close to shore, large distance from measuring buoy). 
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Label

1
13
Name
5
10
object 722
X
3
39
Y
3
36
Width
3
539
Height
3
52
Tool Tip
5
0
Caption
5
62
Losses associated with interactions of devices due to spacing.
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Label

1
13
Name
5
17
tidal_power_curve
X
3
387
Y
3
774
Width
3
90
Height
3
24
Tool Tip
5
0
Caption
5
0
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
Label

1
13
Name
5
19
tidal_resource_calc
X
3
474
Y
3
774
Width
3
90
Height
3
24
Tool Tip
5
0
Caption
5
0
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
Label

1
13
Name
5
13
wave_add_loss
X
3
39
Y
3
573
Width
3
539
Height
3
52
Tool Tip
5
0
Caption
5
87
Miscellaneous losses which would decrease the power output from the device to the grid.
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1

26
annual_cumulative_energy_distribution
3
2
 
 
 
0
8
1
2
1
1
0
Default
annual_energy
3
1
 
 
 
0
8
1
1
1
1
0
Default
annual_energy_distribution
3
3
 
 
 
0
8
1
3
1
1
0
Default
annual_energy_distribution_tidal
3
2
 
 
 
0
8
1
2
1
1
0
Default
capacity_factor
3
1
 
 
 
0
8
1
1
1
1
0
Default
device_average_power
3
1
 
 
 
0
8
1
1
1
1
0
Default
device_rated_capacity
3
1
 
 
 
0
8
1
1
1
1
0
Default
loss_additional
3
1
Additional losses
%
ME Wave Losses
0
0
1
1
1
1
0
Numeric
loss_array_spacing
3
1
Array spacing
%
ME Wave Losses
0
2
1
1
1
1
0
Numeric
loss_downtime
3
1
Array or device downtime
%
ME Wave Losses
0
2
1
1
1
1
2
Numeric
loss_resource_overprediction
3
1
Resource overprediction
%
ME Wave Losses
0
2
1
1
1
1
0
Numeric
loss_total
3
1
Total losses
%
ME Wave Losses
0
8
1
1
1
1
0
Numeric
loss_transmission
3
1
Transmission losses
%
ME Wave Losses
0
2
1
1
1
1
5
Numeric
tidal_power_end_velocity
3
1
 
 
 
0
8
1
1
1
1
0
Default
tidal_power_start_velocity
3
1
 
 
 
0
8
1
1
1
1
0
Default
tidal_resource_calc
3
3
 
 
 
0
8
1
3
1
1
0
DataMatrix
tidal_resource_end_velocity
3
1
 
 
 
0
8
1
1
1
1
0
Default
tidal_resource_start_velocity
3
1
 
 
 
0
8
1
1
1
1
0
Default
wave_power_end_height
3
1
 
 
 
0
8
1
1
1
1
0
Default
wave_power_end_period
3
1
 
 
 
0
8
1
1
1
1
0
Default
wave_power_start_height
3
1
 
 
 
0
8
1
1
1
1
0
Default
wave_power_start_period
3
1
 
 
 
0
8
1
1
1
1
0
Default
wave_resource_end_height
3
1
 
 
 
0
8
1
1
1
1
0
Default
wave_resource_end_period
3
1
 
 
 
0
8
1
1
1
1
0
Default
wave_resource_start_height
3
1
 
 
 
0
8
1
1
1
1
0
Default
wave_resource_start_period
3
1
 
 
 
0
8
1
1
1
1
0
Default

3416
equations{"loss_total"} = define() {
	return ${loss_array_spacing} 
		+ ${loss_resource_overprediction} 
		+ ${loss_transmission} 
		+ ${loss_downtime} 
		+ ${loss_additional};
};

/*equations{ '$MIMO$ mhk modeled wave performance calculations' } = define() {

	tech = technology();
	obj = ssc_create();
	
	if (tech == 'MEwave') 
	{
		
		
		ssc_var(obj,'wave_resource_matrix', ${wave_resource_matrix});
		ssc_var(obj,'wave_power_matrix', ${wave_power_matrix});
		ssc_var(obj,'number_devices', ${number_devices});
		ssc_var(obj,'system_capacity', ${system_capacity});
		//ssc_var(obj,'devices_per_row', ${devices_per_row});
		ssc_var(obj,'device_rated_power', ${device_rated_power});
	
	
	
		ssc_var(obj,'loss_array_spacing', ${loss_array_spacing});
		ssc_var(obj,'loss_resource_overprediction', ${loss_resource_overprediction});
		ssc_var(obj,'loss_transmission', ${loss_transmission});
		ssc_var(obj,'loss_downtime', ${loss_downtime});
		ssc_var(obj,'loss_additional', ${loss_additional});
	

		success = ssc_exec(obj, 'mhk_wave');
		//msgbox(success);
	
		${device_average_power} = ssc_var( obj, 'device_average_power' );
		${annual_energy} = ssc_var( obj, 'annual_energy' );
		${capacity_factor} = ssc_var( obj, 'capacity_factor' );
		${annual_energy_distribution} = ssc_var( obj, 'annual_energy_distribution' );
		${wave_resource_start_height} = ssc_var( obj, 'wave_resource_start_height');
		${wave_resource_start_period} = ssc_var( obj, 'wave_resource_start_period');
		${wave_resource_end_height} = ssc_var( obj, 'wave_resource_end_height');
		${wave_resource_end_period} = ssc_var( obj, 'wave_resource_end_period');
		${wave_power_start_height} = ssc_var( obj, 'wave_power_start_height');
		${wave_power_start_period} = ssc_var( obj, 'wave_power_start_period');
		${wave_power_end_height} = ssc_var( obj, 'wave_power_end_height');
		${wave_power_end_period} = ssc_var( obj, 'wave_power_end_period');
		
		ssc_free(obj);
	}
	
};*/

/*equations {'$MIMO$ mhk tidal performance calculations'} = define() {
	
	obj = ssc_create();
	tech = technology();
	
	if (tech == "MEtidal") 
	{
		ssc_var(obj,'tidal_power_curve', ${tidal_power_curve});
		ssc_var(obj,'tidal_resource', ${tidal_resource_calc});
		
		ssc_var(obj,'number_devices', ${number_devices});
		
	
		ssc_var(obj,'loss_array_spacing', ${loss_array_spacing});
		ssc_var(obj,'loss_resource_overprediction', ${loss_resource_overprediction});
		ssc_var(obj,'loss_transmission', ${loss_transmission});
		ssc_var(obj,'loss_downtime', ${loss_downtime});
		ssc_var(obj,'loss_additional', ${loss_additional});
		
		success = ssc_exec(obj, 'mhk_tidal');
		//msgbox(success);
		
		${deviced_rated_capacity} = ssc_var(obj, 'device_rated_capacity');
		${device_average_power} = ssc_var( obj, 'device_average_power' );
		${annual_energy} = ssc_var( obj, 'annual_energy' );
		${capacity_factor} = ssc_var( obj, 'capacity_factor' );
		${annual_energy_distribution_tidal} = ssc_var( obj, 'annual_energy_distribution' );
		${annual_cumulative_energy_distribution} = ssc_var( obj, 'annual_cumulative_energy_distribution' );
		${tidal_resource_start_velocity} = ssc_var(obj, 'tidal_resource_start_velocity');
		${tidal_resource_end_velocity} = ssc_var( obj, 'tidal_resource_end_velocity');
		${tidal_power_start_velocity} = ssc_var( obj, 'tidal_power_start_velocity');
		${tidal_power_end_velocity} = ssc_var(obj, 'tidal_power_end_velocity');
		
		
		ssc_free(obj);
	}
};*/


2255
function check_mhk_losses(widget_name)
{
	total_loss = to_real(value("loss_additional"))
	+to_real(value("loss_downtime"))
	+to_real(value("loss_transmission"))
	+to_real(value("loss_resource_overprediction"))
	+to_real(value("loss_array_spacing"));
	x = to_real(value(widget_name));
	if (x < 0.0)
	{ 
		x=0.0;
		msgbox("Loss must be greater to or equal to zero.");
	}
	else if (total_loss > 100.0)
	{
		x = 100.0*x/total_loss;
		if (widget_name != "loss_additional")
		{
			y= to_real(value("loss_additional"));
			y=100.0*y/total_loss;
			value("loss_additional",y, false);
			refresh("loss_additional");
		}
		if (widget_name != "loss_downtime")
		{
			y= to_real(value("loss_downtime"));
			y=100.0*y/total_loss;
			value("loss_downtime",y, false);
			refresh("loss_downtime");
		}
		if (widget_name != "loss_transmission")
		{
			y= to_real(value("loss_transmission"));
			y=100.0*y/total_loss;
			value("loss_transmission",y, false);
			refresh("loss_transmission");
		}
		if (widget_name != "loss_resource_overprediction")
		{
			y= to_real(value("loss_resource_overprediction"));
			y=100.0*y/total_loss;
			value("loss_resource_overprediction",y, false);
			refresh("loss_resource_overprediction");
		}
		if (widget_name != "loss_array_spacing")
		{
			y= to_real(value("loss_array_spacing"));
			y=100.0*y/total_loss;
			value("loss_array_spacing",y, false);
			refresh("loss_array_spacing");
		}
		msgbox("Total loss > 100%, so losses scaled so that total is 100%.");
	}
	value(widget_name, x, false);
	refresh(widget_name);
	total_loss = to_real(value("loss_additional"))
	+to_real(value("loss_downtime"))
	+to_real(value("loss_transmission"))
	+to_real(value("loss_resource_overprediction"))
	+to_real(value("loss_array_spacing"));
	value("loss_total", total_loss,false);
	refresh("loss_total");
}

on_change{'loss_additional'}=define()
{
	check_mhk_losses("loss_additional");
};


on_change{'loss_downtime'}=define()
{
	check_mhk_losses('loss_downtime');
};

on_change{'loss_transmission'}=define()
{
	check_mhk_losses('loss_transmission');
};

on_change{'loss_resource_overprediction'}=define()
{
	check_mhk_losses('loss_resource_overprediction');
};

on_change{'loss_array_spacing'}=define()
{
	check_mhk_losses('loss_array_spacing');
};

