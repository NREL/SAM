Simple Efficiency Module Model
564
1054
43
GroupBox

1
8
Name
5
13
BifacialSpecs
X
3
12
Y
3
333
Width
3
544
Height
3
140
Tool Tip
5
0
Caption
5
23
Bifacial Specifications
Bold
2
1
GroupBox

1
8
Name
5
9
GroupBox1
X
3
12
Y
3
9
Width
3
545
Height
3
323
Tool Tip
5
0
Caption
5
15
Characteristics
Bold
2
1
GroupBox

1
8
Name
5
9
GroupBox2
X
3
9
Y
3
477
Width
3
545
Height
3
341
Tool Tip
5
0
Caption
5
17
Module Efficiency
Bold
2
1
GroupBox

1
8
Name
5
11
GroupBox213
X
3
12
Y
3
936
Width
3
546
Height
3
111
Tool Tip
5
0
Caption
5
16
Save / Load Data
Bold
2
1
Label

1
13
Name
5
6
Label1
X
3
129
Y
3
501
Width
3
113
Height
3
21
Tool Tip
5
0
Caption
5
17
Irradiance (W/m²)
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
Label

1
13
Name
5
6
Label2
X
3
246
Y
3
501
Width
3
98
Height
3
21
Tool Tip
5
0
Caption
5
14
Efficiency (%)
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
Label

1
13
Name
5
6
Label3
X
3
39
Y
3
240
Width
3
500
Height
3
39
Tool Tip
5
0
Caption
5
130
1. Maximum power depends on the reference radiation and efficiency values specified below at a reference cell temperature of 25°C.
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Label

1
13
Name
5
7
Label31
X
3
33
Y
3
705
Width
3
494
Height
3
42
Tool Tip
5
0
Caption
5
96
2. The reference irradiance and efficiency value determines the maximum power value shown above.
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Label

1
13
Name
5
8
Label311
X
3
33
Y
3
747
Width
3
494
Height
3
66
Tool Tip
5
0
Caption
5
167
3. Irradiance values are total plane-of-array irradiance, equal to the sum of the direct normal (beam) and diffuse (scaled by the utilization factor above) components.
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Label

1
13
Name
5
7
Label32
X
3
30
Y
3
675
Width
3
494
Height
3
27
Tool Tip
5
0
Caption
5
49
1. Irradiance levels must increase monotonically.
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Label

1
13
Name
5
7
Label33
X
3
39
Y
3
282
Width
3
500
Height
3
39
Tool Tip
5
0
Caption
5
136
2. The Module Structure - Mounting options are used for temperature correction calculations. See Help for information about the options.
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Label

1
13
Name
5
6
Label4
X
3
360
Y
3
501
Width
3
164
Height
3
21
Tool Tip
5
0
Caption
5
19
Reference Condition
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
Button

1
8
Name
5
14
btnLoadSPEData
X
3
186
Y
3
963
Width
3
153
Height
3
24
Tool Tip
5
0
Caption
5
22
Load data from file...
TabOrder
3
4294967295
Button

1
8
Name
5
14
btnSaveSPEData
X
3
27
Y
3
963
Width
3
153
Height
3
24
Tool Tip
5
0
Caption
5
20
Save data to file...
TabOrder
3
4294967295
Hyperlink

1
9
Name
5
9
object 14
X
3
21
Y
3
900
Width
3
531
Height
3
21
Tool Tip
5
0
Caption
5
55
Performance Model Documentation page on the SAM website
URL
5
32
https://sam.nrel.gov/performance
TabOrder
3
4294967295
GroupBox

1
8
Name
5
8
object 4
X
3
12
Y
3
816
Width
3
546
Height
3
117
Tool Tip
5
0
Caption
5
10
References
Bold
2
1
Label

1
13
Name
5
8
object 7
X
3
21
Y
3
834
Width
3
531
Height
3
63
Tool Tip
5
0
Caption
5
195
For information about the simple efficiency module model inputs, see Help. For details about the model implementation, see Gilman (2015) on the SAM website's Performance Model Documentation page:
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Numeric

1
17
Name
5
5
spe_a
X
3
288
Y
3
198
Width
3
55
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
0
Numeric

1
17
Name
5
8
spe_area
X
3
288
Y
3
87
Width
3
100
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
3
Numeric

1
17
Name
5
5
spe_b
X
3
375
Y
3
198
Width
3
55
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
0
Numeric

1
17
Name
5
36
spe_bifacial_ground_clearance_height
X
3
207
Y
3
426
Width
3
90
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
32
spe_bifacial_transmission_factor
X
3
207
Y
3
378
Width
3
90
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
15
spe_bifaciality
X
3
207
Y
3
402
Width
3
90
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
6
spe_dT
X
3
462
Y
3
198
Width
3
55
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
0
TextEntry

1
11
Name
5
17
spe_data_filename
X
3
18
Y
3
1011
Width
3
537
Height
3
24
Tool Tip
5
0
Text
5
0
Editable
2
0
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
8
spe_eff0
X
3
246
Y
3
522
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
5
Numeric

1
17
Name
5
8
spe_eff1
X
3
246
Y
3
543
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
7
Numeric

1
17
Name
5
8
spe_eff2
X
3
246
Y
3
564
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
9
Numeric

1
17
Name
5
8
spe_eff3
X
3
246
Y
3
585
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
11
Numeric

1
17
Name
5
8
spe_eff4
X
3
246
Y
3
606
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
13
Numeric

1
17
Name
5
6
spe_fd
X
3
246
Y
3
639
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
1
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
0
CheckBox

1
9
Name
5
15
spe_is_bifacial
X
3
78
Y
3
351
Width
3
147
Height
3
24
Tool Tip
5
0
Caption
5
18
Module is bifacial
State
2
0
TabOrder
3
4294967295
Choice

1
9
Name
5
20
spe_module_structure
X
3
288
Y
3
168
Width
3
229
Height
3
24
Tool Tip
5
0
Items
6
6
glass/cell/polymer sheet - open rack
glass/cell/glass - open rack
polymer/thin film/steel - open rack
Insulated back (building-integrated PV)
close roof mount
user-defined
Selection
3
4294967295
TabOrder
3
2
Numeric

1
17
Name
5
9
spe_power
X
3
288
Y
3
33
Width
3
100
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
1
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
14
Numeric

1
17
Name
5
8
spe_rad0
X
3
129
Y
3
522
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
200
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4
Numeric

1
17
Name
5
8
spe_rad1
X
3
129
Y
3
543
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
400
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
6
Numeric

1
17
Name
5
8
spe_rad2
X
3
129
Y
3
564
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
600
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
8
Numeric

1
17
Name
5
8
spe_rad3
X
3
129
Y
3
585
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
800
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
10
Numeric

1
17
Name
5
8
spe_rad4
X
3
129
Y
3
606
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
1000
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
12
RadioChoice

1
11
Name
5
13
spe_reference
X
3
363
Y
3
522
Width
3
38
Height
3
110
Tool Tip
5
0
Selection
3
4
Items
6
5
Ref
Ref
Ref
Ref
Ref
ShowCaptions
2
0
Horizontal
2
0
TabOrder
3
0
Numeric

1
17
Name
5
14
spe_temp_coeff
X
3
288
Y
3
60
Width
3
100
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
1
Numeric

1
17
Name
5
7
spe_vmp
X
3
288
Y
3
114
Width
3
100
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
3
Numeric

1
17
Name
5
7
spe_voc
X
3
288
Y
3
141
Width
3
100
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
3

28
spe_a
3
1
a
 
PV Module (Simple Efficiency)
0
0
1
1
1
1
0
Numeric
spe_area
3
1
Area
m²
PV Module (Simple Efficiency)
0
2
1
1
1
1
0.74074
Numeric
spe_b
3
1
b
 
PV Module (Simple Efficiency)
0
0
1
1
1
1
0
Numeric
spe_bifacial_ground_clearance_height
3
1
Ground clearance height
m
PV Module (Simple Efficiency)
0
2
1
1
1
1
1
Default
spe_bifacial_transmission_factor
3
1
Transmission fraction
[0-1]
PV Module (Simple Efficiency)
0
2
1
1
1
1
0.013
Default
spe_bifaciality
3
1
Bifaciality
[0-1]
PV Module (Simple Efficiency)
0
2
1
1
1
1
0.65
Default
spe_dT
3
1
dT
°C
PV Module (Simple Efficiency)
0
0
1
1
1
1
0
Numeric
spe_data_filename
3
4
 
 
 
0
0
1
4
0
TextEntry
spe_eff0
3
1
Efficiency 0
%
PV Module (Simple Efficiency)
0
3
1
1
1
1
13.5
Numeric
spe_eff1
3
1
Efficiency 1
%
PV Module (Simple Efficiency)
0
3
1
1
1
1
13.5
Numeric
spe_eff2
3
1
Efficiency 2
%
PV Module (Simple Efficiency)
0
3
1
1
1
1
13.5
Numeric
spe_eff3
3
1
Efficiency 3
%
PV Module (Simple Efficiency)
0
3
1
1
1
1
13.5
Numeric
spe_eff4
3
1
Efficiency 4
%
PV Module (Simple Efficiency)
0
3
1
1
1
1
13.5
Numeric
spe_fd
3
1
Diffuse utilization factor
0..1
PV Module (Simple Efficiency)
0
0
1
1
1
1
1
Numeric
spe_is_bifacial
3
1
 
 
PV Module (Simple Efficiency)
0
2
1
1
1
1
0
Default
spe_module_structure
3
1
Module structure and mounting
 
PV Module (Simple Efficiency)
192
Glass/Cell/Polymer Sheet - Open Rack|Glass/Cell/Glass - Open Rack|Polymer/Thin Film/Steel - Open Rack|Glass/Cell/Polymer Sheet - Insulated Back|Glass/Cell/Glass - Close Roof Mount|User Defined
2
1
1
1
1
0
Choice
spe_power
3
1
Maximum power (Pmp)
Wdc
PV Module (Simple Efficiency)
0
8
1
1
1
1
100
Numeric
spe_rad0
3
1
Radiation level 0
W/m²
PV Module (Simple Efficiency)
0
3
1
1
1
1
200
Numeric
spe_rad1
3
1
Radiation level 1
W/m²
PV Module (Simple Efficiency)
0
3
1
1
1
1
400
Numeric
spe_rad2
3
1
Radiation level 2
W/m²
PV Module (Simple Efficiency)
0
3
1
1
1
1
600
Numeric
spe_rad3
3
1
Radiation level 3
W/m²
PV Module (Simple Efficiency)
0
3
1
1
1
1
800
Numeric
spe_rad4
3
1
Radiation level 4
W/m²
PV Module (Simple Efficiency)
0
3
1
1
1
1
1000
Numeric
spe_reference
3
1
Reference Radiation and Efficiency
 
PV Module (Simple Efficiency)
0
1
1
1
1
1
4
RadioChoice
spe_temp_coeff
3
1
Temperature coefficient (Pmp)
%/°C
PV Module (Simple Efficiency)
0
2
1
1
1
1
-0.5
Numeric
spe_transient_thermal_model_unit_mass
3
1
Module unit mass
kg/m^2
PV Module (Simple Efficiency)
0
2
1
1
1
1
0
Default
spe_vmp
3
1
Maximum power voltage (Vmp)
Vdc
PV Module (Simple Efficiency)
0
2
1
1
1
1
30
Numeric
spe_voc
3
1
Open circuit voltage (Voc)
Vdc
PV Module (Simple Efficiency)
0
2
1
1
1
1
36
Numeric
step_spe
3
1
 
 
 
0
8
1
1
1
1
0
Default

293
equations{ 'spe_power' } = define() {
	return ?${spe_reference}
[
	${spe_eff0}/100*${spe_rad0},
	${spe_eff1}/100*${spe_rad1},
	${spe_eff2}/100*${spe_rad2},
	${spe_eff3}/100*${spe_rad3},
	${spe_eff4}/100*${spe_rad4}
] 
	* ${spe_area}; };
	
equations{'step_spe'} = define() {
	return ${step};
};
2301
function toggle_spe_bifacial()
{
	enable('spe_bifaciality', value('spe_is_bifacial'));
	enable('spe_bifacial_transmission_factor', value('spe_is_bifacial'));
	enable('spe_bifacial_ground_clearance_height', value('spe_is_bifacial'));
}
on_load{'Simple Efficiency Module Model'} = define() {
	
	toggle_spe_bifacial();
	
	on_change{'spe_module_structure'} ();
	on_change{'spe_is_bifacial'}();
	//on_change{'step_spe'}();
};

/*on_change{'step_spe'} = define() {
	time_step = value('step_spe');
	enable('spe_transient_thermal_model_unit_mass',time_step <= 1200);
	show('transinet_thermal_model_message', time_step <= 1200);
	refresh();
};*/


on_change{'spe_is_bifacial'} = define() {
	toggle_spe_bifacial();
};

on_change{'spe_module_structure'} = define() {

// 0=glass/cell/polymer sheet - open rack
// 1=glass/cell/glass - open rack
// 2=polymer/thin film/steel - open rack
// 3=Insulated back (building-integrated PV)
// 4=close roof mount
// 5=user-defined

	a =  [ -3.56,  -3.47,   -3.58,  -2.81,   -2.98   ];
	b =  [ -0.075, -0.0594, -0.113, -0.0455, -0.0471 ];
	dT = [ 3,       3,       3,      0,       1      ];

	ms = value('spe_module_structure');	
	if ( ms < 5 )
	{
		value( 'spe_a', a[ms] );
		value( 'spe_b', b[ms] );
		value( 'spe_dT', dT[ms] );
	}
	
	editable = (ms == 5);

	enable( 'spe_a', editable);
	enable( 'spe_b', editable);
	enable( 'spe_dT', editable);
};


on_change{'btnSaveSPEData'} = define() {
	logmsg('running btnSaveSPEData');
	file = choose_file( '', 'Save SPE Module Performance Data As', 
		'Data Files (*.csv)|*.csv', true);
		
	if ( file != '' ) {
		file = replace(file, '\\', '/');
		if (group_write('PV Module (Simple Efficiency)',file))
		{	
			value( 'spe_data_filename', file );
			msgbox("Data saved! \n");
		}
		else
		{
			value( 'spe_data_filename', "" );
			msgbox("Data save failed! \n");
		}
	}
};

on_change{'btnLoadSPEData'} = define() {
	logmsg('running btnLoadSPEData');
	file = choose_file( '', 'Open SPE Module Performance File', 
		'Data Files (*.csv)|*.csv');
		
	if ( file != '' ) {
		file = replace(file, '\\', '/');
		if (group_read('PV Module (Simple Efficiency)',file))
		{	
			value( 'spe_data_filename', file );
			msgbox("Data loaded! \n");
		}
		else
		{
			value( 'spe_data_filename', "" );
			msgbox("Data load failed! \n");
		}
	}
};
