Phys Trough Direct Storage
912
356
23
GroupBox

1
8
Name
5
9
GroupBox1
X
3
6
Y
3
105
Width
3
900
Height
3
241
Tool Tip
5
0
Caption
5
14
Storage System
Bold
2
1
Numeric

1
17
Name
5
5
Q_tes
X
3
279
Y
3
123
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
1
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
23
TES_COPY_T_htf_cold_des
X
3
657
Y
3
63
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
1
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
22
TES_COPY_T_htf_hot_des
X
3
657
Y
3
36
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
1
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
20
TES_COPY_q_pb_design
X
3
279
Y
3
36
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
1
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
16
TES_COPY_tshours
X
3
279
Y
3
63
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
1
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
14
cold_tank_Thtr
X
3
657
Y
3
147
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
18
Numeric

1
17
Name
5
18
cold_tank_max_heat
X
3
657
Y
3
171
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
19
Numeric

1
17
Name
5
21
csp.pt.tes.heater_eff
X
3
657
Y
3
243
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
22
Numeric

1
17
Name
5
22
csp.pt.tes.htf_density
X
3
657
Y
3
267
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
1
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
24
csp.pt.tes.tank_diameter
X
3
279
Y
3
267
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
1
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4
Numeric

1
17
Name
5
6
h_tank
X
3
279
Y
3
171
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
5
Numeric

1
17
Name
5
10
h_tank_min
X
3
279
Y
3
195
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
6
Numeric

1
17
Name
5
13
hot_tank_Thtr
X
3
657
Y
3
195
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
20
Numeric

1
17
Name
5
17
hot_tank_max_heat
X
3
657
Y
3
219
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
21
Numeric

1
17
Name
5
20
init_hot_htf_percent
X
3
657
Y
3
123
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
15
GroupBox

1
8
Name
5
8
object 4
X
3
6
Y
3
12
Width
3
900
Height
3
87
Tool Tip
5
0
Caption
5
24
System Design Parameters
Bold
2
1
Numeric

1
17
Name
5
13
q_dot_tes_est
X
3
279
Y
3
315
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
10
tank_pairs
X
3
279
Y
3
243
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
0
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
7
CheckBox

1
9
Name
5
17
tanks_in_parallel
X
3
732
Y
3
291
Width
3
26
Height
3
24
Tool Tip
5
0
Caption
5
0
State
2
1
TabOrder
3
4294967295
Numeric

1
17
Name
5
13
tes_avail_vol
X
3
279
Y
3
147
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
0
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
6
u_tank
X
3
279
Y
3
291
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
10
Numeric

1
17
Name
5
8
vol_tank
X
3
279
Y
3
219
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
0
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
3

24
Q_tes
3
1
TES thermal capacity
MWt-hr
Thermal Energy Storage
0
8
1
1
1
1
0
Default
TES_COPY_T_htf_cold_des
3
1
Loop inlet HTF temperature
°C
Thermal Energy Storage
0
8
1
1
1
1
0
Default
TES_COPY_T_htf_hot_des
3
1
Loop outlet HTF temperature
°C
Thermal Energy Storage
0
8
1
1
1
1
0
Default
TES_COPY_q_pb_design
3
1
Heat sink power
MWt
Thermal Energy Storage
0
8
1
1
1
1
0
Default
TES_COPY_tshours
3
1
Hours of storage at design point
hours
Thermal Energy Storage
0
8
1
1
1
1
0
Default
cold_tank_Thtr
3
1
Cold tank heater temperature set point
°C
Thermal Energy Storage
0
2
1
1
1
1
280
Default
cold_tank_max_heat
3
1
Cold tank heater capacity
MWe
Thermal Energy Storage
0
2
1
1
1
1
15
Default
csp.pt.tes.heater_eff
3
1
Tank heater efficiency
 
Thermal Energy Storage
0
2
1
1
1
1
0.99
Default
csp.pt.tes.htf_calc_temp
3
1
TC
 
Thermal Energy Storage
0
8
1
1
1
1
0
Default
csp.pt.tes.htf_density
3
1
HTF density
kg/m³
Thermal Energy Storage
0
8
1
1
1
1
0
Default
csp.pt.tes.tank_diameter
3
1
Tank diameter
m
Thermal Energy Storage
0
8
1
1
1
1
20
Default
h_tank
3
1
Tank height
m
Thermal Energy Storage
0
2
1
1
1
1
20.9065
Default
h_tank_min
3
1
Tank fluid minimum height
m
Thermal Energy Storage
0
2
1
1
1
1
1
Default
hot_tank_Thtr
3
1
Hot tank heater temperature set point
°C
Thermal Energy Storage
0
2
1
1
1
1
500
Default
hot_tank_max_heat
3
1
Hot tank heater capacity
MWe
Thermal Energy Storage
0
2
1
1
1
1
30
Default
init_hot_htf_percent
3
1
Initial hot HTF percent
%
Thermal Energy Storage
0
2
1
1
1
1
30
Default
q_dot_tes_est
3
1
Estimated heat loss
MWt
Thermal Energy Storage
0
8
1
1
1
1
0
Default
tank_pairs
3
1
Parallel tank pairs
 
Thermal Energy Storage
0
2
1
1
1
1
1
Default
tanks_in_parallel
3
1
Field HTF can bypass TES to cycle
 
Thermal Energy Storage
0
2
1
1
1
1
1
Default
tc_fill
3
1
Filler material
 
Thermal Energy Storage
0
8
1
1
1
1
8
Default
tes_avail_vol
3
1
Available HTF volume
m³
Thermal Energy Storage
0
8
1
1
1
1
0
Default
tes_type
3
1
Storage type
 
Thermal Energy Storage
0
8
1
1
1
1
1
Default
u_tank
3
1
Wetted loss coefficient
Wt/m²-K
Thermal Energy Storage
0
2
1
1
1
1
1.2
Default
vol_tank
3
1
Storage tank volume
m³
Thermal Energy Storage
0
8
1
1
1
1
0
Numeric

2058
//
//  ONLY ADD UI INDICATOR, COMBO CONVERTERS, AND
//  INPUT AGGREGATOR EQUATIONS BELOW!
//
//   If the equations change an input value
//   modify the below main MIMO or add one,
//   referencing in ssc_equations.h
//

// Just UI indicator
equations{ 'TES_COPY_q_pb_design' } = define(){
	return ${q_pb_design}; };

// Just UI indicator
equations{ 'TES_COPY_tshours' } = define(){
	return ${tshours}; };

// Just UI indicator
equations{ 'TES_COPY_T_htf_hot_des' } = define(){
	return ${T_loop_out}; };

// Just UI indicator
equations{ 'TES_COPY_T_htf_cold_des' } = define(){
	return ${T_loop_in_des}; };

// Outputs just UI indicators
equations{ '$MIMO$ ui_tes_calcs' } = define()
{
	obj = ssc_create();

	ssc_var(obj, "P_ref", ${q_pb_design});				//[MWe]
	ssc_var(obj, "design_eff", 1.0);					//[-]
	ssc_var(obj, "tshours", ${tshours});				//[hrs]
	ssc_var(obj, "T_htf_hot_des", ${T_loop_out});		//[C]
	ssc_var(obj, "T_htf_cold_des", ${T_loop_in_des});	//[C]
	ssc_var(obj, "rec_htf", ${Fluid});					//[-]
	ssc_var(obj, "field_fl_props", ${field_fl_props});	//[-]
	ssc_var(obj, "h_tank_min", ${h_tank_min});			//[m]
	ssc_var(obj, "h_tank", ${h_tank});					//[m]
	ssc_var(obj, "tank_pairs", ${tank_pairs});			//[-]
	ssc_var(obj, "u_tank", ${u_tank});					//[-]

	ret = ssc_exec(obj, 'ui_tes_calcs');
	
	if(ret==0) {
		q_tes_des = ssc_var(obj, "q_tes");					//[MWt-hr]
		vol_one_temp_avail = ssc_var(obj, "tes_avail_vol");	//[m^3]
		vol_one_temp_total = ssc_var(obj, "vol_tank");		//[m^3]
		d_tank = ssc_var(obj, "csp_pt_tes_tank_diameter");	//[m]
		q_dot_loss = ssc_var(obj, "q_dot_tes_est");			//[MWt]
		dens = ssc_var(obj, "csp_pt_tes_htf_density");		//[kg/m^3]
	}
	else {
		q_tes_des = 1.0/0.0;
		vol_one_temp_avail = 1.0/0.0;
		vol_one_temp_total = 1.0/0.0;
		d_tank = 1.0/0.0;
		q_dot_loss = 1.0/0.0;
		dens = 1.0/0.0;
	}
	
	${Q_tes} = q_tes_des;
	${tes_avail_vol} = vol_one_temp_avail;
	${vol_tank} = vol_one_temp_total;
	${csp.pt.tes.tank_diameter} = d_tank;
	${q_dot_tes_est} = q_dot_loss;
	${csp.pt.tes.htf_density} = dens;
	
	ssc_free( obj );	
};

832
on_load{"Phys Trough Direct Storage"} = define() {
	// Nothing here yet, but keep as placeholder
	return;
};

function hx_derate_update_module() {
	// Taken from Physical Trough Thermal Storage
	// Need this for Physical Trough Solar Field
	// Commented most things out	
	
	//obj = ssc_create();
	
	//ssc_var(obj, "HTF_code1", ${store_fluid});
	//ssc_var(obj, "fl_props1", ${store_fl_props});
	
	//ssc_var(obj, "HTF_code2", ${Fluid});
	//ssc_var(obj, "fl_props2", ${field_fl_props});

	//ret = ssc_exec(obj, 'user_htf_comparison', {'show_dialog'=false, 'hold_dialog'=false});
	
	//are_equal = ssc_var(obj, "are_equal");

	//is_hx = !(are_equal==1);
	is_hx = 0;

	//enable('dt_hot', is_hx );
	//enable('dt_cold', is_hx );

	// Set 'is_hx' here
	//value("is_hx", is_hx);
	//value("flux_max_dsg", flux_max_dsg);
	
	//ssc_free( obj );
}