{
    "Name": "Fuel Cell Dispatch",
    "Width": 1052.0,
    "Height": 150.0,
    "FormObjects": {
        "Divider": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "divider1"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 27.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 678.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 16.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Orientation": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "Colour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 120.0,
                        "Green": 120.0,
                        "Blue": 120.0,
                        "Alpha": 255.0
                    }
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "Dispatch options"
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 1.0
                }
            }
        },
        "Divider": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "divider35"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 714.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 231.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 16.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Orientation": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "Colour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 120.0,
                        "Green": 120.0,
                        "Blue": 120.0,
                        "Alpha": 255.0
                    }
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "Operation Options"
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 1.0
                }
            }
        },
        "GroupBox": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "fuelCellBox"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 6.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 6.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 1042.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 142.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "Fuel Cell Operation"
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 1.0
                }
            }
        },
        "RadioChoice": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "fuelcell_dispatch_choice"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 36.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 42.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 165.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 93.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Selection": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "Items": {
                    "Type": 6.0,
                    "StringList": "Fixed output|Follow electric load|Manual dispatch|Input dispatch"
                },
                "ShowCaptions": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "Horizontal": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": -1.0
                }
            }
        },
        "DataArray": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "fuelcell_dispatch_input"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 441.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 78.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 90.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 28.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Mode": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Label": {
                    "Type": 5.0,
                    "String": "Fuel Cell Dispatch"
                },
                "Description": {
                    "Type": 5.0,
                    "String": "Enter a power in kW or % of nameplate for each time step to dispatch the fuel cell to."
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": -1.0
                }
            }
        },
        "Choice": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "fuelcell_dispatch_input_units"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 534.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 78.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 93.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Items": {
                    "Type": 6.0,
                    "StringList": "kWac|% nameplate"
                },
                "Selection": {
                    "Type": 3.0,
                    "Integer": -1.0
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": -1.0
                }
            }
        },
        "Numeric": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "fuelcell_fixed_pct"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 441.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 42.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 63.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Value": {
                    "Type": 1.0,
                    "Double": 0.0
                },
                "Mode": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Format": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Decimals": {
                    "Type": 3.0,
                    "Integer": 3.0
                },
                "Prefix": {
                    "Type": 5.0,
                    "String": ""
                },
                "Suffix": {
                    "Type": 5.0,
                    "String": ""
                },
                "ThousandsSep": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": -1.0
                }
            }
        },
        "RadioChoice": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "fuelcell_operation_options"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 726.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 42.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 180.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 90.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Selection": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "Items": {
                    "Type": 6.0,
                    "StringList": "Allowed to shut down|Idle at minimum power"
                },
                "ShowCaptions": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "Horizontal": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": -1.0
                }
            }
        }
    },
    "VarDatabase": {
        "fuelcell_dispatch": {
            "Version": 4.0,
            "Type": 2.0,
            "Label": " ",
            "Units": "kW",
            "Group": "Fuel Cell",
            "IndexLabels": "",
            "Flags": 8.0,
            "DefaultValue": [
                0.0
            ],
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "fuelcell_dispatch_choice": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Dispatch choice",
            "Units": " ",
            "Group": "Fuel Cell",
            "IndexLabels": "Fixed output|Follow electric load|Manual dispatch|Input dispatch",
            "Flags": 3.0,
            "DefaultValue": 0.0,
            "UIObject": "RadioChoice",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "fuelcell_dispatch_input": {
            "Version": 4.0,
            "Type": 2.0,
            "Label": "Input dispatch time series",
            "Units": " ",
            "Group": "Fuel Cell",
            "IndexLabels": "Fuel Cell Dispatch|1",
            "Flags": 0.0,
            "DefaultValue": [
                0.0
            ],
            "UIObject": "DataArray",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "fuelcell_dispatch_input_units": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": " ",
            "Units": " ",
            "Group": "Fuel cell",
            "IndexLabels": "kWac|% nameplate",
            "Flags": 0.0,
            "DefaultValue": 0.0,
            "UIObject": "Choice",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "fuelcell_fixed_pct": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Fixed output percentage",
            "Units": "%",
            "Group": "Fuel Cell",
            "IndexLabels": "",
            "Flags": 2.0,
            "DefaultValue": 95.0,
            "UIObject": "Numeric",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "fuelcell_operation_options": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": " Fuel cell shutdown option",
            "Units": " ",
            "Group": "Fuel Cell",
            "IndexLabels": "Allowed to shut down|Idle at minimum power",
            "Flags": 3.0,
            "DefaultValue": 1.0,
            "UIObject": "RadioChoice",
            "sscVariableName": "",
            "sscVariableValue": ""
        }
    },
    "Equations": {
        "1": "equations{ 'fuelcell_dispatch'} = define(){",
        "2": "\tdispatch = ${fuelcell_dispatch_input};",
        "3": "\tif (${fuelcell_dispatch_input_units} == 1){",
        "4": "\t\tfor (i = 0; i < #dispatch; i++){",
        "5": "\t\t\tdispatch[i] = dispatch[i] * ${fuelcell_unit_max_power};",
        "6": "\t\t}",
        "7": "\t}",
        "8": "\treturn dispatch;",
        "9": "};"
    },
    "Callbacks": {
        "1": "on_load{'Fuel Cell Dispatch'} = define() ",
        "2": "{",
        "3": "\tenable_fc_dispatch_options();",
        "4": "\tcheck_fuel_cell_dispatch();",
        "5": "};",
        "6": "",
        "7": "on_change{'fuelcell_dispatch_choice'} = define()",
        "8": "{",
        "9": "\tenable_fc_dispatch_options();",
        "10": "\ttoggle_dispatch_fc(); // from Fuel Cell Dispatch Manual so manual dispatch options update",
        "11": "\tcheck_fuel_cell_dispatch();",
        "12": "};",
        "13": "",
        "14": "function enable_fc_dispatch_options()",
        "15": "{",
        "16": "\tenable('fuelcell_fixed_pct', value('fuelcell_dispatch_choice') == 0);",
        "17": "\tenable('fuelcell_dispatch_input', value('fuelcell_dispatch_choice') == 3);",
        "18": "\tenable('fuelcell_dispatch_input_units', value('fuelcell_dispatch_choice') == 3);",
        "19": "}",
        "20": "",
        "21": "function check_fuel_cell_dispatch()",
        "22": "{",
        "23": "\tfix_manual_dispatch = value('fuelcell_dispatch_choice') == 2 &&",
        "24": "\t\t\t\t   value('batt_dispatch_choice_ui') != 3;",
        "25": "\tif ( fix_manual_dispatch )",
        "26": "\t{",
        "27": "\t\tok = yesno('Fuel cell manual dispatch requires battery manual dispatch.\\nThe fuel cell manual dispatch option requires that the battery dispatch option be set to manual (even if the system does not include a battery).\\n\\nWould you like SAM to automatically set the battery dispatch option to manual dispatch?');",
        "28": "\t\tif ( ok )",
        "29": "\t\t{ ",
        "30": "\t\t\tvalue('batt_dispatch_choice_ui',3); // 3=manual dispatch for FOM and BTM battery",
        "31": "\t\t}",
        "32": "\t\telse",
        "33": "\t\t{",
        "34": "\t\t\tmsgbox('Fuel cell manual dispatch option not available without manual battery dispatch.\\nTo enable battery manual dispatch, choose Enable Battery on the Battery Storage page, and then choose Manual Dispatch on the Dispatch page for both fuel cell and battery dispatch. If your system does not include a battery, either set the desired battery capacity (kW and kWh) to zero on the Battery Storage page, or disable the battery.\\n\\nSetting fuel cell dispatch to the Fixed Output option because the battery dispatch option is not manual dispatch.');",
        "35": "\t\t\tvalue('fuelcell_dispatch_choice', 0);",
        "36": "\t\t}",
        "37": "\t}\t",
        "38": "}",
        "39": "",
        "40": "",
        "41": "",
        "42": ""
    }
}