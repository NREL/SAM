Wind Turbine Design
961
688
20
GroupBox

1
7
Name
5
9
GroupBox1
X
3
3
Y
3
6
Width
3
950
Height
3
671
Caption
5
12
Wind Turbine
Bold
2
1
Choice

1
8
Name
5
25
wind.turbine.blade_design
X
3
153
Y
3
474
Width
3
199
Height
3
24
Items
6
2
Baseline
Advanced Design
Selection
3
4294967295
TabOrder
3
11
Choice

1
8
Name
5
24
wind.turbine.drive_train
X
3
153
Y
3
447
Width
3
199
Height
3
24
Items
6
4
3 Stage Planetary
Single Stage - Low Speed Generator
Multi-Generator
Direct Drive
Selection
3
4294967295
TabOrder
3
10
Numeric

1
16
Name
5
22
wind.turbine.elevation
X
3
234
Y
3
417
Width
3
118
Height
3
24
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
0
Prefix
5
0
Suffix
5
2
 m
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
16
Name
5
26
wind.turbine.max_tip_speed
X
3
234
Y
3
321
Width
3
118
Height
3
21
Value
1
80
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
4
 m/s
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
6
Numeric

1
16
Name
5
29
wind.turbine.max_tspeed_ratio
X
3
234
Y
3
345
Width
3
118
Height
3
21
Value
1
8
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
7
RadioChoice

1
10
Name
5
33
wind.turbine.radio_list_or_design
X
3
96
Y
3
27
Width
3
257
Height
3
50
Selection
3
4294967295
Items
6
2
Select a turbine from the library
Define turbine design characteristics
ShowCaptions
2
1
Horizontal
2
0
TabOrder
3
1
Choice

1
8
Name
5
25
wind.turbine.tower_design
X
3
153
Y
3
501
Width
3
199
Height
3
24
Items
6
2
Baseline
Advanced Design
Selection
3
4294967295
TabOrder
3
12
Numeric

1
16
Name
5
19
wind_resource_shear
X
3
252
Y
3
156
Width
3
100
Height
3
21
Value
1
0.14
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
14
Numeric

1
16
Name
5
20
wind_turbine_cut_out
X
3
234
Y
3
393
Width
3
118
Height
3
21
Value
1
25
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
4
 m/s
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
9
Numeric

1
16
Name
5
18
wind_turbine_cutin
X
3
234
Y
3
369
Width
3
118
Height
3
21
Value
1
4
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
4
 m/s
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
8
Numeric

1
16
Name
5
19
wind_turbine_hub_ht
X
3
252
Y
3
132
Width
3
100
Height
3
21
Value
1
80
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
2
 m
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
13
Label

1
12
Name
5
23
wind_turbine_hub_ht_msg
X
3
12
Y
3
531
Width
3
335
Height
3
60
Caption
5
14
Error messages
TextColour
4
255
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Numeric

1
16
Name
5
22
wind_turbine_kw_rating
X
3
252
Y
3
84
Width
3
100
Height
3
21
Value
1
1500
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
3
 kW
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
27
Numeric

1
16
Name
5
28
wind_turbine_kw_rating_input
X
3
234
Y
3
249
Width
3
118
Height
3
21
Value
1
1500
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
3
 kW
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
3
Numeric

1
16
Name
5
19
wind_turbine_max_cp
X
3
234
Y
3
297
Width
3
118
Height
3
21
Value
1
0.45
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
5
Plot

1
5
Name
5
29
wind_turbine_power_curve_plot
X
3
366
Y
3
246
Width
3
573
Height
3
414
Numeric

1
16
Name
5
27
wind_turbine_rotor_diameter
X
3
252
Y
3
108
Width
3
100
Height
3
21
Value
1
75
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
2
 m
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
14
Numeric

1
16
Name
5
33
wind_turbine_rotor_diameter_input
X
3
234
Y
3
273
Width
3
118
Height
3
21
Value
1
75
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
2
 m
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4
Library

1
7
Name
5
22
wind_turbine_selection
X
3
366
Y
3
30
Width
3
573
Height
3
201
Library
5
13
Wind Turbines
Fields
5
14
Name,KW Rating

33
a_error_test_number
3
1
 
 
Wind Turbine
0
8
1
1
1
1
17.345
Default
a_error_test_string
3
4
 
 
Wind Turbine
0
8
1
4
17
"default err msg"
Default
resource_definition_type
3
1
 
 
Wind Turbine
0
0
1
1
1
1
0
Default
wind.turbine.blade_design
3
1
Blade design
 
Wind Turbine
24
Baseline|Advanced Design
2
1
1
1
1
0
Choice
wind.turbine.drive_train
3
1
Drive train design
 
Wind Turbine
81
3 Stage Planetary|Single Stage - Low Speed Generator|Multi-Generator|Direct Drive
2
1
1
1
1
0
Choice
wind.turbine.dummy
3
1
 
 
Wind Turbine
0
8
1
1
1
1
0
Default
wind.turbine.elevation
3
1
Turbine elevation (above sea level)
 
Wind Turbine
0
0
1
1
1
1
0
Default
wind.turbine.max_tip_speed
3
1
Maximum tip speed
 
Wind Turbine
0
2
1
1
1
1
80
Numeric
wind.turbine.max_tspeed_ratio
3
1
Maximum tip-speed ratio
 
Wind Turbine
0
2
1
1
1
1
8
Numeric
wind.turbine.name_only
3
4
 
 
Wind Turbine
0
8
1
4
1
0
Default
wind.turbine.radio_list_or_design
3
1
 
 
Wind Turbine
71
Select a turbine from the library|Define turbine design characteristics
0
1
1
1
1
0
RadioChoice
wind.turbine.region2nhalf_slope
3
1
 
 
Wind Turbine
0
0
1
1
1
1
5
Default
wind.turbine.tower_design
3
1
Tower design
 
Wind Turbine
24
Baseline|Advanced Design
2
1
1
1
1
0
Choice
wind_resource_shear
3
1
Shear coefficient
 
Wind Turbine
0
2
1
1
1
1
0.14
Numeric
wind_turbine_IEC_Class_from_lib
3
4
 
 
Wind Turbine
0
8
1
4
1
3
Default
wind_turbine_cut_out
3
1
Cut-out wind speed
 
Wind Turbine
0
2
1
1
1
1
25
Numeric
wind_turbine_cutin
3
1
Cut-in wind speed
 
Wind Turbine
0
2
1
1
1
1
4
Default
wind_turbine_hub_ht
3
1
Hub height
 
Wind Turbine
0
2
1
1
1
1
80
Numeric
wind_turbine_kw_rating
3
1
Rated output
 
Wind Turbine
0
8
1
1
1
1
1500
Numeric
wind_turbine_kw_rating_from_lib
3
1
 
 
Wind Turbine
0
8
1
1
1
1
1800
Default
wind_turbine_kw_rating_input
3
1
User-defined rated output
 
Wind Turbine
0
2
1
1
1
1
1500
Numeric
wind_turbine_max_cp
3
1
Maximum Cp
 
Wind Turbine
0
2
1
1
1
1
0.45
Numeric
wind_turbine_powercurve_err_msg
3
4
 
 
Wind Turbine
0
8
1
4
0
Default
wind_turbine_powercurve_hub_efficiency
3
2
 
 
Wind Turbine
0
8
1
2
1
1
0
Default
wind_turbine_powercurve_powerout
3
2
 
 
Wind Turbine
0
8
1
2
1
1
0
Default
wind_turbine_powercurve_powerout_from_lib
3
2
 
 
Wind Turbine
0
8
1
2
1
1
0
Default
wind_turbine_powercurve_windspeeds
3
2
 
 
Wind Turbine
0
8
1
2
1
1
0
Default
wind_turbine_powercurve_windspeeds_from_lib
3
2
 
 
Wind Turbine
0
8
1
2
1
1
0
Default
wind_turbine_rated_wind_speed
3
1
 
 
Wind Turbine
0
8
1
1
1
1
0
Default
wind_turbine_rotor_diameter
3
1
Rotor diameter
 
Wind Turbine
0
8
1
1
1
1
75
Numeric
wind_turbine_rotor_diameter_from_lib
3
1
 
 
Wind Turbine
0
8
1
1
1
1
80
Default
wind_turbine_rotor_diameter_input
3
1
User-defined rotor diameter
 
Wind Turbine
0
2
1
1
1
1
75
Numeric
wind_turbine_selection
3
4
Wind Turbine Selection
 
Wind Turbine
15
Wind Turbines|0
19
1
4
15
Bergey BWC XL.1
Library

7007
// 'wind_turbine_rotor_diameter' is the SSC input
equations{ 'wind_turbine_rotor_diameter' } = define() {
	if ( ${wind.turbine.radio_list_or_design} == 0)
		return ${wind_turbine_rotor_diameter_from_lib};
	else
		return ${wind_turbine_rotor_diameter_input};
};

// 'wind_turbine_kw_rating' is not used by SSC model, but it is used
// to calculate the nameplate capacity on the wind farm page
equations{ 'wind_turbine_kw_rating' } = define() {
	if ( ${wind.turbine.radio_list_or_design} == 0)
		return  ${wind_turbine_kw_rating_from_lib};
	else
		return ${wind_turbine_kw_rating_input};
};

equations{ '$MIMO$ windturbinemod' } = define() {
	// reset the error message

	// if we don't need to calculate the curve, get it from library and get out
	if (${wind.turbine.radio_list_or_design} == 0) {
		${wind_turbine_powercurve_windspeeds} = ${wind_turbine_powercurve_windspeeds_from_lib};
		${wind_turbine_powercurve_powerout} = ${wind_turbine_powercurve_powerout_from_lib};
		${wind_turbine_rated_wind_speed} = ${wind_turbine_kw_rating_from_lib}; // used for estimating a cost
		${wind_turbine_powercurve_err_msg} = "";

		return 0;
	}
	
	// make sure error msg starts empty
	errmsg = "";

	// If user defined turbine, get user inputs, otherwise get values for kW rating and rotor diameter from the library for the (non-generic) turbine chosen in the drop-down
	data.turbine_size = ${wind_turbine_kw_rating_input};
	data.wind_turbine_rotor_diameter = ${wind_turbine_rotor_diameter_input};
	hubht = ${wind_turbine_hub_ht};
	farmElevation = ${wind.turbine.elevation}; 	// The elevation will be used to change the turbine power curve, which will be passed into the SSC

	// NOTE: April 2014, the last version of SAMwx did NOT account for hubht for air density calculation
	// in this equation.  So, calculations with user defined turbines would create
	// slightly different results.
	// NOTE 2: Power curve is corrected by HUB HEIGHT air density from the weather file in SSC. 
	// Therefore, only correct for elevation if using Weibull wind characteristics. Added 7/16/14 by JMF.
	if(${wind_resource_model_choice} == 1) 
	{
		data.elevation = farmElevation + hubht;
	}
	else data.elevation  = 0;

	data.wind_turbine_max_cp = ${wind_turbine_max_cp};
	data.max_tip_speed = ${wind.turbine.max_tip_speed};
	data.max_tip_sp_ratio = ${wind.turbine.max_tspeed_ratio};
	data.cut_in = ${wind_turbine_cutin};
	data.cut_out = ${wind_turbine_cut_out};
	data.drive_train = ${wind.turbine.drive_train};
	
	ssc_eqn("windpower_turbine_powercurve", data);

	${wind_turbine_powercurve_windspeeds} = data.wind_turbine_powercurve_windspeeds;
	${wind_turbine_powercurve_powerout} = data.wind_turbine_powercurve_powerout;
	${wind_turbine_powercurve_hub_efficiency} = data.hub_efficiency;  // used to show values in Weibull graph

	// other outputs
	${wind_turbine_rated_wind_speed} = data.rated_wind_speed; // used for estimating a cost
	${wind_turbine_powercurve_err_msg} = data.errmsg;

	return 0;
};


4143
function plot_turbine_curve()
{
	setplot('wind_turbine_power_curve_plot');
	clearplot('wind_turbine_power_curve_plot');
	plotopt( {'title'='Turbine power curve','backcolor'=[255,255,255], 'popup'=true, 'legend'=false, 'legendpos'=[75,10]}  );
	
	ws = ${wind_turbine_powercurve_windspeeds};
	pc = ${wind_turbine_powercurve_powerout};
	plot( ws, pc, {'thick'=1, 'scale'=true, 'color'=[100,200,100], 'series'='Turbine Output'});
	
	high = max( ws );
	low = min( ws );
	pad = (high - low) * 0.05;
	axis( 'x1', {'label'='Wind Speed (m/s)', 'min'=floor(low-pad), 'max'=ceil(high+pad) });
	
	high = max( pc );
	low = min( pc );
	pad = (high - low) * 0.05;
	axis( 'y1', {'label'='Turbine Power (kW)', 'min'=floor(low-pad), 'max'=ceil(high+pad) });
	
	// show any error messages
	set_error_msg();
}

function set_error_msg()
{	
	// Start with a fresh error message
	errmsg = '';

	// Check hub height compared to rotor diameter
	rotor_diameter = ${wind_turbine_rotor_diameter};
	hubht = ${wind_turbine_hub_ht};
	if (hubht <  (rotor_diameter/2)+10) 
		errmsg += 'Turbine hub height is too low for rotor diameter. ';
	
	// Check resource height compared to hub height- not for weibull
	if(${wind_resource_model_choice} != 1) 
	{
		ssc = ssc_create();
		ssc_var( ssc, 'file_name', ${wind_resource_filename});	
		ssc_var(ssc, 'scan_header_only', 1);
		ssc_var(ssc, 'requested_ht', hubht);
		err = ssc_exec(ssc, 'wind_file_reader');
		if (err != 0) //file didn't run successfully
		{
			msgbox('Could not check hub height compared to resource height. This may indicate a problem with your weather file.');
			return;
		}
		closest_ht = ssc_var(ssc, 'closest_speed_meas_ht');
		ssc_free(ssc);
		if (hubht > closest_ht + 35) errmsg += 'Turbine hub height is more than 35 meters taller than the measured resource data. ';
		if (hubht < closest_ht - 35) errmsg += 'Turbine hub height is more than 35 meters shorter than the measured resource data. ';
	}
	
	// Check for negative values in power curve
	pc = ${wind_turbine_powercurve_powerout};
	for (i=0; i<#pc; i++)
	{
		if (pc[i] < 0) //negative power curve value
		{
			errmsg += 'Turbine power curve contains negative values. Please check your inputs. ';
			break;
		}
	}
	
	//assign error message
	property('wind_turbine_hub_ht_msg', 'Caption', errmsg );
}

on_change{'wind.turbine.radio_list_or_design'} = define()
{
	turbine_definition_type = value('wind.turbine.radio_list_or_design');
	bDesign = (turbine_definition_type == 1);
	bWeibull = (${resource_definition_type} == 1);

	show('wind_turbine_selection', !bDesign);
	
	show('wind_turbine_kw_rating_input', bDesign);
	show('wind_turbine_rotor_diameter_input', bDesign);
	show('wind_turbine_max_cp', bDesign);
	show('wind.turbine.max_tip_speed', bDesign);
	show('wind.turbine.max_tspeed_ratio', bDesign);
	show('wind_turbine_cutin', bDesign);
	show('wind_turbine_cut_out', bDesign);
	show('wind.turbine.drive_train', bDesign);
	show('wind.turbine.blade_design', bDesign);
	show('wind.turbine.tower_design', bDesign);
		
	show('wind.turbine.elevation',false);
	if (bDesign == true)  // define turbine design characteristics
	  show('wind.turbine.elevation',bWeibull);
	
	plot_turbine_curve();

};

on_load{'Wind Turbine Design'}=define()
{
	on_change{'wind.turbine.radio_list_or_design'}();
};

on_change{'wind_turbine_selection'} = define() {
	// user can only change this when ${wind.turbine.radio_list_or_design} == 0
	plot_turbine_curve();
};

on_change{'wind_turbine_kw_rating_input'} = define() {
	plot_turbine_curve();
};

on_change{'wind_turbine_rotor_diameter_input'} = define() {
	plot_turbine_curve();
};

on_change{'wind_turbine_max_cp'} = define() {
	plot_turbine_curve();
};

on_change{'wind.turbine.max_tip_speed'} = define() {
	plot_turbine_curve();
};

on_change{'wind.turbine.max_tspeed_ratio'} = define() {
	plot_turbine_curve();
};

on_change{'wind_turbine_cutin'} = define() {
	plot_turbine_curve();
};

on_change{'wind_turbine_cut_out'} = define() {
	plot_turbine_curve();
};

on_change{'wind.turbine.drive_train'} = define() {
	plot_turbine_curve();
};

on_change{'wind_turbine_hub_ht'} = define() {
	plot_turbine_curve();
};


