Phys Trough System Design
867
478
21
Numeric

1
17
Name
5
8
I_bn_des
X
3
219
Y
3
57
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
1
Numeric

1
17
Name
5
18
L_heat_sink_piping
X
3
696
Y
3
129
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
1
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
28
SD_COPY_field_thermal_output
X
3
696
Y
3
294
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
14
SD_COPY_nLoops
X
3
219
Y
3
270
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
0
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
18
SD_COPY_solar_mult
X
3
696
Y
3
270
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
22
SD_COPY_total_aperture
X
3
219
Y
3
294
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
1
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
13
T_loop_in_des
X
3
219
Y
3
129
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
1
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
3
Numeric

1
17
Name
5
10
T_loop_out
X
3
219
Y
3
153
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4
Button

1
8
Name
5
20
btn_calc_q_heat_sink
X
3
624
Y
3
165
Width
3
177
Height
3
24
Tool Tip
5
0
Caption
5
22
Choose Number of Loops
TabOrder
3
4294967295
CheckBox

1
9
Name
5
25
is_model_heat_sink_piping
X
3
783
Y
3
105
Width
3
24
Height
3
24
Tool Tip
5
0
Caption
5
0
State
2
0
TabOrder
3
4294967295
Divider

1
10
Name
5
9
object 21
X
3
444
Y
3
195
Width
3
405
Height
3
16
Tool Tip
5
0
Orientation
3
0
Colour
4
120
120
120
255
Caption
5
22
Thermal Energy Storage
Bold
2
1
Divider

1
10
Name
5
11
object 2120
X
3
12
Y
3
36
Width
3
405
Height
3
16
Tool Tip
5
0
Orientation
3
0
Colour
4
120
120
120
255
Caption
5
11
Solar Field
Bold
2
1
Divider

1
10
Name
5
10
object 218
X
3
444
Y
3
36
Width
3
405
Height
3
16
Tool Tip
5
0
Orientation
3
0
Colour
4
120
120
120
255
Caption
5
9
Heat Sink
Bold
2
1
GroupBox

1
8
Name
5
8
object 4
X
3
6
Y
3
249
Width
3
855
Height
3
78
Tool Tip
5
0
Caption
5
14
System Summary
Bold
2
1
GroupBox

1
8
Name
5
10
object 417
X
3
6
Y
3
12
Width
3
855
Height
3
237
Tool Tip
5
0
Caption
5
23
Design Point Parameters
Bold
2
1
Numeric

1
17
Name
5
12
pb_pump_coef
X
3
696
Y
3
81
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
11
q_pb_design
X
3
696
Y
3
57
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
6
Numeric

1
17
Name
5
23
specified_q_dot_rec_des
X
3
219
Y
3
105
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
3
Numeric

1
17
Name
5
24
specified_solar_multiple
X
3
219
Y
3
81
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
2
Numeric

1
17
Name
5
7
tshours
X
3
696
Y
3
213
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
1
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
5
Label

1
13
Name
5
6
ui_msg
X
3
9
Y
3
336
Width
3
848
Height
3
137
Tool Tip
5
0
Caption
5
0
TextColour
4
255
128
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1

17
I_bn_des
3
1
Design point DNI
W/m²
Phys Trough System Design
0
2
1
1
1
1
950
Default
L_heat_sink_piping
3
1
Length of piping through heat sink
m
Phys Trough Solar Field
0
2
1
1
1
1
50
Numeric
SD_COPY_field_thermal_output
3
1
Actual field thermal output
MWt
 
0
8
1
1
1
1
0
Numeric
SD_COPY_nLoops
3
1
Actual number of loops
 
Phys Trough System Design
0
8
1
1
1
1
1
Numeric
SD_COPY_solar_mult
3
1
Actual solar multiple
 
Phys Trough System Design
0
8
1
1
1
1
0
Numeric
SD_COPY_total_aperture
3
1
Total aperture reflective area
m²
Phys Trough System Design
0
8
1
1
1
1
0
Numeric
T_loop_in_des
3
1
Loop inlet HTF temperature
°C
Phys Trough System Design
0
2
1
1
1
1
290
Default
T_loop_out
3
1
Loop outlet HTF temperature
°C
Phys Trough System Design
0
2
1
1
1
1
393
Default
is_model_heat_sink_piping
3
1
Model piping through heat sink?
 
Phys Trough Solar Field
0
2
1
1
1
1
0
CheckBox
nLoops
3
1
Number of loops
-
Phys Trough System Design
0
8
1
1
1
1
0
Default
pb_pump_coef
3
1
Pumping power for HTF through heat sink
kW/kg/s
Phys Trough System Design
0
2
1
1
1
1
0.55
Numeric
q_pb_design
3
1
Heat sink power
MWt
Phys Trough System Design
0
2
1
1
1
1
100
Default
solar_mult
3
1
Solar multiple
-
Phys Trough System Design
0
8
1
1
1
1
2.5
Default
specified_q_dot_rec_des
3
1
Target receiver thermal power
MWt
Phys Trough System Design
0
8
1
1
1
1
0
Default
specified_solar_multiple
3
1
Target solar multiple
 
Phys Trough System Design
0
2
1
1
1
1
1.9
Default
system_capacity
3
1
system capacity for financial models
kWt
Phys Trough System Design
0
8
1
1
1
1
0
Numeric
tshours
3
1
Hours of storage at design point
hours
Phys Trough System Design
0
2
1
1
1
1
6
Default

1173
//
//  ONLY ADD UI INDICATOR, COMBO CONVERTERS, AND
//  INPUT AGGREGATOR EQUATIONS BELOW!
//
//   If the equations change an input value
//   modify the below main MIMO or add one,
//   referencing in ssc_equations.h
//


// Just UI indicator
equations{ 'specified_q_dot_rec_des' } = define() 
{
	return ${specified_solar_multiple}*${q_pb_design}; 
};

equations{ 'system_capacity' } = define()
{
	return ${specified_q_dot_rec_des}*1000.0;
};

// Just UI indicator
equations{ 'SD_COPY_nLoops' } = define()
{
	return ${nLoops};
};

// Just UI indicator
equations{ 'SD_COPY_total_aperture' } = define()
{
	return ${total_aperture};
};

// Just UI indicator
equations{ 'SD_COPY_solar_mult' } = define()
{
	return ${solar_mult};
};

// Just UI indicator
equations{ 'SD_COPY_field_thermal_output' } = define()
{
	return ${field_thermal_output};
};

equations{ 'nLoops' } = define() {
	retval = ( ${specified_solar_multiple}*${total_required_aperture_for_SM1}
				/ ${single_loop_aperature}  );
	return ceil(retval); // SAMwx used "@round" here
};

equations{ 'solar_mult' } = define() {
	return ${field_thermal_output}/${q_pb_design};
	//return ${specified_solar_multiple}; 
};

2144
on_load{'Phys Trough System Design'} = define(){
	on_change{'combo_htf_type'}();
	on_change{'is_model_heat_sink_piping'}();
	check_htf_temp_bounds();
};

function check_htf_temp_bounds()
{
	msg = '';
	if(${T_loop_out} > ${field_htf_max_operating_temp})
	{
		msg = 'The Loop outlet HTF temperature is hotter than the HTF maximum operating temperature. The performance model may still solve, but the HTF properties may be extrapolated and unreliable. ';
	}
	
	if(${T_loop_in_des} < ${field_htf_min_operating_temp})
	{
		//if(msg != '')
		//{
		//	msg = msg + '\n';
		//}
		msg = msg + 'The Loop inlet HTF temperature is colder than the HTF minimum operating temperature. The performance model may still solve, but the HTF properties may be extrapolated and unreliable. ';
	}
	
	property('ui_msg','Caption',msg);
}

on_change{'T_loop_out'} = define()
{ 
	check_htf_temp_bounds();
};

on_change{'T_loop_in_des'} = define()
{
	check_htf_temp_bounds();
};

on_change{'field_htf_min_operating_temp'} = define()
{
	check_htf_temp_bounds();
};

on_change{'field_htf_max_operating_temp'} = define()
{
	check_htf_temp_bounds();
};

function calc_q_heat_sink()
{
	str_in = in('Choose number of loops', '2', '');
	
	if(str_in == "")
	{
		return;
	}
	
	nLoops_spec = to_real(str_in);	

	if(nLoops_spec/to_int(nLoops_spec) > 1 || nLoops_spec < 1)
	{
		msgbox("The number of loops must be a positive integer");
		return;
	}

	field_thermal_output_calc = ${I_bn_des}
								*${total_loop_conversion_efficiency}
								*${single_loop_aperature}*nLoops_spec/1.E6;
								
	q_pb_design_calc = field_thermal_output_calc / ${specified_solar_multiple};
	
	htm_str = 
		"Calculated heat sink power = " + to_string(q_pb_design_calc);
		
	//html_dialog(htm_str, "Choose Number of Loops; Calculate Heat Sink Power", [400,150]);
	
	htm_str = htm_str + " \nUpdate 'Heat sink power'?";
	
	if( yesno(htm_str) )
	{
		value("q_pb_design", q_pb_design_calc);
	}
	
}

on_change{'btn_calc_q_heat_sink'} = define()
{
	calc_q_heat_sink();
};

on_change{'is_model_heat_sink_piping'} = define()
{
	enable('L_heat_sink_piping', value('is_model_heat_sink_piping')==1);
	refresh();
};