Inverter CEC Database
992
626
28
TextEntry

1
11
Name
5
12
inv_cec_date
X
3
843
Y
3
591
Width
3
100
Height
3
24
Tool Tip
5
0
Text
5
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
TextEntry

1
11
Name
5
12
inv_cec_name
X
3
96
Y
3
591
Width
3
399
Height
3
24
Tool Tip
5
0
Text
5
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
TextEntry

1
11
Name
5
12
inv_cec_type
X
3
567
Y
3
591
Width
3
198
Height
3
24
Tool Tip
5
0
Text
5
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
18
inv_snl_ac_voltage
X
3
672
Y
3
390
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
1
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
3
Numeric

1
17
Name
5
10
inv_snl_c0
X
3
843
Y
3
438
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
10
Numeric

1
17
Name
5
10
inv_snl_c1
X
3
843
Y
3
462
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
11
Numeric

1
17
Name
5
10
inv_snl_c2
X
3
843
Y
3
486
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
12
Numeric

1
17
Name
5
10
inv_snl_c3
X
3
843
Y
3
510
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
13
Numeric

1
17
Name
5
15
inv_snl_eff_cec
X
3
876
Y
3
216
Width
3
80
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
10
Numeric

1
17
Name
5
16
inv_snl_eff_euro
X
3
876
Y
3
240
Width
3
80
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
10
Numeric

1
17
Name
5
14
inv_snl_idcmax
X
3
672
Y
3
438
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
1
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
9
Library

1
8
Name
5
21
inv_snl_inverter_name
X
3
9
Y
3
15
Width
3
978
Height
3
168
Tool Tip
5
0
Library
5
13
CEC Inverters
Fields
5
94
Name,Paco,Pdco,Pso,Pnt,Vac,Vdcmax,Vdco,Mppt_high,Mppt_low,C0,C1,C2,C3,Idcmax,cec_type,cec_date
Numeric

1
17
Name
5
15
inv_snl_mppt_hi
X
3
672
Y
3
510
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
1
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
16
Numeric

1
17
Name
5
16
inv_snl_mppt_low
X
3
672
Y
3
462
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
1
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
14
Numeric

1
17
Name
5
16
inv_snl_num_mppt
X
3
603
Y
3
216
Width
3
60
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
0
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
2
Numeric

1
17
Name
5
12
inv_snl_paco
X
3
672
Y
3
294
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4
Numeric

1
17
Name
5
12
inv_snl_pdco
X
3
672
Y
3
318
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
5
Numeric

1
17
Name
5
11
inv_snl_pnt
X
3
672
Y
3
366
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
7
Numeric

1
17
Name
5
11
inv_snl_pso
X
3
672
Y
3
342
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
6
Numeric

1
17
Name
5
14
inv_snl_vdcmax
X
3
672
Y
3
414
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
1
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
8
Numeric

1
17
Name
5
12
inv_snl_vdco
X
3
672
Y
3
486
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
1
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
15
Label

1
13
Name
5
8
msg_mppt
X
3
432
Y
3
240
Width
3
231
Height
3
24
Tool Tip
5
0
Caption
5
31
Number must be between 1 and 4.
TextColour
4
255
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
1
AlignRight
2
1
AlignTop
2
0
GroupBox

1
8
Name
5
9
msg_mppt2
X
3
9
Y
3
192
Width
3
980
Height
3
429
Tool Tip
5
0
Caption
5
36
Efficiency Curve and Characteristics
Bold
2
1
Divider

1
10
Name
5
9
object 21
X
3
24
Y
3
570
Width
3
960
Height
3
16
Tool Tip
5
0
Orientation
3
0
Colour
4
120
120
120
255
Caption
5
15
CEC Information
Bold
2
1
Divider

1
10
Name
5
11
object 2126
X
3
456
Y
3
273
Width
3
315
Height
3
16
Tool Tip
5
0
Orientation
3
0
Colour
4
120
120
120
255
Caption
5
20
Datasheet Parameters
Bold
2
1
Divider

1
10
Name
5
10
object 216
X
3
816
Y
3
417
Width
3
162
Height
3
16
Tool Tip
5
0
Orientation
3
0
Colour
4
120
120
120
255
Caption
5
19
Sandia Coefficients
Bold
2
1
Label

1
13
Name
5
8
object 7
X
3
15
Y
3
537
Width
3
960
Height
3
24
Tool Tip
5
0
Caption
5
139
Note: If you are modeling a system with microinverters or DC power optimizers, see the Losses page to adjust the system losses accordingly.
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
Plot

1
6
Name
5
23
pv.inv.sandia.eff_curve
X
3
15
Y
3
216
Width
3
411
Height
3
297
Tool Tip
5
0

21
inv_cec_date
3
4
CEC date
 
PV Inverter (CEC Database)
0
4
1
4
0
Default
inv_cec_name
3
4
CEC name
 
PV Inverter (CEC Database)
0
4
1
4
2
''
Default
inv_cec_type
3
4
CEC type
 
PV Inverter (CEC Database)
0
4
1
4
0
Default
inv_snl_ac_voltage
3
1
Nominal AC voltage
Vac
PV Inverter (CEC Database)
0
8
1
1
1
1
0
Numeric
inv_snl_c0
3
1
C0
1/Wac
PV Inverter (CEC Database)
0
8
1
1
1
1
0
Numeric
inv_snl_c1
3
1
C1
1/Vdc
PV Inverter (CEC Database)
0
8
1
1
1
1
0
Numeric
inv_snl_c2
3
1
C2
1/Vdc
PV Inverter (CEC Database)
0
8
1
1
1
1
0
Numeric
inv_snl_c3
3
1
C3
1/Vdc
PV Inverter (CEC Database)
0
8
1
1
1
1
0
Numeric
inv_snl_eff_cec
3
1
CEC weighted efficiency
%
PV Inverter (CEC Database)
0
8
1
1
1
1
0
Numeric
inv_snl_eff_euro
3
1
European weighted efficiency
%
PV Inverter (CEC Database)
0
8
1
1
1
1
0
Numeric
inv_snl_idcmax
3
1
Maximum DC current
Adc
PV Inverter (CEC Database)
0
8
1
1
1
1
0
Numeric
inv_snl_inverter_name
3
4
Inverter CEC library selection
 
PV Inverter (CEC Database)
15
CEC Inverters|0
19
1
4
39
SMA America: ST36 (240) 240V [CEC 2010]
Library
inv_snl_mppt_hi
3
1
Maximum MPPT DC voltage
Vdc
PV Inverter (CEC Database)
0
8
1
1
1
1
0
Numeric
inv_snl_mppt_low
3
1
Minimum MPPT DC voltage
Vdc
PV Inverter (CEC Database)
0
8
1
1
1
1
0
Numeric
inv_snl_num_mppt
3
1
Number of MPPT inputs
 
PV Inverter (CEC Database)
0
0
1
1
1
1
1
Numeric
inv_snl_paco
3
1
Maximum AC power
Wac
PV Inverter (CEC Database)
0
8
1
1
1
1
0
Numeric
inv_snl_pdco
3
1
Maximum DC power
Wdc
PV Inverter (CEC Database)
0
8
1
1
1
1
0
Numeric
inv_snl_pnt
3
1
Power use at night
Wac
PV Inverter (CEC Database)
0
8
1
1
1
1
0
Numeric
inv_snl_pso
3
1
Power use during operation
Wdc
PV Inverter (CEC Database)
0
8
1
1
1
1
0
Numeric
inv_snl_vdcmax
3
1
Maximum DC voltage
Vdc
PV Inverter (CEC Database)
0
8
1
1
1
1
0
Numeric
inv_snl_vdco
3
1
Nominal DC voltage
Vdc
PV Inverter (CEC Database)
0
8
1
1
1
1
0
Numeric

1772
equations{ '$MIMO$ SandiaInverterEfficiencies' } = define()
{
	//assign specs
	vdco = ${inv_snl_vdco}; pdco = ${inv_snl_pdco}; pso = ${inv_snl_pso}; paco = ${inv_snl_paco};
	c0= ${inv_snl_c0}; c1= ${inv_snl_c1}; c2= ${inv_snl_c2}; c3= ${inv_snl_c3};
	
	if(pdco <= 0) {return 0;} //prevents division by zero
	
	//calculate intermediate values
	pdc5 = 0.05 * pdco;
	pac5 = snlinverter(pdc5,vdco,vdco,pdco,pso,paco,c0,c1,c2,c3);
	pdc10 = 0.1 * pdco;
	pac10 = snlinverter(pdc10,vdco,vdco,pdco,pso,paco,c0,c1,c2,c3);
	pdc20 = 0.2 * pdco;
	pac20 = snlinverter(pdc20,vdco,vdco,pdco,pso,paco,c0,c1,c2,c3);
	pdc30 = 0.3 * pdco;
	pac30 = snlinverter(pdc30,vdco,vdco,pdco,pso,paco,c0,c1,c2,c3);
	pdc50 = 0.5 * pdco;
	pac50 = snlinverter(pdc50,vdco,vdco,pdco,pso,paco,c0,c1,c2,c3);
	pdc75 = 0.75 * pdco;
	pac75 = snlinverter(pdc75,vdco,vdco,pdco,pso,paco,c0,c1,c2,c3);
	pdc100 = pdco;
	pac100 = snlinverter(pdc100,vdco,vdco,pdco,pso,paco,c0,c1,c2,c3);

	//cec efficiency coefficients
	cec_F1 = 0.00; cec_F2 = 0.04; cec_F3 = 0.05; cec_F4 = 0.12;
	cec_F5 = 0.21; cec_F6 = 0.53; cec_F7 = 0.05;
	
	//euro efficiency coefficients
	euro_F1 = 0.03; euro_F2 = 0.06; euro_F3 = 0.13; euro_F4 = 0.10;
	euro_F5 = 0.48; euro_F6 = 0.00; euro_F7 = 0.20;
	
	//calculate efficiencies
	cec_eff = cec_F1 * pac5 / pdc5 
			+ cec_F2 * pac10 / pdc10 
			+ cec_F3 * pac20 / pdc20 
			+ cec_F4 * pac30 / pdc30 
			+ cec_F5 * pac50 / pdc50 
			+ cec_F6 * pac75 / pdc75 
			+ cec_F7 * pac100 / pdc100 ; 
			
	euro_eff = euro_F1 * pac5 / pdc5 
			+ euro_F2 * pac10 / pdc10 
			+ euro_F3 * pac20 / pdc20 
			+ euro_F4 * pac30 / pdc30 
			+ euro_F5 * pac50 / pdc50 
			+ euro_F6 * pac75 / pdc75 
			+ euro_F7 * pac100 / pdc100 ; 
			
	${inv_snl_eff_cec} = cec_eff * 100;
	${inv_snl_eff_euro} = euro_eff * 100;
};

3904
function plot_inverter_curve()
{
	//assign specs
	vdco = ${inv_snl_vdco}; pdco = ${inv_snl_pdco}; pso = ${inv_snl_pso}; paco = ${inv_snl_paco};
	mppt_low = ${inv_snl_mppt_low}; mppt_hi = ${inv_snl_mppt_hi};
	c0= ${inv_snl_c0}; c1= ${inv_snl_c1}; c2= ${inv_snl_c2}; c3= ${inv_snl_c3};
	
	//don't show mppt_low and mppt_high curves if blank or zero
	bolShowmppt_low = (value('inv_snl_mppt_low') != 0);
	bolShowmppt_hi = (value('inv_snl_mppt_hi') != 0);
	
	//don't show mppt curves if C0,C1,C2,C3 are zero
	if ((c0==0) && (c1==0) && (c2==0) && (c3==0))
	{
		bolShowmppt_low = false; bolShowmppt_hi = false;
	}
	
	//assign initial values
	i = 0; pdc = 0; pac = 0;
	
	//arrays in which to store points
	array_size= 201;
	x= alloc(array_size); xlow= alloc(array_size); xhi= alloc(array_size);
	y= alloc(array_size); ylow= alloc(array_size); yhi= alloc(array_size);
	
	//FIRST POINT
	x[i] = pdc; y[i] = 0;
	if (bolShowmppt_low) {xlow[i] = pdc; ylow[i] = 0;}
	if (bolShowmppt_hi) {xhi[i] = pdc; yhi[i] = 0;}
	i=i+1;
	
	//INTERMEDIATE POINTS
	while(i<200)
	{
		pdc = pdco * i/200; //increment in 200 even partitions
		pac = snlinverter(pdc,vdco,vdco,pdco,pso,paco,c0,c1,c2,c3);
		x[i] = (pdc/pdco*100); //percentage of rated power
		y[i] = (pac/pdc*100); //efficiency
		if (bolShowmppt_low)
		{
			pac = snlinverter(pdc,mppt_low,vdco,pdco,pso,paco,c0,c1,c2,c3);
			xlow[i] = (pdc/pdco*100); //percentage of rated power
			ylow[i] = (pac/pdc*100); //efficiency
		}
		if (bolShowmppt_hi)
		{
			pac = snlinverter(pdc,mppt_hi,vdco,pdco,pso,paco,c0,c1,c2,c3);
			xhi[i] = (pdc/pdco*100); //percentage of rated power
			yhi[i] = (pac/pdc*100); //efficiency
		}
		i = i + 1;
	}
	
	//LAST POINT
	pdc = pdco;
	pac = snlinverter(pdc,vdco,vdco,pdco,pso,paco,c0,c1,c2,c3);
	x[i] = (pdc/pdco*100); //percentage of rated power
	y[i] = (pac/pdc*100); //efficiency
	if (bolShowmppt_low)
	{
		pac = snlinverter(pdc,mppt_low,vdco,pdco,pso,paco,c0,c1,c2,c3);
		xlow[i] = (pdc/pdco*100); //percentage of rated power
		ylow[i] = (pac/pdc*100); //efficiency
	}
	if (bolShowmppt_hi)
	{
		pac = snlinverter(pdc,mppt_hi,vdco,pdco,pso,paco,c0,c1,c2,c3);
		xhi[i] = (pdc/pdco*100); //percentage of rated power
		yhi[i] = (pac/pdc*100); //efficiency
	}
	
	//MAKE THE PLOT	
	setplot("pv.inv.sandia.eff_curve");
	clearplot("pv.inv.sandia.eff_curve");
	//plotopt({"title"=${inv_snl_inverter_name},"popup"=true,"backcolor"=[255,255,255],"legend"=true, "legendpos"=[65,60]});
	plotopt({"title"=value("inv_cec_name"),"popup"=true,"backcolor"=[255,255,255],"legend"=true, "legendpos"=[65,60]});
	plot(x,y,{"thick"=1.5, "scale"=true,"color"=[100,200,100], "series"="Vdco"});
	if(bolShowmppt_low){
		plot(xlow,ylow,{"thick"=1.5, "scale"=true, "color"=[100,100,200], "series"="Mppt-low"});
	}
	if(bolShowmppt_hi){
		plot(xhi,yhi,{"thick"=1.5, "scale"=true, "color"=[200,100,100], "series"="Mppt-hi"});
	}
	axis('x1', {'label'='% of Rated Output Power', 'min'=0, 'max'=100});
	axis('y1', {'label'='Efficiency (%)', 'min'=70, 'max'=100});
}

function show_mppt_msg() {
	show_msg = value('inv_snl_num_mppt') > 4 || value('inv_snl_num_mppt') < 1;
	show( 'msg_mppt', show_msg );
	refresh();
}

function inverter_not_available_msg() {
	if( librarygetcurrentselection('inv_snl_inverter_name') == '' )
	{
		old_name = value( 'inv_snl_inverter_name' );
		librarynotifytext('inv_snl_inverter_name', 'Please choose an inverter. ' + old_name + ' is not available in the library.');
	}
}

on_load{"Inverter CEC Database"} = define()
{
	value( 'inv_cec_name', value( 'inv_snl_inverter_name' ) );
	plot_inverter_curve();
	show_mppt_msg();
	inverter_not_available_msg();
};

on_change{'inv_snl_inverter_name'} = define()
{
	if( librarygetcurrentselection( 'inv_snl_inverter_name' ) != '' )
	{
		value( 'inv_cec_name', value('inv_snl_inverter_name') );
	}	
	plot_inverter_curve();
	show_mppt_msg();
};

on_change{'inv_snl_num_mppt'} = define()
{
	show_mppt_msg();
};
