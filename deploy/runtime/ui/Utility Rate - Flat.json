{
    "Name": "Utility Rate - Flat",
    "Width": 1413.0,
    "Height": 567.0,
    "FormObjects": {
        "GroupBox": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "GroupBox10"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 9.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 3.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 1403.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 129.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "OpenEI U.S. Utility Rate Database"
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 1.0
                }
            }
        },
        "GroupBox": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "GroupBox2"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 9.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 492.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 565.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 70.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "Minimum Charges"
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 1.0
                }
            }
        },
        "GroupBox": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "GroupBox218"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 9.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 144.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 1403.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 66.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "Save / Load Rate Data"
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 1.0
                }
            }
        },
        "GroupBox": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "GroupBox7"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 9.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 441.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 565.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 51.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "Fixed Charge"
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 1.0
                }
            }
        },
        "GroupBox": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "GroupBox71"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 9.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 210.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 1403.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 225.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "Metering and Billing"
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 1.0
                }
            }
        },
        "GroupBox": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "GroupBox9"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 576.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 441.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 833.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 120.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "Annual Escalation"
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 1.0
                }
            }
        },
        "Label": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "Label4"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 606.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 492.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 791.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 61.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "In Value mode, enter a rate in real terms because SAM applies both escalation and inflation to the total first-year electricity bill to calculate the annual electricity bill in later years. In Schedule mode, enter rates in nominal terms because inflation does not apply. See Help for details."
                },
                "TextColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "FontSize": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "WordWrap": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "AlignRight": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "AlignTop": {
                    "Type": 2.0,
                    "Boolean": 1.0
                }
            }
        },
        "Label": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "Label41"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 27.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 1380.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 46.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "Download rate structures for electric utility companies included in the OpenEI Utility Rate Database. After downloading a rate structure, compare the inputs below with a copy of the rate sheet to verify that the information is correct."
                },
                "TextColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "FontSize": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "WordWrap": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "AlignRight": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "AlignTop": {
                    "Type": 2.0,
                    "Boolean": 1.0
                }
            }
        },
        "Button": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "btnLoadRateData"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 183.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 168.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 153.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 28.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "Load rate from file..."
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": -1.0
                }
            }
        },
        "Button": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "btnQueryOpenEI"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 108.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 78.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 227.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 39.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "Search for rates..."
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 0.0
                }
            }
        },
        "Button": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "btnSaveRateData"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 168.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 153.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 28.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "Save rate to file..."
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": -1.0
                }
            }
        },
        "Label": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "lbl_metering_option"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 18.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 369.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 622.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 58.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "For front-of-meter systems, only the Buy All / Sell All metering option is available to define energy buy rates for electricity purchases to charge the battery, meet inverter nighttime consumption, solar field freeze protection, or any other electricity required when the system is not generating electricity."
                },
                "TextColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "FontSize": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "WordWrap": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "AlignRight": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "AlignTop": {
                    "Type": 2.0,
                    "Boolean": 1.0
                }
            }
        },
        "Label": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "msg_unused_items"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 393.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 105.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 737.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "This rate from the URDB contains items that SAM's electricity bill calculator does not consider. See Unused Items below."
                },
                "TextColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "FontSize": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "WordWrap": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "AlignRight": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "AlignTop": {
                    "Type": 2.0,
                    "Boolean": 1.0
                }
            }
        },
        "SchedNumeric": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "rate_escalation"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 873.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 465.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 75.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 21.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Label": {
                    "Type": 5.0,
                    "String": "Value"
                },
                "UseSchedule": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "ScheduleOnly": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "FixedLength": {
                    "Type": 3.0,
                    "Integer": -1.0
                },
                "Description": {
                    "Type": 5.0,
                    "String": "Type an escalation rate (%) for each year. Each year's rate applies to the first-year electricity cost. Inflation does not apply."
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 8.0
                }
            }
        },
        "Numeric": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "ur_annual_min_charge"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 231.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 531.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 75.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Value": {
                    "Type": 1.0,
                    "Double": 0.0
                },
                "Mode": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Format": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Decimals": {
                    "Type": 3.0,
                    "Integer": 3.0
                },
                "Prefix": {
                    "Type": 5.0,
                    "String": ""
                },
                "Suffix": {
                    "Type": 5.0,
                    "String": ""
                },
                "ThousandsSep": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 11.0
                }
            }
        },
        "CheckBox": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "ur_en_ts_buy_rate"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 657.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 345.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 348.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "Use hourly (subhourly) buy rates instead of TOU rates"
                },
                "State": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": -1.0
                }
            }
        },
        "CheckBox": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "ur_en_ts_sell_rate"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 657.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 288.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 348.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "Use hourly (subhourly) sell rates instead of TOU rates"
                },
                "State": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": -1.0
                }
            }
        },
        "RadioChoice": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "ur_metering_option"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 18.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 237.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 346.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 128.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Selection": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "Items": {
                    "Type": 6.0,
                    "StringList": "Net energy metering|Net energy metering with $ credits|Net billing|Net billing with carryover to next month|Buy all / sell all"
                },
                "ShowCaptions": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "Horizontal": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": -1.0
                }
            }
        },
        "Numeric": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "ur_monthly_fixed_charge"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 231.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 456.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 75.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Value": {
                    "Type": 1.0,
                    "Double": 0.0
                },
                "Mode": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Format": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Decimals": {
                    "Type": 3.0,
                    "Integer": 3.0
                },
                "Prefix": {
                    "Type": 5.0,
                    "String": ""
                },
                "Suffix": {
                    "Type": 5.0,
                    "String": ""
                },
                "ThousandsSep": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 7.0
                }
            }
        },
        "Numeric": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "ur_monthly_min_charge"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 231.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 504.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 75.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Value": {
                    "Type": 1.0,
                    "Double": 0.0
                },
                "Mode": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Format": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Decimals": {
                    "Type": 3.0,
                    "Integer": 3.0
                },
                "Prefix": {
                    "Type": 5.0,
                    "String": ""
                },
                "Suffix": {
                    "Type": 5.0,
                    "String": ""
                },
                "ThousandsSep": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 10.0
                }
            }
        },
        "CheckBox": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "ur_nb_apply_credit_current_month"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 1008.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 288.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 391.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "Apply earned credits to current month before roll over"
                },
                "State": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": -1.0
                }
            }
        },
        "CheckBox": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "ur_nb_credit_expire"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 1008.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 261.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 390.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "Accrued credits expire at end of true-up period"
                },
                "State": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": -1.0
                }
            }
        },
        "Choice": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "ur_nm_credit_month"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 858.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 255.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 99.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 28.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Items": {
                    "Type": 6.0,
                    "StringList": "Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec"
                },
                "Selection": {
                    "Type": 3.0,
                    "Integer": 11.0
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": -1.0
                }
            }
        },
        "CheckBox": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "ur_nm_credit_rollover"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 1008.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 234.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 390.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "Roll over net excess compensation to future bills"
                },
                "State": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": -1.0
                }
            }
        },
        "Numeric": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "ur_nm_yearend_sell_rate"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 858.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 228.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 75.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Value": {
                    "Type": 1.0,
                    "Double": 0.0
                },
                "Mode": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Format": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Decimals": {
                    "Type": 3.0,
                    "Integer": 3.0
                },
                "Prefix": {
                    "Type": 5.0,
                    "String": ""
                },
                "Suffix": {
                    "Type": 5.0,
                    "String": ""
                },
                "ThousandsSep": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 11.0
                }
            }
        },
        "Hyperlink": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "ur_rate_url"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 393.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 78.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 737.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "Go to Open EI Utility Rate Database website..."
                },
                "URL": {
                    "Type": 5.0,
                    "String": "http://en.openei.org/wiki/Utility_Rate_Database"
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": -1.0
                }
            }
        },
        "TextEntry": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "ur_ratedata_filename"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 345.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 168.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 617.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 28.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Text": {
                    "Type": 5.0,
                    "String": ""
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": -1.0
                }
            }
        },
        "DataArray": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "ur_ts_buy_rate"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 858.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 372.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 184.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 28.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Mode": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Label": {
                    "Type": 5.0,
                    "String": "Buy Rate ($/kWh)"
                },
                "Description": {
                    "Type": 5.0,
                    "String": "An array of $/kWh buy rates for each time step."
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 3.0
                }
            }
        },
        "DataArray": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "ur_ts_sell_rate"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 858.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 315.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 184.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 28.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Mode": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Label": {
                    "Type": 5.0,
                    "String": "Sell Rate ($/kWh)"
                },
                "Description": {
                    "Type": 5.0,
                    "String": "An array of $/kWh sell rates for each time step."
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 3.0
                }
            }
        }
    },
    "VarDatabase": {
        "is_btm": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Behind-the-meter battery flag",
            "Units": " ",
            "Group": "Electricity Rates - General",
            "IndexLabels": "",
            "Flags": 9.0,
            "DefaultValue": 0.0,
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "rate_escalation": {
            "Version": 4.0,
            "Type": 2.0,
            "Label": "Electricity bill escalation rate",
            "Units": "%/yr",
            "Group": "Electricity Rates - General",
            "IndexLabels": "",
            "Flags": 2.0,
            "DefaultValue": [
                0.0
            ],
            "UIObject": "SchedNumeric",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "ur_annual_min_charge": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Annual minimum charge",
            "Units": "$",
            "Group": "Electricity Rates - General",
            "IndexLabels": "",
            "Flags": 2.0,
            "DefaultValue": 0.0,
            "UIObject": "Numeric",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "ur_en_ts_buy_rate": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Enable time step buy rates",
            "Units": " ",
            "Group": "Electricity Rates - General",
            "IndexLabels": "",
            "Flags": 1.0,
            "DefaultValue": 0.0,
            "UIObject": "CheckBox",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "ur_en_ts_sell_rate": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Enable time step sell rates",
            "Units": " ",
            "Group": "Electricity Rates - General",
            "IndexLabels": "",
            "Flags": 1.0,
            "DefaultValue": 0.0,
            "UIObject": "CheckBox",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "ur_has_unused_items": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "URDB unused items",
            "Units": " ",
            "Group": "Electricity Rates - General",
            "IndexLabels": "",
            "Flags": 4.0,
            "DefaultValue": 0.0,
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "ur_metering_option": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Metering option",
            "Units": " ",
            "Group": "Electricity Rates - General",
            "IndexLabels": "Net energy metering|Net energy metering with $ credits|Net billing|Net billing with carryover to next month|Buy all / sell all",
            "Flags": 3.0,
            "DefaultValue": 0.0,
            "UIObject": "RadioChoice",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "ur_monthly_fixed_charge": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Fixed monthly charge",
            "Units": "$",
            "Group": "Electricity Rates - General",
            "IndexLabels": "",
            "Flags": 2.0,
            "DefaultValue": 0.0,
            "UIObject": "Numeric",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "ur_monthly_min_charge": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Monthly minimum charge",
            "Units": "$",
            "Group": "Electricity Rates - General",
            "IndexLabels": "",
            "Flags": 2.0,
            "DefaultValue": 0.0,
            "UIObject": "Numeric",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "ur_nb_apply_credit_current_month": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Apply earned credits to current month before roll over",
            "Units": "",
            "Group": "Electricity Rates - General",
            "IndexLabels": "",
            "Flags": 3.0,
            "DefaultValue": 0.0,
            "UIObject": "CheckBox",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "ur_nb_credit_expire": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Accrued credits expire at end of true-up period",
            "Units": "",
            "Group": "Electricity Rates - General",
            "IndexLabels": "",
            "Flags": 3.0,
            "DefaultValue": 0.0,
            "UIObject": "CheckBox",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "ur_nm_credit_month": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Month for end of true-up period",
            "Units": " ",
            "Group": "Electricity Rates - General",
            "IndexLabels": "Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec",
            "Flags": 2.0,
            "DefaultValue": 0.0,
            "UIObject": "Choice",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "ur_nm_credit_rollover": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Roll over net excess compensation to future bills",
            "Units": " ",
            "Group": "Electricity Rates - General",
            "IndexLabels": "",
            "Flags": 3.0,
            "DefaultValue": 0.0,
            "UIObject": "CheckBox",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "ur_nm_yearend_sell_rate": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Compensation rate for net excess generation",
            "Units": "$/kWh",
            "Group": "Electricity Rates - General",
            "IndexLabels": "",
            "Flags": 2.0,
            "DefaultValue": 0.0,
            "UIObject": "Numeric",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "ur_ratedata_filename": {
            "Version": 4.0,
            "Type": 4.0,
            "Label": "Electricity rate file",
            "Units": " ",
            "Group": "Electricity Rates - General",
            "IndexLabels": "",
            "Flags": 9.0,
            "DefaultValue": "",
            "UIObject": "TextEntry",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "ur_ts_buy_rate": {
            "Version": 4.0,
            "Type": 2.0,
            "Label": "Hourly (subhourly) buy rates",
            "Units": "$/kWh",
            "Group": "Electricity Rates - General",
            "IndexLabels": "Buy Rate ($/kWh)|1",
            "Flags": 0.0,
            "DefaultValue": [
                0.0
            ],
            "UIObject": "DataArray",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "ur_ts_sell_rate": {
            "Version": 4.0,
            "Type": 2.0,
            "Label": "Hourly (subhourly) sell rates",
            "Units": "$/kWh",
            "Group": "Electricity Rates - General",
            "IndexLabels": "Sell Rate ($/kWh)|1",
            "Flags": 0.0,
            "DefaultValue": [
                0.0
            ],
            "UIObject": "DataArray",
            "sscVariableName": "",
            "sscVariableValue": ""
        }
    },
    "Equations": [],
    "Callbacks": [
        "on_load{'Utility Rate - Flat'} = define(){",
        "\tset_metering_billing_inputs(); ",
        "\tshow('msg_unused_items', value('ur_has_unused_items'));",
        "\trefresh();",
        "};",
        "",
        "function is_fom_bool()",
        "{",
        "\t/*",
        "\tis_batt_tech = ( technology() == 'PV Battery' ",
        "\t\t\t\t\t|| technology() == 'Generic Battery' ",
        "\t\t\t\t\t|| technology() == 'Fuel Cell');",
        "\t*/",
        "\t//No longer just for batteries",
        "\tis_fom = ( financing() == 'Single Owner'",
        "\t\t\t\t|| financing() == 'Sale Leaseback'",
        "\t\t\t\t|| financing() == 'Leveraged Partnership Flip'",
        "\t\t\t\t|| financing() == 'All Equity Partnership Flip');",
        "\treturn ( is_fom );",
        "}",
        "",
        "function is_merchant_plant() ",
        "{",
        "\tis_mp = financing() == \"Merchant Plant\";",
        "\treturn (is_mp);",
        "}",
        "\r",
        "function is_iph()\r",
        "{\r",
        "\ttech = technology();\r",
        "\tis_iph_bool = false;\r",
        "\tif (tech == \"Physical Trough IPH\"\r",
        "\t\t\t|| tech == \"MSPT IPH\"\r",
        "\t\t\t|| tech == \"MSLF IPH\"\r",
        "\t\t\t|| tech == \"DSGL IPH\")\r",
        "\t{\r",
        "\t\tis_iph_bool = true;\r",
        "\t}\r",
        "\treturn is_iph_bool;\r",
        "}\r",
        "",
        "// set inputs on Utility Rate - Energy Charge form",
        "// based on values of inputs on Utility Rate - Flat form",
        "// NOTE: This function is also called on Utility Rate - Energy Charge form",
        "function set_ec_schedule_inputs()",
        "{\t",
        "\teme = value('ur_metering_option');",
        "\ten_ts_buy = value('ur_en_ts_buy_rate');",
        "\ten_ts_sell = value('ur_en_ts_sell_rate');",
        "\tif (eme==0) // net energy metering",
        "\t{",
        "\t\tproperty('ur_ec_tou_mat','ShowColumn',4);",
        "\t\tproperty('ur_ec_tou_mat','HideColumn',5);",
        "\t}",
        "\telseif (eme==1) // net energy metering with $ credits",
        "\t{",
        "\t\tproperty('ur_ec_tou_mat','ShowColumn',4);",
        "\t\tproperty('ur_ec_tou_mat','ShowColumn',5);",
        "\t}",
        "\telse // net billing (both options), buy all / sell all",
        "\t{",
        "\t\tif (en_ts_buy)",
        "\t\t{",
        "\t\t\tproperty('ur_ec_tou_mat','HideColumn',4);",
        "\t\t}",
        "\t\telse",
        "\t\t{",
        "\t\t\tproperty('ur_ec_tou_mat','ShowColumn',4);",
        "\t\t}",
        "\t\tif (en_ts_sell || is_fom_bool() || is_merchant_plant() || is_iph())",
        "\t\t{",
        "\t\t\tproperty('ur_ec_tou_mat','HideColumn',5);",
        "\t\t}",
        "\t\telseif ( !is_fom_bool() || !is_merchant_plant() || !is_iph())",
        "\t\t{",
        "\t\t\tproperty('ur_ec_tou_mat','ShowColumn',5);",
        "\t\t}",
        "\t}",
        "\tif (en_ts_sell && en_ts_buy)",
        "\t{",
        "\t\tenable( 'ur_ec_tou_mat', false);",
        "\t\tenable( 'ur_ec_sched_weekday', false);",
        "\t\tenable( 'ur_ec_sched_weekend', false);",
        "\t\tenable( 'lbl_wkday', false);",
        "\t\tenable( 'lbl_wkend', false);",
        "\t}",
        "\telse // no time series buy or sell rates",
        "\t{",
        "\t\tenable( 'ur_ec_tou_mat', true);",
        "\t\tenable( 'ur_ec_sched_weekday', true);",
        "\t\tenable( 'ur_ec_sched_weekend', true);",
        "\t\tenable( 'lbl_wkday', true);",
        "\t\tenable( 'lbl_wkend', true);",
        "\t}\t",
        "}",
        "",
        "function set_metering_billing_inputs()",
        "{\t",
        "\teme = value('ur_metering_option');",
        "\tenable('ur_metering_option', !is_fom_bool() && !is_merchant_plant() && !is_iph());",
        "\tenable('ur_en_ts_sell_rate', !is_fom_bool() && !is_merchant_plant() && !is_iph());",
        "\tenable('ur_ts_sell_rate', !is_fom_bool() && !is_merchant_plant() && !is_iph());",
        "\tshow('lbl_metering_option',is_fom_bool() && !is_merchant_plant() && is_iph());",
        "\tenable( 'ur_nm_yearend_sell_rate', eme==0 );",
        "\tenable( 'ur_nm_credit_rollover', eme==0 );",
        "\tenable( 'ur_nm_credit_month', eme==0 || eme==1 || eme==3 );\r",
        "\tenable( 'ur_nb_credit_expire', eme==3 );\r",
        "\tenable( 'ur_nb_apply_credit_current_month', eme==3 );",
        "\tif (eme==2 || eme==3|| eme==4)",
        "\t{",
        "\t\tenable( 'ur_en_ts_sell_rate', !is_fom_bool() && !is_merchant_plant() && !is_iph() );",
        "\t\tenable( 'ur_ts_sell_rate', value('ur_en_ts_sell_rate') && (!is_fom_bool() && !is_merchant_plant() && !is_iph()) );",
        "\t\tenable( 'ur_en_ts_buy_rate', true );",
        "\t\tenable( 'ur_ts_buy_rate', value('ur_en_ts_buy_rate') );",
        "\t}",
        "\telse // net energy metering",
        "\t{",
        "\t\tenable( 'ur_ts_sell_rate', false );",
        "\t\tenable( 'ur_ts_buy_rate', false );",
        "\t\tenable( 'ur_en_ts_sell_rate', false );",
        "\t\tenable( 'ur_en_ts_buy_rate', false );",
        "\t}",
        "}",
        "",
        "on_change{'ur_en_ts_sell_rate'} = define()",
        "{",
        "\tset_metering_billing_inputs();",
        "\tset_ec_schedule_inputs();",
        "\trefresh();",
        "};",
        "",
        "on_change{'ur_en_ts_buy_rate'} = define()",
        "{",
        "\tset_metering_billing_inputs();",
        "\tset_ec_schedule_inputs();",
        "\trefresh();",
        "};",
        "",
        "on_change{'ur_metering_option'} = define()",
        "{",
        "\tset_metering_billing_inputs();",
        "\tset_ec_schedule_inputs();",
        "\teme = value('ur_metering_option');",
        "\tif (eme == 0 || eme == 1) ",
        "\t{",
        "\t\t// Disable these so we don't get an exception",
        "\t\t// Can't do this in ur_flat_buy_sell_rates without creating an infinite loop",
        "\t\tvalue( 'ur_en_ts_buy_rate', false );",
        "\t\tvalue( 'ur_en_ts_sell_rate', false );",
        "\t}",
        "\trefresh();",
        "};",
        "",
        "on_change{'btnSaveRateData'} = define() {",
        "\tlogmsg('running btnSaveRateData');",
        "\tfile = choose_file( '', 'Save Utility Rate Data As', ",
        "\t\t'Rate Files (*.csv)|*.csv', true);",
        "\t\t",
        "\tif ( file != '' ) {",
        "\t\tfile = replace(file, '\\\\', '/');",
        "\t\tif (urdb_write(file))",
        "\t\t{\t",
        "\t\t\tvalue( 'ur_ratedata_filename', file );",
        "\t\t\tmsgbox('Rate saved! \\n');",
        "\t\t}",
        "\t\telse",
        "\t\t{",
        "\t\t\tvalue( 'ur_ratedata_filename', '' );",
        "\t\t\tmsgbox('Failed to save rate data to CSV file!\\n');",
        "\t\t}",
        "\t}",
        "};",
        "",
        "on_change{'btnLoadRateData'} = define() {",
        "\tlogmsg('running btnLoadRateData');",
        "\tfile = choose_file( '', 'Choose a rate data file to load', ",
        "\t\t'Rate Files (*.csv)|*.csv');",
        "\t\t",
        "\tif ( file != '' ) {",
        "\t\tfile = replace(file, '\\\\', '/');",
        "\t\tif (urdb_read(file))",
        "\t\t{\t",
        "\t\t\tvalue( 'ur_ratedata_filename', file );",
        "\t\t\t// check energy charge max usage units",
        "\t\t\tM = value( 'ur_ec_tou_mat' );",
        "\t\t\tmax_usage_units_msg = '';",
        "\t\t\tfor ( i=0; i<#M; i++ )",
        "\t\t\t{",
        "\t\t\t\tif ( M[i][3] < 0 )",
        "\t\t\t\t{",
        "\t\t\t\t\tmax_usage_units_msg = 'Maximum usage units for energy charge table in imported file was invalid (' + M[i][3] + ') for one or more periods or tiers. Value changed to zero (kWh)';",
        "\t\t\t\t\tM[i][3] = 0;",
        "\t\t\t\t}",
        "\t\t\t}",
        "\t\t\tif ( max_usage_units_msg != '' ) { value( 'ur_ec_tou_mat', M ); \t}",
        "\t\t\tmsgbox('Rate loaded!\\n' + max_usage_units_msg);",
        "\t\t}",
        "\t\telse",
        "\t\t{",
        "\t\t\tvalue( 'ur_ratedata_filename', '' );",
        "\t\t\tmsgbox('Failed to load rate data from file!\\nPlease check that it is correctly formatted. You can save the current rate to file to see what the file format looks like.');",
        "\t\t}",
        "\t\tif ( value('ur_metering_option') != 4 && is_fom_bool() )",
        "\t\t{",
        "\t\t\tmetering_options = ['Net energy metering','Net Energy Metering with $ Credits','Net Billing','Net Billing with Carryover to Next Month','Buy All / Sell All'];",
        "\t\t\tmsgbox('Metering option not valid for FOM Battery!\\nThe rate data you are loading uses the ' + metering_options[value('ur_metering_option')] + ' metering option. Front-of-meter systems with storage require the Buy All / Sell All metering option with no sell rates. Changing metering option to Buy All / Sell All. Please check the rate data to verify that it is appropriate for your analysis.');",
        "\t\t\tvalue('ur_metering_option',4);",
        "\t\t}",
        "",
        "\t}",
        "};",
        "",
        "on_change{'btnQueryOpenEI'} = define() {",
        "\tlogmsg('running btnQueryOpenEI');",
        "\tguid = openeiutilityrateform();",
        "\tif ( guid == '' ) return;",
        "\thash = urdb_get(guid);",
        "\t// meta data",
        "\tvalue ('ur_utility', hash{'utility'});",
        "\tvalue ('ur_name', hash{'name'});",
        "\tvalue ('ur_source', hash{'source'});",
        "\t",
        "\tvalue ('ur_description', hash{'description'}",
        "\t +\thash{'basicinformationcomments'}",
        "\t +\thash{'energycomments'}",
        "\t +\thash{'demandcomments'});",
        "\t",
        "\tvalue ('ur_start_date', hash{'start_date'});",
        "\tvalue ('ur_end_date', hash{'end_date'});",
        "\tvalue ('ur_uri', hash{'rateurl'});",
        "\t",
        "\tvalue( 'ur_rate_notes',hash{'ratenotes'});",
        "\t",
        "\t// applicability",
        "\tvalue('ur_demand_min',hash{'peakkwcapacitymin'});",
        "\tvalue('ur_demand_max',hash{'peakkwcapacitymax'});",
        "\tvalue('ur_demand_history',hash{'peakkwcapacityhistory'});",
        "",
        "\tvalue('ur_energy_min',hash{'peakkwhusagemin'});",
        "\tvalue('ur_energy_max',hash{'peakkwhusagemax'});",
        "\tvalue('ur_energy_history',hash{'peakkwhusagehistory'});",
        "",
        "\tvalue('ur_voltage_min',hash{'voltageminimum'});",
        "\tvalue('ur_voltage_max',hash{'voltagemaximum'});",
        "\t",
        "\tvalue('ur_voltage_category',hash{'voltagecategory'});",
        "\tvalue('ur_phase_wiring',hash{'phasewiring'});",
        "",
        "\t// urls update hyperlink",
        "\tproperty( 'ur_rate_url', 'caption', hash{'rateurl'} );",
        "\tproperty( 'ur_rate_url', 'url', hash{'rateurl'} );",
        "\tproperty( 'ur_rate_json_url', 'caption', hash{'jsonurl'} );",
        "\tproperty( 'ur_rate_json_url', 'url', hash{'jsonurl'} );",
        "",
        "\t// fixed charges",
        "\tvalue ('ur_monthly_fixed_charge', hash{'monthly_fixed_charge'});",
        "\t",
        "\t// minimum charges",
        "\tvalue ('ur_monthly_min_charge', hash{'monthly_min_charge'});",
        "\tvalue ('ur_annual_min_charge', hash{'annual_min_charge'});",
        "\t",
        "\t// metering option",
        "\tif ( !is_fom_bool()  && !is_iph()) {value('ur_metering_option',hash{'metering_option'});\t}",
        "\tvalue( 'ur_dc_enable', hash{'dc_enable'});",
        "\ton_change{'ur_dc_enable'}(); // invoke callback for ur_ec_enable to set up enable/disable of widgets",
        "\t",
        "\t// schedules",
        "\tvalue ('ur_ec_sched_weekday', hash{'ec_sched_weekday'});",
        "\tvalue ('ur_ec_sched_weekend', hash{'ec_sched_weekend'});",
        "\tvalue ('ur_dc_sched_weekday', hash{'dc_sched_weekday'});",
        "\tvalue ('ur_dc_sched_weekend', hash{'dc_sched_weekend'});",
        "",
        "\tvalue('ur_ec_tou_mat', hash{'ec_tou_mat'});",
        "\tvalue('ur_dc_tou_mat', hash{'dc_tou_mat'});",
        "\tvalue('ur_dc_flat_mat', hash{'dc_flat_mat'});",
        "",
        "\t// billing demand",
        "\tlbm = [];",
        "\tfor ( i=0; i<12; i++ )",
        "\t{",
        "\t\tlbm[i] = hash{'lookbackmonths'+to_string(i)};",
        "\t}",
        "\tlbp = [];",
        "\tfor ( i=0; i<12; i++ )",
        "\t{",
        "\t\tif (lbm[i]) {",
        "\t\t\tlbp[i][0] = hash{'lookbackpercent'};",
        "\t\t}",
        "\t\telse {",
        "\t\t\tlbp[i][0] = 0;",
        "\t\t}",
        "\t\tlbp[i][1] = 0;",
        "\t}\t",
        "\tvalue('ur_billing_demand_lookback_percentages',lbp);",
        "\tvalue('ur_billing_demand_lookback_period',hash{'lookbackrange'});",
        "\thas_billing_demand_adjustments = ( hash{'lookbackpercent'} > 0 || hash{'lookbackrange'} > 0 ); ",
        "\t",
        "\tif (has_billing_demand_adjustments) {",
        "\t\t// Find the maximum period number",
        "\t\tdc_tou_mat = value('ur_dc_tou_mat');",
        "\t\trows = #dc_tou_mat;",
        "\t\tmax_period = 0;",
        "\t\tfor (i=0; i < rows; i++) {",
        "\t\t\tperiod_num = dc_tou_mat[i][0];",
        "\t\t\tif (period_num > max_period){",
        "\t\t\t\tmax_period = period_num;",
        "\t\t\t}",
        "\t\t}",
        "\t\t",
        "\t\t// Create ur_dc_billing_demand_periods with that number of rows",
        "\t\tdc_billing_demand_periods = [];",
        "\t\tfor (i=0; i < max_period; i++) {",
        "\t\t\tdc_billing_demand_periods[i][0] = i + 1; // Period numbers are 1 indexed",
        "\t\t\tdc_billing_demand_periods[i][1] = 1; // Assume all perionds are included in billing demand (not represented in URDB as of V8)",
        "\t\t}",
        "\t\tvalue('ur_dc_billing_demand_periods', dc_billing_demand_periods);",
        "\t}",
        "\t",
        "\t// unused items",
        "\tvalue('ur_has_unused_items',hash{'hasunuseditems'});",
        "\tvalue('ur_is_default',hash{'isdefault'});",
        "\tvalue('ur_service_type',hash{'servicetype'});",
        "\tvalue('ur_demand_window',hash{'demandwindow'});",
        "\tvalue('ur_demand_reactive_power_charge',hash{'demandreactivepowercharge'});",
        "\tarr = [];",
        "\tfor ( i=0; i<12; i++ )",
        "\t{",
        "\t\tarr[i] = hash{'fueladjustmentsmonthly'+to_string(i)};",
        "\t}",
        "\tvalue('ur_fuel_adjustments_monthly', arr);",
        "\tarr = [];",
        "\tvalue('ur_cr_sched', hash{'cr_sched'});",
        "\tvalue('ur_cr_tou_mat', hash{'cr_tou_mat'});",
        "\tvalue('ur_energy_attrs', hash{'energyattrs'});",
        "\tvalue('ur_demand_attrs', hash{'demandattrs'});",
        "\tvalue('ur_fixed_attrs', hash{'fixedattrs'});",
        "\tx = is_demand();",
        "\tvalue('ur_dc_enable', x );",
        "\tx = is_billing_demand();",
        "\tvalue('ur_enable_billing_demand', x );",
        "\tvalue('ur_billing_demand_is_shown', x );",
        "\tshow('msg_unused_items', value('ur_has_unused_items'));",
        "\trefresh();",
        "\tif ( has_billing_demand_adjustments )",
        "\t{",
        "\t\tmsgbox('Billing Demand Notice.\\nThis rate includes billing demand adjustments and/or demand ratchets that may not be accurately reflected in the data downloaded from the URDB. Please check the information in the Description under Description and Applicability and the fields under Unused and review the rate sheet to be sure the billing demand inputs are correct.');",
        "\t\tvalue('ur_billing_demand_minimum',0);",
        "\t\tvalue('ur_desc_is_shown',true);",
        "\t\tvalue('ur_unused_is_shown',true);",
        "\t}",
        "\tmsgbox('Rate data from OpenEI URDB applied!\\n');",
        "};",
        "",
        "function is_demand()",
        "{",
        "\tdc_tou = value('ur_dc_tou_mat');",
        "\tsum_dc_tou = 0;",
        "\tfor ( i=0; i<#dc_tou; i++ )",
        "\t{",
        "\t\tsum_dc_tou += dc_tou[i][3];",
        "\t}",
        "",
        "\tdc_flat = value('ur_dc_flat_mat');",
        "\tsum_dc_flat = 0;",
        "\tfor ( i=0; i<#dc_flat; i++ )",
        "\t{",
        "\t\tsum_dc_tou += dc_flat[i][3];",
        "\t}",
        "",
        "\treturn ( sum_dc_tou + sum_dc_flat ) > 0;",
        "}",
        "",
        "function is_billing_demand()",
        "{",
        "\tbd = value('ur_billing_demand_lookback_percentages');",
        "\tsum_bd = 0;",
        "\tfor ( i=0; i<#bd; i++ )",
        "\t{",
        "\t\tsum_bd += bd[i][0];",
        "\t}",
        "\treturn sum_bd > 0;",
        "}"
    ]
}