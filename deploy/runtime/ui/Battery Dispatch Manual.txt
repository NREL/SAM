Battery Dispatch Manual
1053
645
66
Label

1
13
Name
5
31
AllowChargeFromExcessSolarLabel
X
3
135
Y
3
69
Width
3
78
Height
3
42
Tool Tip
5
0
Caption
5
18
Charge from system
TextColour
4
0
0
0
255
Bold
2
1
FontSize
3
0
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Label

1
13
Name
5
15
Battery_weekday
X
3
21
Y
3
336
Width
3
483
Height
3
21
Tool Tip
5
0
Caption
5
8
Weekday 
TextColour
4
0
0
0
255
Bold
2
1
FontSize
3
0
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Label

1
13
Name
5
15
Battery_weekend
X
3
561
Y
3
336
Width
3
483
Height
3
21
Tool Tip
5
0
Caption
5
7
Weekend
TextColour
4
0
0
0
255
Bold
2
1
FontSize
3
0
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Label

1
13
Name
5
18
ForceChargingLabel
X
3
237
Y
3
69
Width
3
132
Height
3
21
Tool Tip
5
0
Caption
5
16
Charge from grid
TextColour
4
0
0
0
255
Bold
2
1
FontSize
3
0
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Label

1
13
Name
5
31
Percent of rated to discharge22
X
3
438
Y
3
90
Width
3
65
Height
3
21
Tool Tip
5
0
Caption
5
8
Rate (%)
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
Label

1
13
Name
5
31
Percent of rated to discharge37
X
3
282
Y
3
90
Width
3
65
Height
3
21
Tool Tip
5
0
Caption
5
8
Rate (%)
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
Label

1
13
Name
5
7
Period1
X
3
60
Y
3
111
Width
3
69
Height
3
24
Tool Tip
5
0
Caption
5
9
Period 1:
TextColour
4
112
219
47
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
Label

1
13
Name
5
7
Period2
X
3
60
Y
3
138
Width
3
69
Height
3
24
Tool Tip
5
0
Caption
5
9
Period 2:
TextColour
4
95
159
159
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
Label

1
13
Name
5
7
Period3
X
3
60
Y
3
165
Width
3
69
Height
3
24
Tool Tip
5
0
Caption
5
9
Period 3:
TextColour
4
142
107
35
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
Label

1
13
Name
5
7
Period4
X
3
60
Y
3
192
Width
3
69
Height
3
24
Tool Tip
5
0
Caption
5
9
Period 4:
TextColour
4
35
142
107
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
Label

1
13
Name
5
7
Period5
X
3
60
Y
3
219
Width
3
69
Height
3
24
Tool Tip
5
0
Caption
5
9
Period 5:
TextColour
4
234
234
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
Label

1
13
Name
5
7
Period6
X
3
60
Y
3
246
Width
3
69
Height
3
24
Tool Tip
5
0
Caption
5
9
Period 6:
TextColour
4
128
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
Numeric

1
17
Name
5
24
batt_discharge_percent_1
X
3
438
Y
3
111
Width
3
42
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
5
Numeric

1
17
Name
5
24
batt_discharge_percent_2
X
3
438
Y
3
138
Width
3
42
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
10
Numeric

1
17
Name
5
24
batt_discharge_percent_3
X
3
438
Y
3
165
Width
3
42
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
15
Numeric

1
17
Name
5
24
batt_discharge_percent_4
X
3
438
Y
3
192
Width
3
42
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
20
Numeric

1
17
Name
5
24
batt_discharge_percent_5
X
3
438
Y
3
219
Width
3
42
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
25
Numeric

1
17
Name
5
24
batt_discharge_percent_6
X
3
438
Y
3
246
Width
3
42
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
30
Numeric

1
17
Name
5
25
batt_gridcharge_percent_1
X
3
282
Y
3
111
Width
3
42
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
3
Numeric

1
17
Name
5
25
batt_gridcharge_percent_2
X
3
282
Y
3
138
Width
3
42
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
8
Numeric

1
17
Name
5
25
batt_gridcharge_percent_3
X
3
282
Y
3
165
Width
3
42
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
13
Numeric

1
17
Name
5
25
batt_gridcharge_percent_4
X
3
282
Y
3
192
Width
3
42
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
18
Numeric

1
17
Name
5
25
batt_gridcharge_percent_5
X
3
282
Y
3
219
Width
3
42
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
23
Numeric

1
17
Name
5
25
batt_gridcharge_percent_6
X
3
282
Y
3
246
Width
3
42
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
28
Label

1
13
Name
5
26
batt_manual_dispatch_label
X
3
15
Y
3
24
Width
3
1012
Height
3
36
Tool Tip
5
0
Caption
5
250
For each dispatch period, choose options to allow charging or discharging, and set the charge/discharge rate as a percent of available storage capacity. Use the Weekday and Weekend schedules to define the times for each of up to six dispatch periods.
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Button

1
8
Name
5
17
btn_copy_schedule
X
3
24
Y
3
294
Width
3
363
Height
3
24
Tool Tip
5
0
Caption
5
33
Copy Schedules from TOU Schedules
TabOrder
3
33
DiurnalPeriod

1
10
Name
5
21
dispatch_manual_sched
X
3
21
Y
3
357
Width
3
483
Height
3
270
Tool Tip
5
0
TabOrder
3
31
Schedule
5
288
111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
Max
3
9
Min
3
1
DiurnalPeriod

1
10
Name
5
29
dispatch_manual_sched_weekend
X
3
561
Y
3
357
Width
3
483
Height
3
270
Tool Tip
5
0
TabOrder
3
32
Schedule
5
288
111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
Max
3
9
Min
3
1
Label

1
13
Name
5
3
lbl
X
3
237
Y
3
90
Width
3
42
Height
3
21
Tool Tip
5
0
Caption
5
5
Allow
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
Label

1
13
Name
5
17
lbl_copy_schedule
X
3
393
Y
3
294
Width
3
650
Height
3
36
Tool Tip
5
0
Caption
5
164
Use the Copy Schedules button to overwrite the weekday and weekend schedules with schedules from either the energy charge schedules from the Electricity Rates page.
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Label

1
13
Name
5
21
lbl_discharge_options
X
3
393
Y
3
69
Width
3
132
Height
3
21
Tool Tip
5
0
Caption
5
17
Discharge to load
TextColour
4
0
0
0
255
Bold
2
1
FontSize
3
0
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Label

1
13
Name
5
21
lbl_discharge_to_grid
X
3
543
Y
3
69
Width
3
132
Height
3
21
Tool Tip
5
0
Caption
5
17
Discharge to grid
TextColour
4
0
0
0
255
Bold
2
1
FontSize
3
0
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Label

1
13
Name
5
28
lbl_discharge_to_grid_option
X
3
588
Y
3
90
Width
3
65
Height
3
21
Tool Tip
5
0
Caption
5
8
Rate (%)
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
Label

1
13
Name
5
28
lbl_discharge_to_load_option
X
3
393
Y
3
90
Width
3
42
Height
3
21
Tool Tip
5
0
Caption
5
5
Allow
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
Label

1
13
Name
5
21
lbl_to_grid_discharge
X
3
543
Y
3
90
Width
3
42
Height
3
21
Tool Tip
5
0
Caption
5
5
Allow
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
GroupBox

1
8
Name
5
8
object 4
X
3
6
Y
3
3
Width
3
1042
Height
3
633
Tool Tip
5
0
Caption
5
15
Manual Dispatch
Bold
2
1
CheckBox

1
9
Name
5
20
pv.storage.p1.charge
X
3
141
Y
3
111
Width
3
33
Height
3
24
Tool Tip
5
0
Caption
5
0
State
2
1
TabOrder
3
1
CheckBox

1
9
Name
5
23
pv.storage.p1.discharge
X
3
414
Y
3
111
Width
3
21
Height
3
24
Tool Tip
5
0
Caption
5
0
State
2
0
TabOrder
3
4
CheckBox

1
9
Name
5
29
pv.storage.p1.dischargetogrid
X
3
564
Y
3
111
Width
3
21
Height
3
24
Tool Tip
5
0
Caption
5
0
State
2
0
TabOrder
3
4294967295
CheckBox

1
9
Name
5
24
pv.storage.p1.gridcharge
X
3
258
Y
3
111
Width
3
21
Height
3
24
Tool Tip
5
0
Caption
5
0
State
2
0
TabOrder
3
2
CheckBox

1
9
Name
5
20
pv.storage.p2.charge
X
3
141
Y
3
138
Width
3
33
Height
3
24
Tool Tip
5
0
Caption
5
0
State
2
1
TabOrder
3
6
CheckBox

1
9
Name
5
23
pv.storage.p2.discharge
X
3
414
Y
3
138
Width
3
21
Height
3
24
Tool Tip
5
0
Caption
5
0
State
2
0
TabOrder
3
9
CheckBox

1
9
Name
5
29
pv.storage.p2.dischargetogrid
X
3
564
Y
3
138
Width
3
21
Height
3
24
Tool Tip
5
0
Caption
5
0
State
2
0
TabOrder
3
4294967295
CheckBox

1
9
Name
5
24
pv.storage.p2.gridcharge
X
3
258
Y
3
138
Width
3
21
Height
3
24
Tool Tip
5
0
Caption
5
0
State
2
1
TabOrder
3
7
CheckBox

1
9
Name
5
20
pv.storage.p3.charge
X
3
141
Y
3
165
Width
3
33
Height
3
24
Tool Tip
5
0
Caption
5
0
State
2
1
TabOrder
3
11
CheckBox

1
9
Name
5
23
pv.storage.p3.discharge
X
3
414
Y
3
165
Width
3
21
Height
3
24
Tool Tip
5
0
Caption
5
0
State
2
1
TabOrder
3
14
CheckBox

1
9
Name
5
29
pv.storage.p3.dischargetogrid
X
3
564
Y
3
165
Width
3
21
Height
3
24
Tool Tip
5
0
Caption
5
0
State
2
0
TabOrder
3
4294967295
CheckBox

1
9
Name
5
24
pv.storage.p3.gridcharge
X
3
258
Y
3
165
Width
3
21
Height
3
24
Tool Tip
5
0
Caption
5
0
State
2
0
TabOrder
3
12
CheckBox

1
9
Name
5
20
pv.storage.p4.charge
X
3
141
Y
3
192
Width
3
33
Height
3
24
Tool Tip
5
0
Caption
5
0
State
2
0
TabOrder
3
16
CheckBox

1
9
Name
5
23
pv.storage.p4.discharge
X
3
414
Y
3
192
Width
3
21
Height
3
24
Tool Tip
5
0
Caption
5
0
State
2
0
TabOrder
3
19
CheckBox

1
9
Name
5
29
pv.storage.p4.dischargetogrid
X
3
564
Y
3
192
Width
3
21
Height
3
24
Tool Tip
5
0
Caption
5
0
State
2
0
TabOrder
3
4294967295
CheckBox

1
9
Name
5
24
pv.storage.p4.gridcharge
X
3
258
Y
3
192
Width
3
21
Height
3
24
Tool Tip
5
0
Caption
5
0
State
2
0
TabOrder
3
17
CheckBox

1
9
Name
5
20
pv.storage.p5.charge
X
3
141
Y
3
219
Width
3
33
Height
3
24
Tool Tip
5
0
Caption
5
0
State
2
0
TabOrder
3
21
CheckBox

1
9
Name
5
23
pv.storage.p5.discharge
X
3
414
Y
3
219
Width
3
21
Height
3
24
Tool Tip
5
0
Caption
5
0
State
2
0
TabOrder
3
24
CheckBox

1
9
Name
5
29
pv.storage.p5.dischargetogrid
X
3
564
Y
3
219
Width
3
21
Height
3
24
Tool Tip
5
0
Caption
5
0
State
2
0
TabOrder
3
4294967295
CheckBox

1
9
Name
5
24
pv.storage.p5.gridcharge
X
3
258
Y
3
219
Width
3
21
Height
3
24
Tool Tip
5
0
Caption
5
0
State
2
0
TabOrder
3
22
CheckBox

1
9
Name
5
20
pv.storage.p6.charge
X
3
141
Y
3
246
Width
3
33
Height
3
24
Tool Tip
5
0
Caption
5
0
State
2
0
TabOrder
3
26
CheckBox

1
9
Name
5
23
pv.storage.p6.discharge
X
3
414
Y
3
246
Width
3
21
Height
3
24
Tool Tip
5
0
Caption
5
0
State
2
0
TabOrder
3
29
CheckBox

1
9
Name
5
29
pv.storage.p6.dischargetogrid
X
3
564
Y
3
246
Width
3
21
Height
3
24
Tool Tip
5
0
Caption
5
0
State
2
0
TabOrder
3
4294967295
CheckBox

1
9
Name
5
24
pv.storage.p6.gridcharge
X
3
258
Y
3
246
Width
3
21
Height
3
24
Tool Tip
5
0
Caption
5
0
State
2
0
TabOrder
3
27
Numeric

1
17
Name
5
32
ui_copy_batt_discharge_percent_1
X
3
588
Y
3
111
Width
3
42
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
5
Numeric

1
17
Name
5
32
ui_copy_batt_discharge_percent_2
X
3
588
Y
3
138
Width
3
42
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
10
Numeric

1
17
Name
5
32
ui_copy_batt_discharge_percent_3
X
3
588
Y
3
165
Width
3
42
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
15
Numeric

1
17
Name
5
32
ui_copy_batt_discharge_percent_4
X
3
588
Y
3
192
Width
3
42
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
20
Numeric

1
17
Name
5
32
ui_copy_batt_discharge_percent_5
X
3
588
Y
3
219
Width
3
42
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
25
Numeric

1
17
Name
5
32
ui_copy_batt_discharge_percent_6
X
3
588
Y
3
246
Width
3
42
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
30

50
batt_discharge_percent_1
3
1
Battery discharge rate Period 1
%
Battery Dispatch Manual
0
3
1
1
1
1
25
Numeric
batt_discharge_percent_2
3
1
Battery discharge rate Period 2
%
Battery Dispatch Manual
0
3
1
1
1
1
25
Numeric
batt_discharge_percent_3
3
1
Battery discharge rate Period 3
%
Battery Dispatch Manual
0
3
1
1
1
1
25
Numeric
batt_discharge_percent_4
3
1
Battery discharge rate Period 4
%
Battery Dispatch Manual
0
3
1
1
1
1
25
Numeric
batt_discharge_percent_5
3
1
Battery discharge rate Period 5
%
Battery Dispatch Manual
0
3
1
1
1
1
25
Numeric
batt_discharge_percent_6
3
1
Battery discharge rate Period 6
%
Battery Dispatch Manual
0
3
1
1
1
1
25
Numeric
batt_gridcharge_percent_1
3
1
Battery charge from grid rate Period 1
%
Battery Dispatch Manual
0
3
1
1
1
1
100
Numeric
batt_gridcharge_percent_2
3
1
Battery charge from grid rate Period 2
%
Battery Dispatch Manual
0
3
1
1
1
1
100
Numeric
batt_gridcharge_percent_3
3
1
Battery charge from grid rate Period 3
%
Battery Dispatch Manual
0
3
1
1
1
1
100
Numeric
batt_gridcharge_percent_4
3
1
Battery charge from grid rate Period 4
%
Battery Dispatch Manual
0
3
1
1
1
1
100
Numeric
batt_gridcharge_percent_5
3
1
Battery charge from grid rate Period 5
%
Battery Dispatch Manual
0
3
1
1
1
1
100
Numeric
batt_gridcharge_percent_6
3
1
Battery charge from grid rate Period 6
%
Battery Dispatch Manual
0
3
1
1
1
1
100
Numeric
dispatch_manual_btm_discharge_to_grid
3
2
Battery manual allow discharge to grid array
 
Battery Dispatch Manual
0
9
1
2
1
1
0
Default
dispatch_manual_charge
3
2
Battery manual allow charge from system array
 
Battery Dispatch Manual
0
9
1
2
1
1
0
Default
dispatch_manual_discharge
3
2
Battery manual allow discharge array
 
Battery Dispatch Manual
0
9
1
2
1
1
0
Default
dispatch_manual_gridcharge
3
2
Battery manual charge from grid array
 
Battery Dispatch Manual
0
9
1
2
1
1
0
Default
dispatch_manual_percent_discharge
3
2
Battery manual discharge rates array
 
Battery Dispatch Manual
0
9
1
2
1
1
0
Default
dispatch_manual_percent_gridcharge
3
2
Battery manual grid charge rates array
 
Battery Dispatch Manual
0
9
1
2
1
1
0
Default
dispatch_manual_sched
3
3
Battery dispatch weekday schedule
 
Battery Dispatch Manual
0
3
1
3
12
24
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 

DiurnalPeriod
dispatch_manual_sched_weekend
3
3
Battery dispatch weekend schedule
 
Battery Dispatch Manual
0
3
1
3
12
24
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 

DiurnalPeriod
pv.storage.p1.charge
3
1
Battery allow charge from system Period 1
 
Battery Dispatch Manual
0
3
1
1
1
1
1
CheckBox
pv.storage.p1.discharge
3
1
Battery allow discharge Period 1
 
Battery Dispatch Manual
0
3
1
1
1
1
0
CheckBox
pv.storage.p1.dischargetogrid
3
1
Battery allow discharge to grid Period 1
 
Battery Dispatch Manual
0
3
1
1
1
1
0
CheckBox
pv.storage.p1.gridcharge
3
1
Battery allow charge from grid Period 1
 
Battery Dispatch Manual
0
3
1
1
1
1
0
CheckBox
pv.storage.p2.charge
3
1
Battery allow charge from system Period 2
 
Battery Dispatch Manual
0
3
1
1
1
1
1
CheckBox
pv.storage.p2.discharge
3
1
Battery allow discharge Period 2
 
Battery Dispatch Manual
0
3
1
1
1
1
0
CheckBox
pv.storage.p2.dischargetogrid
3
1
Battery allow discharge to grid Period 2
 
Battery Dispatch Manual
0
3
1
1
1
1
0
CheckBox
pv.storage.p2.gridcharge
3
1
Battery allow charge from grid Period 2
 
Battery Dispatch Manual
0
3
1
1
1
1
1
CheckBox
pv.storage.p3.charge
3
1
Battery allow charge from system Period 3
 
Battery Dispatch Manual
0
3
1
1
1
1
1
CheckBox
pv.storage.p3.discharge
3
1
Battery allow discharge Period 3
 
Battery Dispatch Manual
0
3
1
1
1
1
1
CheckBox
pv.storage.p3.dischargetogrid
3
1
Battery allow discharge to grid Period 3
 
Battery Dispatch Manual
0
3
1
1
1
1
0
CheckBox
pv.storage.p3.gridcharge
3
1
Battery allow charge from grid Period 3
 
Battery Dispatch Manual
0
3
1
1
1
1
0
CheckBox
pv.storage.p4.charge
3
1
Battery allow charge from system Period 4
 
Battery Dispatch Manual
0
3
1
1
1
1
0
CheckBox
pv.storage.p4.discharge
3
1
Battery allow discharge Period 4
 
Battery Dispatch Manual
0
3
1
1
1
1
0
CheckBox
pv.storage.p4.dischargetogrid
3
1
Battery allow discharge to grid Period 4
 
Battery Dispatch Manual
0
3
1
1
1
1
0
CheckBox
pv.storage.p4.gridcharge
3
1
Battery allow charge from grid Period 4
 
Battery Dispatch Manual
0
3
1
1
1
1
0
CheckBox
pv.storage.p5.charge
3
1
Battery allow charge from system Period 5
 
Battery Dispatch Manual
0
3
1
1
1
1
0
CheckBox
pv.storage.p5.discharge
3
1
Battery allow discharge Period 5
 
Battery Dispatch Manual
0
3
1
1
1
1
0
CheckBox
pv.storage.p5.dischargetogrid
3
1
Battery allow discharge to grid Period 5
 
Battery Dispatch Manual
0
3
1
1
1
1
0
CheckBox
pv.storage.p5.gridcharge
3
1
Battery allow charge from grid Period 5
 
Battery Dispatch Manual
0
3
1
1
1
1
0
CheckBox
pv.storage.p6.charge
3
1
Battery allow charge from system Period 6
 
Battery Dispatch Manual
0
3
1
1
1
1
0
CheckBox
pv.storage.p6.discharge
3
1
Battery allow discharge Period 6
 
Battery Dispatch Manual
0
3
1
1
1
1
0
CheckBox
pv.storage.p6.dischargetogrid
3
1
Battery allow discharge to grid Period 6
 
Battery Dispatch Manual
0
3
1
1
1
1
0
CheckBox
pv.storage.p6.gridcharge
3
1
Battery allow charge from grid Period 6
 
Battery Dispatch Manual
0
3
1
1
1
1
0
CheckBox
ui_copy_batt_discharge_percent_1
3
1
Battery discharge to grid rate Period 1
%
Battery Dispatch Manual
0
9
1
1
1
1
0
Numeric
ui_copy_batt_discharge_percent_2
3
1
Battery discharge to grid rate Period 2
%
Battery Dispatch Manual
0
9
1
1
1
1
0
Numeric
ui_copy_batt_discharge_percent_3
3
1
Battery discharge to grid rate Period 3
%
Battery Dispatch Manual
0
9
1
1
1
1
0
Numeric
ui_copy_batt_discharge_percent_4
3
1
Battery discharge to grid rate Period 4
%
Battery Dispatch Manual
0
9
1
1
1
1
0
Numeric
ui_copy_batt_discharge_percent_5
3
1
Battery discharge to grid rate Period 5
%
Battery Dispatch Manual
0
9
1
1
1
1
0
Numeric
ui_copy_batt_discharge_percent_6
3
1
Battery discharge to grid rate Period 6
%
Battery Dispatch Manual
0
9
1
1
1
1
0
Numeric

3156
equations{ 'dispatch_manual_charge' } = define() {
	return [ ${pv.storage.p1.charge},
	${pv.storage.p2.charge},
	${pv.storage.p3.charge},
	${pv.storage.p4.charge},
	${pv.storage.p5.charge},
	${pv.storage.p6.charge} ];
};

equations{ 'dispatch_manual_discharge' } = define() {
	return [ ${pv.storage.p1.discharge},
	${pv.storage.p2.discharge},
	${pv.storage.p3.discharge},
	${pv.storage.p4.discharge},
	${pv.storage.p5.discharge},
	${pv.storage.p6.discharge} ];
};

equations{ 'dispatch_manual_gridcharge' } = define() {
	return [ ${pv.storage.p1.gridcharge},
	${pv.storage.p2.gridcharge},
	${pv.storage.p3.gridcharge},
	${pv.storage.p4.gridcharge},
	${pv.storage.p5.gridcharge},
	${pv.storage.p6.gridcharge} ];
};

equations{ 'dispatch_manual_btm_discharge_to_grid' } = define() {
	return [ ${pv.storage.p1.dischargetogrid},
	${pv.storage.p2.dischargetogrid},
	${pv.storage.p3.dischargetogrid},
	${pv.storage.p4.dischargetogrid},
	${pv.storage.p5.dischargetogrid},
	${pv.storage.p6.dischargetogrid} ];
};

equations{ 'dispatch_manual_percent_discharge'} = define() {
	count = 0;
	discharge_array = ${dispatch_manual_discharge};
	for (i = 0; i != #discharge_array; i++)
	{
		ret_array[count] = 0;
		if (discharge_array[i] == 1)
		{
			/* It would be nice if this worked
			str2return = sprintf('batt_discharge_percent_%d',i+1);
			ret_array[count] = env(str2return);
			*/
		
			if (i == 0)
				ret_array[count] = ${batt_discharge_percent_1};
			else if (i == 1)
				ret_array[count] = ${batt_discharge_percent_2};
			else if (i == 2)
				ret_array[count] = ${batt_discharge_percent_3};
			else if (i == 3)
				ret_array[count] = ${batt_discharge_percent_4};		
			else if (i == 4)
				ret_array[count] = ${batt_discharge_percent_5};	
			else if (i == 5)
				ret_array[count] = ${batt_discharge_percent_6};	
			count++;
		}
	}
	return ret_array;
};
equations{ 'dispatch_manual_percent_gridcharge'} = define() {
	count = 0;
	gridcharge_array = ${dispatch_manual_gridcharge};
	for (i = 0; i != #gridcharge_array; i++)
	{
		ret_array[count] = 0;
		if (gridcharge_array[i] == 1)
		{
			if (i == 0)
				ret_array[count] = ${batt_gridcharge_percent_1};
			else if (i == 1)
				ret_array[count] = ${batt_gridcharge_percent_2};
			else if (i == 2)
				ret_array[count] = ${batt_gridcharge_percent_3};
			else if (i == 3)
				ret_array[count] = ${batt_gridcharge_percent_4};		
			else if (i == 4)
				ret_array[count] = ${batt_gridcharge_percent_5};	
			else if (i == 5)
				ret_array[count] = ${batt_gridcharge_percent_6};	
			count++;
		}
	}
	return ret_array;
};

equations{'ui_copy_batt_discharge_percent_1'} = define() {
	return ${batt_discharge_percent_1};
};

equations{'ui_copy_batt_discharge_percent_2'} = define() {
	return ${batt_discharge_percent_2};
};

equations{'ui_copy_batt_discharge_percent_3'} = define() {
	return ${batt_discharge_percent_3};
};

equations{'ui_copy_batt_discharge_percent_4'} = define() {
	return ${batt_discharge_percent_4};
};

equations{'ui_copy_batt_discharge_percent_5'} = define() {
	return ${batt_discharge_percent_5};
};

equations{'ui_copy_batt_discharge_percent_6'} = define() {
	return ${batt_discharge_percent_6};
};


9578
on_load{'Battery Dispatch Manual'}=define()
{	
	value('batt_dispatch_choice', 3);
	show_label();
	show('standalone_batt_label', false);
	toggle_dispatch();
	show_hide_grid_discharge(behind_the_meter());
		
	on_change{'pv.storage.p1.discharge'};
	on_change{'pv.storage.p2.discharge'};
	on_change{'pv.storage.p3.discharge'};
	on_change{'pv.storage.p4.discharge'};
	on_change{'pv.storage.p5.discharge'};
	on_change{'pv.storage.p6.discharge'};
	
	on_change{'pv.storage.p1.gridcharge'};
	on_change{'pv.storage.p2.gridcharge'};
	on_change{'pv.storage.p3.gridcharge'};
	on_change{'pv.storage.p4.gridcharge'};
	on_change{'pv.storage.p5.gridcharge'};
	on_change{'pv.storage.p6.gridcharge'};
	
	if(is_assigned('en_standalone_batt') && value('en_standalone_batt')==1) {
		value('pv.storage.p1.charge', 0);
		value('pv.storage.p2.charge', 0);
		value('pv.storage.p3.charge', 0);
		value('pv.storage.p4.charge', 0);
		value('pv.storage.p5.charge', 0);
		value('pv.storage.p6.charge', 0);
		enable('pv.storage.p1.charge', false);
		enable('pv.storage.p2.charge', false);
		enable('pv.storage.p3.charge', false);
		enable('pv.storage.p4.charge', false);
		enable('pv.storage.p5.charge', false);
		enable('pv.storage.p6.charge', false);
		show('standalone_batt_label', true);
	}
	
	refresh();
		
	

};

on_change{'pv.storage.p1.discharge'}=define(){toggle_discharge_percent();};
on_change{'pv.storage.p2.discharge'}=define(){toggle_discharge_percent();};
on_change{'pv.storage.p3.discharge'}=define(){toggle_discharge_percent();};
on_change{'pv.storage.p4.discharge'}=define(){toggle_discharge_percent();};
on_change{'pv.storage.p5.discharge'}=define(){toggle_discharge_percent();};
on_change{'pv.storage.p6.discharge'}=define(){toggle_discharge_percent();};

on_change{'pv.storage.p1.gridcharge'}=define(){toggle_gridcharge_percent();};
on_change{'pv.storage.p2.gridcharge'}=define(){toggle_gridcharge_percent();};
on_change{'pv.storage.p3.gridcharge'}=define(){toggle_gridcharge_percent();};
on_change{'pv.storage.p4.gridcharge'}=define(){toggle_gridcharge_percent();};
on_change{'pv.storage.p5.gridcharge'}=define(){toggle_gridcharge_percent();};
on_change{'pv.storage.p6.gridcharge'}=define(){toggle_gridcharge_percent();};

on_change{'btn_copy_schedule'}=define()
{
	if ( behind_the_meter() )
	{
		value('dispatch_manual_sched',value('ur_ec_sched_weekday'));
		value('dispatch_manual_sched_weekend',value('ur_ec_sched_weekend'));	
	}
	else
	{
		value('dispatch_manual_sched',value('dispatch_sched_weekday'));
		value('dispatch_manual_sched_weekend',value('dispatch_sched_weekend'));	
	}
};

function behind_the_meter()
{
	btm = false;
	if (financing() == 'Residential' || 
		financing() == 'Commercial' || 
		financing() == 'Third Party' ||
		financing() == 'Host Developer')
		{ btm = true; }
	return btm;
}

function show_label()
{
	is_merchant = ( financing() == 'Merchant Plant' ); 
	show('lbl_copy_schedule', !is_merchant );
	show('btn_copy_schedule', !is_merchant );
	refresh();
}

function toggle_discharge_percent()
{
	enable('batt_discharge_percent_1', (value('pv.storage.p1.discharge')==1));
	enable('batt_discharge_percent_2', (value('pv.storage.p2.discharge')==1));
	enable('batt_discharge_percent_3', (value('pv.storage.p3.discharge')==1));
	enable('batt_discharge_percent_4', (value('pv.storage.p4.discharge')==1));
	enable('batt_discharge_percent_5', (value('pv.storage.p5.discharge')==1));
	enable('batt_discharge_percent_6', (value('pv.storage.p6.discharge')==1));


	if (behind_the_meter()) {
		enable('pv.storage.p1.dischargetogrid', (value('pv.storage.p1.discharge')==1));
		enable('pv.storage.p2.dischargetogrid', (value('pv.storage.p2.discharge')==1));
		enable('pv.storage.p3.dischargetogrid', (value('pv.storage.p3.discharge')==1));
		enable('pv.storage.p4.dischargetogrid', (value('pv.storage.p4.discharge')==1));
		enable('pv.storage.p5.dischargetogrid', (value('pv.storage.p5.discharge')==1));
		enable('pv.storage.p6.dischargetogrid', (value('pv.storage.p6.discharge')==1));

		if (value('pv.storage.p1.discharge') == 0) { value('pv.storage.p1.dischargetogrid', 0); }
		if (value('pv.storage.p2.discharge') == 0) { value('pv.storage.p2.dischargetogrid', 0); }
		if (value('pv.storage.p3.discharge') == 0) { value('pv.storage.p3.dischargetogrid', 0); }
		if (value('pv.storage.p4.discharge') == 0) { value('pv.storage.p4.dischargetogrid', 0); }
		if (value('pv.storage.p5.discharge') == 0) { value('pv.storage.p5.dischargetogrid', 0); }
		if (value('pv.storage.p6.discharge') == 0) { value('pv.storage.p6.dischargetogrid', 0); }
	}
}
function toggle_gridcharge_percent()
{
	enable('batt_gridcharge_percent_1', (value('pv.storage.p1.gridcharge')==1));
	enable('batt_gridcharge_percent_2', (value('pv.storage.p2.gridcharge')==1));
	enable('batt_gridcharge_percent_3', (value('pv.storage.p3.gridcharge')==1));
	enable('batt_gridcharge_percent_4', (value('pv.storage.p4.gridcharge')==1));
	enable('batt_gridcharge_percent_5', (value('pv.storage.p5.gridcharge')==1));
	enable('batt_gridcharge_percent_6', (value('pv.storage.p6.gridcharge')==1));

}

function show_hide_grid_discharge(is_btm) {
	if ( is_btm ) 
	{
		property('lbl_discharge_options','Caption','Discharge to load');
		//property('lbl_discharge_to_load_option','Caption','Load');
		property('lbl_copy_schedule','Caption','Use the Copy Schedules button to overwrite the weekday and weekend schedules with schedules from the energy charge schedules from the Electricity Rates page.');
		property('btn_copy_schedule','Caption','Copy Schedules from TOU Electricity Rates');
	}
	else 
	{
		property('lbl_discharge_options','Caption','Discharge to grid');
		//property('lbl_discharge_to_load_option','Caption','');
		property('lbl_copy_schedule','Caption','Use the Copy Schedules button to overwrite the weekday and weekend schedules with schedules from TOD PPA price multipliers on the Revenue or Financial Parameters page.');
		property('btn_copy_schedule','Caption','Copy Schedules from TOD Power Price Multipliers');
	}
	show('lbl_to_grid_discharge',is_btm);
	show('pv.storage.p1.dischargetogrid',is_btm);
	show('pv.storage.p2.dischargetogrid',is_btm);
	show('pv.storage.p3.dischargetogrid',is_btm);
	show('pv.storage.p4.dischargetogrid',is_btm);
	show('pv.storage.p5.dischargetogrid',is_btm);
	show('pv.storage.p6.dischargetogrid',is_btm);
	show('lbl_discharge_to_grid',is_btm);
	show('lbl_discharge_to_grid_option',is_btm);
	show('ui_copy_batt_discharge_percent_1',is_btm);
	show('ui_copy_batt_discharge_percent_2',is_btm);
	show('ui_copy_batt_discharge_percent_3',is_btm);
	show('ui_copy_batt_discharge_percent_4',is_btm);
	show('ui_copy_batt_discharge_percent_5',is_btm);
	show('ui_copy_batt_discharge_percent_6',is_btm);
	refresh();
}

function toggle_dispatch()
{
	allow_grid_charge = true;
	allow_pv_charge = true;
	allow_discharge = true;
	
	front_of_meter = !behind_the_meter();
	if (front_of_meter == true)
	{
		mode = ${batt_dispatch_choice};
		if (mode == 3)
		{
			allow_grid_charge = true;
			enable_manual_inputs(true, allow_pv_charge, allow_grid_charge, allow_discharge);
			toggle_discharge_percent();
			toggle_gridcharge_percent();
		}
		else
		{
			enable_manual_inputs(false, false, false, false);
		}	
	}
	else
	{
		mode = ${batt_dispatch_choice};

		if (mode != 3)
			enable_manual_inputs(false, false, false, false);
		else
		{
			enable_manual_inputs(true, allow_pv_charge, allow_grid_charge, allow_discharge );
			toggle_discharge_percent();
			toggle_gridcharge_percent();
		}
	}
}

function enable_grid_charge(on_off)
{
	if (!on_off && !behind_the_meter())
	{
		value('pv.storage.p1.gridcharge',0);
		value('pv.storage.p2.gridcharge',0);
		value('pv.storage.p3.gridcharge',0);
		value('pv.storage.p4.gridcharge',0);
		value('pv.storage.p5.gridcharge',0);
		value('pv.storage.p6.gridcharge',0);
	}
	
	enable('pv.storage.p1.gridcharge',on_off);
	enable('pv.storage.p2.gridcharge',on_off);
	enable('pv.storage.p3.gridcharge',on_off);
	enable('pv.storage.p4.gridcharge',on_off);
	enable('pv.storage.p5.gridcharge',on_off);
	enable('pv.storage.p6.gridcharge',on_off);
	enable('batt_gridcharge_percent_1',on_off);
	enable('batt_gridcharge_percent_2',on_off);
	enable('batt_gridcharge_percent_3',on_off);
	enable('batt_gridcharge_percent_4',on_off);
	enable('batt_gridcharge_percent_5',on_off);
	enable('batt_gridcharge_percent_6',on_off);
}
function enable_pv_charge(on_off)
{
	enable('pv.storage.p1.charge',on_off);
	enable('pv.storage.p2.charge',on_off);
	enable('pv.storage.p3.charge',on_off);
	enable('pv.storage.p4.charge',on_off);
	enable('pv.storage.p5.charge',on_off);
	enable('pv.storage.p6.charge',on_off);
}
function enable_discharge(on_off)
{
	enable('pv.storage.p1.discharge',on_off);
	enable('pv.storage.p2.discharge',on_off);
	enable('pv.storage.p3.discharge',on_off);
	enable('pv.storage.p4.discharge',on_off);
	enable('pv.storage.p5.discharge',on_off);
	enable('pv.storage.p6.discharge',on_off);
	enable('batt_discharge_percent_1',on_off);
	enable('batt_discharge_percent_2',on_off);
	enable('batt_discharge_percent_3',on_off);
	enable('batt_discharge_percent_4',on_off);
	enable('batt_discharge_percent_5',on_off);
	enable('batt_discharge_percent_6',on_off);
}

function enable_manual_inputs(on_off, allow_pv_charge, allow_grid_charge, allow_discharge)
{
	enable_pv_charge(allow_pv_charge);
	enable_grid_charge(allow_grid_charge);
	enable_discharge(allow_discharge);
	
	enable('dispatch_manual_sched',on_off);
	enable('dispatch_manual_sched_weekend',on_off);
	enable('batt_dispatch_auto_can_charge', !on_off);
	enable('batt_dispatch_auto_can_gridcharge', !on_off);
}