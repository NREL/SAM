PV Shading
1043
874
77
GroupBox

1
8
Name
5
9
GroupBox1
X
3
6
Y
3
3
Width
3
1028
Height
3
205
Tool Tip
5
0
Caption
5
16
External Shading
Bold
2
1
GroupBox

1
8
Name
5
9
GroupBox2
X
3
6
Y
3
309
Width
3
1026
Height
3
450
Tool Tip
5
0
Caption
5
68
Array Dimensions for Self Shading, Snow Losses, and Bifacial Modules
Bold
2
1
Label

1
13
Name
5
11
Label121112
X
3
111
Y
3
360
Width
3
200
Height
3
21
Tool Tip
5
0
Caption
5
18
Module orientation
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Label

1
13
Name
5
13
Label12111245
X
3
48
Y
3
267
Width
3
200
Height
3
21
Tool Tip
5
0
Caption
5
12
Self shading
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Label

1
13
Name
5
11
Label121113
X
3
27
Y
3
387
Width
3
284
Height
3
21
Tool Tip
5
0
Caption
5
35
Number of modules along side of row
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Label

1
13
Name
5
13
Label12111326
X
3
27
Y
3
411
Width
3
284
Height
3
21
Tool Tip
5
0
Caption
5
37
Number of modules along bottom of row
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Label

1
13
Name
5
13
Label12111327
X
3
27
Y
3
468
Width
3
284
Height
3
21
Tool Tip
5
0
Caption
5
14
Number of rows
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Label

1
13
Name
5
13
Label12111328
X
3
12
Y
3
492
Width
3
299
Height
3
21
Tool Tip
5
0
Caption
5
43
Modules in subarray from System Design page
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Label

1
13
Name
5
13
Label12111373
X
3
111
Y
3
567
Width
3
200
Height
3
21
Tool Tip
5
0
Caption
5
24
Row spacing estimate (m)
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Label

1
13
Name
5
13
Label12111374
X
3
111
Y
3
543
Width
3
200
Height
3
21
Tool Tip
5
0
Caption
5
27
GCR from System Design page
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Label

1
13
Name
5
13
Label12111375
X
3
111
Y
3
519
Width
3
200
Height
3
21
Tool Tip
5
0
Caption
5
18
Length of side (m)
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Label

1
13
Name
5
13
Label12111376
X
3
4294966932
Y
3
237
Width
3
284
Height
3
21
Tool Tip
5
0
Caption
5
28
Number of Modules along Side
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Button

1
8
Name
5
13
edit_3d_scene
X
3
33
Y
3
153
Width
3
207
Height
3
24
Tool Tip
5
0
Caption
5
27
Open 3D shade calculator...
TabOrder
3
4294967295
CheckBox

1
9
Name
5
13
en_snow_model
X
3
126
Y
3
828
Width
3
289
Height
3
24
Tool Tip
5
0
Caption
5
20
Estimate snow losses
State
2
0
TabOrder
3
4294967295
Label

1
13
Name
5
13
lbl_subarray1
X
3
321
Y
3
144
Width
3
100
Height
3
21
Tool Tip
5
0
Caption
5
10
Subarray 1
TextColour
4
0
0
0
255
Bold
2
1
FontSize
3
0
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
Label

1
13
Name
5
13
lbl_subarray2
X
3
450
Y
3
144
Width
3
100
Height
3
21
Tool Tip
5
0
Caption
5
10
Subarray 2
TextColour
4
0
0
0
255
Bold
2
1
FontSize
3
0
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
Label

1
13
Name
5
13
lbl_subarray3
X
3
588
Y
3
144
Width
3
100
Height
3
21
Tool Tip
5
0
Caption
5
10
Subarray 3
TextColour
4
0
0
0
255
Bold
2
1
FontSize
3
0
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
Label

1
13
Name
5
13
lbl_subarray4
X
3
723
Y
3
144
Width
3
100
Height
3
21
Tool Tip
5
0
Caption
5
10
Subarray 4
TextColour
4
0
0
0
255
Bold
2
1
FontSize
3
0
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
Numeric

1
17
Name
5
11
module_area
X
3
147
Y
3
720
Width
3
93
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
4
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
19
module_aspect_ratio
X
3
147
Y
3
639
Width
3
93
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
13
module_length
X
3
147
Y
3
666
Width
3
93
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
12
module_width
X
3
147
Y
3
693
Width
3
93
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Label

1
13
Name
5
9
object 10
X
3
15
Y
3
780
Width
3
828
Height
3
45
Tool Tip
5
0
Caption
5
178
Snow losses are caused by snow covering the array. When your weather file includes snow depth data, SAM can estimate losses due to snow.  Losses are calculated for each subarray.
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Image

1
8
Name
5
9
object 12
X
3
678
Y
3
636
Width
3
334
Height
3
108
Tool Tip
5
0
Image
7
PV Shading_object 12.png
Centered
2
1
Divider

1
10
Name
5
9
object 21
X
3
15
Y
3
75
Width
3
282
Height
3
16
Tool Tip
5
0
Orientation
3
0
Colour
4
120
120
120
255
Caption
5
19
3D Shade Calculator
Bold
2
1
Divider

1
10
Name
5
11
object 2155
X
3
312
Y
3
75
Width
3
519
Height
3
16
Tool Tip
5
0
Orientation
3
0
Colour
4
120
120
120
255
Caption
5
17
Shade Loss Tables
Bold
2
1
GroupBox

1
8
Name
5
8
object 4
X
3
6
Y
3
765
Width
3
1026
Height
3
96
Tool Tip
5
0
Caption
5
11
Snow Losses
Bold
2
1
GroupBox

1
8
Name
5
10
object 413
X
3
6
Y
3
213
Width
3
1026
Height
3
90
Tool Tip
5
0
Caption
5
54
Self Shading for Fixed Subarrays and One-axis Trackers
Bold
2
1
Label

1
13
Name
5
8
object 7
X
3
18
Y
3
231
Width
3
816
Height
3
24
Tool Tip
5
0
Caption
5
80
Self shading is shading of modules in the array by modules in a neighboring row.
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Label

1
13
Name
5
10
object 753
X
3
15
Y
3
93
Width
3
282
Height
3
48
Tool Tip
5
0
Caption
5
82
Automatically generate shade data from a drawing of the array and shading objects.
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Label

1
13
Name
5
10
object 756
X
3
12
Y
3
330
Width
3
966
Height
3
24
Tool Tip
5
0
Caption
5
127
The product of number of modules along side and bottom and number of rows should be equal to the number of modules in subarray.
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Label

1
13
Name
5
10
object 757
X
3
12
Y
3
27
Width
3
822
Height
3
42
Tool Tip
5
0
Caption
5
189
External shading is shading of beam and diffuse incident irradiance by nearby objects such as trees and buildings. Shading losses apply in addition to any soiling losses on the Losses page.
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Label

1
13
Name
5
10
object 758
X
3
312
Y
3
93
Width
3
519
Height
3
48
Tool Tip
5
0
Caption
5
148
Edit and import shade data. Data may be entered by hand, imported from shade analysis software and devices, or generated by the 3D shade calculator.
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Image

1
8
Name
5
20
self_shading_diagram
X
3
261
Y
3
636
Width
3
412
Height
3
112
Tool Tip
5
0
Image
7
PV Shading_self_shading_diagram.png
Centered
2
1
Numeric

1
17
Name
5
17
subarray1_gcr_ref
X
3
324
Y
3
543
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
3
Choice

1
9
Name
5
20
subarray1_mod_orient
X
3
324
Y
3
360
Width
3
98
Height
3
21
Tool Tip
5
0
Items
6
0
Selection
3
4294967295
TabOrder
3
2
Numeric

1
17
Name
5
15
subarray1_nmodx
X
3
324
Y
3
411
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
0
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
3
Numeric

1
17
Name
5
15
subarray1_nmody
X
3
324
Y
3
387
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
0
Format
3
1
Decimals
3
0
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
3
Numeric

1
17
Name
5
22
subarray1_ref_nmodules
X
3
324
Y
3
492
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
0
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
3
Choice

1
9
Name
5
20
subarray1_shade_mode
X
3
315
Y
3
267
Width
3
125
Height
3
21
Tool Tip
5
0
Items
6
0
Selection
3
4294967295
TabOrder
3
4294967295
ShadingFactors

1
9
Name
5
17
subarray1_shading
X
3
321
Y
3
168
Width
3
102
Height
3
24
Tool Tip
5
0
ShowDBOptions
2
1
Description
5
10
Subarray 1
TabOrder
3
1
Numeric

1
17
Name
5
17
subarray2_gcr_ref
X
3
465
Y
3
543
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
6
Choice

1
9
Name
5
20
subarray2_mod_orient
X
3
465
Y
3
360
Width
3
104
Height
3
21
Tool Tip
5
0
Items
6
0
Selection
3
4294967295
TabOrder
3
5
Numeric

1
17
Name
5
15
subarray2_nmodx
X
3
465
Y
3
411
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
0
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
6
Numeric

1
17
Name
5
15
subarray2_nmody
X
3
465
Y
3
387
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
0
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
6
Numeric

1
17
Name
5
22
subarray2_ref_nmodules
X
3
465
Y
3
492
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
0
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
6
Choice

1
9
Name
5
20
subarray2_shade_mode
X
3
462
Y
3
267
Width
3
128
Height
3
21
Tool Tip
5
0
Items
6
0
Selection
3
4294967295
TabOrder
3
4294967295
ShadingFactors

1
9
Name
5
17
subarray2_shading
X
3
450
Y
3
168
Width
3
102
Height
3
24
Tool Tip
5
0
ShowDBOptions
2
1
Description
5
10
Subarray 2
TabOrder
3
4
Numeric

1
17
Name
5
17
subarray3_gcr_ref
X
3
609
Y
3
543
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
10
Choice

1
9
Name
5
20
subarray3_mod_orient
X
3
609
Y
3
360
Width
3
98
Height
3
21
Tool Tip
5
0
Items
6
0
Selection
3
4294967295
TabOrder
3
8
Numeric

1
17
Name
5
15
subarray3_nmodx
X
3
609
Y
3
411
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
0
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
10
Numeric

1
17
Name
5
15
subarray3_nmody
X
3
609
Y
3
387
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
0
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
10
Numeric

1
17
Name
5
22
subarray3_ref_nmodules
X
3
609
Y
3
492
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
0
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
10
Choice

1
9
Name
5
20
subarray3_shade_mode
X
3
603
Y
3
267
Width
3
134
Height
3
21
Tool Tip
5
0
Items
6
0
Selection
3
4294967295
TabOrder
3
4294967295
ShadingFactors

1
9
Name
5
17
subarray3_shading
X
3
588
Y
3
168
Width
3
102
Height
3
24
Tool Tip
5
0
ShowDBOptions
2
1
Description
5
10
Subarray 3
TabOrder
3
7
Numeric

1
17
Name
5
17
subarray4_gcr_ref
X
3
756
Y
3
543
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
13
Choice

1
9
Name
5
20
subarray4_mod_orient
X
3
756
Y
3
360
Width
3
101
Height
3
21
Tool Tip
5
0
Items
6
0
Selection
3
4294967295
TabOrder
3
12
Numeric

1
17
Name
5
15
subarray4_nmodx
X
3
756
Y
3
411
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
0
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
13
Numeric

1
17
Name
5
15
subarray4_nmody
X
3
756
Y
3
387
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
0
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
13
Numeric

1
17
Name
5
22
subarray4_ref_nmodules
X
3
756
Y
3
492
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
0
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
13
Choice

1
9
Name
5
20
subarray4_shade_mode
X
3
753
Y
3
267
Width
3
119
Height
3
21
Tool Tip
5
0
Items
6
0
Selection
3
4294967295
TabOrder
3
4294967295
ShadingFactors

1
9
Name
5
17
subarray4_shading
X
3
723
Y
3
168
Width
3
102
Height
3
24
Tool Tip
5
0
ShowDBOptions
2
1
Description
5
10
Subarray 4
TabOrder
3
11
Divider

1
10
Name
5
21
ui_calculated_divider
X
3
57
Y
3
441
Width
3
810
Height
3
16
Tool Tip
5
0
Orientation
3
0
Colour
4
120
120
120
255
Caption
5
24
Calculated System Layout
Bold
2
1
Label

1
13
Name
5
15
ui_msg_selfshad
X
3
294
Y
3
597
Width
3
720
Height
3
30
Tool Tip
5
0
Caption
5
0
TextColour
4
255
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
0
AlignTop
2
1
Label

1
13
Name
5
11
ui_msg_snow
X
3
429
Y
3
828
Width
3
414
Height
3
24
Tool Tip
5
0
Caption
5
0
TextColour
4
255
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Numeric

1
17
Name
5
24
ui_subarray1_length_side
X
3
324
Y
3
519
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
3
Numeric

1
17
Name
5
18
ui_subarray1_nrows
X
3
324
Y
3
468
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
24
ui_subarray1_row_spacing
X
3
324
Y
3
567
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
3
Numeric

1
17
Name
5
24
ui_subarray2_length_side
X
3
465
Y
3
519
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
3
Numeric

1
17
Name
5
18
ui_subarray2_nrows
X
3
465
Y
3
468
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
24
ui_subarray2_row_spacing
X
3
465
Y
3
567
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
3
Numeric

1
17
Name
5
24
ui_subarray3_length_side
X
3
609
Y
3
519
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
3
Numeric

1
17
Name
5
18
ui_subarray3_nrows
X
3
609
Y
3
468
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
24
ui_subarray3_row_spacing
X
3
609
Y
3
567
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
3
Numeric

1
17
Name
5
24
ui_subarray4_length_side
X
3
756
Y
3
519
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
3
Numeric

1
17
Name
5
18
ui_subarray4_nrows
X
3
756
Y
3
468
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
24
ui_subarray4_row_spacing
X
3
756
Y
3
567
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
3

46
en_snow_model
3
1
Enable snow model
 
Shading and Snow
0
3
1
1
1
1
0
Default
module_area
3
1
Module area
m²
Shading and Snow
0
8
1
1
1
1
0
Default
module_aspect_ratio
3
1
Module aspect ratio
 
Shading and Snow
0
0
1
1
1
1
1.7
Default
module_length
3
1
Module length
m
Shading and Snow
0
8
1
1
1
1
1
Default
module_width
3
1
Module width
m
Shading and Snow
0
8
1
1
1
1
0
Default
shading_3d_scene
3
6
Open 3D shade calculator
 
Shading and Snow
0
0
1
6
0
Default
subarray1_gcr_ref
3
1
GCR 1
m
Shading and Snow
0
9
1
1
1
1
0.3
Default
subarray1_mod_orient
3
1
Module orientation 1
 
Shading and Snow
19
Portrait| Landscape
3
1
1
1
1
0
Choice
subarray1_nmodx
3
1
Number of modules along bottom of row 1
 
Shading and Snow
0
3
1
1
1
1
8
Numeric
subarray1_nmody
3
1
Number of modules along side of row 1
 
Shading and Snow
0
3
1
1
1
1
2
Numeric
subarray1_ref_nmodules
3
1
Number of modules 1
 
Shading and Snow
0
9
1
1
1
1
0
Default
subarray1_shade_mode
3
1
Self shading mode 1
 
Shading and Snow
45
None|Standard (Non-linear)|Thin film (Linear)
3
1
1
1
1
0
Choice
subarray1_shading
3
5
Edit shading losses 1
 
Shading and Snow
0
3
1
5
1
0
ShadingFactors
subarray2_gcr_ref
3
1
GCR 2
 
Shading and Snow
0
9
1
1
1
1
0.3
Default
subarray2_mod_orient
3
1
Module orientation 2
 
Shading and Snow
19
Portrait| Landscape
3
1
1
1
1
0
Choice
subarray2_nmodx
3
1
Number of modules along bottom of row 2
 
Shading and Snow
0
3
1
1
1
1
8
Numeric
subarray2_nmody
3
1
Number of modules along side of row 2
 
Shading and Snow
0
3
1
1
1
1
2
Numeric
subarray2_ref_nmodules
3
1
Number of modules 2
 
Shading and Snow
0
9
1
1
1
1
0
Default
subarray2_shade_mode
3
1
Self shading mode 2
 
Shading and Snow
45
None|Standard (Non-linear)|Thin film (Linear)
3
1
1
1
1
0
Choice
subarray2_shading
3
5
Edit shading losses 2
 
Shading and Snow
0
3
1
5
1
0
ShadingFactors
subarray3_gcr_ref
3
1
GCR 3
 
Shading and Snow
0
9
1
1
1
1
0.3
Default
subarray3_mod_orient
3
1
Module orientation 3
 
Shading and Snow
19
Portrait| Landscape
3
1
1
1
1
0
Choice
subarray3_nmodx
3
1
Number of modules along bottom of row 3
 
Shading and Snow
0
3
1
1
1
1
8
Numeric
subarray3_nmody
3
1
Number of modules along side of row 3
 
Shading and Snow
0
3
1
1
1
1
2
Numeric
subarray3_ref_nmodules
3
1
Number of modules 3
 
Shading and Snow
0
9
1
1
1
1
0
Default
subarray3_shade_mode
3
1
Self shading mode 3
 
Shading and Snow
45
None|Standard (Non-linear)|Thin film (Linear)
3
1
1
1
1
0
Choice
subarray3_shading
3
5
Edit shading losses 3
 
Shading and Snow
0
3
1
5
1
0
ShadingFactors
subarray4_gcr_ref
3
1
GCR 4
 
Shading and Snow
0
9
1
1
1
1
0.3
Default
subarray4_mod_orient
3
1
Module orientation 4
 
Shading and Snow
19
Portrait| Landscape
3
1
1
1
1
0
Choice
subarray4_nmodx
3
1
Number of modules along bottom of row 4
 
Shading and Snow
0
3
1
1
1
1
8
Numeric
subarray4_nmody
3
1
Number of modules along side of row 4
 
Shading and Snow
0
3
1
1
1
1
2
Numeric
subarray4_ref_nmodules
3
1
Number of modules 4
 
Shading and Snow
0
9
1
1
1
1
0
Default
subarray4_shade_mode
3
1
Self shading mode 4
 
Shading and Snow
45
None|Standard (Non-linear)|Thin film (Linear)
3
1
1
1
1
0
Choice
subarray4_shading
3
5
Edit shading losses 4
 
Shading and Snow
0
3
1
5
1
0
ShadingFactors
ui_subarray1_length_side
3
1
Length of subarray side 1
 
Shading and Snow
0
9
1
1
1
1
0
Default
ui_subarray1_nrows
3
1
Number of rows 1
 
Shading and Snow
0
9
1
1
1
1
0
Default
ui_subarray1_row_spacing
3
1
Row spacing 1
m
Shading and Snow
0
9
1
1
1
1
0
Default
ui_subarray2_length_side
3
1
Length of subarray side 2
 
Shading and Snow
0
9
1
1
1
1
0
Default
ui_subarray2_nrows
3
1
Number of rows 2
 
Shading and Snow
0
9
1
1
1
1
0
Default
ui_subarray2_row_spacing
3
1
Row spacing 2
m
Shading and Snow
0
9
1
1
1
1
0
Default
ui_subarray3_length_side
3
1
Length of subarray side 3
 
Shading and Snow
0
9
1
1
1
1
0
Default
ui_subarray3_nrows
3
1
Number of rows 3
 
Shading and Snow
0
9
1
1
1
1
0
Default
ui_subarray3_row_spacing
3
1
Row spacing 3
m
Shading and Snow
0
9
1
1
1
1
0
Default
ui_subarray4_length_side
3
1
Length of subarray side 4
 
Shading and Snow
0
9
1
1
1
1
0
Default
ui_subarray4_nrows
3
1
Number of rows 4
 
Shading and Snow
0
9
1
1
1
1
0
Default
ui_subarray4_row_spacing
3
1
Row spacing 4
m
Shading and Snow
0
9
1
1
1
1
0
Default

3700
equations{'ui_subarray1_length_side'} = define() {
	o=${subarray1_mod_orient};
	n=${subarray1_nmody};
	if (o==0) l=${module_length}*n; //portrait
	else l=${module_width}*n; //landscape
	return l;
};

equations{'module_length'} = define() {
	return sqrt(${module_area}*${module_aspect_ratio});
};

equations{'module_width'} = define() {
	return sqrt(${module_area}/${module_aspect_ratio});
};

equations{'ui_subarray2_length_side'} = define() {
	o=${subarray2_mod_orient};
	n=${subarray2_nmody};
	if (o==0) l=${module_length}*n; //portrait
	else l=${module_width}*n; //landscape
	return l;
};
equations{'ui_subarray3_length_side'} = define() {
	o=${subarray3_mod_orient};
	n=${subarray3_nmody};
	if (o==0) l=${module_length}*n; //portrait
	else l=${module_width}*n; //landscape
	return l;
};
equations{'ui_subarray4_length_side'} = define() {
	o=${subarray4_mod_orient};
	n=${subarray4_nmody};
	if (o==0) l=${module_length}*n; //portrait
	else l=${module_width}*n; //landscape
	return l;
};

equations{'ui_subarray1_row_spacing'} = define() {
	a=${module_area};
	w=${module_width};
	l=${module_length};
	s=w*${subarray1_nmody}; //length of side, landscape
	if (${subarray1_mod_orient}==0) s=l*${subarray1_nmody};//length of side, portrait
	return s/${subarray1_gcr_ref};
};

equations{'ui_subarray2_row_spacing'} = define() {
	a=${module_area};
	w=${module_width};
	l=${module_length};
	s=w*${subarray2_nmody}; //length of side, landscape
	if (${subarray2_mod_orient}==0) s=l*${subarray2_nmody};//length of side, portrait
	return s/${subarray2_gcr_ref};
};
equations{'ui_subarray3_row_spacing'} = define() { 
	a=${module_area};
	w=${module_width};
	l=${module_length};
	s=w*${subarray3_nmody}; //length of side, landscape
	if (${subarray3_mod_orient}==0) s=l*${subarray3_nmody};//length of side, portrait
	return s/${subarray3_gcr_ref};
};
equations{'ui_subarray4_row_spacing'} = define() { 
	a=${module_area};
	w=${module_width};
	l=${module_length};
	s=w*${subarray4_nmody}; //length of side, landscape
	if (${subarray4_mod_orient}==0) s=l*${subarray4_nmody};//length of side, portrait
	return s/${subarray4_gcr_ref};
};

equations{ 'ui_subarray1_nrows' } = define() {
	return ${subarray1_ref_nmodules}/${subarray1_nmodx}/${subarray1_nmody};
};
equations{ 'ui_subarray2_nrows' } = define() {
	return ${subarray2_ref_nmodules}/${subarray2_nmodx}/${subarray2_nmody};
};
equations{ 'ui_subarray3_nrows' } = define() {
	return ${subarray3_ref_nmodules}/${subarray3_nmodx}/${subarray3_nmody};
};
equations{ 'ui_subarray4_nrows' } = define() {
	return ${subarray4_ref_nmodules}/${subarray4_nmodx}/${subarray4_nmody};
};

equations{ 'module_area' } = define() {
return ?${module_model}
	[
		${spe_area},
		${cec_area},
		${6par_area},
		${snl_area},
		${sd11par_area}
	] ;
};

equations{ 'subarray1_ref_nmodules' } = define() {
	return ${subarray1_nstrings} * ${subarray1_modules_per_string};
};

equations{ 'subarray2_ref_nmodules' } = define() {
	if(${subarray2_enable} == 0)
		return 0;
	else
		return ${subarray2_nstrings} * ${subarray2_modules_per_string};
};

equations{ 'subarray3_ref_nmodules' } = define() {
	if(${subarray3_enable} == 0)
		return 0;
	else
		return ${subarray3_nstrings} * ${subarray3_modules_per_string};
};

equations{ 'subarray4_ref_nmodules' } = define() {
	if(${subarray4_enable} == 0)
		return 0;
	else
		return ${subarray4_nstrings} * ${subarray4_modules_per_string};
};

equations{ 'subarray1_gcr_ref' } = define() {
	return ${subarray1_gcr};
};

equations{ 'subarray2_gcr_ref' } = define() {
	return ${subarray2_gcr};
};

equations{ 'subarray3_gcr_ref' } = define() {
	return ${subarray3_gcr};
};

equations{ 'subarray4_gcr_ref' } = define() {
	return ${subarray4_gcr};
};
7665
//just run this function anytime anything relevant changes
function input_enabling()
{
	msg='';
	property('ui_msg_selfshad','Caption',msg);
	
	enable_module_area = false;
	
	msg_snow = '';
	if ( isnan(value('annual_snow')) == true && value('en_snow_model') == 1 ) {
		msg_snow = 'Weather file has no snow data. Simulation will fail.';
	}
	property('ui_msg_snow','Caption',msg_snow);

	for(i=1; i<=4; i++)
	{
		prefix = 'subarray' + i + '_';
		//is subarray enabled?
		en1 = false;
		if (i==1)
			en1 = true;
		else
			if (value(prefix + 'enable') == 1)
				en1 = true;
		//is it the correct type of tracking?
		en2 = false;
		if (value(prefix + 'track_mode') == 0 || //fixed tilt
			value(prefix + 'track_mode') == 1 ) //one-axis tracking
			en2 = true;
		//has self-shading been selected?
		en3 = false;
		if (value(prefix + 'shade_mode') == 1 //self-shaded selected
			|| value(prefix + 'shade_mode') == 2) //linear shading selected
			en3 = true;
		
		//has snow model been activated?
		en4 = false;
		if( value("en_snow_model") == 1 ) en4 = true;
		
		// has bifacial module been entered?
		en5 = is_bifacial();
		
		//display message self shading is enabled and nrows is not an integer
		//or there is only one row
		if (en3 == true ) {
			nrows = value('ui_' + prefix + 'nrows');
			if ( nrows == 1 ) msg = msg + 'Subarray ' + i + ' has only one row.\n';
		    if ( nrows-to_int(nrows) != 0 ) msg = msg + 'The number of rows in subarray ' + i + ' is not an integer.\n';
		}

		//display message if snow model is enabled and nrows is not an integer
		if (en4 == true  && en3 == false) {
			nrows = value('ui_' + prefix + 'nrows');
		    if ( nrows-to_int(nrows) != 0 ) msg = msg + 'The number of rows in subarray ' + i + ' is not an integer.\n';
		}

		//now enable all the inputs
		enable(prefix + 'shading', en1);
		enable(prefix + 'shade_mode', (en1 && en2));
		if (en3) enable_module_area = true;
		enable(prefix + 'mod_orient', (en1 && en2 && en3) || (en1 && en5));
		enable('ui_' + prefix + 'length_side', (en1 && en2 && en3) || (en1 && en5));
		enable('ui_' + prefix + 'nrows', (en1 && en2 && en3) || (en1 && en4) || (en1 && en5));
		enable(prefix + 'ref_nmodules', (en1 && en2 && en3) || (en1 && en4) || (en1 && en5) );
		enable(prefix + 'gcr_ref', (en1 && en2 && en3) || (en1 && en5));
		enable('ui_' + prefix + 'row_spacing', (en1 && en2 && en3) || (en1 && en5));
		enable(prefix + 'nmodx', (en1 && en2 && en3) || (en1 && en4) || (en1 && en5) );
		enable(prefix + 'nmody', (en1 && en2 && en3) || (en1 && en4) || (en1 && en5) );
	}
	enable('module_area', enable_module_area);
    if (msg!="") msg = msg + 'Adjust the number of modules to correct the problem.'; 
	property('ui_msg_selfshad','Caption',msg);

}

on_load{'PV Shading'} = define() { input_enabling(); };
on_change{'subarray1_shade_mode'} = define() { input_enabling(); };
on_change{'subarray2_shade_mode'} = define() { input_enabling(); };
on_change{'subarray3_shade_mode'} = define() { input_enabling(); };
on_change{'subarray4_shade_mode'} = define() { input_enabling(); };
on_change{'subarray1_nmody'} = define() { input_enabling(); };
on_change{'subarray2_nmody'} = define() { input_enabling(); };
on_change{'subarray3_nmody'} = define() { input_enabling(); };
on_change{'subarray4_nmody'} = define() { input_enabling(); };
on_change{'subarray1_nmodx'} = define() { input_enabling(); };
on_change{'subarray2_nmodx'} = define() { input_enabling(); };
on_change{'subarray3_nmodx'} = define() { input_enabling(); };
on_change{'subarray4_nmodx'} = define() { input_enabling(); };
on_change{'en_snow_model'} = define() { input_enabling(); };

on_change{'edit_3d_scene'} = define() {
	
	minute_step = 60;
	if (varinfo("wf_nrecords"))
	{
		nrec = value("wf_nrecords");
		if (!isnan(nrec) && (nrec > 0))
		{
			minute_step = 60 * 8760 / nrec;
		}
	}
	
	x = editscene3d( 'shading_3d_scene', 
		value('lat'), value('lon'), value('tz'), 
		value('city') + ', ' + value('state') , minute_step , true);
	
	if ( x.ierr == 0 )
	{
		n_subarrays = 1; // subarray 1 always enabled.
		if (value("subarray2_enable") == 1)
			n_subarrays++;
		if (value("subarray3_enable") == 1)
			n_subarrays++;
		if (value("subarray4_enable") == 1)
			n_subarrays++;
	
		if (( x.nsubarrays > 1 ) || ( n_subarrays > 1 ))
		{
		// check that nsubarrays = number enabled
			
			msg="";
			if (x.nsubarrays != n_subarrays)
				msg = "WARNING: You have " + n_subarrays + " subarrays enabled and " 
				+ x.nsubarrays + " subarrays in the 3D scene.\n";
				
			msg += "Update timeseries shading and diffuse losses for " 
				+ x.nsubarrays + " subarrays with calculated values from 3D scene?\n\n";
		
		
			if( yesno(msg))
			{
	
				for (i=0;i<4;i++)
				{
					pre = 'subarray' + to_string(i+1);
					
					timestep = x{ pre };
					if ( timestep == null || typeof(timestep) != 'array' ) continue;
					
					// check parallel strings = number of subarray strings
					if (value(pre + "_nstrings") != #timestep[0])
					{
						if (!yesno("WARNING: For " + pre + ", you specifed " 
						+ value(pre + "_nstrings") + " strings and have " + #timestep[0] 
						+ " strings in the 3D scene.\nDo you wish to continue with the 3D scene values?.\n\n"))
							continue;
					}
					
					shad = value( pre+'_shading');
					shad.en_timestep = true;
					shad.timestep = timestep;
					// bugfix 4/20/16
					shad.string_option=0; // default to shading database
					
					// diffuse
					shad.en_diff = true;
					shad.diff = x.diffuse[i];
					value( pre+'_shading', shad );	
				}
				
			}
			/* no longer an option to update first array for multiple
			else if (yesno( 'Update timeseries shading and diffuse losses for the array (in subarray 1)?') )
			{
				timestep = x{ 'subarray1' };
				if ( timestep == null || typeof(timestep) != 'array') // || #mxh != 12 )
				{
					msgbox('Shading loss table was not specified correctly.\n\n'
					 + to_string(timestep) );
					return;
				}
				
				shad = value( 'subarray1_shading');
				shad.en_timestep = true;
				shad.timestep = timestep;
			
					// diffuse
				shad.en_diff = true;
				shad.diff = x.diffuse[0];

				value( 'subarray1_shading', shad );	
			}
			*/
			return;
		}
		
		else if( x.nsubarrays <= 1 
			&& yesno( 'Update timeseries shading and diffuse losses for the array (in subarray 1)?') )
		{
			pre = 'subarray1';
			timestep = x{ pre };
			if ( timestep == null || typeof(timestep) != 'array')// || #mxh != 12 )
			{
				msgbox('Shading loss table was not specified correctly.\n\n'
				 + to_string(timestep) );
				return;
			}
	
			// check parallel strings = number of subarray strings
			if (value(pre + "_nstrings") != #timestep[0])
			{
				if (!yesno("WARNING: For subarray1, you specifed " 
				+ value(pre + "_nstrings") + " strings and have " + #timestep[0] 
				+ " strings in the 3D scene.\nDo you wish to continue with the 3D scene values?.\n\n"))
					return;
			}
			
			shad = value( 'subarray1_shading');
			shad.en_timestep = true;
			shad.timestep = timestep;
			// bugfix 4/20/16
			shad.string_option=0; // default to shading database
		
				// diffuse
			shad.en_diff = true;
			shad.diff = x.diffuse[0];

			value( 'subarray1_shading', shad );	
			return;
		}
	}
	elseif (x.ierr > 0)
	{
		msgbox('Internal error: ' + x.message);
	}
	else
	{// dialog closed without applying 
		return;
	}
};

function is_bifacial()
{	
	module_model = value('module_model');
	is_bifacial = false;
	
	if (module_model == 0){
		is_bifacial = value('spe_is_bifacial');
	}
	else if (module_model == 1){
		is_bifacial = value('cec_is_bifacial');
	}
	else if (module_model ==2){
		is_bifacial = value('6par_is_bifacial');
	}
	
	
	return is_bifacial;

}