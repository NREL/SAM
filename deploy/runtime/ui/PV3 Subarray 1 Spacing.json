{
    "Name": "PV3 Subarray 1 Spacing",
    "Width": 742.0,
    "Height": 411.0,
    "FormObjects": {
        "Label": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "Label121113"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": -364.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 237.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 284.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 21.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "Number of Modules along Side"
                },
                "TextColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "FontSize": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "WordWrap": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "AlignRight": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "AlignTop": {
                    "Type": 2.0,
                    "Boolean": 0.0
                }
            }
        },
        "Numeric": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "module_area"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 630.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 267.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 60.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Value": {
                    "Type": 1.0,
                    "Double": 0.0
                },
                "Mode": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Format": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "Decimals": {
                    "Type": 3.0,
                    "Integer": 4.0
                },
                "Prefix": {
                    "Type": 5.0,
                    "String": ""
                },
                "Suffix": {
                    "Type": 5.0,
                    "String": ""
                },
                "ThousandsSep": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": -1.0
                }
            }
        },
        "Image": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "object 12"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 393.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 45.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 337.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 108.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Image": {
                    "Type": 7.0,
                    "Image": "PV3 Subarray 1 Spacing.png"
                },
                "Centered": {
                    "Type": 2.0,
                    "Boolean": 1.0
                }
            }
        },
        "Label": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "object 7"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 12.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 12.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 708.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 24.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": "Subarray spacing inputs are only used when a self-shading model or the snow loss model are enabled."
                },
                "TextColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "FontSize": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "WordWrap": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "AlignRight": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "AlignTop": {
                    "Type": 2.0,
                    "Boolean": 0.0
                }
            }
        },
        "Image": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "self_shading_diagram"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 354.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 159.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 337.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 106.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Image": {
                    "Type": 7.0,
                    "Image": "PV3 Subarray 1 Spacing.png"
                },
                "Centered": {
                    "Type": 2.0,
                    "Boolean": 1.0
                }
            }
        },
        "Numeric": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "subarray1_gcr_ref"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 207.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 96.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 124.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 21.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Value": {
                    "Type": 1.0,
                    "Double": 0.0
                },
                "Mode": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Format": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Decimals": {
                    "Type": 3.0,
                    "Integer": 3.0
                },
                "Prefix": {
                    "Type": 5.0,
                    "String": ""
                },
                "Suffix": {
                    "Type": 5.0,
                    "String": ""
                },
                "ThousandsSep": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 3.0
                }
            }
        },
        "Choice": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "subarray1_mod_orient"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 207.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 120.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 125.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 21.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Items": {
                    "Type": 6.0,
                    "StringList": ""
                },
                "Selection": {
                    "Type": 3.0,
                    "Integer": -1.0
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 2.0
                }
            }
        },
        "Numeric": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "subarray1_nmodx"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 294.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 69.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 100.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 21.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Value": {
                    "Type": 1.0,
                    "Double": 0.0
                },
                "Mode": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "Format": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Decimals": {
                    "Type": 3.0,
                    "Integer": 3.0
                },
                "Prefix": {
                    "Type": 5.0,
                    "String": ""
                },
                "Suffix": {
                    "Type": 5.0,
                    "String": ""
                },
                "ThousandsSep": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 3.0
                }
            }
        },
        "Numeric": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "subarray1_nmody"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 291.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 45.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 100.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 21.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Value": {
                    "Type": 1.0,
                    "Double": 0.0
                },
                "Mode": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "Format": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Decimals": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "Prefix": {
                    "Type": 5.0,
                    "String": ""
                },
                "Suffix": {
                    "Type": 5.0,
                    "String": ""
                },
                "ThousandsSep": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 3.0
                }
            }
        },
        "Choice": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "subarray1_shade_mode"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 207.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 144.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 125.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 21.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Items": {
                    "Type": 6.0,
                    "StringList": "None|Standard (non-linear)|Thin film (linear)"
                },
                "Selection": {
                    "Type": 3.0,
                    "Integer": -1.0
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": -1.0
                }
            }
        },
        "Label": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "ui_msg_selfshad"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 15.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 297.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 678.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 84.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Caption": {
                    "Type": 5.0,
                    "String": ""
                },
                "TextColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "Bold": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "FontSize": {
                    "Type": 3.0,
                    "Integer": 0.0
                },
                "WordWrap": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "AlignRight": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "AlignTop": {
                    "Type": 2.0,
                    "Boolean": 1.0
                }
            }
        },
        "Numeric": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "ui_subarray1_length_side"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 207.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 243.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 124.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 21.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Value": {
                    "Type": 1.0,
                    "Double": 0.0
                },
                "Mode": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Format": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Decimals": {
                    "Type": 3.0,
                    "Integer": 3.0
                },
                "Prefix": {
                    "Type": 5.0,
                    "String": ""
                },
                "Suffix": {
                    "Type": 5.0,
                    "String": ""
                },
                "ThousandsSep": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 3.0
                }
            }
        },
        "Numeric": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "ui_subarray1_nrows"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 231.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 195.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 100.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 21.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Value": {
                    "Type": 1.0,
                    "Double": 0.0
                },
                "Mode": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Format": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Decimals": {
                    "Type": 3.0,
                    "Integer": 3.0
                },
                "Prefix": {
                    "Type": 5.0,
                    "String": ""
                },
                "Suffix": {
                    "Type": 5.0,
                    "String": ""
                },
                "ThousandsSep": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": -1.0
                }
            }
        },
        "Numeric": {
            "Visible": 1.0,
            "ObjectProperties": {
                "Name": {
                    "Type": 5.0,
                    "String": "ui_subarray1_row_spacing"
                },
                "X": {
                    "Type": 3.0,
                    "Integer": 207.0
                },
                "Y": {
                    "Type": 3.0,
                    "Integer": 219.0
                },
                "Width": {
                    "Type": 3.0,
                    "Integer": 124.0
                },
                "Height": {
                    "Type": 3.0,
                    "Integer": 21.0
                },
                "Tool Tip": {
                    "Type": 5.0,
                    "String": ""
                },
                "Value": {
                    "Type": 1.0,
                    "Double": 0.0
                },
                "Mode": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Format": {
                    "Type": 3.0,
                    "Integer": 1.0
                },
                "Decimals": {
                    "Type": 3.0,
                    "Integer": 3.0
                },
                "Prefix": {
                    "Type": 5.0,
                    "String": ""
                },
                "Suffix": {
                    "Type": 5.0,
                    "String": ""
                },
                "ThousandsSep": {
                    "Type": 2.0,
                    "Boolean": 0.0
                },
                "Editable": {
                    "Type": 2.0,
                    "Boolean": 1.0
                },
                "ForeColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 0.0,
                        "Green": 0.0,
                        "Blue": 0.0,
                        "Alpha": 255.0
                    }
                },
                "BackColour": {
                    "Type": 4.0,
                    "Color": {
                        "Red": 255.0,
                        "Green": 255.0,
                        "Blue": 255.0,
                        "Alpha": 255.0
                    }
                },
                "TabOrder": {
                    "Type": 3.0,
                    "Integer": 3.0
                }
            }
        }
    },
    "VarDatabase": {
        "module_area": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Module area",
            "Units": "mÂ²",
            "Group": "Shading and Snow",
            "IndexLabels": "",
            "Flags": 8.0,
            "DefaultValue": 0.0,
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "shading_3d_scene": {
            "Version": 4.0,
            "Type": 6.0,
            "Label": "Open 3D shade calculator",
            "Units": " ",
            "Group": "Shading and Snow",
            "IndexLabels": "",
            "Flags": 0.0,
            "DefaultValue": {
                "VV_TYPE": 6,
                "DATA": ""
            },
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "subarray1_gcr_ref": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "GCR",
            "Units": "m",
            "Group": "Shading and Snow",
            "IndexLabels": "",
            "Flags": 0.0,
            "DefaultValue": 0.3,
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "subarray1_mod_orient": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Module orientation",
            "Units": " ",
            "Group": "Shading and Snow",
            "IndexLabels": "Portrait| Landscape",
            "Flags": 2.0,
            "DefaultValue": 0.0,
            "UIObject": "Choice",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "subarray1_nmodx": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Number of modules along bottom of row",
            "Units": " ",
            "Group": "Shading and Snow",
            "IndexLabels": "",
            "Flags": 2.0,
            "DefaultValue": 8.0,
            "UIObject": "Numeric",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "subarray1_nmody": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Number of modules along side of row",
            "Units": " ",
            "Group": "Shading and Snow",
            "IndexLabels": "",
            "Flags": 2.0,
            "DefaultValue": 2.0,
            "UIObject": "Numeric",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "subarray1_ref_nmodules": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Number of modules 1",
            "Units": " ",
            "Group": "Shading and Snow",
            "IndexLabels": "",
            "Flags": 9.0,
            "DefaultValue": 0.0,
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "subarray1_shade_mode": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Self shading mode",
            "Units": " ",
            "Group": "Shading and Snow",
            "IndexLabels": "None|Standard (Non-linear)|Thin film (Linear)",
            "Flags": 2.0,
            "DefaultValue": 0.0,
            "UIObject": "Choice",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "subarray1_shading": {
            "Version": 4.0,
            "Type": 5.0,
            "Label": "Edit shading losses 1",
            "Units": " ",
            "Group": "Shading and Snow",
            "IndexLabels": "",
            "Flags": 3.0,
            "DefaultValue": {},
            "UIObject": "ShadingFactors",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "ui_subarray1_length_side": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Length of subarray side",
            "Units": " ",
            "Group": "Shading and Snow",
            "IndexLabels": "",
            "Flags": 8.0,
            "DefaultValue": 0.0,
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "ui_subarray1_nrows": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Number of rows",
            "Units": " ",
            "Group": "Shading and Snow",
            "IndexLabels": "",
            "Flags": 8.0,
            "DefaultValue": 0.0,
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "ui_subarray1_row_spacing": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Row spacing",
            "Units": "m",
            "Group": "Shading and Snow",
            "IndexLabels": "",
            "Flags": 8.0,
            "DefaultValue": 0.0,
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "ui_subarray2_length_side": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Length of subarray side 2",
            "Units": " ",
            "Group": "Shading and Snow",
            "IndexLabels": "",
            "Flags": 9.0,
            "DefaultValue": 0.0,
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "ui_subarray2_nrows": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Number of rows 2",
            "Units": " ",
            "Group": "Shading and Snow",
            "IndexLabels": "",
            "Flags": 9.0,
            "DefaultValue": 0.0,
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "ui_subarray2_row_spacing": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Row spacing 2",
            "Units": "m",
            "Group": "Shading and Snow",
            "IndexLabels": "",
            "Flags": 9.0,
            "DefaultValue": 0.0,
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "ui_subarray3_length_side": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Length of subarray side 3",
            "Units": " ",
            "Group": "Shading and Snow",
            "IndexLabels": "",
            "Flags": 9.0,
            "DefaultValue": 0.0,
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "ui_subarray3_nrows": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Number of rows 3",
            "Units": " ",
            "Group": "Shading and Snow",
            "IndexLabels": "",
            "Flags": 9.0,
            "DefaultValue": 0.0,
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "ui_subarray3_row_spacing": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Row spacing 3",
            "Units": "m",
            "Group": "Shading and Snow",
            "IndexLabels": "",
            "Flags": 9.0,
            "DefaultValue": 0.0,
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "ui_subarray4_length_side": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Length of subarray side 4",
            "Units": " ",
            "Group": "Shading and Snow",
            "IndexLabels": "",
            "Flags": 9.0,
            "DefaultValue": 0.0,
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "ui_subarray4_nrows": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Number of rows 4",
            "Units": " ",
            "Group": "Shading and Snow",
            "IndexLabels": "",
            "Flags": 9.0,
            "DefaultValue": 0.0,
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        },
        "ui_subarray4_row_spacing": {
            "Version": 4.0,
            "Type": 1.0,
            "Label": "Row spacing 4",
            "Units": "m",
            "Group": "Shading and Snow",
            "IndexLabels": "",
            "Flags": 9.0,
            "DefaultValue": 0.0,
            "UIObject": "Default",
            "sscVariableName": "",
            "sscVariableValue": ""
        }
    },
    "Equations": {
        "1": "equations{'ui_subarray1_length_side'} = define() {",
        "2": "\to=${subarray1_mod_orient};",
        "3": "\tn=${subarray1_nmody};",
        "4": "\ta=${module_area};",
        "5": "\tif (o==0) l=1.7*n; //portrait",
        "6": "\telse l=a/1.7*n; //landscape",
        "7": "\treturn l;",
        "8": "};",
        "9": "equations{'ui_subarray2_length_side'} = define() {",
        "10": "\to=${subarray2_mod_orient};",
        "11": "\tn=${subarray2_nmody};",
        "12": "\ta=${module_area};",
        "13": "\tif (o==0) l=1.7*n; //portrait",
        "14": "\telse l=a/1.7*n; //landscape",
        "15": "\treturn l;",
        "16": "};",
        "17": "equations{'ui_subarray3_length_side'} = define() {",
        "18": "\to=${subarray3_mod_orient};",
        "19": "\tn=${subarray3_nmody};",
        "20": "\ta=${module_area};",
        "21": "\tif (o==0) l=1.7*n; //portrait",
        "22": "\telse l=a/1.7*n; //landscape",
        "23": "\treturn l;",
        "24": "};",
        "25": "equations{'ui_subarray4_length_side'} = define() {",
        "26": "\to=${subarray4_mod_orient};",
        "27": "\tn=${subarray4_nmody};",
        "28": "\ta=${module_area};",
        "29": "\tif (o==0) l=1.7*n; //portrait",
        "30": "\telse l=a/1.7*n; //landscape",
        "31": "\treturn l;",
        "32": "};",
        "33": "",
        "34": "equations{'ui_subarray1_row_spacing'} = define() {",
        "35": "\ta=${module_area};",
        "36": "\tw=a/1.7; //module width",
        "37": "\tl=a/w; //module length",
        "38": "\ts=w*${subarray1_nmody}; //length of side, landscape",
        "39": "\tif (${subarray1_mod_orient}==0) s=l*${subarray1_nmody};//length of side, portrait",
        "40": "\treturn s/${subarray1_gcr_ref};",
        "41": "};",
        "42": "",
        "43": "equations{'ui_subarray2_row_spacing'} = define() {",
        "44": "\ta=${module_area};",
        "45": "\tw=a/1.7; //module width",
        "46": "\tl=a/w; //module length",
        "47": "\ts=w*${subarray2_nmody}; //length of side, landscape",
        "48": "\tif (${subarray2_mod_orient}==0) s=l*${subarray2_nmody};//length of side, portrait",
        "49": "\treturn s/${subarray2_gcr_ref};",
        "50": "};",
        "51": "equations{'ui_subarray3_row_spacing'} = define() { ",
        "52": "\ta=${module_area};",
        "53": "\tw=a/1.7; //module width",
        "54": "\tl=a/w; //module length",
        "55": "\ts=w*${subarray3_nmody}; //length of side, landscape",
        "56": "\tif (${subarray3_mod_orient}==0) s=l*${subarray3_nmody};//length of side, portrait",
        "57": "\treturn s/${subarray3_gcr_ref};",
        "58": "};",
        "59": "equations{'ui_subarray4_row_spacing'} = define() { ",
        "60": "\ta=${module_area};",
        "61": "\tw=a/1.7; //module width",
        "62": "\tl=a/w; //module length",
        "63": "\ts=w*${subarray4_nmody}; //length of side, landscape",
        "64": "\tif (${subarray4_mod_orient}==0) s=l*${subarray4_nmody};//length of side, portrait",
        "65": "\treturn s/${subarray4_gcr_ref};",
        "66": "};",
        "67": "",
        "68": "equations{ 'ui_subarray1_nrows' } = define() {",
        "69": "\treturn ${subarray1_ref_nmodules}/${subarray1_nmodx}/${subarray1_nmody};",
        "70": "};",
        "71": "equations{ 'ui_subarray2_nrows' } = define() {",
        "72": "\treturn ${subarray2_ref_nmodules}/${subarray2_nmodx}/${subarray2_nmody};",
        "73": "};",
        "74": "equations{ 'ui_subarray3_nrows' } = define() {",
        "75": "\treturn ${subarray3_ref_nmodules}/${subarray3_nmodx}/${subarray3_nmody};",
        "76": "};",
        "77": "equations{ 'ui_subarray4_nrows' } = define() {",
        "78": "\treturn ${subarray4_ref_nmodules}/${subarray4_nmodx}/${subarray4_nmody};",
        "79": "};",
        "80": "",
        "81": "equations{ 'module_area' } = define() {",
        "82": "return ?${module_model}",
        "83": "\t[",
        "84": "\t\t${spe_area},",
        "85": "\t\t${cec_area},",
        "86": "\t\t${6par_area},",
        "87": "\t\t${snl_area},",
        "88": "\t\t${sd11par_area}",
        "89": "\t] ;",
        "90": "};",
        "91": "",
        "92": "equations{ 'subarray1_ref_nmodules' } = define() {",
        "93": "\treturn ${subarray1_nstrings} * ${modules_per_string};",
        "94": "};",
        "95": "",
        "96": "equations{ 'subarray2_ref_nmodules' } = define() {",
        "97": "\tif(${subarray2_enable} == 0)",
        "98": "\t\treturn 0;",
        "99": "\telse",
        "100": "\t\treturn ${subarray2_nstrings} * ${modules_per_string};",
        "101": "};",
        "102": "",
        "103": "equations{ 'subarray3_ref_nmodules' } = define() {",
        "104": "\tif(${subarray3_enable} == 0)",
        "105": "\t\treturn 0;",
        "106": "\telse",
        "107": "\t\treturn ${subarray3_nstrings} * ${modules_per_string};",
        "108": "};",
        "109": "",
        "110": "equations{ 'subarray4_ref_nmodules' } = define() {",
        "111": "\tif(${subarray4_enable} == 0)",
        "112": "\t\treturn 0;",
        "113": "\telse",
        "114": "\t\treturn ${subarray4_nstrings} * ${modules_per_string};",
        "115": "};",
        "116": "",
        "117": "equations{ 'subarray1_gcr_ref' } = define() {",
        "118": "\treturn ${subarray1_gcr};",
        "119": "};",
        "120": "",
        "121": "equations{ 'subarray2_gcr_ref' } = define() {",
        "122": "\treturn ${subarray2_gcr};",
        "123": "};",
        "124": "",
        "125": "equations{ 'subarray3_gcr_ref' } = define() {",
        "126": "\treturn ${subarray3_gcr};",
        "127": "};",
        "128": "",
        "129": "equations{ 'subarray4_gcr_ref' } = define() {",
        "130": "\treturn ${subarray4_gcr};",
        "131": "};"
    },
    "Callbacks": {
        "1": "//just run this function anytime anything relevant changes",
        "2": "function input_enabling()",
        "3": "{",
        "4": "\tmsg='';",
        "5": "\tproperty('ui_msg_selfshad','Caption',msg);",
        "6": "\t",
        "7": "\tenable_module_area = false;",
        "8": "\t",
        "9": "\tmsg_snow = '';",
        "10": "\tif ( isnan(value('annual_snow')) == true && value('en_snow_model') == 1 ) {",
        "11": "\t\tmsg_snow = 'Weather file has no snow data. Simulation will fail.';",
        "12": "\t}",
        "13": "\tproperty('ui_msg_snow','Caption',msg_snow);",
        "14": "",
        "15": "\tfor(i=1; i<=4; i++)",
        "16": "\t{",
        "17": "\t\tprefix = 'subarray' + i + '_';",
        "18": "\t\t//is subarray enabled?",
        "19": "\t\ten1 = false;",
        "20": "\t\tif (i==1)",
        "21": "\t\t\ten1 = true;",
        "22": "\t\telse",
        "23": "\t\t\tif (value(prefix + 'enable') == 1)",
        "24": "\t\t\t\ten1 = true;",
        "25": "\t\t//is it the correct type of tracking?",
        "26": "\t\ten2 = false;",
        "27": "\t\tif (value(prefix + 'track_mode') == 0 || //fixed tilt",
        "28": "\t\t\t(value(prefix + 'track_mode') == 1 && value(prefix + 'backtrack') == 0)) //one-axis tracking w/o backtracking",
        "29": "\t\t\ten2 = true;",
        "30": "\t\t//has self-shading been selected?",
        "31": "\t\ten3 = false;",
        "32": "\t\tif (value(prefix + 'shade_mode') == 1 //self-shaded selected",
        "33": "\t\t\t|| value(prefix + 'shade_mode') == 2) //linear shading selected",
        "34": "\t\t\ten3 = true;",
        "35": "\t\t",
        "36": "\t\t//has snow model been activated?",
        "37": "\t\ten4 = false;",
        "38": "\t\tif( value(\"en_snow_model\") == 1 ) en4 = true;",
        "39": "\t\t",
        "40": "\t\t//display message self shading is enabled and nrows is not an integer",
        "41": "\t\t//or there is only one row",
        "42": "\t\tif (en3 == true ) {",
        "43": "\t\t\tnrows = value('ui_' + prefix + 'nrows');",
        "44": "\t\t\tif ( nrows == 1 ) msg = msg + 'Subarray ' + i + ' has only one row.\\n';",
        "45": "\t\t    if ( nrows-to_int(nrows) != 0 ) msg = msg + 'The number of rows in subarray ' + i + ' is not an integer.\\n';",
        "46": "\t\t}",
        "47": "",
        "48": "\t\t//display message if snow model is enabled and nrows is not an integer",
        "49": "\t\tif (en4 == true  && en3 == false) {",
        "50": "\t\t\tnrows = value('ui_' + prefix + 'nrows');",
        "51": "\t\t    if ( nrows-to_int(nrows) != 0 ) msg = msg + 'The number of rows in subarray ' + i + ' is not an integer.\\n';",
        "52": "\t\t}",
        "53": "",
        "54": "\t\t//now enable all the inputs",
        "55": "\t\tenable(prefix + 'shading', en1);",
        "56": "\t\tenable(prefix + 'shade_mode', (en1 && en2));",
        "57": "\t\tif (en3) enable_module_area = true;",
        "58": "\t\tenable(prefix + 'mod_orient', en1 && en2 && en3);",
        "59": "\t\tenable('ui_' + prefix + 'length_side', en1 && en2 && en3);",
        "60": "\t\tenable('ui_' + prefix + 'nrows', (en1 && en2 && en3) || (en1 && en4) );",
        "61": "\t\tenable(prefix + 'ref_nmodules', (en1 && en2 && en3) || (en1 && en4) );",
        "62": "\t\tenable(prefix + 'gcr_ref', (en1 && en2 && en3));",
        "63": "\t\tenable('ui_' + prefix + 'row_spacing', (en1 && en2 && en3));",
        "64": "\t\tenable(prefix + 'nmodx', (en1 && en2 && en3) || (en1 && en4) );",
        "65": "\t\tenable(prefix + 'nmody', (en1 && en2 && en3) || (en1 && en4) );",
        "66": "\t}",
        "67": "\tenable('module_area', enable_module_area);",
        "68": "    if (msg!=\"\") msg = msg + 'Adjust the number of modules to correct the problem.'; ",
        "69": "\tproperty('ui_msg_selfshad','Caption',msg);",
        "70": "",
        "71": "}",
        "72": "",
        "73": "on_load{'PV Shading'} = define() { input_enabling(); };",
        "74": "on_change{'subarray1_shade_mode'} = define() { input_enabling(); };",
        "75": "on_change{'subarray2_shade_mode'} = define() { input_enabling(); };",
        "76": "on_change{'subarray3_shade_mode'} = define() { input_enabling(); };",
        "77": "on_change{'subarray4_shade_mode'} = define() { input_enabling(); };",
        "78": "on_change{'subarray1_nmody'} = define() { input_enabling(); };",
        "79": "on_change{'subarray2_nmody'} = define() { input_enabling(); };",
        "80": "on_change{'subarray3_nmody'} = define() { input_enabling(); };",
        "81": "on_change{'subarray4_nmody'} = define() { input_enabling(); };",
        "82": "on_change{'subarray1_nmodx'} = define() { input_enabling(); };",
        "83": "on_change{'subarray2_nmodx'} = define() { input_enabling(); };",
        "84": "on_change{'subarray3_nmodx'} = define() { input_enabling(); };",
        "85": "on_change{'subarray4_nmodx'} = define() { input_enabling(); };",
        "86": "on_change{'en_snow_model'} = define() { input_enabling(); };",
        "87": "",
        "88": "on_change{'edit_3d_scene'} = define() {",
        "89": "\t",
        "90": "\tminute_step = 60;",
        "91": "\tif (varinfo(\"wf_nrecords\"))",
        "92": "\t{",
        "93": "\t\tnrec = value(\"wf_nrecords\");",
        "94": "\t\tif (!isnan(nrec) && (nrec > 0))",
        "95": "\t\t{",
        "96": "\t\t\tminute_step = 60 * 8760 / nrec;",
        "97": "\t\t}",
        "98": "\t}",
        "99": "\t",
        "100": "\tx = editscene3d( 'shading_3d_scene', ",
        "101": "\t\tvalue('lat'), value('lon'), value('tz'), ",
        "102": "\t\tvalue('city') + ', ' + value('state') , minute_step , true);",
        "103": "\t",
        "104": "\tif ( x.ierr == 0 )",
        "105": "\t{",
        "106": "\t\tn_subarrays = 1; // subarray 1 always enabled.",
        "107": "\t\tif (value(\"subarray2_enable\") == 1)",
        "108": "\t\t\tn_subarrays++;",
        "109": "\t\tif (value(\"subarray3_enable\") == 1)",
        "110": "\t\t\tn_subarrays++;",
        "111": "\t\tif (value(\"subarray4_enable\") == 1)",
        "112": "\t\t\tn_subarrays++;",
        "113": "\t",
        "114": "\t\tif (( x.nsubarrays > 1 ) || ( n_subarrays > 1 ))",
        "115": "\t\t{",
        "116": "\t\t// check that nsubarrays = number enabled",
        "117": "\t\t\t",
        "118": "\t\t\tmsg=\"\";",
        "119": "\t\t\tif (x.nsubarrays != n_subarrays)",
        "120": "\t\t\t\tmsg = \"WARNING: You have \" + n_subarrays + \" subarrays enabled and \" ",
        "121": "\t\t\t\t+ x.nsubarrays + \" subarrays in the 3D scene.\\n\";",
        "122": "\t\t\t\t",
        "123": "\t\t\tmsg += \"Update timeseries shading and diffuse losses for \" ",
        "124": "\t\t\t\t+ x.nsubarrays + \" subarrays with calculated values from 3D scene?\\n\\n\";",
        "125": "\t\t",
        "126": "\t\t",
        "127": "\t\t\tif( yesno(msg))",
        "128": "\t\t\t{",
        "129": "\t",
        "130": "\t\t\t\tfor (i=0;i<4;i++)",
        "131": "\t\t\t\t{",
        "132": "\t\t\t\t\tpre = 'subarray' + to_string(i+1);",
        "133": "\t\t\t\t\t",
        "134": "\t\t\t\t\ttimestep = x{ pre };",
        "135": "\t\t\t\t\tif ( timestep == null || typeof(timestep) != 'array' ) continue;",
        "136": "\t\t\t\t\t",
        "137": "\t\t\t\t\t// check parallel strings = number of subarray strings",
        "138": "\t\t\t\t\tif (value(pre + \"_nstrings\") != #timestep[0])",
        "139": "\t\t\t\t\t{",
        "140": "\t\t\t\t\t\tif (!yesno(\"WARNING: For \" + pre + \", you specified \" ",
        "141": "\t\t\t\t\t\t+ value(pre + \"_nstrings\") + \" strings and have \" + #timestep[0] ",
        "142": "\t\t\t\t\t\t+ \" strings in the 3D scene.\\nDo you wish to continue with the 3D scene values?.\\n\\n\"))",
        "143": "\t\t\t\t\t\t\tcontinue;",
        "144": "\t\t\t\t\t}",
        "145": "\t\t\t\t\t",
        "146": "\t\t\t\t\tshad = value( pre+'_shading');",
        "147": "\t\t\t\t\tshad.en_timestep = true;",
        "148": "\t\t\t\t\tshad.timestep = timestep;",
        "149": "\t\t\t\t\t// bugfix 4/20/16",
        "150": "\t\t\t\t\tshad.string_option=0; // default to shading database",
        "151": "\t\t\t\t\t",
        "152": "\t\t\t\t\t// diffuse",
        "153": "\t\t\t\t\tshad.en_diff = true;",
        "154": "\t\t\t\t\tshad.diff = x.diffuse[i];",
        "155": "\t\t\t\t\tvalue( pre+'_shading', shad );\t",
        "156": "\t\t\t\t}",
        "157": "\t\t\t\t",
        "158": "\t\t\t}",
        "159": "\t\t\t/* no longer an option to update first array for multiple",
        "160": "\t\t\telse if (yesno( 'Update timeseries shading and diffuse losses for the array (in subarray 1)?') )",
        "161": "\t\t\t{",
        "162": "\t\t\t\ttimestep = x{ 'subarray1' };",
        "163": "\t\t\t\tif ( timestep == null || typeof(timestep) != 'array') // || #mxh != 12 )",
        "164": "\t\t\t\t{",
        "165": "\t\t\t\t\tmsgbox('Shading loss table was not specified correctly.\\n\\n'",
        "166": "\t\t\t\t\t + to_string(timestep) );",
        "167": "\t\t\t\t\treturn;",
        "168": "\t\t\t\t}",
        "169": "\t\t\t\t",
        "170": "\t\t\t\tshad = value( 'subarray1_shading');",
        "171": "\t\t\t\tshad.en_timestep = true;",
        "172": "\t\t\t\tshad.timestep = timestep;",
        "173": "\t\t\t",
        "174": "\t\t\t\t\t// diffuse",
        "175": "\t\t\t\tshad.en_diff = true;",
        "176": "\t\t\t\tshad.diff = x.diffuse[0];",
        "177": "",
        "178": "\t\t\t\tvalue( 'subarray1_shading', shad );\t",
        "179": "\t\t\t}",
        "180": "\t\t\t*/",
        "181": "\t\t\treturn;",
        "182": "\t\t}",
        "183": "\t\t",
        "184": "\t\telse if( x.nsubarrays <= 1 ",
        "185": "\t\t\t&& yesno( 'Update timeseries shading and diffuse losses for the array (in subarray 1)?') )",
        "186": "\t\t{",
        "187": "\t\t\tpre = 'subarray1';",
        "188": "\t\t\ttimestep = x{ pre };",
        "189": "\t\t\tif ( timestep == null || typeof(timestep) != 'array')// || #mxh != 12 )",
        "190": "\t\t\t{",
        "191": "\t\t\t\tmsgbox('Shading loss table was not specified correctly.\\n\\n'",
        "192": "\t\t\t\t + to_string(timestep) );",
        "193": "\t\t\t\treturn;",
        "194": "\t\t\t}",
        "195": "\t",
        "196": "\t\t\t// check parallel strings = number of subarray strings",
        "197": "\t\t\tif (value(pre + \"_nstrings\") != #timestep[0])",
        "198": "\t\t\t{",
        "199": "\t\t\t\tif (!yesno(\"WARNING: For subarray1, you specified \" ",
        "200": "\t\t\t\t+ value(pre + \"_nstrings\") + \" strings and have \" + #timestep[0] ",
        "201": "\t\t\t\t+ \" strings in the 3D scene.\\nDo you wish to continue with the 3D scene values?.\\n\\n\"))",
        "202": "\t\t\t\t\treturn;",
        "203": "\t\t\t}",
        "204": "\t\t\t",
        "205": "\t\t\tshad = value( 'subarray1_shading');",
        "206": "\t\t\tshad.en_timestep = true;",
        "207": "\t\t\tshad.timestep = timestep;",
        "208": "\t\t\t// bugfix 4/20/16",
        "209": "\t\t\tshad.string_option=0; // default to shading database",
        "210": "\t\t",
        "211": "\t\t\t\t// diffuse",
        "212": "\t\t\tshad.en_diff = true;",
        "213": "\t\t\tshad.diff = x.diffuse[0];",
        "214": "",
        "215": "\t\t\tvalue( 'subarray1_shading', shad );\t",
        "216": "\t\t\treturn;",
        "217": "\t\t}",
        "218": "\t}",
        "219": "\telse",
        "220": "\t{",
        "221": "\t\tmsgbox('Internal error: ' + x.message);",
        "222": "\t}",
        "223": "};"
    }
}