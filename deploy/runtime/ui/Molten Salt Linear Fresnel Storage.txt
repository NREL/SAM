Molten Salt Linear Fresnel Storage
920
376
26
GroupBox

1
8
Name
5
9
GroupBox1
X
3
6
Y
3
12
Width
3
900
Height
3
353
Tool Tip
5
0
Caption
5
14
Storage System
Bold
2
1
Numeric

1
17
Name
5
7
TES_cap
X
3
321
Y
3
84
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
3
Numeric

1
17
Name
5
14
cold_tank_Thtr
X
3
321
Y
3
276
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
11
Choice

1
9
Name
5
28
csp.mslf.control.store_fluid
X
3
705
Y
3
183
Width
3
160
Height
3
21
Tool Tip
5
0
Items
6
10
Solar Salt
Caloria
Hitec XL
VP-1
Hitec
Dowtherm Q
Dowtherm RP
Therminol 59
Therminol 66
User-defined...
Selection
3
4294967295
TabOrder
3
21
Numeric

1
17
Name
5
23
csp.mslf.control.tes_cp
X
3
705
Y
3
333
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
25
Numeric

1
17
Name
5
25
csp.mslf.control.tes_dens
X
3
705
Y
3
309
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
24
Choice

1
9
Name
5
25
csp.mslf.enet.tes_fp_mode
X
3
705
Y
3
81
Width
3
163
Height
3
24
Tool Tip
5
0
Items
6
2
Electric heating
Fossil heating
Selection
3
4294967295
TabOrder
3
0
Numeric

1
17
Name
5
32
csp.mslf.tes.estimated_heat_loss
X
3
321
Y
3
252
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
10
Numeric

1
17
Name
5
29
csp.mslf.tes.htf_max_opt_temp
X
3
705
Y
3
261
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
16
Numeric

1
17
Name
5
29
csp.mslf.tes.htf_min_opt_temp
X
3
705
Y
3
237
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
16
Numeric

1
17
Name
5
6
d_tank
X
3
321
Y
3
180
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
7
Numeric

1
17
Name
5
7
dt_cold
X
3
705
Y
3
135
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
18
Numeric

1
17
Name
5
6
dt_hot
X
3
705
Y
3
111
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
17
Numeric

1
17
Name
5
11
eta_tes_htr
X
3
705
Y
3
57
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
16
Numeric

1
17
Name
5
6
h_tank
X
3
321
Y
3
132
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
5
Numeric

1
17
Name
5
10
h_tank_min
X
3
321
Y
3
156
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
6
Numeric

1
17
Name
5
13
hot_tank_Thtr
X
3
321
Y
3
300
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
12
Numeric

1
17
Name
5
9
hx_derate
X
3
705
Y
3
159
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
19
MaterialProperties

1
7
Name
5
14
store_fl_props
X
3
705
Y
3
207
Width
3
98
Height
3
28
Tool Tip
5
0
TabOrder
3
22
Numeric

1
17
Name
5
13
tank_max_heat
X
3
705
Y
3
33
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
15
Numeric

1
17
Name
5
10
tank_pairs
X
3
321
Y
3
108
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
1
Mode
3
0
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4
Numeric

1
17
Name
5
8
tes_temp
X
3
705
Y
3
285
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
23
Numeric

1
17
Name
5
7
tshours
X
3
321
Y
3
36
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
1
Numeric

1
17
Name
5
6
u_tank
X
3
321
Y
3
228
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
9
Numeric

1
17
Name
5
7
vol_min
X
3
321
Y
3
204
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
8
Numeric

1
17
Name
5
8
vol_tank
X
3
321
Y
3
60
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
1
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
2

46
TES_cap
3
1
TES Thermal capacity
MWht
MSLF Thermal Storage
0
8
1
1
1
1
0
Default
T_field_in_des
3
1
 
 
MSLF Thermal Storage
0
8
1
1
1
1
0
Default
T_tank_cold_ini
3
1
 
 
MSLF Thermal Storage
0
8
1
1
1
1
0
Default
T_tank_hot_ini
3
1
 
 
MSLF Thermal Storage
0
8
1
1
1
1
0
Default
T_tank_hot_inlet_min
3
1
Minimum hot tank htf inlet temperature
C
MSLF Parasitics
0
2
1
1
1
1
0
Default
V_tank_hot_ini
3
1
 
 
MSLF Thermal Storage
0
8
1
1
1
1
0
Default
cold_tank_Thtr
3
1
Cold tank heater set point
°C
MSLF Thermal Storage
0
2
1
1
1
1
250
Default
csp.mslf.control.ffrac1
3
1
Fossil Fill Fraction Period 1
 
MSLF Thermal Storage
0
3
1
1
1
1
0
Default
csp.mslf.control.ffrac2
3
1
Fossil Fill Fraction Period 2
 
MSLF Thermal Storage
0
3
1
1
1
1
0
Default
csp.mslf.control.ffrac3
3
1
Fossil Fill Fraction Period 3
 
MSLF Thermal Storage
0
3
1
1
1
1
0
Default
csp.mslf.control.ffrac4
3
1
Fossil Fill Fraction Period 4
 
MSLF Thermal Storage
0
3
1
1
1
1
0
Default
csp.mslf.control.ffrac5
3
1
Fossil Fill Fraction Period 5
 
MSLF Thermal Storage
0
3
1
1
1
1
0
Default
csp.mslf.control.ffrac6
3
1
Fossil Fill Fraction Period 6
 
MSLF Thermal Storage
0
3
1
1
1
1
0
Default
csp.mslf.control.ffrac7
3
1
Fossil Fill Fraction Period 7
 
MSLF Thermal Storage
0
3
1
1
1
1
0
Default
csp.mslf.control.ffrac8
3
1
Fossil Fill Fraction Period 8
 
MSLF Thermal Storage
0
3
1
1
1
1
0
Default
csp.mslf.control.ffrac9
3
1
Fossil Fill Fraction Period 9
 
MSLF Thermal Storage
0
3
1
1
1
1
0
Default
csp.mslf.control.store_fluid
3
1
Storage HTF
 
MSLF Thermal Storage
125
Hitec Solar Salt|Caloria HT 43|Hitec XL|Therminol VP-1|Hitec|Dowtherm Q|Dowtherm RP|Therminol 59|Therminol 66|User-defined...
2
1
1
1
1
3
Default
csp.mslf.control.tes_cp
3
1
TES specific heat
kJ/kg-K
MSLF Thermal Storage
0
8
1
1
1
1
0
Default
csp.mslf.control.tes_dens
3
1
TES fluid density
kg/m3
MSLF Thermal Storage
0
8
1
1
1
1
0
Default
csp.mslf.enet.tes_fp_mode
3
1
HTF freeze protection mode
 
MSLF Thermal Storage
31
Electric heating|Fossil heating
2
1
1
1
1
1
Default
csp.mslf.tes.estimated_heat_loss
3
1
Estimated tank heat loss
MWt
MSLF Thermal Storage
0
8
1
1
1
1
0
Default
csp.mslf.tes.htf_max_opt_temp
3
1
Storage HTF max operating temp
°C
MSLF Thermal Storage
0
8
1
1
1
1
0
Default
csp.mslf.tes.htf_min_opt_temp
3
1
Storage HTF min operating temp
°C
MSLF Thermal Storage
0
8
1
1
1
1
0
Default
csp.mslf.tes.notify_text
3
4
 
 
MSLF Thermal Storage
0
0
1
4
5
empty
Default
d_tank
3
1
Tank diameter
m
MSLF Thermal Storage
0
8
1
1
1
1
0
Default
dt_cold
3
1
Cold side HX approach temp
°C
MSLF Thermal Storage
0
8
1
1
1
1
5
Default
dt_hot
3
1
Hot side HX approach temp
°C
MSLF Thermal Storage
0
2
1
1
1
1
5
Default
eta_tes_htr
3
1
Tank heater efficiency
 
MSLF Thermal Storage
0
2
1
1
1
1
0.98
Default
fp_mode
3
1
 
 
MSLF Thermal Storage
0
8
1
1
1
1
0
Default
h_tank
3
1
Height of HTF when tank is full
m
MSLF Thermal Storage
0
2
1
1
1
1
20
Default
h_tank_min
3
1
Minimum tank fluid height
m
MSLF Thermal Storage
0
2
1
1
1
1
1
Default
has_hot_tank_bypass
3
1
Bypass valve connects field outlet to cold tank
-
MSLF Parasitics
0
2
1
1
1
1
0
Default
hot_tank_Thtr
3
1
Hot tank heater set point
°C
MSLF Thermal Storage
0
2
1
1
1
1
450
Default
hx_derate
3
1
Thermal storage exergetic efficiency
 
MSLF Thermal Storage
0
8
1
1
1
1
0
Default
mslf_is_hx
3
1
Heat exchanger no/yes flag
0/1
MSLF Thermal Storage
0
9
1
1
1
1
0
Default
q_max_aux
3
1
 
 
MSLF Thermal Storage
0
8
1
1
1
1
0
Default
store_fl_props
3
3
User-defined HTF
 
MSLF Thermal Storage
0
0
1
3
1
9
1 7 0 0 0 0 0 0 0 

MaterialProperties
store_fluid
3
1
 
 
MSLF Thermal Storage
0
8
1
1
1
1
0
Default
tank_max_heat
3
1
Tank heater capacity
MWe
MSLF Thermal Storage
0
2
1
1
1
1
25
Default
tank_pairs
3
1
Number of equivalent tank pairs
 
MSLF Thermal Storage
0
2
1
1
1
1
1
Default
tanks_in_parallel
3
1
Tanks are in parallel, not in series, with solar field
-
MSLF Parasitics
0
2
1
1
1
1
0
Default
tes_temp
3
1
Fluid Temperature
°C
MSLF Thermal Storage
0
8
1
1
1
1
0
Default
tshours
3
1
Equivalent full-load thermal storage hours
hr
MSLF Thermal Storage
0
2
1
1
1
1
6
Default
u_tank
3
1
Loss coefficient from the tank
W/m2-K
MSLF Thermal Storage
0
2
1
1
1
1
0.4
Default
vol_min
3
1
Min fluid volume
m³
MSLF Thermal Storage
0
8
1
1
1
1
0
Default
vol_tank
3
1
Total tank volume
m³
MSLF Thermal Storage
0
8
1
1
1
1
0
Default

4136
equations{ 'fp_mode' } = define() {
	return ${csp.mslf.enet.tes_fp_mode} + 1; };

equations{ 'q_max_aux' } = define() {
return ${sf_q_design}*${solar_mult}; };
equations{ 'V_tank_hot_ini' } = define() {
return ${vol_tank} * 0.2; };
equations{ 'T_tank_hot_ini' } = define() {
return ${T_loop_out}; };
equations{ 'T_tank_cold_ini' } = define() {
return ${T_loop_in_des}; };
equations{ 'T_field_in_des' } = define() {
return ${T_loop_in_des}; };

equations{ 'store_fluid' } = define() {
	return ?${csp.mslf.control.store_fluid}
	[
		18, //    18.) Nitrate Salt**
		19, //    19.) Caloria HT 43**
		20, //    20.) Hitec XL**
		21, //    21.) Therminol VP-1**
		22, //    22.) Hitec**
		23, //    23.) Dowtherm Q**
		24, //    24.) Dowtherm RP**
		30, //    30.) Therminol 59
		29, //    29.) Therminol 66    
		50  //    user defined HTF
	];
};

equations{ 'csp.mslf.control.tes_cp' } = define() {
	return ?${csp.mslf.control.store_fluid}
[
	substance_specific_heat( 18, ${tes_temp} ),
	substance_specific_heat( 19, ${tes_temp} ),
	substance_specific_heat( 20, ${tes_temp} ),
	substance_specific_heat( 21, ${tes_temp} ),
	substance_specific_heat( 22, ${tes_temp} ),
	substance_specific_heat( 23, ${tes_temp} ),
	substance_specific_heat( 24, ${tes_temp} ),
	substance_specific_heat( 30, ${tes_temp} ),
	substance_specific_heat( 29, ${tes_temp} ),
	substance_userhtf(  ${store_fl_props},${tes_temp}, 'specific heat' )
]; };

equations{ 'vol_min' } = define() {
	return ${vol_tank} * ${h_tank_min} / ${h_tank}; };

equations{ 'vol_tank' } = define() {
	return ${TES_cap} * 3.6e6 / 
(${csp.mslf.control.tes_dens} * ${csp.mslf.control.tes_cp} * 
 ${hx_derate} * 
((${T_loop_out}-${dt_hot}) - 
			 (${T_loop_in_des}-${dt_cold})) ); 
};

equations{ 'TES_cap' } = define() {
	return ${sf_q_design} * ${tshours}; };

equations{ 'tes_temp' } = define() {
	return  ( ${T_loop_in_des} + ${T_loop_out} )/2; };

equations{ 'd_tank' } = define() {
	return 2*sqrt(${vol_tank}/(${h_tank}*3.1415926*${tank_pairs})); };

equations{ 'csp.mslf.tes.estimated_heat_loss' } = define() {
	return ( ${h_tank} * 3.1415926 * ${d_tank} + 
3.1415926 * pow( ${d_tank}/2, 2) ) 
* ${tank_pairs} * ( ${tes_temp} - 20 ) * ${u_tank} / 1.e6; };


equations{ 'hx_derate' } = define() {
	if (${mslf_is_hx} != 1 )
		return 1; /* fluids are the same, no HX */
	else
	{
		dt_ave = 0.5*(${dt_hot}+${dt_cold});
		T_htf_ave = 0.5*(${T_loop_out}+${T_loop_in_des});
		T_cold_baseline = 50.0;
		return (T_htf_ave-2*dt_ave-T_cold_baseline)/(T_htf_ave-T_cold_baseline);
		//return (${T_loop_out}-dt_ave-50.0)/(
		//return 1-(${dt_hot}+${dt_cold})/(${T_loop_out}-${T_loop_in_des});
	}
};

//equations{ 'hx_derate' } = define() {
//	hx = 1; /* fluids are the same, no HX */
//	if (${Fluid} != ${store_fluid})
//	{ 
//		hx = 1-(${dt_hot}+${dt_cold})
//	   /(${T_loop_out} - ${T_loop_in_des});
//	}
//	return hx; };

equations{ 'csp.mslf.tes.htf_min_opt_temp' } = define() {
	return ?${csp.mslf.control.store_fluid} [ 	
	238,/* fluid num 18 */ 	
	-12,/* fluid num 19 */ 	
	120,/* fluid num 20 */ 	
	12,/* fluid num 21 */ 	
	142,/* fluid num 22 */ 	
	-35,/* fluid num 23 */ 	
	0,/* fluid num 24 */ 	
	-45,/* fluid num 30 */ 	
	0,/* fluid num 29 */ 	
	0/* user fluid */ ]; };

equations{ 'csp.mslf.tes.htf_max_opt_temp' } = define() {
	return ?${csp.mslf.control.store_fluid}
[
	593,/* fluid num 18 */
	315,/* fluid num 19 */
	500,/* fluid num 20 */
	400,/* fluid num 21 */
	538,/* fluid num 22 */
	330,/* fluid num 23 */
	330,/* fluid num 24 */
	315,/* fluid num 30 */
	345,/* fluid num 29 */
	0/* user fluid */
]; };

equations{ 'csp.mslf.control.tes_dens' } = define() {
	return ?${csp.mslf.control.store_fluid}
[
	substance_density( 18, ${tes_temp} ),
	substance_density( 19, ${tes_temp} ),
	substance_density( 20, ${tes_temp} ),
	substance_density( 21, ${tes_temp} ),
	substance_density( 22, ${tes_temp} ),
	substance_density( 23, ${tes_temp} ),
	substance_density( 24, ${tes_temp} ),
	substance_density( 30, ${tes_temp} ),
	substance_density( 29, ${tes_temp} ),
	substance_userhtf( ${store_fl_props},${tes_temp},'density' )
]; };


equations{ 'dt_cold' } = define() {
	return ${dt_hot};
};

1069
on_load{'Molten Salt Linear Fresnel Storage'} = define()
{
	on_change{'csp.mslf.control.store_fluid'}();
	//mslf_hx_derate_update();
};

function mslf_hx_derate_update()
{
	obj = ssc_create();

	ssc_var(obj, "HTF_code1", ${store_fluid});
	ssc_var(obj, "fl_props1", ${store_fl_props});
	
	ssc_var(obj, "HTF_code2", ${Fluid});
	ssc_var(obj, "fl_props2", ${field_fl_props});
	
	ret = ssc_exec(obj, 'user_htf_comparison', {'show_dialog'=false, 'hold_dialog'=false});
	
	are_equal = ssc_var(obj, "are_equal");
	
	is_hx = !(are_equal==1);
	
	enable('dt_hot', is_hx );
	enable('dt_cold', is_hx );
	
	// Set 'is_hx' here
	value("mslf_is_hx", is_hx);
	//value("flux_max_dsg", flux_max_dsg);
	
	ssc_free( obj );
}

on_change{'store_fl_props'} = define(){
	mslf_hx_derate_update();
};

on_change{'csp.mslf.control.store_fluid'} = define()
{
	mslf_hx_derate_update();

  bCustomHTF = (value('csp.mslf.control.store_fluid')==9);
  enable('store_fl_props',bCustomHTF);
  enable('csp.mslf.tes.htf_min_opt_temp',!bCustomHTF);
  enable('csp.mslf.tes.htf_max_opt_temp',!bCustomHTF);  
};