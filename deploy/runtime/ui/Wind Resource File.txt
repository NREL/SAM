Wind Resource File
753
698
20
GroupBox

1
8
Name
5
9
GroupBox2
X
3
6
Y
3
9
Width
3
744
Height
3
465
Tool Tip
5
0
Caption
5
50
Choose a representative typical wind resource file
Bold
2
1
Button

1
8
Name
5
14
btnScanLibrary
X
3
549
Y
3
336
Width
3
150
Height
3
24
Tool Tip
5
0
Caption
5
15
Refresh Library
TabOrder
3
4294967295
Button

1
8
Name
5
21
btnWindLocationLookup
X
3
21
Y
3
504
Width
3
158
Height
3
24
Tool Tip
5
0
Caption
5
11
Download...
TabOrder
3
1
GroupBox

1
8
Name
5
8
object 4
X
3
6
Y
3
480
Width
3
744
Height
3
111
Tool Tip
5
0
Caption
5
97
Download a wind resource file from the online NREL WIND Toolkit (continental U.S. locations only)
Bold
2
1
GroupBox

1
8
Name
5
10
object 418
X
3
6
Y
3
594
Width
3
744
Height
3
96
Tool Tip
5
0
Caption
5
48
Use a wind resource file stored on your computer
Bold
2
1
Label

1
13
Name
5
8
object 7
X
3
18
Y
3
648
Width
3
588
Height
3
39
Tool Tip
5
0
Caption
5
127
Check the box and click Browse to choose a an .srw file stored on your computer without adding it to the wind resource library.
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
4294967295
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Label

1
13
Name
5
10
object 719
X
3
216
Y
3
501
Width
3
507
Height
3
81
Tool Tip
5
0
Caption
5
278
Click Download and enter location information for your project site. SAM downloads wind resource data as an .srw file from the NREL WIND Toolkit and stores it in the Downloaded Weather Files folder on your computer shown under "Use a weather file stored on your computer" below.
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
4294967295
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Label

1
13
Name
5
9
object 73
X
3
15
Y
3
30
Width
3
804
Height
3
24
Tool Tip
5
0
Caption
5
128
Click a name in the list to choose a file from the library. Type a few letters of the name in the search box to filter the list.
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
4294967295
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Button

1
8
Name
5
14
select_wf_wind
X
3
648
Y
3
618
Width
3
90
Height
3
24
Tool Tip
5
0
Caption
5
9
Browse...
TabOrder
3
4294967295
CheckBox

1
9
Name
5
20
use_specific_wf_wind
X
3
18
Y
3
618
Width
3
30
Height
3
27
Tool Tip
5
0
Caption
5
0
State
2
0
TabOrder
3
4294967295
TextEntry

1
11
Name
5
22
user_specified_wf_wind
X
3
57
Y
3
618
Width
3
585
Height
3
24
Tool Tip
5
0
Text
5
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
TextEntry

1
11
Name
5
18
wind_resource.city
X
3
102
Y
3
363
Width
3
142
Height
3
24
Tool Tip
5
0
Text
5
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
0
TextEntry

1
11
Name
5
21
wind_resource.country
X
3
102
Y
3
417
Width
3
90
Height
3
24
Tool Tip
5
0
Text
5
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
TextEntry

1
11
Name
5
25
wind_resource.description
X
3
102
Y
3
336
Width
3
425
Height
3
24
Tool Tip
5
0
Text
5
71
NREL AWS TruePower Data: representative of northwestern AR - flat lands
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
0
Numeric

1
17
Name
5
18
wind_resource.elev
X
3
384
Y
3
417
Width
3
142
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
1
Prefix
5
0
Suffix
5
2
 m
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
TextEntry

1
11
Name
5
18
wind_resource.file
X
3
243
Y
3
444
Width
3
499
Height
3
24
Tool Tip
5
0
Text
5
0
Editable
2
1
ForeColour
4
128
0
64
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
17
Name
5
17
wind_resource.lat
X
3
384
Y
3
363
Width
3
142
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
3
 °N
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Library

1
8
Name
5
22
wind_resource.location
X
3
15
Y
3
54
Width
3
726
Height
3
276
Tool Tip
5
0
Library
5
16
WindResourceData
Fields
5
17
Description,State
Numeric

1
17
Name
5
17
wind_resource.lon
X
3
384
Y
3
390
Width
3
142
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
3
 °E
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
TextEntry

1
11
Name
5
19
wind_resource.state
X
3
102
Y
3
390
Width
3
142
Height
3
24
Tool Tip
5
0
Text
5
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
0

23
use_specific_wf_wind
3
1
Wind resource enable user-specified file
 
Wind Resource by Location
0
5
1
1
1
1
0
CheckBox
user_specified_wf_wind
3
4
Wind resource user-specified file
 
Wind Resource by Location
0
1
1
4
1
 
Default
wind_climate.avg_wind_speed_closest_to_hub_ht
3
1
Average wind speed nearest hub height
 
Wind Resource by Location
0
8
1
1
1
1
0
Numeric
wind_climate.msg
3
4
 
 
Wind Resource by Location
0
0
1
4
0
Default
wind_climate.msg_is_error
3
1
 
 
Wind Resource by Location
20
=\wind_resource_info
0
1
1
1
1
0
Default
wind_climate.url_info
3
4
Data source
 
Wind Resource by Location
0
0
1
4
5
empty
Default
wind_resource.city
3
4
City
 
Wind Resource by Location
0
8
1
4
0
TextEntry
wind_resource.closest_dir_meas_ht
3
1
Height of direction data closest to hub height
 
Wind Resource by Location
0
8
1
1
1
1
0
Numeric
wind_resource.closest_speed_meas_ht
3
1
Height of speed data closest to hub height
 
Wind Resource by Location
0
8
1
1
1
1
0
Numeric
wind_resource.country
3
4
Country
 
Wind Resource by Location
0
8
1
4
0
TextEntry
wind_resource.description
3
4
Description
 
Wind Resource by Location
0
8
1
4
0
TextEntry
wind_resource.elev
3
1
Elevation above sea level
 
Wind Resource by Location
0
8
1
1
1
1
0
Numeric
wind_resource.file
3
4
Wind resource file name from library
 
Wind Resource by Location
0
8
1
4
0
TextEntry
wind_resource.lat
3
1
Latitude
 
Wind Resource by Location
0
8
1
1
1
1
0
Numeric
wind_resource.lat_requested
3
1
 
deg
Wind Resource by Location
0
0
1
1
1
1
0
Default
wind_resource.location
3
4
Wind Resource
 
Wind Resource by Location
18
WindResourceData|0
19
1
4
16
WY Cheyenne_2006
Library
wind_resource.location_id
3
4
 
 
Wind Resource by Location
0
8
1
4
0
Default
wind_resource.lon
3
1
Longitude
 
Wind Resource by Location
0
8
1
1
1
1
0
Numeric
wind_resource.lon_requested
3
1
Longitude
deg
Wind Resource by Location
0
0
1
1
1
1
0
Default
wind_resource.requested_ht
3
1
Turbine hub height
 
Wind Resource by Location
0
8
1
1
1
1
0
Numeric
wind_resource.state
3
4
State
 
Wind Resource by Location
0
8
1
4
0
TextEntry
wind_resource.year
3
1
 
 
Wind Resource by Location
0
8
1
1
1
1
0
Default
wind_resource_filename
3
4
Wind resource file for simulation
 
Wind Resource by Location
0
9
1
4
0
Default

244
equations{ 'wind_resource.requested_ht' } = define() {
	return ${wind_turbine_hub_ht}; };

equations{'wind_resource_filename'} = define() {
	if ( ${use_specific_wf_wind} ) return ${user_specified_wf_wind};
	else return ${wind_resource.file};
};
1808
on_change{'btnScanLibrary'} = define() {
	rescanlibrary('wind');
};

on_load{'Wind Resource File'} = define() {
	on_change{'use_specific_wf_wind'}();
};

on_change{'wind_resource.location'} = define() {
	file = ${wind_resource.file};
	
	if (!file_exists(file))
	{
		rescanlibrary( 'wind' );
		refresh('wind_resource.location');
		return;
	}

	file = replace(file, '\\', '/');
	fn = open(file,'r');

	close(fn);
};

on_change{'btnWindLocationLookup'} = define() {
	file = windtoolkit();
	//do nothing if they cancel the window
	if ( file == null || file == "" ) 
		return;
		
	obj = ssc_create();
	//check that the file downloaded in a valid format
	ssc_var( obj, 'file_name', file);
	ssc_var(obj, 'scan_header_only', 1);
	//hard code in a hub height of 80 just for checking the file
	ssc_var(obj, 'requested_ht', 80);
	err = ssc_exec(obj, 'wind_file_reader');
	if (err != 0) //file didn't run successfully
	{
		msgbox('File could not be downloaded successfully. Please check your inputs. If they are correct, the NREL service may be down- please try again later.');
		return;
	}
	ssc_free(obj);
	
	//otherwise, everything went fine, assign the file
	value( 'user_specified_wf_wind', file );
	value( 'use_specific_wf_wind', 1 );
	msgbox("File downloaded successfully! \n" + file);
	enable( 'user_specified_wf_wind', 1);
	enable( 'select_wf_wind', 1);
};

on_change{'use_specific_wf_wind'} = define() {
	enable( 'user_specified_wf_wind', ${use_specific_wf_wind} );
	enable( 'select_wf_wind', ${use_specific_wf_wind} );
};

on_change{'select_wf_wind'} = define() {
	file = choose_file( path_only( value('user_specified_wf_wind') ), 'Choose a wind resource file', 
		'Wind Resource Files (*.srw)|*.srw');
		
	if ( file != '' ) {
		file = replace(file, '\\', '/');
		value( 'user_specified_wf_wind', file );
	}
};