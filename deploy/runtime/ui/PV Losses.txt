PV Losses
853
1000
93
GroupBox

1
8
Name
5
9
GroupBox1
X
3
6
Y
3
204
Width
3
842
Height
3
362
Tool Tip
5
0
Caption
5
9
DC Losses
Bold
2
1
GroupBox

1
8
Name
5
11
GroupBox159
X
3
6
Y
3
864
Width
3
842
Height
3
130
Tool Tip
5
0
Caption
5
19
System Availability
Bold
2
1
GroupBox

1
8
Name
5
9
GroupBox6
X
3
6
Y
3
570
Width
3
842
Height
3
80
Tool Tip
5
0
Caption
5
9
AC Losses
Bold
2
1
GroupBox

1
8
Name
5
11
GroupBox658
X
3
6
Y
3
654
Width
3
842
Height
3
123
Tool Tip
5
0
Caption
5
18
Transformer Losses
Bold
2
1
GroupBox

1
8
Name
5
9
GroupBox7
X
3
6
Y
3
780
Width
3
842
Height
3
80
Tool Tip
5
0
Caption
5
19
Transmission Losses
Bold
2
1
Label

1
13
Name
5
7
Label12
X
3
30
Y
3
285
Width
3
218
Height
3
21
Tool Tip
5
0
Caption
5
26
Diodes and connections (%)
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Label

1
13
Name
5
8
Label121
X
3
30
Y
3
261
Width
3
218
Height
3
21
Tool Tip
5
0
Caption
5
19
Module mismatch (%)
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Label

1
13
Name
5
11
Label121111
X
3
21
Y
3
96
Width
3
218
Height
3
21
Tool Tip
5
0
Caption
5
20
Monthly soiling loss
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Label

1
13
Name
5
9
Label1213
X
3
30
Y
3
333
Width
3
218
Height
3
21
Tool Tip
5
0
Caption
5
18
Tracking error (%)
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Label

1
13
Name
5
8
Label123
X
3
30
Y
3
405
Width
3
218
Height
3
21
Tool Tip
5
0
Caption
5
27
DC power optimizer loss (%)
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Label

1
13
Name
5
9
Label1231
X
3
30
Y
3
429
Width
3
218
Height
3
21
Tool Tip
5
0
Caption
5
23
Total DC power loss (%)
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Label

1
13
Name
5
10
Label12350
X
3
30
Y
3
357
Width
3
218
Height
3
21
Tool Tip
5
0
Caption
5
13
Nameplate (%)
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Label

1
13
Name
5
7
Label14
X
3
30
Y
3
309
Width
3
218
Height
3
21
Tool Tip
5
0
Caption
5
13
DC wiring (%)
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Label

1
13
Name
5
7
Label19
X
3
21
Y
3
123
Width
3
218
Height
3
21
Tool Tip
5
0
Caption
5
27
Average annual soiling loss
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Label

1
13
Name
5
6
Label4
X
3
384
Y
3
69
Width
3
100
Height
3
21
Tool Tip
5
0
Caption
5
10
Subarray 2
TextColour
4
0
0
0
255
Bold
2
1
FontSize
3
0
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
Label

1
13
Name
5
7
Label41
X
3
519
Y
3
69
Width
3
100
Height
3
21
Tool Tip
5
0
Caption
5
10
Subarray 3
TextColour
4
0
0
0
255
Bold
2
1
FontSize
3
0
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
Label

1
13
Name
5
8
Label411
X
3
654
Y
3
69
Width
3
100
Height
3
21
Tool Tip
5
0
Caption
5
10
Subarray 4
TextColour
4
0
0
0
255
Bold
2
1
FontSize
3
0
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
Label

1
13
Name
5
9
Label4111
X
3
252
Y
3
69
Width
3
100
Height
3
21
Tool Tip
5
0
Caption
5
10
Subarray 1
TextColour
4
0
0
0
255
Bold
2
1
FontSize
3
0
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
Label

1
13
Name
5
16
Label_bifacial_0
X
3
765
Y
3
150
Width
3
59
Height
3
21
Tool Tip
5
0
Caption
5
10
Calculate?
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Label

1
13
Name
5
16
Label_bifacial_1
X
3
765
Y
3
360
Width
3
59
Height
3
21
Tool Tip
5
0
Caption
5
10
Calculate?
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Label

1
13
Name
5
18
Label_bifacial_120
X
3
21
Y
3
147
Width
3
218
Height
3
21
Tool Tip
5
0
Caption
5
25
Bifacial rear soiling (%)
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Label

1
13
Name
5
16
Label_bifacial_2
X
3
21
Y
3
171
Width
3
218
Height
3
21
Tool Tip
5
0
Caption
5
25
Bifacial rack shading (%)
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Label

1
13
Name
5
16
Label_bifacial_3
X
3
30
Y
3
381
Width
3
218
Height
3
21
Tool Tip
5
0
Caption
5
32
Bifacial electrical mismatch (%)
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Divider

1
10
Name
5
15
ac_loss_divider
X
3
567
Y
3
885
Width
3
230
Height
3
16
Tool Tip
5
0
Orientation
3
0
Colour
4
120
120
120
255
Caption
5
9
AC Losses
Bold
2
1
Numeric

1
17
Name
5
13
acwiring_loss
X
3
366
Y
3
618
Width
3
100
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
33
LossAdjustment

1
14
Name
5
6
adjust
X
3
567
Y
3
906
Width
3
270
Height
3
73
Tool Tip
5
0
TabOrder
3
4294967295
Description
5
26
Test descriptive text here
Label
5
0
Mode
3
1
AnalysisPeriod
3
25
ShowMode
2
1
AnnualEnabled
2
1
WeeklyEnabled
2
1
Button

1
8
Name
5
10
btn_dc_opt
X
3
645
Y
3
525
Width
3
160
Height
3
28
Tool Tip
5
0
Caption
5
13
DC optimizers
TabOrder
3
4294967295
Button

1
8
Name
5
17
btn_microinverter
X
3
474
Y
3
525
Width
3
160
Height
3
28
Tool Tip
5
0
Caption
5
14
Microinverters
TabOrder
3
4294967295
Button

1
8
Name
5
14
btn_string_inv
X
3
300
Y
3
525
Width
3
160
Height
3
28
Tool Tip
5
0
Caption
5
17
Central inverters
TabOrder
3
4294967295
CheckBox

1
9
Name
5
38
calculate_bifacial_electrical_mismatch
X
3
774
Y
3
378
Width
3
27
Height
3
24
Tool Tip
5
0
Caption
5
0
State
2
1
TabOrder
3
4294967295
CheckBox

1
9
Name
5
22
calculate_rack_shading
X
3
774
Y
3
168
Width
3
27
Height
3
24
Tool Tip
5
0
Caption
5
0
State
2
0
TabOrder
3
4294967295
LossAdjustment

1
14
Name
5
9
dc_adjust
X
3
297
Y
3
906
Width
3
270
Height
3
79
Tool Tip
5
0
TabOrder
3
4294967295
Description
5
0
Label
5
0
Mode
3
1
AnalysisPeriod
3
25
ShowMode
2
1
AnnualEnabled
2
1
WeeklyEnabled
2
1
Divider

1
10
Name
5
15
dc_loss_divider
X
3
291
Y
3
885
Width
3
230
Height
3
16
Tool Tip
5
0
Orientation
3
0
Colour
4
120
120
120
255
Caption
5
9
DC Losses
Bold
2
1
Numeric

1
17
Name
5
16
dcoptimizer_loss
X
3
252
Y
3
405
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
7
Divider

1
10
Name
5
11
object 2120
X
3
30
Y
3
477
Width
3
765
Height
3
16
Tool Tip
5
0
Orientation
3
0
Colour
4
120
120
120
255
Caption
5
17
Default DC Losses
Bold
2
1
GroupBox

1
8
Name
5
8
object 4
X
3
6
Y
3
3
Width
3
842
Height
3
198
Tool Tip
5
0
Caption
5
17
Irradiance Losses
Bold
2
1
Label

1
13
Name
5
8
object 7
X
3
9
Y
3
591
Width
3
831
Height
3
24
Tool Tip
5
0
Caption
5
129
AC losses apply to the electrical output of the inverter and account for losses not calculated by the inverter performance model.
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Label

1
13
Name
5
10
object 715
X
3
21
Y
3
222
Width
3
822
Height
3
36
Tool Tip
5
0
Caption
5
128
DC losses apply to the electrical output of each subarray and account for losses not calculated by the module performance model.
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Label

1
13
Name
5
10
object 718
X
3
75
Y
3
525
Width
3
222
Height
3
28
Tool Tip
5
0
Caption
5
25
Apply default losses for:
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Label

1
13
Name
5
10
object 719
X
3
30
Y
3
495
Width
3
771
Height
3
24
Tool Tip
5
0
Caption
5
80
Apply default losses to replace DC losses for all subarrays with default values.
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Label

1
13
Name
5
10
object 721
X
3
252
Y
3
453
Width
3
465
Height
3
24
Tool Tip
5
0
Caption
5
72
Total DC power loss = 100% * [  1 - the product of ( 1 - loss/100%  )  ]
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
4294967294
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
Label

1
13
Name
5
10
object 729
X
3
366
Y
3
405
Width
3
477
Height
3
21
Tool Tip
5
0
Caption
5
67
All four subarrays are subject to the same DC power optimizer loss.
TextColour
4
112
112
112
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
0
AlignTop
2
0
Label

1
13
Name
5
10
object 762
X
3
21
Y
3
675
Width
3
813
Height
3
64
Tool Tip
5
0
Caption
5
262
The transformer loss model is intended for distribution or substation transformers in large PV systems. Losses apply to the electrical output of the inverter and assume a power factor of 1. The transformer capacity is equal to the total inverter AC power rating.
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Label

1
13
Name
5
10
object 767
X
3
21
Y
3
882
Width
3
258
Height
3
111
Tool Tip
5
0
Caption
5
174
System availability losses reduce the system output to represent system outages or other events. Availability losses may be applied either on the DC or AC side of the system.
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Label

1
13
Name
5
10
object 772
X
3
21
Y
3
21
Width
3
672
Height
3
42
Tool Tip
5
0
Caption
5
150
Losses apply to the total solar irradiance incident on each subarray. SAM applies these losses in addition to any losses on the Shading and Snow page.
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Label

1
13
Name
5
8
object 8
X
3
21
Y
3
801
Width
3
807
Height
3
24
Tool Tip
5
0
Caption
5
63
Transmission losses apply to the system generated power output.
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Numeric

1
17
Name
5
16
subarray1_dcloss
X
3
252
Y
3
429
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
8
Numeric

1
17
Name
5
23
subarray1_dcwiring_loss
X
3
252
Y
3
309
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
5
Numeric

1
17
Name
5
24
subarray1_diodeconn_loss
X
3
252
Y
3
285
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4
Numeric

1
17
Name
5
29
subarray1_electrical_mismatch
X
3
252
Y
3
381
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
2
Numeric

1
17
Name
5
23
subarray1_mismatch_loss
X
3
252
Y
3
261
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
1
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
3
Numeric

1
17
Name
5
24
subarray1_nameplate_loss
X
3
252
Y
3
357
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
7
Numeric

1
17
Name
5
22
subarray1_rack_shading
X
3
252
Y
3
171
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
2
Numeric

1
17
Name
5
27
subarray1_rear_soiling_loss
X
3
252
Y
3
147
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
2
MonthlyFactor

1
8
Name
5
17
subarray1_soiling
X
3
252
Y
3
90
Width
3
99
Height
3
28
Tool Tip
5
0
Description
5
34
Soiling losses for sub-array 1 (%)
TabOrder
3
1
Numeric

1
17
Name
5
32
subarray1_soiling_annual_average
X
3
252
Y
3
123
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
2
Numeric

1
17
Name
5
23
subarray1_tracking_loss
X
3
252
Y
3
333
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
6
Numeric

1
17
Name
5
16
subarray2_dcloss
X
3
384
Y
3
429
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
16
Numeric

1
17
Name
5
23
subarray2_dcwiring_loss
X
3
384
Y
3
309
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
13
Numeric

1
17
Name
5
24
subarray2_diodeconn_loss
X
3
384
Y
3
285
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
12
Numeric

1
17
Name
5
29
subarray2_electrical_mismatch
X
3
384
Y
3
381
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
2
Numeric

1
17
Name
5
23
subarray2_mismatch_loss
X
3
384
Y
3
261
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
11
Numeric

1
17
Name
5
24
subarray2_nameplate_loss
X
3
384
Y
3
357
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
15
Numeric

1
17
Name
5
22
subarray2_rack_shading
X
3
384
Y
3
171
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
2
Numeric

1
17
Name
5
27
subarray2_rear_soiling_loss
X
3
384
Y
3
147
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
2
MonthlyFactor

1
8
Name
5
17
subarray2_soiling
X
3
384
Y
3
90
Width
3
99
Height
3
28
Tool Tip
5
0
Description
5
34
Soiling losses for sub-array 2 (%)
TabOrder
3
9
Numeric

1
17
Name
5
32
subarray2_soiling_annual_average
X
3
384
Y
3
123
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
10
Numeric

1
17
Name
5
23
subarray2_tracking_loss
X
3
384
Y
3
333
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
14
Numeric

1
17
Name
5
16
subarray3_dcloss
X
3
519
Y
3
429
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
24
Numeric

1
17
Name
5
23
subarray3_dcwiring_loss
X
3
519
Y
3
309
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
21
Numeric

1
17
Name
5
24
subarray3_diodeconn_loss
X
3
519
Y
3
285
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
20
Numeric

1
17
Name
5
29
subarray3_electrical_mismatch
X
3
519
Y
3
381
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
2
Numeric

1
17
Name
5
23
subarray3_mismatch_loss
X
3
519
Y
3
261
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
19
Numeric

1
17
Name
5
24
subarray3_nameplate_loss
X
3
519
Y
3
357
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
23
Numeric

1
17
Name
5
22
subarray3_rack_shading
X
3
519
Y
3
171
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
2
Numeric

1
17
Name
5
27
subarray3_rear_soiling_loss
X
3
519
Y
3
147
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
2
MonthlyFactor

1
8
Name
5
17
subarray3_soiling
X
3
519
Y
3
90
Width
3
99
Height
3
28
Tool Tip
5
0
Description
5
34
Soiling losses for sub-array 3 (%)
TabOrder
3
17
Numeric

1
17
Name
5
32
subarray3_soiling_annual_average
X
3
519
Y
3
123
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
18
Numeric

1
17
Name
5
23
subarray3_tracking_loss
X
3
519
Y
3
333
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
22
Numeric

1
17
Name
5
16
subarray4_dcloss
X
3
654
Y
3
429
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
32
Numeric

1
17
Name
5
23
subarray4_dcwiring_loss
X
3
654
Y
3
309
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
29
Numeric

1
17
Name
5
24
subarray4_diodeconn_loss
X
3
654
Y
3
285
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
28
Numeric

1
17
Name
5
29
subarray4_electrical_mismatch
X
3
654
Y
3
381
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
2
Numeric

1
17
Name
5
23
subarray4_mismatch_loss
X
3
654
Y
3
261
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
27
Numeric

1
17
Name
5
24
subarray4_nameplate_loss
X
3
654
Y
3
357
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
31
Numeric

1
17
Name
5
22
subarray4_rack_shading
X
3
654
Y
3
171
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
2
Numeric

1
17
Name
5
27
subarray4_rear_soiling_loss
X
3
654
Y
3
147
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
2
MonthlyFactor

1
8
Name
5
17
subarray4_soiling
X
3
654
Y
3
90
Width
3
99
Height
3
28
Tool Tip
5
0
Description
5
34
Soiling losses for sub-array 4 (%)
TabOrder
3
25
Numeric

1
17
Name
5
32
subarray4_soiling_annual_average
X
3
654
Y
3
123
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
26
Numeric

1
17
Name
5
23
subarray4_tracking_loss
X
3
654
Y
3
333
Width
3
100
Height
3
21
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
30
Numeric

1
17
Name
5
21
transformer_load_loss
X
3
564
Y
3
738
Width
3
100
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
35
Numeric

1
17
Name
5
24
transformer_no_load_loss
X
3
252
Y
3
738
Width
3
100
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
34
Numeric

1
17
Name
5
17
transmission_loss
X
3
366
Y
3
828
Width
3
100
Height
3
24
Tool Tip
5
0
Value
1
0
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
33

54
acwiring_loss
3
1
AC wiring
%
Losses
0
2
1
1
1
1
1
Numeric
adjust
3
5
AC performance adjustment losses
 
Losses
0
1
1
5
1
0
LossAdjustment
calculate_bifacial_electrical_mismatch
3
1
Calculate bifacial electrical mismatch
 
Losses
0
3
1
1
1
1
1
CheckBox
calculate_rack_shading
3
1
Calculate rack shading
 
Losses
0
3
1
1
1
1
0
CheckBox
dc_adjust
3
5
DC performance adjustment losses
 
Losses
0
1
1
5
1
0
LossAdjustment
dcoptimizer_loss
3
1
DC power optimizer loss
%
Losses
0
3
1
1
1
1
0
Default
subarray1_dcloss
3
1
Total DC power loss 1
%
Losses
0
9
1
1
1
1
0
Numeric
subarray1_dcwiring_loss
3
1
DC wiring loss 1
%
Losses
0
3
1
1
1
1
2
Numeric
subarray1_diodeconn_loss
3
1
Diodes and connections loss 1
%
Losses
0
3
1
1
1
1
0.5
Numeric
subarray1_electrical_mismatch
3
1
Electrical mismatch 1
 
Losses
0
3
1
1
1
1
0
Numeric
subarray1_mismatch_loss
3
1
Module mismatch loss 1
%
Losses
0
3
1
1
1
1
2
Numeric
subarray1_nameplate_loss
3
1
Nameplate loss 1
%
Losses
0
3
1
1
1
1
0
Numeric
subarray1_rack_shading
3
1
Rack shading 1
 
Losses
0
3
1
1
1
1
0
Numeric
subarray1_rear_soiling_loss
3
1
Rear soiling loss 1
 
Losses
0
3
1
1
1
1
0
Numeric
subarray1_soiling
3
2
Monthly soiling losses 1
 
Losses
0
3
1
2
1
12
5 5 5 5 5 5 5 5 5 5 5 5 

MonthlyFactor
subarray1_soiling_annual_average
3
1
Average annual soiling 1
%
Losses
0
9
1
1
1
1
0
Numeric
subarray1_tracking_loss
3
1
Tracking error loss 1
%
Losses
0
3
1
1
1
1
0
Numeric
subarray2_dcloss
3
1
Total DC power loss 2
%
Losses
0
9
1
1
1
1
0
Numeric
subarray2_dcwiring_loss
3
1
DC wiring loss 2
%
Losses
0
3
1
1
1
1
2
Numeric
subarray2_diodeconn_loss
3
1
Diodes and connections loss 2
%
Losses
0
3
1
1
1
1
0.5
Numeric
subarray2_electrical_mismatch
3
1
Electrical mismatch 2
 
Losses
0
3
1
1
1
1
0
Numeric
subarray2_mismatch_loss
3
1
Module mismatch loss 2
%
Losses
0
3
1
1
1
1
2
Numeric
subarray2_nameplate_loss
3
1
Nameplate loss 2
%
Losses
0
3
1
1
1
1
0
Numeric
subarray2_rack_shading
3
1
Rack shading 2
 
Losses
0
3
1
1
1
1
0
Numeric
subarray2_rear_soiling_loss
3
1
Rear soiling loss 2
 
Losses
0
3
1
1
1
1
0
Numeric
subarray2_soiling
3
2
Monthly soiling losses 2
 
Losses
0
3
1
2
1
12
5 5 5 5 5 5 5 5 5 5 5 5 

MonthlyFactor
subarray2_soiling_annual_average
3
1
Average annual soiling 2
%
Losses
0
9
1
1
1
1
0
Numeric
subarray2_tracking_loss
3
1
Tracking error loss 2
%
Losses
0
3
1
1
1
1
0
Numeric
subarray3_dcloss
3
1
Total DC power loss 3
%
Losses
0
9
1
1
1
1
0
Numeric
subarray3_dcwiring_loss
3
1
DC wiring loss 3
%
Losses
0
3
1
1
1
1
2
Numeric
subarray3_diodeconn_loss
3
1
Diodes and connections loss 3
%
Losses
0
3
1
1
1
1
0.5
Numeric
subarray3_electrical_mismatch
3
1
Electrical mismatch 3
 
Losses
0
3
1
1
1
1
0
Numeric
subarray3_mismatch_loss
3
1
Module mismatch loss 3
%
Losses
0
3
1
1
1
1
2
Numeric
subarray3_nameplate_loss
3
1
Nameplate loss 3
%
Losses
0
3
1
1
1
1
0
Numeric
subarray3_rack_shading
3
1
Rack shading 3
 
Losses
0
3
1
1
1
1
0
Numeric
subarray3_rear_soiling_loss
3
1
Rear soiling loss 3
 
Losses
0
3
1
1
1
1
0
Numeric
subarray3_soiling
3
2
Monthly soiling losses array 3
 
Losses
0
3
1
2
1
12
5 5 5 5 5 5 5 5 5 5 5 5 

MonthlyFactor
subarray3_soiling_annual_average
3
1
Average annual soiling 3
%
Losses
0
9
1
1
1
1
0
Numeric
subarray3_tracking_loss
3
1
Tracking error loss 3
%
Losses
0
3
1
1
1
1
0
Numeric
subarray4_dcloss
3
1
Total DC power loss 4
%
Losses
0
9
1
1
1
1
0
Numeric
subarray4_dcwiring_loss
3
1
DC wiring loss 4
%
Losses
0
3
1
1
1
1
2
Numeric
subarray4_diodeconn_loss
3
1
Diodes and connections loss 4
%
Losses
0
3
1
1
1
1
0.5
Numeric
subarray4_electrical_mismatch
3
1
Electrical mismatch 4
 
Losses
0
3
1
1
1
1
0
Numeric
subarray4_mismatch_loss
3
1
Module mismatch loss 4
%
Losses
0
3
1
1
1
1
2
Numeric
subarray4_nameplate_loss
3
1
Nameplate loss 4
%
Losses
0
3
1
1
1
1
0
Numeric
subarray4_rack_shading
3
1
Rack shading 4
 
Losses
0
3
1
1
1
1
0
Numeric
subarray4_rear_soiling_loss
3
1
Rear soiling loss 4
 
Losses
0
3
1
1
1
1
0
Numeric
subarray4_soiling
3
2
Monthly soiling losses array 4
 
Losses
0
3
1
2
1
12
5 5 5 5 5 5 5 5 5 5 5 5 

MonthlyFactor
subarray4_soiling_annual_average
3
1
Average annual soiling 4
%
Losses
0
9
1
1
1
1
0
Numeric
subarray4_tracking_loss
3
1
Tracking error loss 4
%
Losses
0
3
1
1
1
1
0
Numeric
transformer_load_loss
3
1
Transformer load loss
%
Losses
0
0
1
1
1
1
0
Numeric
transformer_no_load_loss
3
1
Transformer no load loss
%
Losses
0
0
1
1
1
1
0
Numeric
transformer_rating
3
1
Transformer rating
kVA
Losses
0
0
1
1
1
1
0
Numeric
transmission_loss
3
1
Transmission loss
%
Losses
0
2
1
1
1
1
0
Numeric

1555
equations{ 'subarray1_dcloss' } = define() {
	return (1 - 
	(1-${subarray1_mismatch_loss}/100)
	*(1-${subarray1_diodeconn_loss}/100)
	*(1-${subarray1_dcwiring_loss}/100)
	*(1-${subarray1_tracking_loss}/100)
	*(1-${subarray1_nameplate_loss}/100)
	*(1-${dcoptimizer_loss}/100)
	)*100; 
};

equations{ 'subarray2_dcloss' } = define() {
	return (1 -
	(1-${subarray2_mismatch_loss}/100)
	*(1-${subarray2_diodeconn_loss}/100)
	*(1-${subarray2_dcwiring_loss}/100)
	*(1-${subarray2_tracking_loss}/100)
	*(1-${subarray2_nameplate_loss}/100)
	*(1-${dcoptimizer_loss}/100)
	)*100; 
};

equations{ 'subarray3_dcloss' } = define() {
	return (1 -
	(1-${subarray3_mismatch_loss}/100)
	*(1-${subarray3_diodeconn_loss}/100)
	*(1-${subarray3_dcwiring_loss}/100)
	*(1-${subarray3_tracking_loss}/100)
	*(1-${subarray3_nameplate_loss}/100)
	*(1-${dcoptimizer_loss}/100)
	)*100; 
};
	
equations{ 'subarray4_dcloss' } = define() {
	return (1 -
	(1-${subarray4_mismatch_loss}/100)
	*(1-${subarray4_diodeconn_loss}/100)
	*(1-${subarray4_dcwiring_loss}/100)
	*(1-${subarray4_tracking_loss}/100)
	*(1-${subarray4_nameplate_loss}/100)
	*(1-${dcoptimizer_loss}/100)
	)*100; 
};

equations{ 'subarray1_soiling_annual_average' } = define() {
	return mean(${subarray1_soiling});	};
	
equations{ 'subarray2_soiling_annual_average' } = define() {
	return mean(${subarray2_soiling}); };

equations{ 'subarray3_soiling_annual_average' } = define() {
	return mean(${subarray3_soiling}); };

equations{ 'subarray4_soiling_annual_average' } = define() {
	return mean(${subarray4_soiling}); };
	
3462
function pv_losses_enable_subarray_items( isub, en )
{
	prefix = "subarray" + to_string(isub) + "_";
	vars = [ "dcwiring_loss",
		"diodeconn_loss",
		"mismatch_loss",
		"soiling",
		"nameplate_loss",
		"soiling_annual_average",
		"dcloss",
		"tracking_loss",
		"monthly_soiling"];	
	for (i=0;i<#vars;i++)
		enable( prefix + vars[i], en );
	bifacial_pv_losses_enable_subarray_items( isub, en);
}
function bifacial_pv_losses_enable_subarray_items( isub, en)
{
	enable("calculate_rack_shading", false);	// keep false
	enable("calculate_bifacial_electrical_mismatch", is_bifacial());
	
	prefix = "subarray" + to_string(isub) + "_";
	vars = [ "rear_soiling_loss",
		"rack_shading",
		"electrical_mismatch"];
	for (i=0;i<#vars;i++)
		if (vars[i] == "electrical_mismatch")
			enable( prefix + vars[i], en && is_bifacial() && !value("calculate_bifacial_electrical_mismatch"));
		else
			enable( prefix + vars[i], en && is_bifacial());
}

on_load{'PV Losses'} = define() {
	bifacial_pv_losses_enable_subarray_items( 1, true);
	bifacial_pv_losses_enable_subarray_items( 2, value('subarray2_enable') != false);
	bifacial_pv_losses_enable_subarray_items( 3, value('subarray3_enable') != false);
	bifacial_pv_losses_enable_subarray_items( 4, value('subarray4_enable') != false);
	pv_losses_enable_subarray_items( 2, value('subarray2_enable') != false );
	pv_losses_enable_subarray_items( 3, value('subarray3_enable') != false );
	pv_losses_enable_subarray_items( 4, value('subarray4_enable') != false );
	loss_adjustment_set();
	dc_loss_adjustment_set();
	
	// Remove the following once there's a bifacial rack shading calculation
	show('Label_bifacial_0', false);
	show('calculate_rack_shading', false);
};

on_change{'btn_string_inv'} = define() {
	value('acwiring_loss', 1);
	for (i=1; i<=4; i++)
	{
		prefix = "subarray" + to_string(i) + "_";
		value(prefix + 'mismatch_loss', 2);
		value(prefix + 'diodeconn_loss', 0.5);
		value(prefix + 'dcwiring_loss', 2);
		value(prefix + 'tracking_loss', 0);
		value(prefix + 'nameplate_loss', 0);
	}	
	value('dcoptimizer_loss', 0);
};

on_change{'btn_microinverter'} = define() {
	value('acwiring_loss', 1);
	for (i=1; i<=4; i++)
	{
		prefix = "subarray" + to_string(i) + "_";
		value(prefix + 'mismatch_loss', 0);
		value(prefix + 'diodeconn_loss', 0.5);
		value(prefix + 'dcwiring_loss', 2);
		value(prefix + 'tracking_loss', 0);
		value(prefix + 'nameplate_loss', 0);
	}	
	value('dcoptimizer_loss', 0);
};

on_change{'btn_dc_opt'} = define() {
	value('acwiring_loss', 1);
	for (i=1; i<=4; i++)
	{
		prefix = "subarray" + to_string(i) + "_";
		value(prefix + 'mismatch_loss', 0);
		value(prefix + 'diodeconn_loss', 0.5);
		value(prefix + 'dcwiring_loss', 2);
		value(prefix + 'tracking_loss', 0);
		value(prefix + 'nameplate_loss', 0);
	}	
	value('dcoptimizer_loss', 1);
};

function loss_adjustment_set() 
{
	if (is_assigned('system_use_lifetime_output')) {
		if (value('system_use_lifetime_output') == 1) {
			property('adjust', 'AnalysisPeriod', value('analysis_period'));
		}
		else {
			property('adjust', 'AnalysisPeriod', 1);
		}
	}
	else {
		property('adjust', 'AnalysisPeriod', 1);
	}
}

function dc_loss_adjustment_set() 
{
	if (is_assigned('system_use_lifetime_output')) {
		if (value('system_use_lifetime_output') == 1) {
			property('dc_adjust', 'AnalysisPeriod', value('analysis_period'));
		}
		else {
			property('dc_adjust', 'AnalysisPeriod', 1);
		}
	}
	else {
		property('dc_adjust', 'AnalysisPeriod', 1);
	}
}