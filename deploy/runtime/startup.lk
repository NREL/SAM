// SAM startup script.

en_iscc = 0;

en_pvsamv3 = 0;

// define all the configurations
if ( en_pvsamv3 ) addconfig( 'Photovoltaic', ['None'] );

// order of performance models in configuration tree determined by order of calls to addconfig(), except order of parent items, which appear at the top of the tree with order determined in
// PopulateTech() function in main.cpp.
// order of financial models for each performance model determined by order of array items in second parameter of addconfig().
addconfig( 'Flat Plate PV', ['Residential', 'Commercial', 'Third Party', 'Host Developer', 'Single Owner', 'Merchant Plant', 'Leveraged Partnership Flip', 'All Equity Partnership Flip', 'Sale Leaseback', 'LCOE Calculator', 'None'] );
addconfig( 'PVWatts', [ 'Residential', 'Commercial', 'Third Party', 'Host Developer', 'Single Owner', 'Merchant Plant', 'Leveraged Partnership Flip', 'All Equity Partnership Flip', 'Sale Leaseback', 'LCOE Calculator', 'None' ] );
addconfig( 'High-X Concentrating PV', ['Single Owner', 'Merchant Plant', 'Leveraged Partnership Flip', 'All Equity Partnership Flip', 'Sale Leaseback', 'LCOE Calculator', 'None']);
addconfig( 'Wind Power', [ 'Residential', 'Commercial', 'Single Owner', 'Merchant Plant', 'Leveraged Partnership Flip', 'All Equity Partnership Flip', 'Sale Leaseback', 'LCOE Calculator', 'None'] );
addconfig( 'Physical Trough', ['Commercial','Single Owner', 'Merchant Plant', 'Leveraged Partnership Flip', 'All Equity Partnership Flip', 'Sale Leaseback', 'LCOE Calculator', 'None']);
addconfig( 'Empirical Trough', ['Commercial','Single Owner', 'Merchant Plant', 'Leveraged Partnership Flip', 'All Equity Partnership Flip', 'Sale Leaseback', 'LCOE Calculator', 'None']);
addconfig( 'MSPT', ['Single Owner', 'Merchant Plant', 'Leveraged Partnership Flip', 'All Equity Partnership Flip', 'Sale Leaseback']);
addconfig( 'DSPT', ['Single Owner', 'Merchant Plant', 'Leveraged Partnership Flip', 'All Equity Partnership Flip', 'Sale Leaseback']);
addconfig( 'MSLF', ['Commercial','Single Owner', 'Merchant Plant', 'Leveraged Partnership Flip', 'All Equity Partnership Flip', 'Sale Leaseback', 'LCOE Calculator', 'None']);
addconfig( 'DSLF', ['Commercial','Single Owner', 'Merchant Plant', 'Leveraged Partnership Flip', 'All Equity Partnership Flip', 'Sale Leaseback', 'LCOE Calculator', 'None']);
addconfig( 'Dish Stirling', ['Commercial','Single Owner', 'Merchant Plant', 'Leveraged Partnership Flip', 'All Equity Partnership Flip', 'Sale Leaseback', 'LCOE Calculator', 'None']);
addconfig( 'Generic CSP System', ['Commercial','Single Owner', 'Merchant Plant', 'Leveraged Partnership Flip', 'All Equity Partnership Flip', 'Sale Leaseback', 'LCOE Calculator', 'None']);
if ( en_iscc ) { addconfig( 'ISCC', ['Single Owner']); }
addconfig( 'Physical Trough IPH', ['None', 'LCOH Calculator']);
addconfig( 'DSGL IPH', ['None', 'LCOH Calculator']);
addconfig( 'Fuel Cell', ['Commercial', 'Single Owner']);
addconfig( 'MEwave', ['LCOE Calculator']);
addconfig( 'MEtidal', ['LCOE Calculator']);
addconfig( 'Geothermal Power', ['Single Owner', 'Merchant Plant', 'Leveraged Partnership Flip', 'All Equity Partnership Flip', 'Sale Leaseback', 'LCOE Calculator', 'None']);
addconfig( 'Solar Water Heating', ['Residential', 'Commercial', 'LCOE Calculator', 'None']);
addconfig( 'Biopower', ['Single Owner', 'Merchant Plant', 'Leveraged Partnership Flip', 'All Equity Partnership Flip', 'Sale Leaseback', 'LCOE Calculator', 'None']);
addconfig( 'Generic System', ['Residential', 'Commercial', 'Third Party', 'Host Developer', 'Single Owner', 'Merchant Plant', 'Leveraged Partnership Flip', 'All Equity Partnership Flip', 'Sale Leaseback', 'LCOE Calculator', 'None']);
addconfig( 'PV Battery', ['Residential', 'Commercial', 'Third Party', 'Host Developer', 'Single Owner', 'Merchant Plant', 'Leveraged Partnership Flip', 'All Equity Partnership Flip', 'Sale Leaseback'] );
addconfig( 'PVWatts Battery', ['Residential', 'Commercial', 'Third Party', 'Host Developer'] );
addconfig( 'Generic Battery', ['Residential', 'Commercial', 'Third Party', 'Host Developer', 'Single Owner', 'Merchant Plant', 'Leveraged Partnership Flip', 'All Equity Partnership Flip', 'Sale Leaseback'] );

// tree_parent for performance models defined in PopulateTech() in main.cpp
if ( en_pvsamv3 ) {	configopt( 'Photovoltaic', {'tree_parent'='PV', 'long_name'='Photovoltaic (super detailed)', 'short_name'='Photovoltaic', 'description'='Photovoltaic system using detailed photovoltaic model with separate module and inverter component models' } ); }	
configopt( 'Flat Plate PV',               { 'tree_parent'='PV', 'long_name'='Detailed PV Model',                'short_name'='Photovoltaic',     'description'='Photovoltaic system using detailed photovoltaic model with separate module and inverter component models' } );
configopt( 'PVWatts',                     { 'tree_parent'='PV','long_name'='PVWatts',                 'short_name'='PVWatts',          'description'='Photovoltaic system using basic NREL PVWatts V5 algorithm' } );
configopt( 'High-X Concentrating PV',     { 'tree_parent'='PV', 'long_name'='High Concentration PV',                  'short_name'='HCPV',             'description'='Concentrating photovoltaic system with a high concentration photovoltaic module model and separate inverter model' } );
configopt( 'PV Battery',               { 'tree_parent'='BATT', 'long_name'='Detailed PV-Battery',       'short_name'='PV-Battery',     'description'='Detailed photovoltaic model with battery storage' } );
configopt( 'PVWatts Battery',          { 'tree_parent'='BATT', 'long_name'='PVWatts-Battery',     'short_name'='PVWatts-Battery',     'description'='PVWatts system model with battery storage' } );
configopt( 'Generic Battery',          { 'tree_parent'='BATT', 'long_name'='Generic System-Battery',    'short_name'='Generic-Battery',     'description'='Generic system model with battery storage' } );
configopt( 'Wind Power',                  { 'long_name'='Wind',                                   'short_name'='Wind',             'description'='Small or large wind power system' } );
configopt( 'Biopower',                    { 'long_name'='Biomass Combustion',                     'short_name'='Biopower',         'description'='Biomass combustion for electricity generation' } );
configopt( 'Geothermal Power',            { 'long_name'='Geothermal',                             'short_name'='Geothermal',       'description'='Geothermal power model for hydrothermal and EGS systems with flash or binary conversion' } );
configopt( 'Solar Water Heating',         { 'long_name'='Solar Water Heating',                    'short_name'='Solar water',      'description'='Solar water heating model for residential and commercial building applications' } );
configopt( 'Fuel Cell',                   { 'long_name'='Fuel Cell-PV-Battery',                   'short_name'='Fuel Cell',        'description'='Fuel cell with photovoltaic system and optional electric battery for commercial building or PPA project applications' } );
configopt( 'Generic System',              { 'long_name'='Generic System',                         'short_name'='Generic',          'description'='Basic power system model using either capacity, capacity factor, and heat rate, or an hourly power generation profile as input' } );
configopt( 'MSPT',     	                  { 'tree_parent'='CSP', 'long_name'='Power Tower Molten Salt',            'short_name'='Tower (salt)',     'description'='CSP molten salt power tower system using heat transfer and thermodynamic component models' } );
configopt( 'DSPT',     	                  { 'tree_parent'='CSP', 'long_name'='Power Tower Direct Steam',           'short_name'='Tower (steam)',    'description'='CSP direct steam power tower system using heat transfer and thermodynamic component models' } );
configopt( 'Physical Trough',             { 'tree_parent'='CSP', 'long_name'='Parabolic Trough - Physical',        'short_name'='Trough (phys)',    'description'='CSP parabolic trough system using heat transfer and thermodynamic component models' } );
configopt( 'Empirical Trough',            { 'tree_parent'='CSP', 'long_name'='Parabolic Trough - Empirical',       'short_name'='Trough (empr)',    'description'='CSP parabolic trough system using model with empirically-derived coefficients and equations' } );
configopt( 'Dish Stirling',            	  { 'tree_parent'='CSP', 'long_name'='Dish Stirling',                      'short_name'='Dish Stirling',    'description'='Dish Stirling model with parameters for SES and WGA-ADDS systems' } );
configopt( 'Generic CSP System',          { 'tree_parent'='CSP', 'long_name'='Generic Model',                      'short_name'='Generic CSP',      'description'='CSP power system with solar field modeled using a table of optical efficiency values' } );
configopt( 'DSLF',        				  { 'tree_parent'='CSP', 'long_name'='Linear Fresnel Direct Steam',        'short_name'='Fresnel (steam)',  'description'='CSP power system that uses long small mirrors to line focus sunlight on fixed receiver tubes mounted above them.' } );
configopt( 'MSLF',        				  { 'tree_parent'='CSP', 'long_name'='Linear Fresnel Molten Salt',         'short_name'='Fresnel (salt)',   'description'='CSP power system that uses long small mirrors to line focus sunlight on fixed receiver tubes mounted above them.' } );
if ( en_iscc ) { configopt( 'ISCC',       { 'tree_parent'='CSP', 'long_name'='Integrated Solar Combined Cycle',    'short_name'='Tower Salt ISCC',  'description'='A triple pressure NGCC cycle connected to a molten salt power tower solar field/receiver' } ); }
configopt( 'Physical Trough IPH',         { 'tree_parent'='CSP', 'long_name'='Parabolic Trough - Heat',          'short_name'='IPH Trough',       'description'='Industrial process heat parabolic trough system using heat transfer and thermodynamic component models' } );
configopt( 'DSGL IPH',                    { 'tree_parent'='CSP', 'long_name'='Linear Fresnel Direct Steam - Heat',       'short_name'='IPH Linear (steam)','description'='Industrial process heat linear collector system' } );
configopt( 'MEwave',                     { 'tree_parent'='ME', 'long_name'='Wave',           'short_name'='Marine Wave',          'description'='Marine energy wave system' });
configopt( 'MEtidal',                    { 'tree_parent'='ME', 'long_name'='Tidal',          'short_name'='Marine Tidal',         'description'='Marine energy tidal system' });

// tree_parent for financial models defined in UpdateFinTree() in main.cpp
configopt( 'LCOE Calculator',             { 'long_name'='LCOE Calculator (FCR Method)',           'short_name'='LCOE Calculator',  'description'='Calculate LCOE using fixed charge rate method' } );
configopt( 'Residential',                 { 'tree_parent'='DISTRIBUTED', 'long_name'='Residential Owner',           	  'short_name'='Residential',      'description'='Renewable energy system displaces residential home electric load' } );
configopt( 'Commercial',                  { 'tree_parent'='DISTRIBUTED','long_name'='Commercial Owner',        		  'short_name'='Commercial',       'description'='Renewable energy system displaces commercial building electric load' } );
configopt( 'Third Party',                 { 'tree_parent'='DISTRIBUTED',  'long_name'='Third Party Owner - Host',           'short_name'='TPO Host',      'description'='Third party ownership from host perspective for PPA or lease agreement' } );
configopt( 'Host Developer',              { 'tree_parent'='DISTRIBUTED',  'long_name'='Third Party - Host / Developer', 'short_name'='TPO Host/Developer',  'description'='Third party ownershop from host and developer perspective for PPA' } );
configopt( 'Single Owner',                { 'tree_parent'='PPA', 'long_name'='Single Owner',                       'short_name'='Single owner',     'description'='Single owner PPA with constant DSCR and IRR target year, reserve accounts and depreciation allocations' } );
configopt( 'Leveraged Partnership Flip',  { 'tree_parent'='PPA', 'long_name'='Partnership Flip with Debt',         'short_name'='Flip (debt)',      'description'='Developer/investor partnership flip PPA structure with debt' } );
configopt( 'All Equity Partnership Flip', { 'tree_parent'='PPA', 'long_name'='Partnership Flip without Debt',      'short_name'='Flip (no debt)',   'description'='Developer/investor partnership flip PPA structure without debt' } );
configopt( 'Sale Leaseback',              { 'tree_parent'='PPA', 'long_name'='Sale Leaseback',                     'short_name'='Sale leaseback',   'description'='Sale leaseback partnership PPA structure' } );
configopt( 'Single Owner PPA Buy Rate',   { 'tree_parent'='PPA', 'long_name'='Single Owner with Buy Rate',         'short_name'='Single owner buy rate',     'description'='Single owner PPA with constant DSCR and IRR target year, reserve accounts and depreciation allocations' } );
configopt( 'Merchant Plant',              { 'long_name'='Merchant Plant',                         'short_name'='Merchant',     'description'='Merchant plant with constant DSCR and ancillary services revenue, reserve accounts and depreciation allocations' } );
configopt( 'None',                        { 'long_name'='No Financial Model',                               'short_name'='No financial',     'description'='Run the performance model with no financial model' } );

enum { LOAD_SIMPLE, LOAD_BELPE, LOAD_SIMPLE_CRIT, LOAD_BELPE_CRIT, NO_LOAD };
enum { DEGRADATION_AC_SINGLE_YEAR, DEGRADATION_DC_LIFETIME, DEGRADATION_AC_LIFETIME, DEGRADATION_PVSAM };

function setup_elec_load_page( mode ) //i is 1 for technologies that HAVE the building load calculator (for now just PV, CSP, Biopower, and Generic Solar- MUST HAVE SOLAR RESOURCE DATA), 2 for techs without ANY load pages (SWH), and 0 for technologies that don't
{
	if (mode == LOAD_BELPE)
	{
		addpage( [ [{'name' ='Electric Load', 'caption' = 'No Load Data'}], [{'name'='Electric Load Other', 'caption'='Input Time Series Load Data'}], [{'name'='Electric Building Load Calculator', 'caption'='Calculate Load Data'}] ], 
			{ 'sidebar'='Electric Load', 'exclusive_var'='load_model', 'help'='electric_load' } );
	}
	elseif( mode == LOAD_SIMPLE )
	{
		addpage( [ [{'name' ='Electric Load', 'caption' = 'No Load Data'}], [{'name'='Electric Load Other', 'caption'='Input Time Series Load Data'}] ], 
			{ 'sidebar'='Electric Load', 'exclusive_var'='load_model', 'help'='electric_load' } );
	}
	elseif( mode == LOAD_BELPE_CRIT )
	{
		addpage( [ [{'name' ='Electric Load', 'caption' = 'No Load Data'}], [{'name'='Electric Load Crit', 'caption'='Input Time Series Load Data'}, 
			{'name'='Electric Load Critical', 'caption'='Critical Loads', 'collapsible'=true, 'collapsible_var'='crit_load_is_shown'}], [{'name'='Electric Building Load Calculator', 'caption'='Calculate Load Data'}] ], 
			{ 'sidebar'='Electric Load', 'exclusive_var'='load_model', 'help'='electric_load' } );
	}
	elseif ( mode == LOAD_SIMPLE_CRIT )
	{
		addpage( [ [{'name' ='Electric Load', 'caption' = 'No Load Data'}], [{'name'='Electric Load Crit', 'caption'='Input Time Series Load Data'},
			{'name'='Electric Load Critical', 'caption'='Critical Loads', 'collapsible'=true, 'collapsible_var'='crit_load_is_shown'}] ], 
			{ 'sidebar'='Electric Load', 'exclusive_var'='load_model', 'help'='electric_load' } );
	}
	else return;
}

function setup_battery_pages_behind_the_meter()
{
	addpage([['Battery Model',
			  'Battery Bank Sizing',
			   'Battery REopt Optimization',
			   'Battery Current and Capacity',
			   'Battery Configuration',
			   'Battery Dispatch Common',
			   'Battery Dispatch Behind the Meter',
			   'Battery Dispatch Manual', 
               {'name'='Battery Lifetime', 'caption'='Battery Lifetime', 'collapsible'=true, 'collapsible_var'='battery_lifetime_shown'},
			   {'name'='Battery Replacements', 'caption'='Battery Replacements', 'collapsible'=true, 'collapsible_var'='battery_replacements_shown'},
			   {'name'='Battery Voltage', 'caption'='Battery Voltage', 'collapsible'=true, 'collapsible_var'='battery_voltage_shown'},
			   {'name'='Battery Ancillary Losses', 'caption'='Battery Losses', 'collapsible'=true, 'collapsible_var'='battery_losses_shown'},
			   {'name'='Battery Thermal', 'caption'='Battery Thermal', 'collapsible'=true, 'collapsible_var'='battery_thermal_shown'},
			  ]],
			  { 'sidebar'='Battery Storage', 'help'='battery_storage_btm' } );
}

function setup_battery_pages_front_of_meter()
{
	addpage([ [  'Battery Model',
				'Battery Bank Sizing',
			   'Battery Current and Capacity',
			   'Battery Configuration',
			   'Battery Dispatch Common',
			   'Battery Dispatch Front of Meter', 
			   'Battery Dispatch Manual',
			   {'name'='Battery Lifetime', 'caption'='Battery Lifetime', 'collapsible'=true, 'collapsible_var'='battery_lifetime_shown'},
			   {'name'='Battery Replacements', 'caption'='Battery Replacements', 'collapsible'=true, 'collapsible_var'='battery_replacements_shown'},
			   {'name'='Battery Voltage', 'caption'='Battery Voltage', 'collapsible'=true, 'collapsible_var'='battery_voltage_shown'},
			   {'name'='Battery Ancillary Losses', 'caption'='Battery Losses', 'collapsible'=true, 'collapsible_var'='battery_losses_shown'},
			   {'name'='Battery Thermal', 'caption'='Battery Thermal', 'collapsible'=true, 'collapsible_var'='battery_thermal_shown'},
			   ] ],
			  { 'sidebar'='Battery Storage', 'help'='Battery_Storage_fom' } );
}

function setup_pvwatts_battery_pages_behind_the_meter()
{
	addpage( [[ 'Solar Resource Data' ]], { 'sidebar'='Location and Resource', 'help'='pv_location_and_resource' } );
	addpage( [[ 'PVWatts', 'Battery Model Simple with REopt']], { 'sidebar'='System Design', 'help'='pvwatts_system_design' } );
	setup_grid_page();
}

function setup_pvwatts_pages()
{
	addpage( [[ 'Solar Resource Data' ]], { 'sidebar'='Location and Resource', 'help'='pv_location_and_resource' } );
	addpage( [[ 'PVWatts']], { 'sidebar'='System Design', 'help'='pvwatts_system_design' } );
	setup_grid_page();

}
function setup_flat_plate_pv_pages()
{
	//addpage( [ ['AA Widgets'] ], { 'sidebar'='Widgets' } ); // use for widget testing

	addpage( [[ 'Solar Resource Data', {'name'='PV Albedo and Radiation', 'caption' = 'Albedo - Sky Diffuse Model - Irradiance Data (Advanced)', 'collapsible'=true, 'collapsible_var'='pv.radmode.is_shown'} ]], { 'sidebar'='Location and Resource', 'help'='pv_location_and_resource' } );
	addpage( [ ['Simple Efficiency Module Model'],
//				['CEC Performance Model with Module Database', { 'name'='Test 1', 'collapsible'=true, 'collapsible_var'='pv.module.test_1.is_shown' }],
				['CEC Performance Model with Module Database'],
				['CEC Performance Model with User Entered Specifications'], 
				['Sandia PV Array Performance Model with Module Database'],
				['IEC61853 Single Diode Model'] ], 				
			{ 'sidebar'='Module', 'help'='pv_module', 'exclusive_var'='module_model' } );
	addpage( [ ['Inverter CEC Database', 'Inverter Temp Derate CEC DB'], 
			 ['Inverter Datasheet', 'Inverter Temp Derate DS'], 
			 ['Inverter Part Load Curve', 'Inverter Temp Derate PLC'], 
			 ['Inverter CEC Coefficient Generator', 'Inverter Temp Derate CEC CG'] ], 
			{ 'sidebar'='Inverter', 'help'='pv_inverter', 'exclusive_var'='inverter_model' } );
	// Battery Enable form stores hidden en_batt variable required by some UI forms to determine if there is a battery
	addpage( [ ['PV System Design', {'name'='PV Subarray Voltage Mismatch', 'collapsible'=true, 'collapsible_var' = 'mismatch_shown'}, 'Battery Enable'] ], { 'sidebar'='System Design', 'help'='pv_system_design' } );
	addpage( [ ['PV Shading'] ], { 'sidebar'='Shading and Layout', 'help'='pv_shading' } );
	addpage( [ ['PV Losses'] ], { 'sidebar'='Losses', 'help'='pv_losses' } );
	setup_grid_page();
}

function setup_lifetime_page( degradation_mode )
{
	sidebar_name = 'Lifetime and Degradation';
	help_name = 'lifetime';
	// annual DC degradation over analysis period, 'dc_degradation' requires 'system_use_lifetime = 1'
	// PVWatts, PVWatts Battery, Fuel Cell
	if ( degradation_mode == DEGRADATION_DC_LIFETIME ) 
	{
		addpage( [ [ 'Degradation DC Lifetime' ] ], { 'sidebar'=sidebar_name,'help'=help_name } );
    }
    // annual AC degradation over analysis period, 'generic_degradation' requires 'system_use_lifetime = 1'
    // Generic Battery
    elseif ( degradation_mode == DEGRADATION_AC_LIFETIME ) 
    {
    	addpage( [ [ 'Degradation AC Lifetime'] ], { 'sidebar'=sidebar_name,'help'=help_name } );
    }
    // annual DC degradation over analysis period with daily AC / DC losses over lifetime
    // 'dc_degradation' requires 'system_use_lifetime = 1'
    // Flat Plate PV, PV Battery
	elseif ( degradation_mode == DEGRADATION_PVSAM )
	{
		addpage( [ [ 'Degradation DC Lifetime', 'Degradation AC DC Lifetime Daily', 'Degradation Lifetime Variables'], ],
                 { 'sidebar'=sidebar_name,'help'=help_name } );
	}
     // annual AC degradation over one year, 'degradation' requires 'system_use_lifetime = 0'
     // everything else. 
     else // DEGRADATION_AC_SINGLE_YEAR
     {
     	addpage( [ [ 'Degradation AC Single Year'] ], { 'sidebar'=sidebar_name,'help'=help_name } );
     }
}

//// Financial input pages /////////////////////////////////////////////////////

function setup_residential_pages( mode ) // mode determines whether or not the building load calculator is included (see function:setup_elec_load_page)
{
  setting( { 'analysis_period_var'='cf_length' } );
  addpage( [[ 'Financial Debt Residential',
              'Financial Analysis Parameters',
              'Financial Tax and Insurance Rates',
              'Financial Salvage Value' ]],
           { 'sidebar'='Financial Parameters', 'help'='fin_residential'} );
  addpage( [[ 'Financial DSIRE Download',
              { 'name'='Financial Tax Credits','caption'='Tax Credits','collapsible'=true,'collapsible_var'='show_tax_credits', 'collapsed_by_default'=false },
              { 'name'='Financial Cash Incentives','caption'='Direct Cash Incentives','collapsible'=true,'collapsible_var'='show_cash_incentives', 'collapsed_by_default'=false } ]], 
           { 'sidebar'='Incentives','help'='incentives' } );
  setup_utility_rate();
  setup_elec_load_page( mode );
}

function setup_thirdparty_pages( load ) // FOR NOW, THIRD PARTY OWNERSHIP MODEL IS ONLY VALID FOR PVWATTS AND PV DETAILED and generic system!!
{
  setting( { 'analysis_period_var'='cf_length' } );
  addpage( [[ 'Financial Third Party Ownership']],
           { 'sidebar'='Financial Parameters', 'help'='fin_thirdparty'} );
  setup_utility_rate();
  setup_elec_load_page( load ); // BELPE IS VALID FOR BOTH PVWATTS AND PV DETAILED, but not generic system
}

function setup_lcoefcr_pages() // LCOE calculator will not work with tower models because cost inputs required for solar pilot
{
  addpage( [[ 'Financial LCOE Calculator']],
           { 'sidebar'='Financial Parameters', 'help'='fin_lcoefcr'} );
}

function setup_iph_lcoefcr_pages() // LCOE calculator will not work with tower models because cost inputs required for solar pilot
{
  addpage( [[ 'Financial LCOE Calc IPH Add', 
				'Financial LCOE Calculator']],
           { 'sidebar'='Financial Parameters', 'help'='fin_lcoefcr'} );
}

function setup_commercial_pages( mode ) // mode determines whether or not the building load calculator is included (see function:setup_elec_load_page)
{
  setting( { 'analysis_period_var'='cf_length' } );
  addpage( [[ 'Financial Debt Min DSCR',
              'Financial Analysis Parameters',
		      'Financial Tax and Insurance Rates',
		      'Financial Salvage Value',
              'Financial Depreciation Simple', ]],
           { 'sidebar'='Financial Parameters','help'='fin_commercial'} );
  addpage( [[ 'Financial DSIRE Download',
              { 'name'='Financial Tax Credits','caption'='Tax Credits','collapsible'=true,'collapsible_var'='show_tax_credits', 'collapsed_by_default'=false },
              { 'name'='Financial Cash Incentives','caption'='Direct Cash Incentives','collapsible'=true,'collapsible_var'='show_cash_incentives', 'collapsed_by_default'=false } ]],
		   { 'sidebar'='Incentives', 'help'='incentives' } );
 setup_utility_rate();
  setup_elec_load_page( mode );
}

function setup_grid_page()
{
  addpage( [[ 'Grid Interconnection', 'Grid Curtailment']],
           { 'sidebar'='Grid Limits', 'help'='grid_limits' } );					
}

// note 'collapsed by default' does not seem to do anything. To set default behavior, set default value of collapsible_var. For example, to collapse description by default, use Defaults Manager to set ur_desc_is_shown = 0.
function setup_utility_rate()
{
	addpage( [[ 'Utility Rate - Flat',
			    { 'name'='Utility Rate - Description', 'caption'='Description and Applicability', 'collapsible'=true, 'collapsible_var'='ur_desc_is_shown', 'collapsed_by_default'=true }, 
			    { 'name'='Utility Rate - Energy Charge', 'caption'='Energy Charges', 'collapsible'=true, 'collapsible_var'='ur_ec_is_shown', 'collapsed_by_default'=false },
			    { 'name'='Utility Rate - Demand Charge', 'caption'='Demand Charges', 'collapsible'=true, 'collapsible_var'='ur_dc_is_shown', 'collapsed_by_default'=false } ]],
		     { 'sidebar'='Electricity Rates', 'help'='electricity_rates' } );
}

// 'en_electricity_rates' is only an input available for single owner configurations
function setup_utility_rate_optional()
{
	addpage( [[{'name'='Utility Rate - Enable','caption'='No Electricity Rate'}],
			  [{'name'='Utility Rate - Flat', 'caption'='Enable Electricity Rate'},
			    { 'name'='Utility Rate - Description', 'caption'='Description and Applicability', 'collapsible'=true, 'collapsible_var'='ur_desc_is_shown', 'collapsed_by_default'=true }, 
			    { 'name'='Utility Rate - Energy Charge', 'caption'='Energy Charges', 'collapsible'=true, 'collapsible_var'='ur_ec_is_shown', 'collapsed_by_default'=false },
			    { 'name'='Utility Rate - Demand Charge', 'caption'='Demand Charges', 'collapsible'=true, 'collapsible_var'='ur_dc_is_shown', 'collapsed_by_default'=false} ]],
		     { 'sidebar'='Electricity Rates', 'help'='electricity_rates', 'exclusive_var'='en_electricity_rates' } );
}

function setup_single_owner_pages()
{
  setting( { 'analysis_period_var'='cf_length' } );
  addpage( [[ 'Financial Analysis Parameters',
		      'Financial Tax and Insurance Rates',
		      'Financial Salvage Value',
		      {'name'='Financial Debt DSCR or Debt Fraction','caption'='Project Term Debt','collapsible'=true,'collapsible_var'='show_DebtConstDSCR'},
              {'name'='Financial Cost of Financing Single Owner', 'caption'='Cost of Acquiring Financing','collapsible'=true,'collapsible_var'='show_CapitalCostSO'},
              {'name'='Financial Construction Financing','caption'='Construction Financing','collapsible'=true,'collapsible_var'='show_construction_period', 'collapsed_by_default'=false},
              {'name'='Financial Reserve Accounts', 'caption'='Reserve Accounts','collapsible'=true,'collapsible_var'='show_ReserveAccounts'},
               {'name'='Financial Return on Equity', 'caption'='Return on Equity','collapsible'=true,'collapsible_var'='show_ReturnonEquity', 'collapsed_by_default'=true}  ]], 
           { 'sidebar'='Financial Parameters', 'help'='fin_single_owner' }  );
  addpage( [[ 'Financial Solution Mode Single Owner', 
  			    { 'name'='Financial TOD Factors', 'caption'='Time of Delivery', 'collapsible'=true, 'collapsible_var'='revenue_TOD_is_shown', 'collapsed_by_default'=true }, 
			    { 'name'='Financial Capacity Payments', 'caption'='Capacity Payments', 'collapsible'=true, 'collapsible_var'='revenue_capacity_payments_is_shown', 'collapsed_by_default'=true },
			    { 'name'='Financial Curtailment Price', 'caption'='Curtailment Payments', 'collapsible'=true, 'collapsible_var'='revenue_curtailment_is_shown', 'collapsed_by_default'=true } ]],
            { 'sidebar'='Revenue', 'help'='revenue_ppa' } );					
  addpage( [[ 'Financial Tax Credits','Financial Cash Incentives']],
           { 'sidebar'='Incentives', 'help'='incentives' } );					
  addpage( [['Financial Depreciation Detailed' ]], 
           { 'sidebar'='Depreciation', 'help'='depreciation' });
}

function setup_merchant_plant_pages()
{
  setting( { 'analysis_period_var'='cf_length' } );
  addpage( [[ 'Financial Analysis Parameters',
		      'Financial Tax and Insurance Rates',
		      'Financial Salvage Value',
		      {'name'='Financial Debt DSCR or Debt Fraction','caption'='Project Term Debt','collapsible'=true,'collapsible_var'='show_DebtConstDSCR'},
              {'name'='Financial Cost of Financing Single Owner', 'caption'='Cost of Acquiring Financing','collapsible'=true,'collapsible_var'='show_CapitalCostSO'},
              {'name'='Financial Construction Financing','caption'='Construction Financing','collapsible'=true,'collapsible_var'='show_construction_period', 'collapsed_by_default'=false},
              {'name'='Financial Reserve Accounts', 'caption'='Reserve Accounts','collapsible'=true,'collapsible_var'='show_ReserveAccounts'},
               {'name'='Financial Return on Equity', 'caption'='Return on Equity','collapsible'=true,'collapsible_var'='show_ReturnonEquity', 'collapsed_by_default'=true}  ]], 
           { 'sidebar'='Financial Parameters', 'help'='fin_merchant_plant' }  );
  addpage( [[ 'Financial Merchant Plant', 'Financial Capacity Payments']], 
            { 'sidebar'='Revenue', 'help'='revenue_merchant_plant' } );					
  addpage( [[ 'Financial Tax Credits','Financial Cash Incentives']],
           { 'sidebar'='Incentives', 'help'='incentives' } );					
  addpage( [['Financial Depreciation Detailed' ]], 
           { 'sidebar'='Depreciation', 'help'='depreciation' });
}

function setup_host_developer_pages(mode)
{
  setting( { 'analysis_period_var'='cf_length' } );
  addpage( [[ 'Financial Solution Mode Single Owner',
              'Financial Analysis Host Developer Parameters',
		      'Financial Tax and Insurance Rates',
		      'Financial Salvage Value',
		      {'name'='Financial Debt DSCR or Debt Fraction','caption'='Project Term Debt','collapsible'=true,'collapsible_var'='show_DebtConstDSCR'},
              {'name'='Financial Cost of Financing Single Owner', 'caption'='Cost of Acquiring Financing','collapsible'=true,'collapsible_var'='show_CapitalCostSO'},
              {'name'='Financial Construction Financing','caption'='Construction Financing','collapsible'=true,'collapsible_var'='show_construction_period', 'collapsed_by_default'=false},
              {'name'='Financial Reserve Accounts', 'caption'='Reserve Accounts','collapsible'=true,'collapsible_var'='show_ReserveAccounts'},
               {'name'='Financial Return on Equity', 'caption'='Return on Equity','collapsible'=true,'collapsible_var'='show_ReturnonEquity', 'collapsed_by_default'=true}  ]], 
           { 'sidebar'='Financial Parameters', 'help'='fin_tpo_host_developer' }  );
  addpage( [[ 'Financial TOD Factors' ]], { 'sidebar'='Time of Delivery Factors', 'help'='tod_factors' });
           
  addpage( [[ 'Financial Tax Credits','Financial Cash Incentives']],
           { 'sidebar'='Incentives', 'help'='incentives' } );					
  addpage( [['Financial Depreciation Detailed' ]], 
           { 'sidebar'='Depreciation', 'help'='depreciation' });
  setup_utility_rate();
  setup_elec_load_page( mode );
}

function setup_leveraged_partnership_flip_pages()
{
  setting( { 'analysis_period_var'='cf_length' } );
  addpage( [[ 'Financial Solution Mode Flip Leaseback',
              'Financial Equity Flip Structure', 
			  'Financial Analysis Parameters',
			  'Financial Tax and Insurance Rates',
			  'Financial Salvage Value',
//		      {'name'='Financial Debt Constant DSCR','caption'='Project Term Debt','collapsible'=true,'collapsible_var'='show_DebtConstDSCR'},
		      {'name'='Financial Debt DSCR or Debt Fraction','caption'='Project Term Debt','collapsible'=true,'collapsible_var'='show_DebtConstDSCR'},
              {'name'='Financial Cost of Financing Flip Leaseback', 'caption'='Cost of Acquiring Financing','collapsible'=true,'collapsible_var'='show_CapitalCostSO'},
              {'name'='Financial Construction Financing','caption'='Construction Financing','collapsible'=true,'collapsible_var'='show_construction_period'},
              {'name'='Financial Reserve Accounts', 'caption'='Reserve Accounts','collapsible'=true,'collapsible_var'='show_ReserveAccounts'} ]], 
           { 'sidebar'='Financial Parameters', 'help'='fin_leveraged_partnership' }  );
  addpage( [[ 'Financial TOD Factors' ]], { 'sidebar'='Time of Delivery Factors', 'help'='tod_factors' });
/*    addpage( [[ {'name'='Financial TOD Factors', 'caption'='TOD Factors by Schedule'}],
			[ {'name'='Financial TOD Factors Timestep', 'caption'='TOD Factors by Time Step' }],],
           {  'sidebar'='Time of Delivery Factors','help'='tod_factors', 'exclusive_var'='ppa_multiplier_model' } );*/
  addpage( [[ 'Financial Tax Credits',
              'Financial Cash Incentives']],
           { 'sidebar'='Incentives', 'help'='incentives' } );					
  addpage( [['Financial Depreciation Detailed' ]], 
           { 'sidebar'='Depreciation', 'help'='depreciation' });
}

function setup_all_equity_partnership_flip_pages()
{
  setting( { 'analysis_period_var'='cf_length' } );
  addpage( [[ 'Financial Solution Mode Flip Leaseback',
              'Financial Equity Flip Structure', 
              'Financial Flip Developer Capital Recovery',
			  'Financial Analysis Parameters',
			  'Financial Tax and Insurance Rates',
			  'Financial Salvage Value',
              {'name'='Financial Cost of Financing Flip Leaseback', 'caption'='Cost of Acquiring Financing','collapsible'=true,'collapsible_var'='show_CapitalCostSO'},
              {'name'='Financial Construction Financing','caption'='Construction Financing','collapsible'=true,'collapsible_var'='show_construction_period'},
              {'name'='Financial Reserve Accounts', 'caption'='Reserve Accounts','collapsible'=true,'collapsible_var'='show_ReserveAccounts'} ]], 
           { 'sidebar'='Financial Parameters', 'help'='fin_all_equity_partnership' }  );
  addpage( [[ 'Financial TOD Factors' ]], { 'sidebar'='Time of Delivery Factors', 'help'='tod_factors' });
/*    addpage( [[ {'name'='Financial TOD Factors', 'caption'='TOD Factors by Schedule'}],
			[ {'name'='Financial TOD Factors Timestep', 'caption'='TOD Factors by Time Step' }],],
           {  'sidebar'='Time of Delivery Factors','help'='tod_factors', 'exclusive_var'='ppa_multiplier_model' } );*/
  addpage( [[ 'Financial Tax Credits',
              'Financial Cash Incentives']],
           { 'sidebar'='Incentives', 'help'='incentives' } );					
  addpage( [['Financial Depreciation Detailed' ]], 
           { 'sidebar'='Depreciation', 'help'='depreciation' });
}

function setup_sale_leaseback_pages()
{
  setting( { 'analysis_period_var'='cf_length' } );
  addpage( [[ 'Financial Solution Mode Flip Leaseback',
              'Financial Sale Leaseback', 
			  'Financial Analysis Parameters',
			  'Financial Tax and Insurance Rates',
			  'Financial Salvage Value',
              {'name'='Financial Cost of Financing Flip Leaseback', 'caption'='Cost of Acquiring Financing','collapsible'=true,'collapsible_var'='show_CapitalCostSO'},
              {'name'='Financial Construction Financing','caption'='Construction Financing','collapsible'=true,'collapsible_var'='show_construction_period'},
              {'name'='Financial Reserve Accounts', 'caption'='Reserve Accounts','collapsible'=true,'collapsible_var'='show_ReserveAccounts'} ]], 
          { 'sidebar'='Financial Parameters', 'help'='fin_sale_leaseback' }  );
  addpage( [[ 'Financial TOD Factors' ]], { 'sidebar'='Time of Delivery Factors', 'help'='tod_factors' });
/*    addpage( [[ {'name'='Financial TOD Factors', 'caption'='TOD Factors by Schedule'}],
			[ {'name'='Financial TOD Factors Timestep', 'caption'='TOD Factors by Time Step' }],],
           {  'sidebar'='Time of Delivery Factors','help'='tod_factors', 'exclusive_var'='ppa_multiplier_model' } );*/
  addpage( [[ 'Financial Tax Credits',
              'Financial Cash Incentives']],
           { 'sidebar'='Incentives', 'help'='incentives' } );					
  addpage ( [['Financial Depreciation Detailed' ]], 
            { 'sidebar'='Depreciation', 'help'='depreciation' });
}

function setup_windpower_pages()
{
	addpage( [[ 'Wind Resource File'], 
	          [ 'Wind Speed Weibull Distribution'],
	          [ 'Wind Resource Distribution']], 
	         { 'sidebar'='Wind Resource', 'exclusive_var'='wind_resource_model_choice', 'help'='wind_resource' } );
	//addpage( [[ 'Wind Siting Considerations' ]], { 'sidebar'='Siting Considerations' } );
	addpage( [[ 'Wind Turbine Design' ]], { 'sidebar'='Wind Turbine', 'help'='wind_turbine' } );
	addpage( [[ 'Wind Farm Specifications' ]], { 'sidebar'='Wind Farm', 'help'='wind_farm' } );
	setup_grid_page();
	addpage( [[ 'Wind Losses' ]], { 'sidebar'='Losses', 'help'='wind_losses'} );
	addpage( [[ 'Wind Uncertainty' ]], { 'sidebar'='Uncertainties','help'='wind_uncertainties'} );

}

function setup_solar_water_heating_pages()
{
	addpage( [[ 'Solar Resource Data' ]], { 'sidebar'='Location and Resource' , 'help'='shw_location_and_resource' });
	addpage( [[ 'Solar Water Heating' ]], { 'sidebar'='Solar Water Heating', 'help'='shw_system' } );
    setup_grid_page();
}

function setup_fuel_cell_pages_btm()
{
	addpage([ [{'name'='Battery None','caption'='No Battery'}],
				  [{'name'='Battery Model', 'caption'='Enable Battery'},
				   'Battery Bank Sizing',
				   'Battery Current and Capacity',
				   'Battery Configuration',
				   'Battery Dispatch Common',
				   {'name'='Battery Lifetime', 'caption'='Battery Lifetime', 'collapsible'=true, 'collapsible_var'='battery_lifetime_shown'},
				   {'name'='Battery Replacements', 'caption'='Battery Replacements', 'collapsible'=true, 'collapsible_var'='battery_replacements_shown'},
				   {'name'='Battery Voltage', 'caption'='Battery Voltage', 'collapsible'=true, 'collapsible_var'='battery_voltage_shown'},
				   {'name'='Battery Ancillary Losses', 'caption'='Battery Losses', 'collapsible'=true, 'collapsible_var'='battery_losses_shown'},
				   {'name'='Battery Thermal', 'caption'='Battery Thermal', 'collapsible'=true, 'collapsible_var'='battery_thermal_shown'}
					]],
				  { 'sidebar'='Battery Storage', 'help'='battery_model', 'exclusive_var'='en_batt'} );
	addpage([['Fuel Cell']], {'sidebar'='Fuel Cell', 'help'='fuelcell_fuel_cell'});
	addpage([['Fuel Cell Dispatch',
			'Battery Dispatch Behind the Meter',
			'Fuel Cell Dispatch Manual']], {'sidebar'='Dispatch', 'help'='fuelcell_dispatch'});
    setup_grid_page();
}

function setup_fuel_cell_pages_fom()
{
	addpage([ [{'name'='Battery None','caption'='No Battery'}],
				  [{'name'='Battery Model', 'caption'='Enable Battery'},
				   'Battery Bank Sizing',
				   'Battery Current and Capacity',
				   'Battery Configuration',
				   'Battery Dispatch Common',
					{'name'='Battery Lifetime', 'caption'='Battery Lifetime', 'collapsible'=true, 'collapsible_var'='battery_lifetime_shown'},
				   {'name'='Battery Replacements', 'caption'='Battery Replacements', 'collapsible'=true, 'collapsible_var'='battery_replacements_shown'},
				   {'name'='Battery Voltage', 'caption'='Battery Voltage', 'collapsible'=true, 'collapsible_var'='battery_voltage_shown'},
				   {'name'='Battery Ancillary Losses', 'caption'='Battery Losses', 'collapsible'=true, 'collapsible_var'='battery_losses_shown'},
				   {'name'='Battery Thermal', 'caption'='Battery Thermal', 'collapsible'=true, 'collapsible_var'='battery_thermal_shown'}
					]],
				  { 'sidebar'='Battery Storage', 'help'='battery_model', 'exclusive_var'='en_batt'} );
	addpage([['Fuel Cell']], {'sidebar'='Fuel Cell', 'help'='fuelcell_fuel_cell'});
	addpage([['Fuel Cell Dispatch',
			'Battery Dispatch Front of Meter',
			'Fuel Cell Dispatch Manual']], {'sidebar'='Dispatch', 'help'='fuelcell_dispatch'});
	setup_grid_page();
}

function setup_csp_physical_trough_pages()
{
	addpage( [[ 'Solar Resource Data' ]], { 'sidebar'='Location and Resource', 'help'='trough_location_and_resource' } );
	addpage( [[ 'Physical Trough System Design' ]], { 'sidebar'='System Design', 'help'='troughphysical_system_design' } );
	addpage( [[ 'Physical Trough Solar Field' ]], { 'sidebar'='Solar Field', 'help'='troughphysical_solar_field' } );
	addpage( [[ 'Physical Trough Collector Header',
	 {'name'='Physical Trough Collector Type 1', 'caption'='Collector Type 1', 'collapsible'=false, 'collapsible_var'='sca_1_is_shown'},
	 {'name'='Physical Trough Collector Type 2', 'caption'='Collector Type 2', 'collapsible'=true, 'collapsible_var'='sca_2_is_shown'},
	 {'name'='Physical Trough Collector Type 3', 'caption'='Collector Type 3', 'collapsible'=true, 'collapsible_var'='sca_3_is_shown'},
	 {'name'='Physical Trough Collector Type 4', 'caption'='Collector Type 4', 'collapsible'=true, 'collapsible_var'='sca_4_is_shown'} ]],
	 { 'sidebar'='Collectors (SCAs)', 'help'='troughphysical_collectors_scas' } );
	addpage( [[ 'Physical Trough Receiver Header',
	 {'name'='Physical Trough Receiver Type 1', 'caption'='Receiver Type 1', 'collapsible'=false, 'collapsible_var'='hce_1_is_shown'},
	 {'name'='Physical Trough Receiver Type 2', 'caption'='Receiver Type 2', 'collapsible'=true, 'collapsible_var'='hce_2_is_shown'},
	 {'name'='Physical Trough Receiver Type 3', 'caption'='Receiver Type 3', 'collapsible'=true, 'collapsible_var'='hce_3_is_shown'},
	 {'name'='Physical Trough Receiver Type 4', 'caption'='Receiver Type 4', 'collapsible'=true, 'collapsible_var'='hce_4_is_shown'} ]],
	 { 'sidebar'='Receivers (HCEs)', 'help'='troughphysical_receivers_hces' } );
	addpage( [[ 'Rankine Cycle' ], [ 'User Defined Power Cycle' ]], 
			{ 'sidebar'='Power Cycle', 'help'='troughphysical_power_cycle', 'exclusive_var' = 'pc_config',
			  'exclusive_header_pages' = ['Physical Trough Power Cycle Common']} );
	
	//addpage( [[ 'Physical Trough Power Block Common' ,
	  //{'name' = 'Physical Trough Rankine Cycle', 'caption' = 'Rankine Cycle', 'collapsible'=false, 'collapsible_var'='csp_dispatch_is_shown'} ]],
	  //{ 'sidebar'='Power Cycle', 'help'='troughphysical_power_cycle' } );
	//addpage( [[ 'Physical Trough Power Block' ]], { 'sidebar'='Power Cycle', 'help'='troughphysical_power_cycle' } );
	addpage( [[ 'Physical Trough Thermal Storage' ]], { 'sidebar'='Thermal Storage', 'help'='troughphysical_thermal_storage' } );
	addpage( [[ 'Physical Trough System Control' ,
	  {'name' = 'Physical Trough Dispatch Control', 'caption'='Dispatch Control', 'collapsible'=false, 'collapsible_var'='csp_dispatch_is_shown'} ]], 
	  { 'sidebar'='System Control', 'help'='troughphysical_system_control' } );
	setup_grid_page();
}

function setup_cst_physical_trough_pages()
{
	addpage( [[ 'Solar Resource Data' ]], { 'sidebar'='Location and Resource', 'help'='iph_trough-location_resource' } );
	addpage( [[ 'Phys Trough System Design' ]], { 'sidebar'='System Design', 'help'='iph_trough-system_design' } );
	addpage( [[ 'Physical Trough Solar Field' ]], { 'sidebar'='Solar Field', 'help'='iph_trough-solar_field' } );
	addpage( [[ 'Physical Trough Collector Header',
	 {'name'='Physical Trough Collector Type 1', 'caption'='Collector Type 1', 'collapsible'=false, 'collapsible_var'='sca_1_is_shown'},
	 {'name'='Physical Trough Collector Type 2', 'caption'='Collector Type 2', 'collapsible'=true, 'collapsible_var'='sca_2_is_shown'},
	 {'name'='Physical Trough Collector Type 3', 'caption'='Collector Type 3', 'collapsible'=true, 'collapsible_var'='sca_3_is_shown'},
	 {'name'='Physical Trough Collector Type 4', 'caption'='Collector Type 4', 'collapsible'=true, 'collapsible_var'='sca_4_is_shown'} ]],
	 { 'sidebar'='Collectors (SCAs)', 'help'='iph_trough-collectors' } );
	addpage( [[ 'Physical Trough Receiver Header',
	 {'name'='Physical Trough Receiver Type 1', 'caption'='Receiver Type 1', 'collapsible'=false, 'collapsible_var'='hce_1_is_shown'},
	 {'name'='Physical Trough Receiver Type 2', 'caption'='Receiver Type 2', 'collapsible'=true, 'collapsible_var'='hce_2_is_shown'},
	 {'name'='Physical Trough Receiver Type 3', 'caption'='Receiver Type 3', 'collapsible'=true, 'collapsible_var'='hce_3_is_shown'},
	 {'name'='Physical Trough Receiver Type 4', 'caption'='Receiver Type 4', 'collapsible'=true, 'collapsible_var'='hce_4_is_shown'} ]],
	 { 'sidebar'='Receivers (HCEs)', 'help'='iph_trough-receivers' } );
	 addpage( [[ 'Phys Trough Direct Storage' ]], { 'sidebar'='Thermal Storage', 'help'='iph_trough-tes' } );
	 addpage( [[ 'Phys Trough System Control' ,
	  {'name' = 'Phys Trough Dispatch Control', 'caption'='Dispatch Control', 'collapsible'=false, 'collapsible_var'='csp_dispatch_is_shown'} ]], 
	  { 'sidebar'='System Control', 'help'='iph_trough-system_control' } );
}

function setup_csp_empirical_trough_pages()
{
	addpage( [[ 'Solar Resource Data' ]], { 'sidebar'='Location and Resource', 'help'='trough_location_and_resource' } );
	addpage( [[ 'Empirical Trough Solar Field' ]], { 'sidebar'='Solar Field', 'help'='troughempirical_solar_field' } );
	addpage( [[ 'Empirical Trough SCA' ]], { 'sidebar'='Collectors (SCAs)', 'help'='troughempirical_collectors_scas' } );
	addpage( [[ 'Empirical Trough HCE' ]], { 'sidebar'='Receivers (HCEs)', 'help'='troughempirical_receivers_hces' } );
	addpage( [[ 'Empirical Trough Power Block' ]], { 'sidebar'='Power Block', 'help'='troughempirical_power_block' } );
	addpage( [[ 'Empirical Trough Thermal Storage',
	  {'name' = 'CSP Dispatch Control', 'caption'='Dispatch Control', 'collapsible'=false, 'collapsible_var'='csp_dispatch_is_shown'} ]], 
	  { 'sidebar'='Thermal Storage', 'help'='troughempirical_thermal_storage' } );
	addpage( [[ 'Empirical Trough Parasitics' ]], { 'sidebar'='Parasitics', 'help'='troughempirical_parasitics' } );
	setup_grid_page();
}

function setup_geothermal_power_pages()
{
	addpage( [[ 'Solar Resource Data' ]], { 'sidebar'='Ambient Conditions', 'help'='geo_ambient_conditions' } );
	addpage( [[ 'Geothermal Resource' ]], { 'sidebar'='Geothermal Resource', 'help'='geo_geothermal_resource' } );
	addpage( [[ 'Geothermal Plant and Equipment' ]], { 'sidebar'='Plant and Equipment', 'help'='geo_plant_equipment' } );
	addpage( [[ 'Geothermal Power Block' ]], { 'sidebar'='Power Block', 'help'='geo_power_block' } );
    setup_grid_page();
}


////////////////////////////////////////////////////////////////////////////////
// now set up all the pages ////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////


// CSP - Empirical Trough ///////////////////////////////////////////////////////
setconfig( 'Empirical Trough', 'LCOE Calculator' );
setmodules( ['tcstrough_empirical', 'lcoefcr']);
setup_csp_empirical_trough_pages();
setup_lcoefcr_pages();

setconfig( 'Empirical Trough', 'None' );
setmodules( ['tcstrough_empirical']);
setup_csp_empirical_trough_pages();

setconfig( 'Empirical Trough', 'Commercial' );
setmodules( ['tcstrough_empirical', 'utilityrate5', 'cashloan']);
setup_csp_empirical_trough_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Empirical Trough Capital Costs','O and M Costs' ]], { 'sidebar'='System Costs', 'help'='trough_system_costs' } );
setup_commercial_pages(LOAD_SIMPLE); //belpe not valid for commercial

setconfig( 'Empirical Trough', 'Single Owner' );
setmodules( ['tcstrough_empirical', 'singleowner']);
setup_csp_empirical_trough_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);addpage( [[ 'Empirical Trough Capital Costs','O and M Costs' ]], { 'sidebar'='System Costs', 'help'='trough_system_costs' } );
setup_single_owner_pages();

setconfig( 'Empirical Trough', 'Merchant Plant' );
setmodules( ['tcstrough_empirical', 'merchantplant']);
setup_csp_empirical_trough_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);addpage( [[ 'Empirical Trough Capital Costs','O and M Costs' ]], { 'sidebar'='System Costs', 'help'='trough_system_costs' } );
setup_merchant_plant_pages();

setconfig( 'Empirical Trough', 'Leveraged Partnership Flip' );
setmodules( ['tcstrough_empirical', 'levpartflip']);
setup_csp_empirical_trough_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);addpage( [[ 'Empirical Trough Capital Costs','O and M Costs' ]], { 'sidebar'='System Costs', 'help'='trough_system_costs' } );
setup_leveraged_partnership_flip_pages();

setconfig( 'Empirical Trough', 'Sale Leaseback' );
setmodules( ['tcstrough_empirical', 'saleleaseback']);
setup_csp_empirical_trough_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);addpage( [[ 'Empirical Trough Capital Costs','O and M Costs' ]], { 'sidebar'='System Costs', 'help'='trough_system_costs' } );
setup_sale_leaseback_pages();

setconfig( 'Empirical Trough', 'All Equity Partnership Flip' );
setmodules( ['tcstrough_empirical', 'equpartflip']);
setup_csp_empirical_trough_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);addpage( [[ 'Empirical Trough Capital Costs','O and M Costs' ]], { 'sidebar'='System Costs', 'help'='trough_system_costs' } );
setup_all_equity_partnership_flip_pages();

// not yet set up as a configuration
/*setconfig('Battery', 'None');
setup_battery_pages_behind_the_meter();
setup_lifetime_page(DEGRADATION_AC_LIFETIME);
setmodules(['battery']);*/

// Flat Plate PV ////////////////////////////////////////////////////////////////
setconfig( 'Flat Plate PV', 'LCOE Calculator' );
setup_flat_plate_pv_pages();
setup_lcoefcr_pages();
setmodules( ['pvsamv1', 'grid', 'lcoefcr'] );

setconfig( 'Flat Plate PV', 'None' );
setup_flat_plate_pv_pages();
setmodules( ['pvsamv1', 'grid'] );

setconfig( 'Flat Plate PV', 'Residential' );
setmodules( ['belpe', 'pvsamv1', 'grid', 'utilityrate5', 'cashloan']);
setup_flat_plate_pv_pages();
setup_lifetime_page( DEGRADATION_PVSAM );
addpage( [[ 'PV Capital Costs','O and M Costs' ]], { 'sidebar'='System Costs', 'help'='pv_system_costs' } );
setup_residential_pages( LOAD_BELPE ); //includes building load calculator

setconfig( 'Flat Plate PV', 'Third Party' );
setmodules( ['belpe', 'pvsamv1', 'grid', 'utilityrate5', 'thirdpartyownership']);
setup_flat_plate_pv_pages();
setup_lifetime_page( DEGRADATION_PVSAM );
setup_thirdparty_pages( LOAD_BELPE ); //includes building load calculator by default in this function

setconfig( 'Flat Plate PV', 'Host Developer' );
setmodules( ['pvsamv1', 'grid', 'utilityrate5', 'host_developer']);
setup_flat_plate_pv_pages();
setup_lifetime_page( DEGRADATION_PVSAM );
addpage( [[ 'PV Capital Costs','O and M Costs' ]], { 'sidebar'='System Costs', 'help'='pv_system_costs' } );
setup_host_developer_pages( LOAD_SIMPLE ); 

setconfig( 'Flat Plate PV', 'Commercial' );
setmodules( ['pvsamv1', 'grid', 'utilityrate5', 'cashloan']);
setup_flat_plate_pv_pages();
setup_lifetime_page( DEGRADATION_PVSAM );
addpage( [[ 'PV Capital Costs','O and M Costs' ]], { 'sidebar'='System Costs', 'help'='pv_system_costs' } );
setup_commercial_pages( LOAD_SIMPLE ); //belpe not valid for commercial

setconfig( 'Flat Plate PV', 'Single Owner' );
// TO DO include utilityrate5 for inverter nighttime consumption? update all PPA and Merchant Plant configs accordingly
//setmodules( ['pvsamv1', 'grid', 'utilityrate5', 'singleowner'] );
setmodules( ['pvsamv1', 'grid', 'singleowner'] );
setup_flat_plate_pv_pages();
setup_lifetime_page( DEGRADATION_PVSAM );
addpage( [[ 'PV Capital Costs','O and M Costs' ]], { 'sidebar'='System Costs', 'help'='pv_system_costs' } );
setup_single_owner_pages( );
//addpage( [[ 'Financial Capacity Payments' ]], { 'sidebar'='Ancillary Services', 'help'='ancillary_services' });
// setup_utility_rate_optional(); // required if utilityrate5 included in config

setconfig( 'Flat Plate PV', 'Merchant Plant' );	
setmodules( ['pvsamv1', 'grid', 'merchantplant']);
setup_flat_plate_pv_pages();
setup_lifetime_page( DEGRADATION_PVSAM );
addpage( [[ 'PV Capital Costs','O and M Costs' ]], { 'sidebar'='System Costs', 'help'='pv_system_costs' } );
setup_merchant_plant_pages( );

setconfig( 'Flat Plate PV', 'Leveraged Partnership Flip' );	
setmodules( ['pvsamv1', 'grid', 'levpartflip']);
setup_flat_plate_pv_pages();
setup_lifetime_page( DEGRADATION_PVSAM );
addpage( [[ 'PV Capital Costs','O and M Costs' ]], { 'sidebar'='System Costs', 'help'='pv_system_costs' } );
setup_leveraged_partnership_flip_pages( );

setconfig( 'Flat Plate PV', 'All Equity Partnership Flip' );	
setmodules( ['pvsamv1', 'grid', 'equpartflip']);
setup_flat_plate_pv_pages();
setup_lifetime_page( DEGRADATION_PVSAM );
addpage( [[ 'PV Capital Costs','O and M Costs' ]], { 'sidebar'='System Costs', 'help'='pv_system_costs' } );
setup_all_equity_partnership_flip_pages( );

setconfig( 'Flat Plate PV', 'Sale Leaseback' );	
setmodules( ['pvsamv1', 'grid', 'saleleaseback']);
setup_flat_plate_pv_pages();
setup_lifetime_page( DEGRADATION_PVSAM );
addpage( [[ 'PV Capital Costs','O and M Costs' ]], { 'sidebar'='System Costs', 'help'='pv_system_costs' } );
setup_sale_leaseback_pages( );

// CSThermal - Physical Trough ////////////////////////////////
setconfig( 'Physical Trough IPH', 'None' );
setmodules( ['trough_physical_process_heat']);
setup_cst_physical_trough_pages();

setconfig( 'Physical Trough IPH', 'LCOH Calculator' );
setmodules( ['trough_physical_process_heat', 'iph_to_lcoefcr', 'lcoefcr']);
setup_cst_physical_trough_pages();
setup_iph_lcoefcr_pages();

// CSP - Physical Trough ///////////////////////////////////////////////////////
setconfig( 'Physical Trough', 'LCOE Calculator' );
setmodules( ['trough_physical', 'grid', 'lcoefcr']);
setup_csp_physical_trough_pages();
setup_lcoefcr_pages();

setconfig( 'Physical Trough', 'None' );
setmodules( ['trough_physical', 'grid']);
setup_csp_physical_trough_pages();

setconfig( 'Physical Trough', 'Commercial' );
setmodules( ['trough_physical', 'grid', 'utilityrate5', 'cashloan']);
setup_csp_physical_trough_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);addpage( [[ 'Physical Trough Capital Costs','O and M Costs' ]], { 'sidebar'='System Costs', 'help'='trough_system_costs' } );
setup_commercial_pages( LOAD_SIMPLE ); //belpe not valid for commercial

//-----------------------------------------------------
setconfig( 'Physical Trough', 'Leveraged Partnership Flip' );
setmodules( ['trough_physical', 'grid', 'levpartflip']);
setup_csp_physical_trough_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);addpage( [[ 'Physical Trough Capital Costs','O and M Costs' ]], { 'sidebar'='System Costs', 'help'='trough_system_costs' } );
setup_leveraged_partnership_flip_pages();

//-----------------------------------------------------
setconfig( 'Physical Trough', 'All Equity Partnership Flip' );
setmodules( ['trough_physical', 'grid', 'equpartflip']);
setup_csp_physical_trough_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);addpage( [[ 'Physical Trough Capital Costs','O and M Costs' ]], { 'sidebar'='System Costs', 'help'='trough_system_costs' } );
setup_all_equity_partnership_flip_pages();

//-----------------------------------------------------
setconfig( 'Physical Trough', 'Sale Leaseback' );
setmodules( ['trough_physical', 'grid', 'saleleaseback']);
setup_csp_physical_trough_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);addpage( [[ 'Physical Trough Capital Costs','O and M Costs' ]], { 'sidebar'='System Costs', 'help'='trough_system_costs' } );
setup_sale_leaseback_pages();

//-----------------------------------------------------
setconfig( 'Physical Trough', 'Single Owner' );
setmodules( ['trough_physical', 'grid', 'singleowner']);
setup_csp_physical_trough_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);addpage( [[ 'Physical Trough Capital Costs','O and M Costs' ]], { 'sidebar'='System Costs', 'help'='trough_system_costs' } );
setup_single_owner_pages();

setconfig( 'Physical Trough', 'Merchant Plant' );
setmodules( ['trough_physical', 'grid', 'merchantplant']);
setup_csp_physical_trough_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);addpage( [[ 'Physical Trough Capital Costs','O and M Costs' ]], { 'sidebar'='System Costs', 'help'='trough_system_costs' } );
setup_merchant_plant_pages();

// PVWatts /////////////////////////////////////////////////////////////////////
setconfig( 'PVWatts', 'LCOE Calculator' );
setmodules( ['pvwattsv7', 'grid','lcoefcr']);
setup_pvwatts_pages();
setup_lcoefcr_pages();

setconfig( 'PVWatts', 'None' );
setmodules( ['pvwattsv7','grid']);
setup_pvwatts_pages();

setconfig( 'PVWatts', 'Residential' );	
setmodules( ['pvwattsv7', 'belpe', 'grid','utilityrate5', 'cashloan']);
setup_pvwatts_pages();
setup_lifetime_page( DEGRADATION_AC_SINGLE_YEAR );
addpage( [[ 'PV Capital Costs','O and M Costs' ]], { 'sidebar'='System Costs', 'help'='pv_system_costs' } );
setup_residential_pages( LOAD_BELPE ); //includes building load calculator

setconfig( 'PVWatts', 'Commercial' );	
setmodules( ['pvwattsv7', 'grid', 'utilityrate5', 'cashloan']);
setup_pvwatts_pages();
setup_lifetime_page( DEGRADATION_AC_SINGLE_YEAR );
addpage( [[ 'PV Capital Costs','O and M Costs' ]], { 'sidebar'='System Costs', 'help'='pv_system_costs' } );
setup_commercial_pages(LOAD_SIMPLE); //belpe not valid for commercial

setconfig( 'PVWatts', 'Leveraged Partnership Flip' );	
setmodules( ['pvwattsv7', 'grid', 'levpartflip']);
setup_pvwatts_pages();
setup_lifetime_page( DEGRADATION_AC_SINGLE_YEAR );
addpage( [[ 'PV Capital Costs','O and M Costs' ]], { 'sidebar'='System Costs', 'help'='pv_system_costs' } );
setup_leveraged_partnership_flip_pages();

setconfig( 'PVWatts', 'All Equity Partnership Flip' );	
setmodules( ['pvwattsv7', 'grid', 'equpartflip']);
setup_pvwatts_pages();
setup_lifetime_page( DEGRADATION_AC_SINGLE_YEAR );
addpage( [[ 'PV Capital Costs','O and M Costs' ]], { 'sidebar'='System Costs', 'help'='pv_system_costs' } );
setup_all_equity_partnership_flip_pages();

setconfig( 'PVWatts', 'Sale Leaseback' );	
setmodules( ['pvwattsv7', 'grid','saleleaseback']);
setup_pvwatts_pages();
setup_lifetime_page( DEGRADATION_AC_SINGLE_YEAR );
addpage( [[ 'PV Capital Costs','O and M Costs' ]], { 'sidebar'='System Costs', 'help'='pv_system_costs' } );
setup_sale_leaseback_pages();

setconfig( 'PVWatts', 'Single Owner' );	
setmodules( ['pvwattsv7', 'grid','singleowner']);
setup_pvwatts_pages();
setup_lifetime_page( DEGRADATION_AC_SINGLE_YEAR );
addpage( [[ 'PV Capital Costs','O and M Costs' ]], { 'sidebar'='System Costs', 'help'='pv_system_costs' } );
setup_single_owner_pages();

setconfig( 'PVWatts', 'Merchant Plant' );	
setmodules( ['pvwattsv7', 'grid','merchantplant']);
setup_pvwatts_pages();
setup_lifetime_page( DEGRADATION_AC_SINGLE_YEAR );
addpage( [[ 'PV Capital Costs','O and M Costs' ]], { 'sidebar'='System Costs', 'help'='pv_system_costs' } );
setup_merchant_plant_pages();

setconfig( 'PVWatts', 'Host Developer' );
setmodules( ['pvwattsv7', 'grid', 'utilityrate5', 'host_developer']);
setup_pvwatts_pages();
setup_lifetime_page( DEGRADATION_AC_SINGLE_YEAR );
addpage( [[ 'PV Capital Costs','O and M Costs' ]], { 'sidebar'='System Costs', 'help'='pv_system_costs' } );
setup_host_developer_pages( LOAD_SIMPLE ); //includes building load calculator by default in this function

setconfig( 'PVWatts', 'Third Party' );	
setmodules( ['pvwattsv7', 'belpe', 'grid','utilityrate5', 'thirdpartyownership']);
setup_pvwatts_pages();
setup_lifetime_page( DEGRADATION_AC_SINGLE_YEAR );
setup_thirdparty_pages( LOAD_BELPE); //includes building load calculator by default in this function

// Wind Power //////////////////////////////////////////////////////////////////

//-----------------------------------------------------
setconfig( 'Wind Power', 'Residential' );	
setmodules( ['windpower', 'grid', 'utilityrate5', 'cashloan']);
setup_windpower_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [['Wind Farm Costs','O and M Costs',
		{'name'='Wind BOS','caption'='Land-Based Balance of System Cost Model','collapsible'=true,'collapsible_var'='wind_bos_shown','collapsed_by_default'=true},
		{'name'='Wind OBOS','caption'='Offshore Balance of System Cost Model', 'collapsible'=true,'collapsible_var'='wind_obos_shown','collapsed_by_default'=true}]],
		{ 'sidebar'='System Costs', 'help'='wind_system_costs' } );
setup_residential_pages( LOAD_SIMPLE ); //does not include building load calculator

//-----------------------------------------------------
setconfig( 'Wind Power', 'Commercial' );	
setmodules( ['windpower', 'grid', 'utilityrate5', 'cashloan']);
setup_windpower_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [['Wind Farm Costs','O and M Costs',
		{'name'='Wind BOS','caption'='Land-Based Balance of System Cost Model','collapsible'=true,'collapsible_var'='wind_bos_shown'},
		{'name'='Wind OBOS','caption'='Offshore Balance of System Cost Model', 'collapsible'=true,'collapsible_var'='wind_obos_shown'}]],
		{ 'sidebar'='System Costs', 'help'='wind_system_costs' } );
setup_commercial_pages( LOAD_SIMPLE ); //does not include building load calculator


//-----------------------------------------------------
setconfig( 'Wind Power', 'Leveraged Partnership Flip' );
setmodules( ['windpower', 'grid', 'levpartflip']);
setup_windpower_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [['Wind Farm Costs','O and M Costs',
		{'name'='Wind BOS','caption'='Land-Based Balance of System Cost Model','collapsible'=true,'collapsible_var'='wind_bos_shown'},
		{'name'='Wind OBOS','caption'='Offshore Balance of System Cost Model', 'collapsible'=true,'collapsible_var'='wind_obos_shown'}]],
		{ 'sidebar'='System Costs', 'help'='wind_system_costs' } );
setup_leveraged_partnership_flip_pages();

//-----------------------------------------------------
setconfig( 'Wind Power', 'All Equity Partnership Flip' );
setmodules( ['windpower', 'grid', 'equpartflip']);
setup_windpower_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [['Wind Farm Costs','O and M Costs',
		{'name'='Wind BOS','caption'='Land-Based Balance of System Cost Model','collapsible'=true,'collapsible_var'='wind_bos_shown'},
		{'name'='Wind OBOS','caption'='Offshore Balance of System Cost Model', 'collapsible'=true,'collapsible_var'='wind_obos_shown'}]],
		{ 'sidebar'='System Costs', 'help'='wind_system_costs' } );
setup_all_equity_partnership_flip_pages();

//-----------------------------------------------------
setconfig( 'Wind Power', 'Sale Leaseback' );
setmodules( ['windpower', 'grid','saleleaseback']);
setup_windpower_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [['Wind Farm Costs','O and M Costs',
		{'name'='Wind BOS','caption'='Land-Based Balance of System Cost Model','collapsible'=true,'collapsible_var'='wind_bos_shown'},
		{'name'='Wind OBOS','caption'='Offshore Balance of System Cost Model', 'collapsible'=true,'collapsible_var'='wind_obos_shown'}]],
		{ 'sidebar'='System Costs', 'help'='wind_system_costs' } );
setup_sale_leaseback_pages();

//-----------------------------------------------------
setconfig( 'Wind Power', 'Single Owner' );
setmodules( ['windpower', 'grid','singleowner']);
setup_windpower_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [['Wind Farm Costs','O and M Costs',
		{'name'='Wind BOS','caption'='Land-Based Balance of System Cost Model','collapsible'=true,'collapsible_var'='wind_bos_shown'},
		{'name'='Wind OBOS','caption'='Offshore Balance of System Cost Model', 'collapsible'=true,'collapsible_var'='wind_obos_shown'}]],
		{ 'sidebar'='System Costs', 'help'='wind_system_costs' } );
setup_single_owner_pages();

setconfig( 'Wind Power', 'Merchant Plant' );
setmodules( ['windpower', 'grid','merchantplant']);
setup_windpower_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [['Wind Farm Costs','O and M Costs',
		{'name'='Wind BOS','caption'='Land-Based Balance of System Cost Model','collapsible'=true,'collapsible_var'='wind_bos_shown'},
		{'name'='Wind OBOS','caption'='Offshore Balance of System Cost Model', 'collapsible'=true,'collapsible_var'='wind_obos_shown'}]],
		{ 'sidebar'='System Costs', 'help'='wind_system_costs' } );
setup_merchant_plant_pages();

//-----------------------------------------------------
setconfig( 'Wind Power', 'LCOE Calculator' );	
setmodules( ['windpower', 'grid','lcoefcr']);
setup_windpower_pages();
setup_lcoefcr_pages();		

 /*addpage( [[ 'Financial DSIRE Download',
              { 'name'='Financial Tax Credits','caption'='Tax Credits','collapsible'=true,'collapsible_var'='show_tax_credits', 'collapsed_by_default'=false },
              { 'name'='Financial Cash Incentives','caption'='Direct Cash Incentives','collapsible'=true,'collapsible_var'='show_cash_incentives', 'collapsed_by_default'=false } ]], 
           { 'sidebar'='Incentives','help'='Incentives' } );*/
//-----------------------------------------------------
setconfig( 'Wind Power', 'None' );
//setmodules( ['windpower','grid']);
setmodules( ['windpower', 'grid']);
setup_windpower_pages();

// Solar Water Heating /////////////////////////////////////////////////////////
setconfig( 'Solar Water Heating', 'LCOE Calculator');
setmodules( ['swh',  'lcoefcr'] );
setup_solar_water_heating_pages();
setup_lcoefcr_pages();

setconfig( 'Solar Water Heating', 'None');
setmodules( ['swh'] );
setup_solar_water_heating_pages();

setconfig( 'Solar Water Heating', 'Residential');
setmodules( ['swh',  'belpe', 'utilityrate5', 'cashloan'] );
setup_solar_water_heating_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Solar Water Heating Costs','O and M Costs' ]], { 'sidebar'='System Costs', 'help'='shw_system_costs' } );
setup_residential_pages( LOAD_BELPE ); //yes belpe

setconfig( 'Solar Water Heating', 'Commercial');
setmodules( ['swh', 'utilityrate5', 'cashloan'] );
setup_solar_water_heating_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);addpage( [[ 'Solar Water Heating Costs','O and M Costs' ]], { 'sidebar'='System Costs', 'help'='shw_system_costs' } );
setup_commercial_pages(LOAD_SIMPLE); //belpe not valid for commercial

// Fuel Cell /////////////////////////////////////////////////////////
setconfig( 'Fuel Cell', 'Commercial');
setmodules( ['pvwattsv7', 'fuelcell', 'battery', 'grid','utilityrate5', 'thermalrate', 'cashloan'] );
addpage( [[ 'Solar Resource Data' ]], { 'sidebar'='Location and Resource', 'help'='pv_location_and_resource' } );
addpage( [[ 'PVWatts']], { 'sidebar'='PV System', 'help'='fuelcell_pv_system' } );
setup_fuel_cell_pages_btm();
setup_lifetime_page( DEGRADATION_DC_LIFETIME );
addpage( [[ 'Fuel Cell Costs','Fuel Cell O and M Costs' ]], { 'sidebar'='System Costs', 'help'='fuelcell_system_costs' } );
setup_commercial_pages(LOAD_SIMPLE); //belpe not valid for commercial
addpage( [[ 'Thermal Rate' ]], {'sidebar' = 'Thermal Rates','help' = 'thermal_rates'});
addpage( [[ 'Thermal Load' ]], {'sidebar' = 'Thermal Load','help' = 'thermal_load'});

setconfig( 'Fuel Cell', 'Single Owner');
setmodules( ['pvwattsv7', 'fuelcell', 'battery', 'grid','utilityrate5', 'thermalrate', 'singleowner']);
addpage( [[ 'Solar Resource Data' ]], { 'sidebar'='Location and Resource', 'help'='pv_location_and_resource' } );
addpage( [[ 'PVWatts']], { 'sidebar'='PV System', 'help'='fuelcell_pv_system' } );
setup_fuel_cell_pages_fom();
setup_lifetime_page( DEGRADATION_DC_LIFETIME );
addpage( [[ 'Fuel Cell Costs','Fuel Cell O and M Costs' ]], { 'sidebar'='System Costs', 'help'='fuelcell_system_costs' } );
setup_single_owner_pages();
setup_utility_rate_optional();
addpage( [[ 'Thermal Rate' ]], {'sidebar' = 'Thermal Rates','help' = 'thermal_rates'});

// Geothermal Power ////////////////////////////////////////////////////////////

setconfig( 'Geothermal Power', 'Leveraged Partnership Flip' );
setmodules( ['geothermal', 'grid', 'levpartflip']);
setup_geothermal_power_pages();
addpage( [[ 'Geothermal Costs','O and M Costs' ]], { 'sidebar'='System Costs', 'help'='geo_system_costs' } );
setup_leveraged_partnership_flip_pages();

setconfig( 'Geothermal Power', 'All Equity Partnership Flip' );
setmodules( ['geothermal', 'grid','equpartflip']);
setup_geothermal_power_pages();
addpage( [[ 'Geothermal Costs','O and M Costs' ]], { 'sidebar'='System Costs', 'help'='geo_system_costs' } );
setup_all_equity_partnership_flip_pages();

setconfig( 'Geothermal Power', 'Sale Leaseback' );
setmodules( ['geothermal', 'grid','saleleaseback']);
setup_geothermal_power_pages();
addpage( [[ 'Geothermal Costs','O and M Costs' ]], { 'sidebar'='System Costs', 'help'='geo_system_costs' } );
setup_sale_leaseback_pages();

setconfig( 'Geothermal Power', 'Single Owner' );
setmodules( ['geothermal', 'grid','singleowner']);
setup_geothermal_power_pages();
addpage( [[ 'Geothermal Costs','O and M Costs' ]], { 'sidebar'='System Costs', 'help'='geo_system_costs' } );
setup_single_owner_pages();

setconfig( 'Geothermal Power', 'Merchant Plant' );
setmodules( ['geothermal', 'grid','merchantplant']);
setup_geothermal_power_pages();
addpage( [[ 'Geothermal Costs','O and M Costs' ]], { 'sidebar'='System Costs', 'help'='geo_system_costs' } );
setup_merchant_plant_pages();

setconfig( 'Geothermal Power', 'LCOE Calculator' );
setmodules( ['geothermal',  'grid','lcoefcr']);
setup_geothermal_power_pages();
setup_lcoefcr_pages();	

setconfig( 'Geothermal Power', 'None' );
setmodules( ['geothermal', 'grid',]);
setup_geothermal_power_pages();

// Generic System //////////////////////////////////////////////////////////////
function setup_generic_system_pages()
{
	// need en_batt variable for O&M cost page and power plant page 
	addpage( [[ 'Generic System Plant' ,'Battery Enable']], { 'sidebar'='Power Plant' , 'help'='generic_system_plant' } );
	setup_grid_page();
}
//***
setconfig( 'Generic System', 'Residential' );	
setmodules( ['generic_system', 'grid', 'utilityrate5', 'cashloan']);
setup_generic_system_pages();
setup_lifetime_page( DEGRADATION_AC_SINGLE_YEAR );
addpage( [[ 'Generic System Costs','O and M Costs']],{ 'sidebar'='System Costs', 'help'='generic_system_costs' } );
setup_residential_pages( LOAD_SIMPLE ); //does not include building load calculator

//-----------------------------------------------------
setconfig( 'Generic System', 'Third Party' );
setmodules( ['generic_system', 'grid', 'utilityrate5', 'thirdpartyownership']);
setup_generic_system_pages();
setup_lifetime_page( DEGRADATION_AC_SINGLE_YEAR );
setup_thirdparty_pages( LOAD_SIMPLE );

//-----------------------------------------------------
setconfig( 'Generic System', 'Commercial' );	
setmodules( ['generic_system',  'grid', 'utilityrate5', 'cashloan']);
setup_generic_system_pages();
setup_lifetime_page( DEGRADATION_AC_SINGLE_YEAR );
addpage( [[ 'Generic System Costs','O and M Costs']],{ 'sidebar'='System Costs', 'help'='generic_system_costs' } );
setup_commercial_pages(LOAD_SIMPLE); //does not include building load calculator

//-----------------------------------------------------
setconfig( 'Generic System', 'Leveraged Partnership Flip' );
setmodules( ['generic_system', 'grid','levpartflip']);
setup_generic_system_pages();
setup_lifetime_page( DEGRADATION_AC_SINGLE_YEAR );
addpage( [[ 'Generic System Costs','O and M Costs']],{ 'sidebar'='System Costs', 'help'='generic_system_costs' } );
setup_leveraged_partnership_flip_pages();

//-----------------------------------------------------
setconfig( 'Generic System', 'All Equity Partnership Flip' );
setmodules( ['generic_system', 'grid','equpartflip']);
setup_generic_system_pages();
setup_lifetime_page( DEGRADATION_AC_SINGLE_YEAR );
addpage( [[ 'Generic System Costs','O and M Costs']],{ 'sidebar'='System Costs', 'help'='generic_system_costs' } );
setup_all_equity_partnership_flip_pages();

//-----------------------------------------------------
setconfig( 'Generic System', 'Sale Leaseback' );
setmodules( ['generic_system', 'grid', 'saleleaseback']);
setup_generic_system_pages();
setup_lifetime_page( DEGRADATION_AC_SINGLE_YEAR );
addpage( [[ 'Generic System Costs','O and M Costs']],{ 'sidebar'='System Costs', 'help'='generic_system_costs' } );
setup_sale_leaseback_pages();

//-----------------------------------------------------
setconfig( 'Generic System', 'Single Owner' );
setmodules( ['generic_system', 'grid', 'singleowner']);
setup_generic_system_pages();
setup_lifetime_page( DEGRADATION_AC_SINGLE_YEAR );
addpage( [[ 'Generic System Costs','O and M Costs']],{ 'sidebar'='System Costs', 'help'='generic_system_costs' } );
setup_single_owner_pages();

setconfig( 'Generic System', 'Merchant Plant' );
setmodules( ['generic_system', 'grid', 'merchantplant']);
setup_generic_system_pages();
setup_lifetime_page( DEGRADATION_AC_SINGLE_YEAR );
addpage( [[ 'Generic System Costs','O and M Costs']],{ 'sidebar'='System Costs', 'help'='generic_system_costs' } );
setup_merchant_plant_pages();

setconfig( 'Generic System', 'Host Developer' );
setmodules( ['generic_system', 'grid','utilityrate5', 'host_developer']);
setup_generic_system_pages();
setup_lifetime_page( DEGRADATION_AC_SINGLE_YEAR );
addpage( [[ 'Generic System Costs','O and M Costs']],{ 'sidebar'='System Costs', 'help'='generic_system_costs' } );
setup_host_developer_pages( LOAD_SIMPLE ); //includes building load calculator by default in this function

//-----------------------------------------------------
setconfig( 'Generic System', 'LCOE Calculator' );
setmodules( ['generic_system', 'grid', 'lcoefcr']);
setup_generic_system_pages();
setup_lcoefcr_pages();	

//-----------------------------------------------------
setconfig( 'Generic System', 'None' );
setmodules( ['generic_system', 'grid']);
setup_generic_system_pages();

// Generic CSP System //////////////////////////////////////////////////////////
function setup_generic_csp_pages()
{
	addpage( [[ 'Solar Resource Data' ]], { 'sidebar'='Location and Resource', 'help'='gss_location_and_resource' } );
	addpage( [[ 'Generic CSP Solar Field' ]], { 'sidebar'='Solar Field', 'help'='gss_solar_field' } );
	addpage( [[ 'Generic CSP Power Block' ]], { 'sidebar'='Power Block', 'help'='gss_power_block' } );
//	addpage( [[ 'Generic CSP Thermal Storage' ]], { 'sidebar'='Thermal Storage', 'help'='gss_thermal_storage' } );
	addpage( [[ 'Generic CSP Thermal Storage' ,
	  {'name' = 'CSP Dispatch Control', 'caption'='Dispatch Control', 'collapsible'=false, 'collapsible_var'='csp_dispatch_is_shown'} ]], 
	  { 'sidebar'='Thermal Storage', 'help'='gss_thermal_storage' } );
 	setup_grid_page();
}

//-----------------------------------------------------
setconfig( 'Generic CSP System', 'Commercial' );	
setmodules( ['tcsgeneric_solar', 'grid', 'utilityrate5', 'cashloan']);
setup_generic_csp_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Generic CSP System Costs','O and M Costs']],{ 'sidebar'='System Costs', 'help'='gss_system_costs' } );
setup_commercial_pages(LOAD_SIMPLE); //belpe not valid for commercial
//-----------------------------------------------------
setconfig( 'Generic CSP System', 'Leveraged Partnership Flip' );
setmodules( ['tcsgeneric_solar', 'grid', 'levpartflip']);
setup_generic_csp_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Generic CSP System Costs','O and M Costs']],{ 'sidebar'='System Costs', 'help'='gss_system_costs' } );
setup_leveraged_partnership_flip_pages();
//-----------------------------------------------------
setconfig( 'Generic CSP System', 'All Equity Partnership Flip' );
setmodules( ['tcsgeneric_solar', 'grid', 'equpartflip']);
setup_generic_csp_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Generic CSP System Costs','O and M Costs']],{ 'sidebar'='System Costs', 'help'='gss_system_costs' } );
setup_all_equity_partnership_flip_pages();
//-----------------------------------------------------
setconfig( 'Generic CSP System', 'Sale Leaseback' );
setmodules( ['tcsgeneric_solar', 'grid', 'saleleaseback']);
setup_generic_csp_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Generic CSP System Costs','O and M Costs']],{ 'sidebar'='System Costs', 'help'='gss_system_costs' } );
setup_sale_leaseback_pages();
//-----------------------------------------------------
setconfig( 'Generic CSP System', 'Single Owner' );
setmodules( ['tcsgeneric_solar', 'grid', 'singleowner']);
setup_generic_csp_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Generic CSP System Costs','O and M Costs']],{ 'sidebar'='System Costs', 'help'='gss_system_costs' } );
setup_single_owner_pages();
//-----------------------------------------------------
setconfig( 'Generic CSP System', 'Merchant Plant' );
setmodules( ['tcsgeneric_solar', 'grid', 'merchantplant']);
setup_generic_csp_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Generic CSP System Costs','O and M Costs']],{ 'sidebar'='System Costs', 'help'='gss_system_costs' } );
setup_merchant_plant_pages();
//-----------------------------------------------------
setconfig( 'Generic CSP System', 'LCOE Calculator' );
setmodules( ['tcsgeneric_solar', 'grid',  'lcoefcr']);
setup_generic_csp_pages();
setup_lcoefcr_pages();	
//-----------------------------------------------------
setconfig( 'Generic CSP System', 'None' );
setmodules( ['tcsgeneric_solar', 'grid']);
setup_generic_csp_pages();

// High-X Concentrating PV /////////////////////////////////////////////////////
function setup_hcpv_pages()
{
	addpage( [[ 'Solar Resource Data' ]], { 'sidebar'='Location and Resource', 'help'='pv_location_and_resource' } );
	addpage( [[ 'HCPV Module' ]], { 'sidebar'='Module', 'help'='hcpv_module' } );
	addpage( [ ['Inverter CEC Database']], { 'sidebar'='Inverter', 'help'='hcpv_inverter' } );
	addpage( [[ 'HCPV Array' ]], { 'sidebar'='Array', 'help'='hcpv_array' } );
	setup_grid_page();
}

//-----------------------------------------------------
setconfig( 'High-X Concentrating PV', 'Leveraged Partnership Flip' );
setmodules( ['hcpv', 'grid', 'levpartflip']);
setup_hcpv_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'HCPV Costs','O and M Costs']],{ 'sidebar'='System Costs', 'help'='pv_system_costs' } );
setup_leveraged_partnership_flip_pages();
//-----------------------------------------------------
setconfig( 'High-X Concentrating PV', 'All Equity Partnership Flip' );
setmodules( ['hcpv', 'grid', 'equpartflip']);
setup_hcpv_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'HCPV Costs','O and M Costs']],{ 'sidebar'='System Costs', 'help'='pv_system_costs' } );
setup_all_equity_partnership_flip_pages();
//-----------------------------------------------------
setconfig( 'High-X Concentrating PV', 'Sale Leaseback' );
setmodules( ['hcpv', 'grid', 'saleleaseback']);
setup_hcpv_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'HCPV Costs','O and M Costs']],{ 'sidebar'='System Costs', 'help'='pv_system_costs' } );
setup_sale_leaseback_pages();
//-----------------------------------------------------
setconfig( 'High-X Concentrating PV', 'Single Owner' );
setmodules( ['hcpv', 'grid', 'singleowner']);
setup_hcpv_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'HCPV Costs','O and M Costs']],{ 'sidebar'='System Costs', 'help'='pv_system_costs' } );
setup_single_owner_pages();
//-----------------------------------------------------
setconfig( 'High-X Concentrating PV', 'Merchant Plant' );
setmodules( ['hcpv', 'grid', 'merchantplant']);
setup_hcpv_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'HCPV Costs','O and M Costs']],{ 'sidebar'='System Costs', 'help'='pv_system_costs' } );
setup_merchant_plant_pages();
//-----------------------------------------------------
setconfig( 'High-X Concentrating PV', 'LCOE Calculator' );
setmodules( ['hcpv', 'grid',  'lcoefcr']);
setup_hcpv_pages();
setup_lcoefcr_pages();
//-----------------------------------------------------
setconfig( 'High-X Concentrating PV', 'None' );
setmodules( ['hcpv', 'grid']);
setup_hcpv_pages();

// Dish Stirling ///////////////////////////////////////////////////////////////
function setup_dish_stirling_pages()
{
	addpage( [[ 'Solar Resource Data' ]], { 'sidebar'='Location and Resource', 'help'='dish_location_and_resource' } );
	addpage( [[ 'Dish Solar Field' ]], { 'sidebar'='Solar Field', 'help'='dish_solar_field' } );
	addpage( [[ 'Dish Collector' ]], { 'sidebar'='Collector', 'help'='dish_collector' } );
	addpage( [[ 'Dish Receiver' ]], { 'sidebar'='Receiver', 'help'='dish_receiver' } );
	addpage( [[ 'Dish Stirling Engine' ]], { 'sidebar'='Stirling Engine', 'help'='dish_stirling_engine' } );
	addpage( [[ 'Dish Parasitics' ]], { 'sidebar'='Parasitics', 'help'='dish_parasitics' } );
	addpage( [[ 'Dish Reference Inputs' ]], { 'sidebar'='Reference Inputs', 'help'='dish_reference_inputs' } );
	setup_grid_page();
}

//-----------------------------------------------------
setconfig( 'Dish Stirling', 'Commercial' );	
setmodules( ['tcsdish', 'grid', 'utilityrate5', 'cashloan']);
setup_dish_stirling_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Dish Capital Costs','O and M Costs']],{ 'sidebar'='System Costs', 'help'='dish_system_costs' } );
setup_commercial_pages(LOAD_SIMPLE); //belpe not valid for commercial
//-----------------------------------------------------
setconfig( 'Dish Stirling', 'Leveraged Partnership Flip' );
setmodules( ['tcsdish', 'grid', 'levpartflip']);
setup_dish_stirling_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Dish Capital Costs','O and M Costs']],{ 'sidebar'='System Costs', 'help'='dish_system_costs' } );
setup_leveraged_partnership_flip_pages();
//-----------------------------------------------------
setconfig( 'Dish Stirling', 'All Equity Partnership Flip' );
setmodules( ['tcsdish', 'grid', 'equpartflip']);
setup_dish_stirling_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Dish Capital Costs','O and M Costs']],{ 'sidebar'='System Costs', 'help'='dish_system_costs' } );
setup_all_equity_partnership_flip_pages();
//-----------------------------------------------------
setconfig( 'Dish Stirling', 'Sale Leaseback' );
setmodules( ['tcsdish', 'grid', 'saleleaseback']);
setup_dish_stirling_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Dish Capital Costs','O and M Costs']],{ 'sidebar'='System Costs', 'help'='dish_system_costs' } );
setup_sale_leaseback_pages();
//-----------------------------------------------------
setconfig( 'Dish Stirling', 'Single Owner' );
setmodules( ['tcsdish', 'grid', 'singleowner']);
setup_dish_stirling_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Dish Capital Costs','O and M Costs']],{ 'sidebar'='System Costs', 'help'='dish_system_costs' } );
setup_single_owner_pages();
//-----------------------------------------------------
setconfig( 'Dish Stirling', 'Merchant Plant' );
setmodules( ['tcsdish', 'grid', 'merchantplant']);
setup_dish_stirling_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Dish Capital Costs','O and M Costs']],{ 'sidebar'='System Costs', 'help'='dish_system_costs' } );
setup_merchant_plant_pages();
//-----------------------------------------------------
setconfig( 'Dish Stirling', 'LCOE Calculator' );
setmodules( ['tcsdish', 'grid',  'lcoefcr']);
setup_dish_stirling_pages();
setup_lcoefcr_pages();	
//-----------------------------------------------------
setconfig( 'Dish Stirling', 'None' );
setmodules( ['tcsdish', 'grid']);
setup_dish_stirling_pages();

// Biopower ////////////////////////////////////////////////////////////////////
function setup_biopower_pages()
{
	addpage( [[ 'Solar Resource Data' ]], { 'sidebar'='Ambient Conditions', 'help'='biopower_location_ambient_conditions' } );
	addpage( [[ 'Biopower Feedstock' ]], { 'sidebar'='Feedstock', 'help'='biopower_feedstock' } );
	addpage( [[ 'Biopower Plant Specifications' ]], { 'sidebar'='Plant Specs', 'help'='biopower_plant_specs' } );
	addpage( [[ 'Biopower Emissions Comparison' ]], { 'sidebar'='Emissions', 'help'='biopower_emissions' } );
	setup_grid_page();
}

//-----------------------------------------------------
setconfig( 'Biopower', 'Leveraged Partnership Flip' );
setmodules( ['biomass', 'grid', 'levpartflip']);
setup_biopower_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Biopower System Cost','O and M Costs']],{ 'sidebar'='System Costs', 'help'='biopower_system_costs' } );
addpage( [[ 'Biopower Feedstock Costs' ]], { 'sidebar'='Feedstock Costs', 'help'='biopower_feedstock_costs' } );
setup_leveraged_partnership_flip_pages();
//-----------------------------------------------------
setconfig( 'Biopower', 'All Equity Partnership Flip' );
setmodules( ['biomass', 'grid', 'equpartflip']);
setup_biopower_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Biopower System Cost','O and M Costs']],{ 'sidebar'='System Costs', 'help'='biopower_system_costs' } );
addpage( [[ 'Biopower Feedstock Costs' ]], { 'sidebar'='Feedstock Costs', 'help'='biopower_feedstock_costs' } );
setup_all_equity_partnership_flip_pages();
//-----------------------------------------------------
setconfig( 'Biopower', 'Sale Leaseback' );
setmodules( ['biomass', 'grid', 'saleleaseback']);
setup_biopower_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Biopower System Cost','O and M Costs']],{ 'sidebar'='System Costs', 'help'='biopower_system_costs' } );
addpage( [[ 'Biopower Feedstock Costs' ]], { 'sidebar'='Feedstock Costs', 'help'='biopower_feedstock_costs' } );
setup_sale_leaseback_pages();
//-----------------------------------------------------
setconfig( 'Biopower', 'Single Owner' );
setmodules( ['biomass', 'grid', 'singleowner']);
setup_biopower_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Biopower System Cost','O and M Costs']],{ 'sidebar'='System Costs', 'help'='biopower_system_costs' } );
addpage( [[ 'Biopower Feedstock Costs' ]], { 'sidebar'='Feedstock Costs', 'help'='biopower_feedstock_costs' } );
setup_single_owner_pages();
//-----------------------------------------------------
setconfig( 'Biopower', 'Merchant Plant' );
setmodules( ['biomass', 'grid', 'merchantplant']);
setup_biopower_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Biopower System Cost','O and M Costs']],{ 'sidebar'='System Costs', 'help'='biopower_system_costs' } );
addpage( [[ 'Biopower Feedstock Costs' ]], { 'sidebar'='Feedstock Costs', 'help'='biopower_feedstock_costs' } );
setup_merchant_plant_pages();
//-----------------------------------------------------
setconfig( 'Biopower', 'LCOE Calculator' );
setmodules( ['biomass', 'grid',  'lcoefcr']);
setup_biopower_pages();
setup_lcoefcr_pages();	
//-----------------------------------------------------
setconfig( 'Biopower', 'None' );
setmodules( ['biomass', 'grid']);
setup_biopower_pages();

// Molten Salt Power Tower ////////////////////////////////////////////////////////////////////
function setup_MSPT_pages()
{
	addpage( [[ 'Solar Resource Data' ]], { 'sidebar'='Location and Resource', 'help'='pt_location_and_resource' } );
	addpage( [[ 'MSPT System Design' ]], { 'sidebar'='System Design', 'help'='mspt_system_design' } );
	addpage( [[ 'Tower SolarPilot Solar Field' ]], { 'sidebar'='Heliostat Field', 'help'='mspt_heliostat_field' } );
	addpage( [[ 'MSPT Receiver' ]], { 'sidebar'='Tower and Receiver', 'help'='mspt_tower_and_receiver' } );
	addpage( [[ 'Rankine Cycle' ], [ 'User Defined Power Cycle' ], ['Supercritical Carbon Dioxide Power Cycle']], 
			{ 'sidebar'='Power Cycle', 'help'='mspt_power_cycle', 'exclusive_var' = 'pc_config',
			  'exclusive_header_pages' = ['Molten Salt Tower Power Block Common']} );
	addpage( [[ 'Molten Salt Tower Storage' ]], { 'sidebar'='Thermal Storage', 'help'='mspt_thermal_storage' } );
	addpage( [[ 'MSPT System Control' ,
	  {'name' = 'MSPT Dispatch Control', 'caption'='Dispatch Control', 'collapsible'=false, 'collapsible_var'='csp_dispatch_is_shown'} ]], 
	  { 'sidebar'='System Control', 'help'='mspt_system_control' } );
  	setup_grid_page();
}

//-----------------------------------------------------
setconfig( 'MSPT', 'Leveraged Partnership Flip' );
setmodules( ['tcsmolten_salt', 'grid', 'levpartflip']);
setup_MSPT_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Tower SolarPilot Capital Costs','O and M Costs']],{ 'sidebar'='System Costs', 'help'='pt_system_costs' } );
setup_leveraged_partnership_flip_pages();
//-----------------------------------------------------
setconfig( 'MSPT', 'All Equity Partnership Flip' );
setmodules( ['tcsmolten_salt', 'grid', 'equpartflip']);
setup_MSPT_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Tower SolarPilot Capital Costs','O and M Costs']],{ 'sidebar'='System Costs', 'help'='pt_system_costs' } );
setup_all_equity_partnership_flip_pages();
//-----------------------------------------------------
setconfig( 'MSPT', 'Sale Leaseback' );
setmodules( ['tcsmolten_salt', 'grid', 'saleleaseback']);
setup_MSPT_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Tower SolarPilot Capital Costs','O and M Costs']],{ 'sidebar'='System Costs', 'help'='pt_system_costs' } );
setup_sale_leaseback_pages();
//-----------------------------------------------------
setconfig( 'MSPT', 'Single Owner' );
setmodules( ['tcsmolten_salt', 'grid', 'singleowner']);
setup_MSPT_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Tower SolarPilot Capital Costs','O and M Costs']],{ 'sidebar'='System Costs', 'help'='pt_system_costs' } );
setup_single_owner_pages();
//-----------------------------------------------------
setconfig( 'MSPT', 'Merchant Plant' );
setmodules( ['tcsmolten_salt', 'grid', 'merchantplant']);
setup_MSPT_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Tower SolarPilot Capital Costs','O and M Costs']],{ 'sidebar'='System Costs', 'help'='pt_system_costs' } );
setup_merchant_plant_pages();
if ( en_iscc ) {
	// ISCC Molten Salt Power Tower //////////////////////////////////////////////////////
	function setup_ISCC_pages()
	{
			addpage( [[ 'Solar Resource Data' ]], { 'sidebar'='Location and Resource', 'help'='iscc_location_and_resource' } );
			addpage( [[ 'Tower Solar Field' ]], { 'sidebar'='Heliostat Field', 'help'='iscc_heliostat_field' } );
			addpage( [[ 'ISCC Molten Salt Tower Receiver',{'name' = 'ISCC Receiver and Powerblock', 'caption'='DESIGN POINT Integration with Natural Gas Combined Cycle',
			'collapsible'=false,'collapsible_var'='iscc_is_shown'}]], { 'sidebar'='Tower Receiver Cycle', 'help'='iscc_tower_receiver_cycle' } );
			addpage( [[ 'ISCC Parasitics' ]], { 'sidebar'='Parasitics', 'help'='iscc_parasitics' } );
			setup_grid_page();
	}
	//-----------------------------------------------------
	setconfig( 'ISCC', 'Single Owner' );
	setmodules( ['tcsiscc', 'grid', 'singleowner']);
	setup_ISCC_pages();
	setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
	addpage( [[ 'Tower Capital Costs','O and M Costs']],{ 'sidebar'='System Costs', 'help'='iscc_system_costs' } );
	setup_single_owner_pages();
}
// Direct Steam Linear IPH ////////////
function setup_DSGL_IPH_pages()
{
	addpage( [[ 'Solar Resource Data' ]], { 'sidebar'='Location and Resource', 'help'='iph_linear_ds-location_resource' } );
	addpage( [[ 'LF DSG System Design' ]], { 'sidebar'='System Design', 'help'='iph_linear_ds-system_design' } );
	addpage( [[ 'LF DSG Solar Field' ]], { 'sidebar'='Solar Field', 'help'='iph_linear_ds-solar_field' } );
	addpage( [[ 'LF DSG Boiler Header', 'Linear Fresnel Boiler Geometry' ]], { 'sidebar'='Collector and Receiver', 'help'='iph_linear_ds-collector_receiver' } );
 	//setup_grid_page();
}

//--------------------------------------------------
setconfig( 'DSGL IPH', 'None' );
setmodules( ['linear_fresnel_dsg_iph'] );
setup_DSGL_IPH_pages();

setconfig( 'DSGL IPH', 'LCOH Calculator' );
setmodules( ['linear_fresnel_dsg_iph', 'iph_to_lcoefcr', 'lcoefcr'] );
setup_DSGL_IPH_pages();
setup_iph_lcoefcr_pages();


// Direct Steam Linear Fresnel ////////////////////////////////////////////////////////////////////
function setup_DSLF_pages()
{
	addpage( [[ 'Solar Resource Data' ]], { 'sidebar'='Location and Resource', 'help'='lf_location_and_resource' } );
	addpage( [[ 'Linear Fresnel Solar Field' ]], { 'sidebar'='Solar Field', 'help'='dslf_solar_field' } );

	addpage( [[ 'Linear Fresnel Collector and Receiver Header',
	 {'name'='Linear Fresnel Boiler Geometry', 'caption'='Boiler Geometry', 'collapsible'=true, 'collapsible_var'='boiler_is_shown'},
	 {'name'='Linear Fresnel Superheater Geometry', 'caption'='Superheater Geometry', 'collapsible'=true, 'collapsible_var'='superheater_is_shown'} ]],
	 { 'sidebar'='Collector and Receiver', 'help'='dslf_collector_and_receiver' } );
	addpage( [[ 'PBNS Power Block', {'name' = 'CSP PBNS Dispatch Control', 'caption'='Dispatch Control', 'collapsible'=false, 'collapsible_var'='csp_dispatch_is_shown'}  ]], { 'sidebar'='Power Cycle', 'help'='dslf_power_cycle' } );
	addpage( [[ 'Linear Fresnel Parasitics' ]], { 'sidebar'='Parasitics', 'help'='dslf_parasitics' } );
 	setup_grid_page();
}

//-----------------------------------------------------
setconfig( 'DSLF', 'LCOE Calculator' );
setmodules( ['tcslinear_fresnel', 'grid',  'lcoefcr']);
setup_DSLF_pages();
setup_lcoefcr_pages();	

//-----------------------------------------------------
setconfig( 'DSLF', 'None' );
setmodules( ['tcslinear_fresnel', 'grid']);
setup_DSLF_pages();

//-----------------------------------------------------
setconfig( 'DSLF', 'Commercial' );	
setmodules( ['tcslinear_fresnel', 'grid', 'utilityrate5', 'cashloan']);
setup_DSLF_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Linear Fresnel Capital Costs','O and M Costs']], { 'sidebar'='System Costs', 'help'='lf_system_costs' } );
setup_commercial_pages(LOAD_SIMPLE); //belpe not valid for commercial
//-----------------------------------------------------
setconfig( 'DSLF', 'Leveraged Partnership Flip' );
setmodules( ['tcslinear_fresnel', 'grid', 'levpartflip']);
setup_DSLF_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Linear Fresnel Capital Costs','O and M Costs']], { 'sidebar'='System Costs', 'help'='lf_system_costs' } );
setup_leveraged_partnership_flip_pages();
//-----------------------------------------------------
setconfig( 'DSLF', 'All Equity Partnership Flip' );
setmodules( ['tcslinear_fresnel', 'grid', 'equpartflip']);
setup_DSLF_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Linear Fresnel Capital Costs','O and M Costs']], { 'sidebar'='System Costs', 'help'='lf_system_costs' } );
setup_all_equity_partnership_flip_pages();
//-----------------------------------------------------
setconfig( 'DSLF', 'Sale Leaseback' );
setmodules( ['tcslinear_fresnel', 'grid', 'saleleaseback']);
setup_DSLF_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Linear Fresnel Capital Costs','O and M Costs']], { 'sidebar'='System Costs', 'help'='lf_system_costs' } );
setup_sale_leaseback_pages();
//-----------------------------------------------------
setconfig( 'DSLF', 'Single Owner' );
setmodules( ['tcslinear_fresnel', 'grid', 'singleowner']);
setup_DSLF_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Linear Fresnel Capital Costs','O and M Costs']], { 'sidebar'='System Costs', 'help'='lf_system_costs' } );
setup_single_owner_pages();
//-----------------------------------------------------
setconfig( 'DSLF', 'Merchant Plant' );
setmodules( ['tcslinear_fresnel', 'grid', 'merchantplant']);
setup_DSLF_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Linear Fresnel Capital Costs','O and M Costs']], { 'sidebar'='System Costs', 'help'='lf_system_costs' } );
setup_merchant_plant_pages();
//-----------------------------------------------------

// Direct Steam Power Tower ////////////////////////////////////////////////////////////////////
function setup_DSPT_pages()
{
	addpage( [[ 'Solar Resource Data' ]], { 'sidebar'='Location and Resource', 'help'='pt_location_and_resource' } );
	addpage( [[ 'Tower Solar Field' ]], { 'sidebar'='Heliostat Field', 'help'='dspt_heliostat_field' } );
	addpage( [[ 'Direct Steam Tower Receiver' ]], { 'sidebar'='Tower and Receiver', 'help'='dspt_tower_and_receiver' } );
	addpage( [[ 'PBNS Power Block', {'name' = 'CSP PBNS Dispatch Control', 'caption'='Dispatch Control', 'collapsible'=false, 'collapsible_var'='csp_dispatch_is_shown'}  ]], { 'sidebar'='Power Cycle', 'help'='dspt_power_cycle' } );
	addpage( [[ 'Direct Steam Tower Parasitics' ]], { 'sidebar'='Parasitics', 'help'='dspt_parasitics' } ); 	
	setup_grid_page();
}

//-----------------------------------------------------
setconfig( 'DSPT', 'Leveraged Partnership Flip' );
setmodules( ['tcsdirect_steam', 'grid', 'levpartflip']);
setup_DSPT_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Tower Capital Costs','O and M Costs']],{ 'sidebar'='System Costs', 'help'='pt_system_costs' } );
setup_leveraged_partnership_flip_pages();
//-----------------------------------------------------
setconfig( 'DSPT', 'All Equity Partnership Flip' );
setmodules( ['tcsdirect_steam', 'grid', 'equpartflip']);
setup_DSPT_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Tower Capital Costs','O and M Costs']],{ 'sidebar'='System Costs', 'help'='pt_system_costs' } );
setup_all_equity_partnership_flip_pages();
//-----------------------------------------------------
setconfig( 'DSPT', 'Sale Leaseback' );
setmodules( ['tcsdirect_steam', 'grid', 'saleleaseback']);
setup_DSPT_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Tower Capital Costs','O and M Costs']],{ 'sidebar'='System Costs', 'help'='pt_system_costs' } );
setup_sale_leaseback_pages();
//-----------------------------------------------------
setconfig( 'DSPT', 'Single Owner' );
setmodules( ['tcsdirect_steam', 'grid', 'singleowner']);
setup_DSPT_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Tower Capital Costs','O and M Costs']],{ 'sidebar'='System Costs', 'help'='pt_system_costs' } );
setup_single_owner_pages();
//-----------------------------------------------------
setconfig( 'DSPT', 'Merchant Plant' );
setmodules( ['tcsdirect_steam', 'grid', 'merchantplant']);
setup_DSPT_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Tower Capital Costs','O and M Costs']],{ 'sidebar'='System Costs', 'help'='pt_system_costs' } );
setup_merchant_plant_pages();

// Molten Salt Linear Fresnel ////////////////////////////////////////////////////////////////////
function setup_MSLF_pages()
{
	addpage( [[ 'Solar Resource Data' ]], { 'sidebar'='Location and Resource', 'help'='lf_location_and_resource' } );
	addpage( [[ 'Molten Salt Linear Fresnel Solar Field' ]], { 'sidebar'='Solar Field', 'help'='mslf_solar_field' } );

	addpage( [[ 'Molten Salt Linear Fresnel Collector and Receiver' ]],
	 { 'sidebar'='Collector and Receiver', 'help'='mslf_collector_and_receiver' } );
	
	//addpage( [['MSLF Power Cycle Common' ,
	//	{ 'name' = 'Physical Trough Rankine Cycle', 'caption' = 'Rankine Cycle', 'collapsible'=false, 'collapsible_var'='csp_dispatch_is_shown'} ]],
	//	{ 'sidebar'='Power Cycle', 'help'='mslf_power_cycle' } );
	
	addpage( [[ 'Rankine Cycle and Hybrid Cooling' ], [ 'User Defined Power Cycle' ]], 
			{ 'sidebar'='Power Cycle', 'help'='mspt_power_cycle', 'exclusive_var' = 'pc_config',
			  'exclusive_header_pages' = ['MSLF Power Cycle Common']} );
	
	//addpage( [[ 'Molten Salt Linear Fresnel Power Cycle' ]], { 'sidebar'='Power Cycle', 'help'='mslf_power_cycle' } );
	
	addpage( [[ 'Molten Salt Linear Fresnel Storage' ,
	  {'name' = 'CSP Dispatch Control', 'caption'='Dispatch Control', 'collapsible'=false, 'collapsible_var'='csp_dispatch_is_shown'} ]], 
	  { 'sidebar'='Thermal Storage', 'help'='mslf_thermal_storage' } );
	addpage( [[ 'Molten Salt Linear Fresnel Parasitics' ]], { 'sidebar'='Parasitics', 'help'='mslf_parasitics' } );
 	setup_grid_page();
}

//-----------------------------------------------------
setconfig( 'MSLF', 'LCOE Calculator' );
setmodules( ['tcsMSLF', 'grid',  'lcoefcr']);
setup_MSLF_pages();
setup_lcoefcr_pages();	

//-----------------------------------------------------
setconfig( 'MSLF', 'None' );
setmodules( ['tcsMSLF', 'grid']);
setup_MSLF_pages();

//-----------------------------------------------------
setconfig( 'MSLF', 'Commercial' );	
setmodules( ['tcsMSLF', 'grid', 'utilityrate5', 'cashloan']);
setup_MSLF_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Molten Salt Linear Fresnel Capital Costs','O and M Costs']], { 'sidebar'='System Costs', 'help'='lf_system_costs' } );
setup_commercial_pages(LOAD_SIMPLE); //belpe not valid for commercial
//-----------------------------------------------------
setconfig( 'MSLF', 'Leveraged Partnership Flip' );
setmodules( ['tcsMSLF', 'grid', 'levpartflip']);
setup_MSLF_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Molten Salt Linear Fresnel Capital Costs','O and M Costs']], { 'sidebar'='System Costs', 'help'='lf_system_costs' } );
setup_leveraged_partnership_flip_pages();
//-----------------------------------------------------
setconfig( 'MSLF', 'All Equity Partnership Flip' );
setmodules( ['tcsMSLF', 'grid', 'equpartflip']);
setup_MSLF_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Molten Salt Linear Fresnel Capital Costs','O and M Costs']], { 'sidebar'='System Costs', 'help'='lf_system_costs' } );
setup_all_equity_partnership_flip_pages();
//-----------------------------------------------------
setconfig( 'MSLF', 'Sale Leaseback' );
setmodules( ['tcsMSLF', 'grid', 'saleleaseback']);
setup_MSLF_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Molten Salt Linear Fresnel Capital Costs','O and M Costs']], { 'sidebar'='System Costs', 'help'='lf_system_costs' } );
setup_sale_leaseback_pages();
//-----------------------------------------------------
setconfig( 'MSLF', 'Single Owner' );
setmodules( ['tcsMSLF', 'grid', 'singleowner']);
setup_MSLF_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Molten Salt Linear Fresnel Capital Costs','O and M Costs']], { 'sidebar'='System Costs', 'help'='lf_system_costs' } );
setup_single_owner_pages();
//-----------------------------------------------------
setconfig( 'MSLF', 'Merchant Plant' );
setmodules( ['tcsMSLF', 'grid', 'merchantplant']);
setup_MSLF_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Molten Salt Linear Fresnel Capital Costs','O and M Costs']], { 'sidebar'='System Costs', 'help'='lf_system_costs' } );
setup_merchant_plant_pages();

// Marine Energy ////////////////////////////////////////////////////////////////////
function setup_mewave_pages()
{
	addpage( [[ 'Marine Wave Resource']], { 'sidebar'='Wave Resource', 'help'='mhk_wave_resource' } );
	addpage( [[ 'Marine Wave Converter' ]], { 'sidebar'='Wave Energy Converter', 'help'='mhk_wave_converter' } );
	addpage( [[ 'Marine Array' ]], { 'sidebar'='Array', 'help'='mhk_wave_array' } );
	addpage( [[ 'Marine Losses' ]], { 'sidebar'='Losses', 'help'='mhk_wave_losses' } );
	addpage( [[ 'Marine Costs']],{ 'sidebar'='System Costs', 'help'='mhk_wave_system_costs' } );
}
setconfig( 'MEwave', 'LCOE Calculator' );
setmodules( ['wave_file_reader', 'mhk_wave', 'lcoefcr']);
setup_mewave_pages();
addpage( [[ 'Financial LCOE Calc with Costs Page']], { 'sidebar'='Financial Parameters', 'help'='fin_lcoefcr'} );

function setup_metidal_pages()
{
	addpage( [[ 'Marine Tidal Resource']], { 'sidebar'='Tidal Resource', 'help'='mhk_tidal_resource' } );
	addpage( [[ 'Marine Tidal Converter' ]], { 'sidebar'='Tidal Energy Converter', 'help'='mhk_tidal_converter' } );
	addpage( [[ 'Marine Array' ]], { 'sidebar'='Array', 'help'='mhk_tidal_array' } );
	addpage( [[ 'Marine Losses' ]], { 'sidebar'='Losses', 'help'='mhk_tidal_losses' } );
	addpage( [[ 'Marine Costs']],{ 'sidebar'='System Costs', 'help'='mhk_tidal_system_costs' } );
}
setconfig( 'MEtidal', 'LCOE Calculator' );
setmodules( ['mhk_tidal', 'lcoefcr']);
setup_metidal_pages();
addpage( [[ 'Financial LCOE Calc with Costs Page']], { 'sidebar'='Financial Parameters', 'help'='fin_lcoefcr'} );

if ( en_pvsamv3 )
{
	setconfig( 'Photovoltaic', 'None' );
	addpage( [[ 'Solar Resource Data', {'name'='PV Albedo and Radiation', 'caption' = 'Albedo - Sky Diffuse Model - Irradiance Data (Advanced)', 'collapsible'=true, 'collapsible_var'='pv.radmode.is_shown'} ]], { 'sidebar'='Location and Resource', 'help'='pv_location_and_resource' } );

	addpage( [ ['PV2 Environment'] ], { 'sidebar'='Environment', 'help'='pv_environ' } );

	addpage( [ [ {'name'='PV2 Unified Module Model 1', 'caption'='Module 1' }],
				[{'name'='PV2 Unified Module Model 2', 'caption'='Module 2' }],
				[{'name'='PV2 Unified Module Model 3', 'caption'='Module 3' }], 
				[{'name'='PV2 Unified Module Model 4', 'caption'='Module 4' }] ], 				
			{ 'sidebar'='Modules', 'help'='pv_module', 'exclusive_var'='module_type', 'exclusive_tabs'=true} );
	addpage( [ [ {'name'='PV2 Unified Inverter Model 1', 'caption'='Inverter 1' }] ], 				
			{ 'sidebar'='Inverter', 'help'='pv_inverter' } );
	addpage( [ [ {'name'='PV2 MLPE Optimizers', 'caption'='DC Optimizer' }] ], 				
			{ 'sidebar'='DC optimizer', 'help'='dc_optimizer' } );
	addpage( [ [ {'name'='PV2 DC Design 1', 'caption'='Subarray 1' }],
				[{'name'='PV2 DC Design 2', 'caption'='Subarray 2' }],
				[{'name'='PV2 DC Design 3', 'caption'='Subarray 3' }], 
				[{'name'='PV2 DC Design 4', 'caption'='Subarray 4' }],
				[{'name'='PV2 DC Design 5', 'caption'='Subarray 5' }],
				[{'name'='PV2 DC Design 6', 'caption'='Subarray 6' }] ], 				
			{ 'sidebar'='System Design', 'help'='system_design', 'exclusive_var'='subarray_index', 
				'exclusive_tabs'=true, 'exclusive_header_pages'=['PV2 AC Design']} );
	addpage( [ [ {'name'='PV2 Interconnection', 'caption'='Interconnection' }] ], 				
			{ 'sidebar'='Interconnection', 'help'='pv_interconnection' } );
	//addpage( [ [ 'PV3 Subarray 1', {'name'='PV3 Subarray 1 Spacing', 'caption' = 'Subarray Spacing (For Self-Shading and Snow Only)', 'collapsible'=true, 'collapsible_var'='pv3.sub_spacing_is_shown'} ] ], {'sidebar'='System Design J'});
	setup_battery_pages_behind_the_meter();
}

// Battery /////////////////////////////////////////////////////////////////////

// PV Battery //////////////////////////////////////////////////////////////
setconfig( 'PV Battery', 'Residential' );
setmodules( ['belpe', 'pvsamv1', 'grid', 'utilityrate5', 'cashloan']);
setup_flat_plate_pv_pages();
setup_battery_pages_behind_the_meter(); // modified to remove exclusive var
setup_lifetime_page( DEGRADATION_PVSAM );
addpage( [[ 'PV Battery Capital Costs','O and M Costs' ]], { 'sidebar'='System Costs', 'help'='pv_system_costs' } );
setup_residential_pages( LOAD_BELPE_CRIT ); //includes building load calculator

setconfig( 'PV Battery', 'Commercial' );
setmodules( ['pvsamv1', 'grid', 'utilityrate5', 'cashloan']);
setup_flat_plate_pv_pages();
setup_battery_pages_behind_the_meter();
setup_lifetime_page( DEGRADATION_PVSAM );
addpage( [[ 'PV Battery Capital Costs','O and M Costs' ]], { 'sidebar'='System Costs', 'help'='pv_system_costs' } );
setup_commercial_pages( LOAD_SIMPLE_CRIT ); //belpe not valid for commercial

setconfig( 'PV Battery', 'Third Party' );
setmodules( ['belpe', 'pvsamv1', 'grid', 'utilityrate5', 'thirdpartyownership']);
setup_flat_plate_pv_pages();
setup_battery_pages_behind_the_meter();
setup_lifetime_page( DEGRADATION_PVSAM );
setup_thirdparty_pages( LOAD_BELPE_CRIT ); //includes building load calculator by default in this function

setconfig( 'PV Battery', 'Host Developer' );
setmodules( ['pvsamv1', 'grid', 'utilityrate5', 'host_developer']);
setup_flat_plate_pv_pages();
setup_battery_pages_behind_the_meter();
setup_lifetime_page( DEGRADATION_PVSAM );
addpage( [[ 'PV Battery Capital Costs','O and M Costs' ]], { 'sidebar'='System Costs', 'help'='pv_system_costs' } );
setup_host_developer_pages( LOAD_SIMPLE_CRIT ); //includes building load calculator by default in this function

setconfig( 'PV Battery', 'Single Owner' );	
setmodules( ['pvsamv1', 'grid', 'utilityrate5', 'singleowner']);
setup_flat_plate_pv_pages();
setup_battery_pages_front_of_meter();
setup_lifetime_page( DEGRADATION_PVSAM );
addpage( [[ 'PV Battery Capital Costs','O and M Costs' ]], { 'sidebar'='System Costs', 'help'='pv_system_costs' } );
setup_single_owner_pages( );
setup_utility_rate_optional();

setconfig( 'PV Battery', 'Merchant Plant' );	
setmodules( ['pvsamv1', 'grid', 'merchantplant']);
setup_flat_plate_pv_pages();
setup_battery_pages_front_of_meter();
setup_lifetime_page( DEGRADATION_PVSAM );
addpage( [[ 'PV Battery Capital Costs','O and M Costs' ]], { 'sidebar'='System Costs', 'help'='pv_system_costs' } );
setup_merchant_plant_pages( );

setconfig( 'PV Battery', 'Leveraged Partnership Flip' );	
setmodules( ['pvsamv1', 'grid', 'levpartflip']);
setup_flat_plate_pv_pages();
setup_battery_pages_front_of_meter();
setup_lifetime_page( DEGRADATION_PVSAM );
addpage( [[ 'PV Battery Capital Costs','O and M Costs' ]], { 'sidebar'='System Costs', 'help'='pv_system_costs' } );
setup_leveraged_partnership_flip_pages( );

setconfig( 'PV Battery', 'All Equity Partnership Flip' );	
setmodules( ['pvsamv1', 'grid', 'equpartflip']);
setup_flat_plate_pv_pages();
setup_battery_pages_front_of_meter();
setup_lifetime_page( DEGRADATION_PVSAM );
addpage( [[ 'PV Battery Capital Costs','O and M Costs' ]], { 'sidebar'='System Costs', 'help'='pv_system_costs' } );
setup_all_equity_partnership_flip_pages( );

setconfig( 'PV Battery', 'Sale Leaseback' );	
setmodules( ['pvsamv1', 'grid', 'saleleaseback']);
setup_flat_plate_pv_pages();
setup_battery_pages_front_of_meter();
setup_lifetime_page( DEGRADATION_PVSAM );
addpage( [[ 'PV Battery Capital Costs','O and M Costs' ]], { 'sidebar'='System Costs', 'help'='pv_system_costs' } );
setup_sale_leaseback_pages( );

// Generic Battery /////////////////////////////////////////////////////////

setconfig( 'Generic Battery', 'Residential' );	
setmodules( ['belpe', 'generic_system', 'battery',  'grid', 'utilityrate5', 'cashloan']);
setup_generic_system_pages();
setup_battery_pages_behind_the_meter(); // modified to remove exclusive var
setup_lifetime_page( DEGRADATION_AC_LIFETIME );
addpage( [[ 'Generic System Battery Costs','O and M Costs']],{ 'sidebar'='System Costs', 'help'='generic_system_costs' } );
setup_residential_pages( LOAD_BELPE_CRIT ); 

setconfig( 'Generic Battery', 'Commercial' );	
setmodules( ['generic_system', 'battery',  'grid', 'utilityrate5', 'cashloan']);
setup_generic_system_pages();
setup_battery_pages_behind_the_meter(); // modified to remove exclusive var
setup_lifetime_page( DEGRADATION_AC_LIFETIME );
addpage( [[ 'Generic System Battery Costs','O and M Costs']],{ 'sidebar'='System Costs', 'help'='generic_system_costs' } );
setup_commercial_pages( LOAD_SIMPLE_CRIT ); //does not include building load calculator

setconfig( 'Generic Battery', 'Third Party' );
setmodules( ['belpe', 'generic_system', 'battery', 'grid', 'utilityrate5', 'thirdpartyownership']);
setup_generic_system_pages();
setup_battery_pages_behind_the_meter();
setup_lifetime_page( DEGRADATION_AC_LIFETIME );
setup_thirdparty_pages( LOAD_BELPE_CRIT ); 

setconfig( 'Generic Battery', 'Host Developer' );
setmodules( ['generic_system', 'battery', 'grid', 'utilityrate5', 'host_developer']);
setup_generic_system_pages();
setup_battery_pages_behind_the_meter();
setup_lifetime_page( DEGRADATION_AC_LIFETIME );
addpage( [[ 'Generic System Battery Costs','O and M Costs' ]], { 'sidebar'='System Costs', 'help'='pv_system_costs' } );
setup_host_developer_pages( LOAD_SIMPLE_CRIT ); 

setconfig( 'Generic Battery', 'Single Owner' );	
setmodules( ['generic_system', 'battery', 'grid', 'utilityrate5', 'singleowner']);
setup_generic_system_pages();
setup_battery_pages_front_of_meter();
setup_lifetime_page( DEGRADATION_AC_LIFETIME );
addpage( [[ 'Generic System Battery Costs','O and M Costs' ]], { 'sidebar'='System Costs', 'help'='pv_system_costs' } );
setup_single_owner_pages( );
setup_utility_rate_optional();

setconfig( 'Generic Battery', 'Merchant Plant' );	
setmodules( ['generic_system', 'battery', 'grid', 'merchantplant']);
setup_generic_system_pages();
setup_battery_pages_front_of_meter();
setup_lifetime_page( DEGRADATION_AC_LIFETIME );
addpage( [[ 'Generic System Battery Costs','O and M Costs' ]], { 'sidebar'='System Costs', 'help'='pv_system_costs' } );
setup_merchant_plant_pages( );

setconfig( 'Generic Battery', 'Leveraged Partnership Flip' );	
setmodules( ['generic_system', 'battery', 'grid', 'levpartflip']);
setup_generic_system_pages();
setup_battery_pages_front_of_meter();
setup_lifetime_page( DEGRADATION_AC_LIFETIME );
addpage( [[ 'Generic System Battery Costs','O and M Costs' ]], { 'sidebar'='System Costs', 'help'='pv_system_costs' } );
setup_leveraged_partnership_flip_pages( );

setconfig( 'Generic Battery', 'All Equity Partnership Flip' );	
setmodules( ['generic_system', 'battery', 'grid', 'equpartflip']);
setup_generic_system_pages();
setup_battery_pages_front_of_meter();
setup_lifetime_page( DEGRADATION_AC_LIFETIME );
addpage( [[ 'Generic System Battery Costs','O and M Costs' ]], { 'sidebar'='System Costs', 'help'='pv_system_costs' } );
setup_all_equity_partnership_flip_pages( );

setconfig( 'Generic Battery', 'Sale Leaseback' );	
setmodules( ['generic_system', 'battery', 'grid', 'saleleaseback']);
setup_generic_system_pages();
setup_battery_pages_front_of_meter();
setup_lifetime_page( DEGRADATION_AC_LIFETIME );
addpage( [[ 'Generic System Battery Costs','O and M Costs' ]], { 'sidebar'='System Costs', 'help'='pv_system_costs' } );
setup_sale_leaseback_pages( );
	
// PVWatts Battery /////////////////////////////////////////////////////////	
setconfig( 'PVWatts Battery', 'Residential' );	
setmodules( ['pvwattsv7', 'belpe', 'battwatts', 'grid','utilityrate5', 'cashloan']);
setup_pvwatts_battery_pages_behind_the_meter();
setup_lifetime_page( DEGRADATION_AC_SINGLE_YEAR );
addpage( [[ 'PV Battery Capital Costs','O and M Costs' ]], { 'sidebar'='System Costs', 'help'='pv_system_costs' } );
setup_residential_pages( LOAD_BELPE_CRIT ); //includes building load calculator

setconfig( 'PVWatts Battery', 'Commercial' );	
setmodules( ['pvwattsv7', 'battwatts','grid', 'utilityrate5', 'cashloan']);
setup_pvwatts_battery_pages_behind_the_meter();
setup_lifetime_page( DEGRADATION_AC_SINGLE_YEAR );
addpage( [[ 'PV Battery Capital Costs','O and M Costs' ]], { 'sidebar'='System Costs', 'help'='pv_system_costs' } );
setup_commercial_pages(LOAD_SIMPLE_CRIT); //belpe not valid for commercial

setconfig( 'PVWatts Battery', 'Host Developer' );
setmodules( ['pvwattsv7', 'battwatts', 'grid', 'utilityrate5', 'host_developer']);
setup_pvwatts_battery_pages_behind_the_meter();
setup_lifetime_page( DEGRADATION_AC_SINGLE_YEAR );
addpage( [[ 'PV Battery Capital Costs','O and M Costs' ]], { 'sidebar'='System Costs', 'help'='pv_system_costs' } );
setup_host_developer_pages( LOAD_SIMPLE_CRIT ); //includes building load calculator by default in this function

setconfig( 'PVWatts Battery', 'Third Party' );	
setmodules( ['pvwattsv7', 'belpe', 'battwatts', 'grid','utilityrate5', 'thirdpartyownership']);
setup_pvwatts_battery_pages_behind_the_meter();
setup_lifetime_page( DEGRADATION_AC_SINGLE_YEAR );
setup_thirdparty_pages( LOAD_BELPE_CRIT ); //includes building load calculator by default in this function
