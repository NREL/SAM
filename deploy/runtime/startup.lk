// SAM startup script.

const BTM = true;
const FOM = false;

// define all the configurations

// The order of performance models in configuration tree determined by order of calls to addconfig(), except order of groups, 
// which appear at the top of the tree with order determined in PopulateTech() function in main.cpp.
// The order of financial models for each performance model determined by order of array items in second parameter of addconfig().
// configopt() assignments below determine what group each configuration belongs to.

// Photovoltaic
addconfig( 'Flat Plate PV', ['Residential', 'Commercial', 'Third Party', 'Host Developer', 'Single Owner', 'Merchant Plant', 'Leveraged Partnership Flip', 'All Equity Partnership Flip', 'Sale Leaseback', 'LCOE Calculator', 'None'] );
addconfig( 'PVWatts', [ 'Residential', 'Commercial', 'Third Party', 'Host Developer', 'Single Owner', 'Community Solar', 'Merchant Plant', 'Leveraged Partnership Flip', 'All Equity Partnership Flip', 'Sale Leaseback', 'LCOE Calculator', 'None' ] );
addconfig( 'High-X Concentrating PV', ['Single Owner', 'Merchant Plant', 'Leveraged Partnership Flip', 'All Equity Partnership Flip', 'Sale Leaseback', 'LCOE Calculator', 'None']);
// Energy Storage
addconfig( 'PV Battery', ['Residential', 'Commercial', 'Third Party', 'Host Developer', 'Single Owner', 'Merchant Plant', 'Leveraged Partnership Flip', 'All Equity Partnership Flip', 'Sale Leaseback'] );
addconfig( 'PVWatts Battery', ['Residential', 'Commercial', 'Third Party', 'Host Developer'] );
addconfig( 'Custom Generation Battery', ['Residential', 'Commercial', 'Third Party', 'Host Developer', 'Single Owner', 'Merchant Plant', 'Leveraged Partnership Flip', 'All Equity Partnership Flip', 'Sale Leaseback'] );
addconfig( 'Standalone Battery', ['Residential', 'Commercial', 'Third Party', 'Host Developer', 'Single Owner', 'Merchant Plant', 'Leveraged Partnership Flip', 'All Equity Partnership Flip', 'Sale Leaseback'] );
addconfig( 'ETES', ['Single Owner']);
addconfig( 'PTES', ['Single Owner']);
// Concentrating Solar Power
addconfig( 'Physical Trough', ['Single Owner', 'Merchant Plant', 'Leveraged Partnership Flip', 'All Equity Partnership Flip', 'Sale Leaseback', 'LCOE Calculator', 'None']);
addconfig( 'Empirical Trough', ['Commercial','Single Owner', 'Merchant Plant', 'Leveraged Partnership Flip', 'All Equity Partnership Flip', 'Sale Leaseback', 'LCOE Calculator', 'None']);
addconfig( 'MSPT', ['Single Owner', 'Merchant Plant', 'Leveraged Partnership Flip', 'All Equity Partnership Flip', 'Sale Leaseback', 'None']);
addconfig( 'MSLF', ['Single Owner', 'Merchant Plant', 'Leveraged Partnership Flip', 'All Equity Partnership Flip', 'Sale Leaseback']);
addconfig( 'DSLF', ['Commercial','Single Owner', 'Merchant Plant', 'Leveraged Partnership Flip', 'All Equity Partnership Flip', 'Sale Leaseback', 'LCOE Calculator', 'None']);
//addconfig( 'Dish Stirling', ['Commercial','Single Owner', 'Merchant Plant', 'Leveraged Partnership Flip', 'All Equity Partnership Flip', 'Sale Leaseback', 'LCOE Calculator', 'None']);
addconfig( 'Generic CSP System', ['Commercial','Single Owner', 'Merchant Plant', 'Leveraged Partnership Flip', 'All Equity Partnership Flip', 'Sale Leaseback', 'LCOE Calculator', 'None']);
// Heat
addconfig( 'MSPT IPH', ['None', 'LCOH Calculator']);
addconfig( 'Physical Trough IPH', ['None', 'LCOH Calculator']);
addconfig( 'DSGL IPH', ['None', 'LCOH Calculator']);
addconfig( 'MSLF IPH', ['None', 'LCOH Calculator']);
// Marine Energy
addconfig( 'MEwave', ['Single Owner', 'LCOE Calculator', 'None']);
addconfig( 'MEwave Battery', ['Single Owner']);
addconfig( 'MEtidal', ['LCOE Calculator', 'None']);
// Wind
addconfig( 'Wind Power', [ 'Residential', 'Commercial', 'Single Owner', 'Merchant Plant', 'Leveraged Partnership Flip', 'All Equity Partnership Flip', 'Sale Leaseback', 'LCOE Calculator', 'None'] );
// Fuel Cell-PV-Battery
addconfig( 'Fuel Cell', ['Commercial', 'Single Owner']);
// Geothermal
addconfig( 'Geothermal Power', ['Single Owner', 'Merchant Plant', 'Leveraged Partnership Flip', 'All Equity Partnership Flip', 'Sale Leaseback', 'LCOE Calculator', 'None']);
// Solar Water Heating
addconfig( 'Solar Water Heating', ['Residential', 'Commercial', 'LCOE Calculator', 'None']);
// Biomass Combustion
addconfig( 'Biopower', ['Single Owner', 'Merchant Plant', 'Leveraged Partnership Flip', 'All Equity Partnership Flip', 'Sale Leaseback', 'LCOE Calculator', 'None']);
// Generic System
addconfig( 'Custom Generation Profile', ['Residential', 'Commercial', 'Third Party', 'Host Developer', 'Single Owner', 'Merchant Plant', 'Leveraged Partnership Flip', 'All Equity Partnership Flip', 'Sale Leaseback', 'LCOE Calculator', 'None']); //have to leave in startup for 1 year for version upgrade script to find config
addconfig( 'Generic System', ['Residential', 'Commercial', 'Third Party', 'Host Developer', 'Single Owner', 'Merchant Plant', 'Leveraged Partnership Flip', 'All Equity Partnership Flip', 'Sale Leaseback', 'LCOE Calculator', 'None']);
addconfig( 'Generic Battery', ['Residential', 'Commercial', 'Third Party', 'Host Developer', 'Single Owner', 'Merchant Plant', 'Leveraged Partnership Flip', 'All Equity Partnership Flip', 'Sale Leaseback'] );
addconfig( 'Generic PVWatts Wind FuelCell Battery Hybrid', ['Single Owner', 'Host Developer']);

addconfig( 'Retired', ['None']);
// Hybrid Power
addconfig('PVWatts Wind Battery Hybrid', ['Single Owner', 'Host Developer']);
addconfig('PVWatts Wind FuelCell Battery Hybrid', ['Single Owner', 'Host Developer']);
addconfig('Photovoltaic Wind Battery Hybrid', ['Single Owner', 'Host Developer']);
addconfig('CustomGeneration PVWatts Wind FuelCell Battery Hybrid', ['Single Owner', 'Host Developer']);


// order tech and fin trees
configopt("TechnologyTreeOrder", {'description' = 'Photovoltaic,Energy Storage,Hybrid,Concentrating Solar Power,Industrial Process Heat,Marine Energy,Wind,Fuel Cell - PV - Battery, Geothermal, Solar Water Heating, Biomass Combustion, Custom Generation Profile'});

// group names 'tree_parent' for performance models are defined in PopulateTech() in main.cpp
configopt( 'Flat Plate PV', { 'tree_parent'='Photovoltaic', 'long_name'='Detailed PV Model', 'short_name'='Photovoltaic', 'description'='Photovoltaic system using detailed photovoltaic model with separate module and inverter component models' } );
configopt( 'PVWatts', { 'tree_parent'='Photovoltaic','long_name'='PVWatts', 'short_name'='PVWatts', 'description'='Photovoltaic system using basic NREL PVWatts V8 algorithm. Does not do detailed degradation or loss modeling. If those are important, please use pvsamv1.' } );
configopt( 'High-X Concentrating PV', { 'tree_parent'='Photovoltaic', 'long_name'='High Concentration PV', 'short_name'='HCPV', 'description'='Concentrating photovoltaic system with a high concentration photovoltaic module model and separate inverter model' } );
configopt( 'PV Battery', { 'tree_parent'='Energy Storage', 'long_name'='Detailed PV-Battery', 'short_name'='PV-Battery', 'description'='Detailed photovoltaic model with battery storage' } );
configopt( 'PVWatts Battery', { 'tree_parent'='Energy Storage', 'long_name'='PVWatts-Battery', 'short_name'='PVWatts-Battery', 'description'='PVWatts system model with battery storage' } );
configopt( 'Custom Generation Battery', { 'tree_parent'='Energy Storage', 'long_name'='Custom Generation Profile-Battery (Generic Battery)', 'short_name'='Custom Generation-Battery', 'description'='Generic system model with battery storage' } );
configopt( 'Standalone Battery', { 'tree_parent'='Energy Storage', 'long_name'='Standalone Battery', 'short_name'='Battery', 'description'='Generic standalone battery storage' } );
configopt( 'ETES', { 'tree_parent'='Energy Storage', 'long_name'='Electric Thermal Energy Storage', 'short_name'='ETES', 'description'='Electric thermal energy storage' } );
configopt( 'PTES', { 'tree_parent'='Energy Storage', 'long_name'='Pumped Thermal Energy Storage', 'short_name'='PTES', 'description'='Pumped thermal energy storage' } );
configopt( 'Wind Power', { 'long_name'='Wind', 'short_name'='Wind', 'description'='Small or large wind power system' } );
configopt( 'Biopower', { 'long_name'='Biomass Combustion', 'short_name'='Biopower', 'description'='Biomass combustion for electricity generation' } );
configopt( 'Geothermal Power', { 'long_name'='Geothermal', 'short_name'='Geothermal', 'description'='Geothermal power model for hydrothermal and EGS systems with flash or binary conversion' } );
configopt( 'Solar Water Heating', { 'long_name'='Solar Water Heating', 'short_name'='Solar water', 'description'='Solar water heating model for residential and commercial building applications' } );
configopt( 'Fuel Cell', { 'long_name'='Fuel Cell - PV - Battery', 'short_name'='FuelCell', 'description'='Fuel cell with photovoltaic system and optional electric battery for commercial building or PPA project applications' } );
configopt( 'Custom Generation Profile', { 'long_name'='Custom Generation Profile (Generic System)', 'short_name'='CustomGeneration', 'description'='Basic power system model using either capacity, capacity factor, and heat rate, or an hourly power generation profile as input' } );
configopt( 'Generic System', { 'tree_parent'='Retired'} );
configopt( 'Generic Battery', { 'tree_parent'='Retired'} );
configopt( 'Generic PVWatts Wind FuelCell Battery Hybrid', { 'tree_parent'='Retired'} );



configopt( 'MEwave', { 'tree_parent'='Marine Energy', 'long_name'='Wave', 'short_name'='Marine Wave', 'description'='Marine energy wave system' });
configopt( 'MEwave Battery', { 'tree_parent'='Marine Energy', 'long_name'='Wave Battery', 'short_name'='Wave-Battery', 'description'='Marine energy wave system with battery' });
configopt( 'MEtidal', { 'tree_parent'='Marine Energy', 'long_name'='Tidal', 'short_name'='Marine Tidal', 'description'='Marine energy tidal system' });
configopt( 'PVWatts Wind Battery Hybrid', { 'tree_parent'='Hybrid', 'long_name'='PVWatts Wind Battery Hybrid', 'short_name' = 'PVWatts-Wind-Battery', 'description' ='Hybrid power system with PVWatts and wind power generation and battery storage)'});
configopt( 'PVWatts Wind FuelCell Battery Hybrid', { 'tree_parent'='Hybrid', 'long_name'='PVWatts Wind Fuel Cell Battery Hybrid', 'short_name' = 'PVWatts-Wind-FuelCell-Battery', 'description' ='Hybrid power system with PVWatts and wind power generation, fuel cell, and battery storage)'});
configopt( 'Photovoltaic Wind Battery Hybrid', { 'tree_parent'='Hybrid', 'long_name'='Photovoltaic Wind Battery Hybrid', 'short_name' = 'PV-Wind-Battery', 'description' ='Hybrid power system with PVWatts and wind power generation and battery storage)'});
configopt( 'CustomGeneration PVWatts Wind FuelCell Battery Hybrid', { 'tree_parent'='Hybrid', 'long_name'='Custom Generation PVWatts Wind Fuel Cell Battery Hybrid', 'short_name' = 'CustomGeneration-PVWatts-Wind-FuelCell-Battery', 'description' ='Hybrid power system with PVWatts and wind power generation and battery storage)'});
configopt( 'MSPT', { 'tree_parent'='Concentrating Solar Power', 'long_name'='Power Tower Molten Salt', 'short_name'='CSP Tower Molten Salt', 'description'='CSP molten salt power tower system using heat transfer and thermodynamic component models' } );
configopt( 'Physical Trough', { 'tree_parent'='Concentrating Solar Power', 'long_name'='Parabolic Trough Physical Model', 'short_name'='CSP Trough (Physical Model)', 'description'='CSP parabolic trough system using heat transfer and thermodynamic component models' } );
configopt( 'Empirical Trough', { 'tree_parent'='Concentrating Solar Power', 'long_name'='Parabolic Trough Empirical Model', 'short_name'='CSP Trough (Empirical Model)', 'description'='CSP parabolic trough system using model with empirically-derived coefficients and equations' } );
//configopt( 'Dish Stirling', { 'tree_parent'='Retired', 'long_name'='CSP Dish Stirling', 'short_name'='Dish Stirling', 'description'='Dish Stirling model with parameters for SES and WGA-ADDS systems' } );
configopt( 'Generic CSP System', { 'tree_parent'='Concentrating Solar Power', 'long_name'='Generic Solar Model', 'short_name'='CSP Generic Model', 'description'='CSP power system with solar field modeled using a table of optical efficiency values' } );
configopt( 'DSLF', { 'tree_parent'='Concentrating Solar Power', 'long_name'='Linear Fresnel Direct Steam', 'short_name'='CSP Linear Fresnel Direct Steam', 'description'='CSP power system that uses long small mirrors to line focus sunlight on fixed receiver tubes mounted above them.' } );
configopt( 'MSLF', { 'tree_parent'='Concentrating Solar Power', 'long_name'='Linear Fresnel Molten Salt', 'short_name'='CSP Linear Fresnel Molten Salt', 'description'='CSP power system that uses long small mirrors to line focus sunlight on fixed receiver tubes mounted above them.' } );
configopt( 'Physical Trough IPH', { 'tree_parent'='Industrial Process Heat', 'long_name'='Parabolic Trough', 'short_name'='IPH Trough', 'description'='Industrial process heat parabolic trough system using heat transfer and thermodynamic component models' } );
configopt( 'DSGL IPH', { 'tree_parent'='Industrial Process Heat', 'long_name'='Linear Direct Steam', 'short_name'='IPH Linear Fresnel Direct Steam','description'='Industrial process heat linear Fresnel collector system' } );
configopt( 'MSLF IPH', { 'tree_parent'='Industrial Process Heat', 'long_name'='Linear Molten Salt', 'short_name'='IPH Linear Fresnel Molten Salt','description'='Industrial process heat linear collector system with molten salt heat transfer fluid' } );
configopt( 'MSPT IPH', { 'tree_parent'='Industrial Process Heat', 'long_name'='Tower Molten Salt', 'short_name'='IPH Tower Molten Salt','description'='Industrial process heat power tower system with molten salt heat transfer fluid' } );

configopt( 'Retired', { 'tree_parent'='Retired', 'long_name'= 'Retired technology', 'short_name' = 'Retired', 'description'= 'Retired technologies' });

// group names 'tree_parent' for financial models are defined in UpdateFinTree() in main.cpp
configopt( 'LCOE Calculator', { 'long_name'='LCOE Calculator (FCR Method)', 'short_name'='LCOE Calculator', 'description'='Calculate LCOE using fixed charge rate method' } );
configopt( 'Residential', { 'tree_parent'='DISTRIBUTED', 'long_name'='Residential Owner', 'short_name'='Residential', 'description'='Renewable energy system displaces residential home electric load' } );
configopt( 'Commercial', { 'tree_parent'='DISTRIBUTED','long_name'='Commercial Owner', 'short_name'='Commercial', 'description'='Renewable energy system displaces commercial building electric load' } );
configopt( 'Third Party', { 'tree_parent'='DISTRIBUTED', 'long_name'='Third Party Owner - Host', 'short_name'='TPO Host', 'description'='Third party ownership from host perspective for PPA or lease agreement' } );
configopt( 'Host Developer', { 'tree_parent'='DISTRIBUTED', 'long_name'='Third Party - Host / Developer', 'short_name'='TPO Host-Developer', 'description'='Third party ownershop from host and developer perspective for PPA' } );
configopt( 'Single Owner', { 'tree_parent'='PPA', 'long_name'='Single Owner', 'short_name'='Single Owner', 'description'='Single owner PPA with constant DSCR and IRR target year, reserve accounts and depreciation allocations' } );
configopt( 'Leveraged Partnership Flip', { 'tree_parent'='PPA', 'long_name'='Partnership Flip with Debt', 'short_name'='Flip (debt)', 'description'='Developer/investor partnership flip PPA structure with debt' } );
configopt( 'All Equity Partnership Flip', { 'tree_parent'='PPA', 'long_name'='Partnership Flip without Debt', 'short_name'='Flip (no debt)', 'description'='Developer/investor partnership flip PPA structure without debt' } );
configopt( 'Sale Leaseback', { 'tree_parent'='PPA', 'long_name'='Sale Leaseback', 'short_name'='Sale Leaseback', 'description'='Sale leaseback partnership PPA structure' } );
configopt( 'Merchant Plant', { 'long_name'='Merchant Plant', 'short_name'='Merchant', 'description'='Merchant plant with constant DSCR and ancillary services revenue, reserve accounts and depreciation allocations' } );
configopt( 'Community Solar', { 'long_name'='Community Solar', 'short_name'='Community', 'description'='Community solar owner model' } );
configopt( 'None', { 'long_name'='No Financial Model', 'short_name'='No financial', 'description'='Run the performance model with no financial model' } );

enum { LOAD_SIMPLE, LOAD_BELPE, NO_LOAD };
enum { DEGRADATION_AC_SINGLE_YEAR, DEGRADATION_DC_LIFETIME, DEGRADATION_AC_LIFETIME, DEGRADATION_PVSAM };

function setup_elec_load_page( mode ) //i is 1 for technologies that HAVE the building load calculator (for now just PV, CSP, Biopower, and Generic Solar- MUST HAVE SOLAR RESOURCE DATA), 2 for techs without ANY load pages (SWH), and 0 for technologies that don't
{
	if (mode == LOAD_BELPE)
	{
		addpage( [[{'name'='Electric Load Options', 'caption' = 'No Load Data'}],
		          [{'name'='Electric Load Data', 'caption'='Input Time Series Load Data'}],
		          [{'name'='Electric Building Load Calculator', 'caption'='Calculate Load Data'}]],
			     { 'sidebar'='Electric Load', 'exclusive_var'='load_model', 'help'='electric_load' } );
	}
	elseif( mode == LOAD_SIMPLE )
	{
		addpage( [[{'name'='Electric Load Options', 'caption' = 'No Load Data'}],
		          [{'name'='Electric Load Data', 'caption'='Input Time Series Load Data'}]],
			     { 'sidebar'='Electric Load', 'exclusive_var'='load_model', 'help'='electric_load' } );
	}
	else return;
}

function setup_pages_battery_cell_and_system(is_reopt,is_btm)
{
	if ( is_reopt )
	{
		addpage([['Battery Model',
			  'Battery REopt Optimization',
			  'Battery Bank Sizing',
			  'Battery Current and Capacity',
			  'Battery Configuration',
			  {'name'='Battery Voltage', 'caption'='Battery Voltage', 'collapsible'=true, 'collapsible_var'='battery_voltage_shown'},
			  {'name'='Battery Losses', 'caption'='Battery Losses', 'collapsible'=true, 'collapsible_var'='battery_losses_shown'},
			  {'name'='Battery Thermal', 'caption'='Battery Thermal', 'collapsible'=true, 'collapsible_var'='battery_thermal_shown'},
			  'Battery Standalone Enable',
			 ]], { 'sidebar'='Battery Cell and System', 'help'='battery_storage_btm', 'bin_name'='Battery' } );
	}
	elseif( is_btm )
	{
		addpage([['Battery Model',
			  'Battery Bank Sizing',
			  'Battery Current and Capacity',
			  'Battery Configuration',
			  {'name'='Battery Voltage', 'caption'='Battery Voltage', 'collapsible'=true, 'collapsible_var'='battery_voltage_shown'},
			  {'name'='Battery Losses', 'caption'='Battery Losses', 'collapsible'=true, 'collapsible_var'='battery_losses_shown'},
			  {'name'='Battery Thermal', 'caption'='Battery Thermal', 'collapsible'=true, 'collapsible_var'='battery_thermal_shown'},
			  'Battery Standalone Enable',
			 ]], { 'sidebar'='Battery Cell and System', 'help'='battery_storage_btm', 'bin_name'='Battery'  } );
	}
	else // fom has different help id
	{
		addpage([['Battery Model',
			  'Battery Bank Sizing',
			  'Battery Current and Capacity',
			  'Battery Configuration',
			  {'name'='Battery Voltage', 'caption'='Battery Voltage', 'collapsible'=true, 'collapsible_var'='battery_voltage_shown'},
			  {'name'='Battery Losses', 'caption'='Battery Losses', 'collapsible'=true, 'collapsible_var'='battery_losses_shown'},
			  {'name'='Battery Thermal', 'caption'='Battery Thermal', 'collapsible'=true, 'collapsible_var'='battery_thermal_shown'},
			  'Battery Standalone Enable',
			 ]], { 'sidebar'='Battery Cell and System', 'help'='battery_storage_fom', 'bin_name'='Battery'  } );
	}
	
}

function setup_pages_battery_life()
{
	addpage([ [{'name'='Battery Life Cycle Calendar', 'caption'='Calendar and Cycle Degradation'}],
			  [{'name'='Battery Life Empty 1','caption'='Li-on NMC/Graphite Degradation'}],
			  [{'name'='Battery Life Empty 2','caption'='Li-ion LMO/LTO Degradation'}]],
	  		   {'sidebar'='Battery Life',
	  		    'help'='battery_life' ,
	  		    'exclusive_var' = 'batt_life_excl',
	  		    'exclusive_header_pages' = ['Battery Replacements','Battery Life Options' ], 'exclusive_tabs' = true, 'exclusive_hide' = true, 'bin_name'='Battery'  } );
}

function setup_pages_battery_dispatch_btm()
{
	addpage( [[ {'name'='Battery Dispatch Peak Shaving BTM', 'caption'='Peak Shaving'} ],
	          [ {'name'='Battery Dispatch Grid Power Targets', 'caption'='Grid Power Targets'} ],
		      [ {'name'='Battery Dispatch Battery Power Targets', 'caption'='Battery Power Targets'}],
		      [ {'name'='Battery Dispatch Manual', 'caption'='Manual'}],
		      [ {'name'='Battery Dispatch Retail Rate', 'caption'='Retail Rate'} ],
		      [ {'name'='Battery Dispatch Self Consumption', 'caption'='Self Consumption'} ]],
			    { 'sidebar'='Battery Dispatch', 'help'='battery_dispatch_btm',
			      'exclusive_var' = 'batt_dispatch_excl',
			      'exclusive_header_pages' = ['Battery Dispatch Common', 'Battery Dispatch Options BTM'], 'exclusive_tabs'=true, 'exclusive_hide'=true, 'bin_name'='Battery'  } );
}

function setup_pages_standalone_battery_dispatch_btm()
{
	addpage( [[ {'name'='Battery Dispatch Peak Shaving BTM', 'caption'='Peak Shaving'} ],
	          [ {'name'='Battery Dispatch Grid Power Targets', 'caption'='Grid Power Targets'} ],
		      [ {'name'='Battery Dispatch Battery Power Targets', 'caption'='Battery Power Targets'}],
		      [ {'name'='Battery Dispatch Manual', 'caption'='Manual'}],
		      [ {'name'='Battery Dispatch Retail Rate', 'caption'='Retail Rate'} ]],
			    { 'sidebar'='Battery Dispatch', 'help'='battery_dispatch_btm',
			      'exclusive_var' = 'batt_dispatch_excl',
			      'exclusive_header_pages' = ['Battery Dispatch Common', 'Battery Dispatch Standalone Options BTM'], 'exclusive_tabs'=true, 'exclusive_hide'=true, 'bin_name'='Battery'  } );
}

function setup_pages_pv_battery_dispatch_fom()
{
	addpage( [
		[ {'name'='Battery Dispatch Automated FOM', 'caption'='Automated'} ],
		[{'name'='Battery Dispatch PV Smoothing', 'caption'='PV Smoothing'}],
		[{'name'='Battery Dispatch Custom Time Series', 'caption'='Custom Time Series'} ],
		[{'name'='Battery Dispatch Manual', 'caption'='Manual'}],
		],
			{ 'sidebar'='Battery Dispatch', 'help'='battery_dispatch_fom', 'exclusive_var' = 'batt_dispatch_excl',
			  'exclusive_header_pages' = ['Battery Dispatch Common', 'Battery Dispatch Options FOM'], 'exclusive_tabs'=true, 'exclusive_hide'=true, 'bin_name'='Battery' } );
}

function setup_pages_standalone_battery_dispatch_fom()
{
	addpage( [
		[ {'name'='Battery Dispatch Automated FOM', 'caption'='Automated'} ],
		[{'name'='Battery Dispatch Custom Time Series', 'caption'='Custom Time Series'} ],
		[{'name'='Battery Dispatch Manual', 'caption'='Manual'}],
		],
			{ 'sidebar'='Battery Dispatch', 'help'='battery_dispatch_fom', 'exclusive_var' = 'batt_dispatch_excl',
			  'exclusive_header_pages' = ['Battery Dispatch Common', 'Battery Dispatch Standalone Options FOM'], 'exclusive_tabs'=true, 'exclusive_hide'=true, 'bin_name'='Battery'} );
}

function setup_pvwatts_battery_pages_behind_the_meter()
{
	addpage( [[ 'Solar Resource Data' ]], { 'sidebar'='Location and Resource', 'help'='pvwatts_location_and_resource' } );
	addpage( [[ 'PVWatts',
	            'Battery Model Simple with REopt',
	            {'name'='PV Land Area', 'caption' = 'Land Area', 'collapsible'=true, 'collapsible_var'='pv_land_area_is_shown'},
	            {'name'='PVWatts Advanced Inputs', 'caption' = 'Advanced Inputs', 'collapsible'=true, 'collapsible_var'='pvwatts.advanced.is_shown'} ]],
	            { 'sidebar'='System Design', 'help'='pvwatts_system_design' } );
	setup_grid_limits_page();
}

function setup_pvwatts_pages()
{
	addpage( [[ 'Solar Resource Data' ]], { 'sidebar'='Location and Resource', 'help'='pvwatts_location_and_resource' } );
	addpage( [[ 'PVWatts',
	            {'name'='PV Land Area', 'caption' = 'Land Area', 'collapsible'=true, 'collapsible_var'='pv_land_area_is_shown'},
	            {'name'='PVWatts Advanced Inputs', 'caption' = 'Advanced Inputs', 'collapsible'=true, 'collapsible_var'='pvwatts.advanced.is_shown'}]],
	            { 'sidebar'='System Design', 'help'='pvwatts_system_design' } );
	setup_grid_limits_page();
}

function setup_flat_plate_pv_pages()
{
	//addpage( [ ['AA Widgets'] ], { 'sidebar'='Widgets' } ); // use for widget testing

	addpage( [[ 'Solar Resource Data', {'name'='PV Albedo and Radiation', 'caption' = 'Albedo - Sky Diffuse Model - Irradiance Data (Advanced)', 'collapsible'=true, 'collapsible_var'='pv.radmode.is_shown'} ]], { 'sidebar'='Location and Resource', 'help'='pv_location_and_resource' } );
	addpage( [ ['Simple Efficiency Module Model'],
				['CEC Performance Model with Module Database'],
				['CEC Performance Model with User Entered Specifications'],
				['Sandia PV Array Performance Model with Module Database'],
				['IEC61853 Single Diode Model'] ],
			{ 'sidebar'='Module', 'help'='pv_module', 'exclusive_var'='module_model' } );
	addpage( [ ['Inverter CEC Database', 'Inverter Temp Derate CEC DB'],
			 ['Inverter Datasheet', 'Inverter Temp Derate DS'],
			 ['Inverter Part Load Curve', 'Inverter Temp Derate PLC'],
			 ['Inverter CEC Coefficient Generator', 'Inverter Temp Derate CEC CG'] ],
			{ 'sidebar'='Inverter', 'help'='pv_inverter', 'exclusive_var'='inverter_model' } );
	// Battery Enable form stores hidden en_batt variable required by some UI forms to determine if there is a battery
	addpage( [ ['PV System Design', 
	           {'name'='PV Land Area', 'caption' = 'Land Area', 'collapsible'=true, 'collapsible_var'='pv_land_area_is_shown'},
			   {'name'='PV Subarray Voltage Mismatch', 'collapsible'=true, 'collapsible_var' = 'mismatch_shown'},
	            'Battery Enable'] ], { 'sidebar'='System Design', 'help'='pv_system_design' } );
	addpage( [ ['PV Shading'] ], { 'sidebar'='Shading and Layout', 'help'='pv_shading' } );
	addpage( [ ['PV Losses']], { 'sidebar'='Losses', 'help'='pv_losses' } );
	setup_grid_limits_page();
}

function setup_lifetime_page( degradation_mode )
{
	// annual DC degradation over analysis period, 'dc_degradation' requires 'system_use_lifetime = 1'
	// PVWatts, PVWatts Battery, Fuel Cell
	if ( degradation_mode == DEGRADATION_DC_LIFETIME )
	{
		addpage( [ [ 'Degradation DC Lifetime' ] ], { 'sidebar'='DC Degradation','help'='degradation_dc' } );
    }
    // annual AC degradation over analysis period, 'generic_degradation' requires 'system_use_lifetime = 1'
    // Generic Battery
    elseif ( degradation_mode == DEGRADATION_AC_LIFETIME )
    {
    	addpage( [ [ 'Degradation AC Lifetime'] ], { 'sidebar'='AC Degradation','help'='degradation_ac' } );
    }
    // annual DC degradation over analysis period with daily AC / DC losses over lifetime
    // 'dc_degradation' requires 'system_use_lifetime = 1'
    // Flat Plate PV, PV Battery
	elseif ( degradation_mode == DEGRADATION_PVSAM )
	{
		addpage( [ [ 'Degradation DC Lifetime', 'Degradation AC DC Lifetime Daily', 'Degradation Lifetime Variables'], ],
                 { 'sidebar'='DC Degradation','help'='degradation_dc' } );
	}
     // annual AC degradation over one year, 'degradation' requires 'system_use_lifetime = 0'
     // everything else.
     else // DEGRADATION_AC_SINGLE_YEAR
     {
     	addpage( [ [ 'Degradation AC Single Year'] ], { 'sidebar'='AC Degradation','help'='degradation_ac' } );
     }
}

//// Financial input pages /////////////////////////////////////////////////////

function setup_residential_pages( mode ) // mode determines whether or not the building load calculator is included (see function:setup_elec_load_page)
{
  setting( { 'analysis_period_var'='cf_length' } );
  addpage( [[ 'Financial Debt Residential',
              'Financial Analysis Parameters',
              'Financial Tax and Insurance Rates',
              'Financial Salvage Value' ]],
           { 'sidebar'='Financial Parameters', 'help'='fin_residential'} );
  addpage( [[ 'Financial DSIRE Download',
              { 'name'='Financial Tax Credits','caption'='Tax Credits','collapsible'=true,'collapsible_var'='show_tax_credits', 'collapsed_by_default'=false },
              { 'name'='Financial Cash Incentives','caption'='Direct Cash Incentives','collapsible'=true,'collapsible_var'='show_cash_incentives', 'collapsed_by_default'=false } ]],
           { 'sidebar'='Incentives','help'='incentives' } );
  setup_utility_rate();
  setup_elec_load_page( mode );
}

function setup_thirdparty_pages( load ) // Third party host
{
  setting( { 'analysis_period_var'='cf_length' } );
  addpage( [[ 'Financial Third Party Ownership']],
           { 'sidebar'='Financial Parameters', 'help'='fin_tpo_host'} );
  setup_utility_rate();
  setup_elec_load_page( load ); // BELPE IS VALID FOR BOTH PVWATTS AND PV DETAILED, but not generic system
}

function setup_host_developer_pages(mode) // third party host-developer
{
  setting( { 'analysis_period_var'='cf_length' } );
  addpage( [[ 'Financial Solution Mode Single Owner',
              'Financial Analysis Host Developer Parameters',
		      'Financial Tax and Insurance Rates',
		      'Financial Salvage Value',
		      {'name'='Financial Debt DSCR or Debt Fraction','caption'='Project Term Debt','collapsible'=true,'collapsible_var'='show_DebtConstDSCR'},
              {'name'='Financial Cost of Financing Single Owner', 'caption'='Cost of Acquiring Financing','collapsible'=true,'collapsible_var'='show_CapitalCostSO'},
              {'name'='Financial Construction Financing','caption'='Construction Financing','collapsible'=true,'collapsible_var'='show_construction_period', 'collapsed_by_default'=false},
              {'name'='Financial Reserve Accounts', 'caption'='Reserve Accounts','collapsible'=true,'collapsible_var'='show_ReserveAccounts'},   ]],
           { 'sidebar'='Financial Parameters', 'help'='fin_tpo_host_developer' }  );
  addpage( [[ 'Financial TOD Factors' ]], { 'sidebar'='Time of Delivery Factors', 'help'='tod_factors' });

  addpage( [[ 'Financial Tax Credits','Financial Cash Incentives']],
           { 'sidebar'='Incentives', 'help'='incentives' } );
  addpage( [['Financial Depreciation Detailed' ]],
           { 'sidebar'='Depreciation', 'help'='depreciation' });
  setup_utility_rate();
  setup_elec_load_page( mode );
}

function setup_lcoefcr_pages() // LCOE calculator will not work with tower models because cost inputs required for solar pilot
{
  addpage( [[ 'Financial LCOE Calculator']],
           { 'sidebar'='Financial Parameters', 'help'='fin_lcoefcr'} );
}

function setup_iph_lcoefcr_pages() // LCOE calculator will not work with tower models because cost inputs required for solar pilot
{
  addpage( [[ 'Financial LCOE Calc IPH Add',
				'Financial LCOE Calculator']],
           { 'sidebar'='Financial Parameters', 'help'='fin_lcoh'} );
}

function setup_iph_lcoefcr_cost_pages() // LCOE calculator will not work with tower models because cost inputs required for solar pilot
{
  addpage( [[ 'Financial LCOE Calc IPH Add',
				'Financial LCOE Calc with Costs']],
           { 'sidebar'='Financial Parameters', 'help'='fin_lcoh'} );
}

function setup_commercial_pages( mode ) // mode determines whether or not the building load calculator is included (see function:setup_elec_load_page)
{
  setting( { 'analysis_period_var'='cf_length' } );
  addpage( [[ 'Financial Debt Min DSCR',
              'Financial Analysis Parameters',
		      'Financial Tax and Insurance Rates',
		      'Financial Salvage Value',
              'Financial Depreciation Simple', ]],
           { 'sidebar'='Financial Parameters','help'='fin_commercial'} );
  addpage( [[ 'Financial DSIRE Download',
              { 'name'='Financial Tax Credits','caption'='Tax Credits','collapsible'=true,'collapsible_var'='show_tax_credits', 'collapsed_by_default'=false },
              { 'name'='Financial Cash Incentives','caption'='Direct Cash Incentives','collapsible'=true,'collapsible_var'='show_cash_incentives', 'collapsed_by_default'=false } ]],
		   { 'sidebar'='Incentives', 'help'='incentives' } );
 setup_utility_rate();
  setup_elec_load_page( mode );
}

function setup_grid_limits_page()
{
	addpage( [[ 'Grid Interconnection', 'Grid Curtailment']],
           { 'sidebar'='Grid Limits', 'help'='grid_limits' } );
}

function setup_grid_outage_page()
{
	/*addpage( [[ 'Grid Interconnection', 'Grid Curtailment', 'Grid Outage']],
           { 'sidebar'='Grid Limits', 'help'='grid_limits' } );*/
	addpage( [[ 'Grid Outage', ]], { 'sidebar'='Grid Outage', 'help'='grid_outage' } );           
}

// note 'collapsed by default' does not seem to do anything. To set default behavior, set default value of collapsible_var. For example, to collapse description by default, use Defaults Manager to set ur_desc_is_shown = 0.
function setup_utility_rate()
{
	addpage( [[ 'Utility Rate - Flat',
			    { 'name'='Utility Rate - Description', 'caption'='Description and Applicability', 'collapsible'=true, 'collapsible_var'='ur_desc_is_shown', 'collapsed_by_default'=true },
			    { 'name'='Utility Rate - Energy Charge', 'caption'='Energy Charges', 'collapsible'=true, 'collapsible_var'='ur_ec_is_shown', 'collapsed_by_default'=false },
				{ 'name'='Utility Rate - Billing Demand', 'caption'='Billing Demand', 'collapsible'=true, 'collapsible_var'='ur_billing_demand_is_shown', 'collapsed_by_default'=true },
			    { 'name'='Utility Rate - Demand Charge', 'caption'='Demand Charges', 'collapsible'=true, 'collapsible_var'='ur_dc_is_shown', 'collapsed_by_default'=false },
			    { 'name'='Utility Rate - Unused', 'caption'='Unused Items', 'collapsible'=true, 'collapsible_var'='ur_unused_is_shown', 'collapsed_by_default'=true },]],
		     { 'sidebar'='Electricity Rates', 'help'='electricity_rates' } );
}

// 'en_electricity_rates' is only an input available for FOM configurations
function setup_electricity_purchases()
{
	
	addpage( [[{'name'='Utility Rate - Empty','caption'='Use PPA Price'}],
			  [{'name'='Utility Rate - Flat', 'caption'='Use Retail Rates'},
			    { 'name'='Utility Rate - Description', 'caption'='Description and Applicability', 'collapsible'=true, 'collapsible_var'='ur_desc_is_shown', 'collapsed_by_default'=true },
			    { 'name'='Utility Rate - Energy Charge', 'caption'='Energy Charges', 'collapsible'=true, 'collapsible_var'='ur_ec_is_shown', 'collapsed_by_default'=false },
			    { 'name'='Utility Rate - Billing Demand', 'caption'='Billing Demand Calculation', 'collapsible'=true, 'collapsible_var'='ur_billing_demand_is_shown', 'collapsed_by_default'=true },
			    { 'name'='Utility Rate - Demand Charge', 'caption'='Demand Charges', 'collapsible'=true, 'collapsible_var'='ur_dc_is_shown', 'collapsed_by_default'=false},
			    { 'name'='Utility Rate - Unused', 'caption'='Unused Items', 'collapsible'=true, 'collapsible_var'='ur_unused_is_shown', 'collapsed_by_default'=true },]],
		     { 'sidebar'='Electricity Purchases', 'help'='electricity_purchases', 'exclusive_header_pages'=['Utility Rate - Enable'], 'exclusive_var'='en_electricity_rates', 'exclusive_hide'=true } );

}

function setup_single_owner_pages()
{
  setting( { 'analysis_period_var'='cf_length' } );
  addpage( [[ 'Financial Analysis Parameters',
		      'Financial Tax and Insurance Rates',
		      'Financial Salvage Value',
		      {'name'='Financial Debt DSCR or Debt Fraction','caption'='Project Term Debt','collapsible'=true,'collapsible_var'='show_DebtConstDSCR'},
              {'name'='Financial Cost of Financing Single Owner', 'caption'='Cost of Acquiring Financing','collapsible'=true,'collapsible_var'='show_CapitalCostSO'},
              {'name'='Financial Construction Financing','caption'='Construction Financing','collapsible'=true,'collapsible_var'='show_construction_period', 'collapsed_by_default'=false},
              {'name'='Financial Reserve Accounts', 'caption'='Reserve Accounts','collapsible'=true,'collapsible_var'='show_ReserveAccounts'}]],
           { 'sidebar'='Financial Parameters', 'help'='fin_single_owner' }  );
  addpage( [[ 'Financial Solution Mode Single Owner',
  			    { 'name'='Financial TOD Factors', 'caption'='Time of Delivery', 'collapsible'=true, 'collapsible_var'='revenue_TOD_is_shown', 'collapsed_by_default'=true },
			    { 'name'='Financial Capacity Payments', 'caption'='Capacity Payments', 'collapsible'=true, 'collapsible_var'='revenue_capacity_payments_is_shown', 'collapsed_by_default'=true },
			    { 'name'='Financial Curtailment Price', 'caption'='Curtailment Payments', 'collapsible'=true, 'collapsible_var'='revenue_curtailment_is_shown', 'collapsed_by_default'=true } ]],
            { 'sidebar'='Revenue', 'help'='revenue_ppa' } );
  addpage( [[ 'Financial Tax Credits','Financial Cash Incentives']],
           { 'sidebar'='Incentives', 'help'='incentives' } );
  addpage( [['Financial Depreciation Detailed' ]],
           { 'sidebar'='Depreciation', 'help'='depreciation' });
}


function setup_community_solar_pages()
{
  setting( { 'analysis_period_var'='cf_length' } );
  addpage( [[ 'Financial CS Subscribers',
              'Financial CS Credit Rate',
              'Financial CS Revenue',
              'Financial CS Costs' ]], {'sidebar' = 'Community Solar', 'help' = 'fin_community_solar'} );
  addpage( [[ 'Financial Analysis Parameters',
		      'Financial Tax and Insurance Rates',
		      'Financial Salvage Value',
		      {'name'='Financial Debt DSCR or Debt Fraction','caption'='Project Term Debt','collapsible'=true,'collapsible_var'='show_DebtConstDSCR'},
              {'name'='Financial Cost of Financing Single Owner', 'caption'='Cost of Acquiring Financing','collapsible'=true,'collapsible_var'='show_CapitalCostSO'},
              {'name'='Financial Construction Financing','caption'='Construction Financing','collapsible'=true,'collapsible_var'='show_construction_period', 'collapsed_by_default'=false},
              {'name'='Financial Reserve Accounts', 'caption'='Reserve Accounts','collapsible'=true,'collapsible_var'='show_ReserveAccounts'} ]],
           { 'sidebar'='Financial Parameters', 'help'='fin_single_owner' }  );
  addpage( [[ 'Financial Tax Credits','Financial Cash Incentives']],
           { 'sidebar'='Incentives', 'help'='incentives' } );
  addpage( [['Financial Depreciation Detailed' ]],
           { 'sidebar'='Depreciation', 'help'='depreciation' });
}

function setup_single_owner_dispatch_pages()
{
  setting( { 'analysis_period_var'='cf_length' } );
  addpage( [[ 'Financial Analysis Parameters',
		      'Financial Tax and Insurance Rates',
		      'Financial Salvage Value',
		      {'name'='Financial Debt DSCR or Debt Fraction','caption'='Project Term Debt','collapsible'=true,'collapsible_var'='show_DebtConstDSCR'},
              {'name'='Financial Cost of Financing Single Owner', 'caption'='Cost of Acquiring Financing','collapsible'=true,'collapsible_var'='show_CapitalCostSO'},
              {'name'='Financial Construction Financing','caption'='Construction Financing','collapsible'=true,'collapsible_var'='show_construction_period', 'collapsed_by_default'=false},
              {'name'='Financial Reserve Accounts', 'caption'='Reserve Accounts','collapsible'=true,'collapsible_var'='show_ReserveAccounts'} ]],
           { 'sidebar'='Financial Parameters', 'help'='fin_single_owner' }  );
 /*addpage( [[ 'Financial Solution Mode Single Owner',
  			    { 'name'='Financial TOD Factors', 'caption'='Time of Delivery', 'collapsible'=true, 'collapsible_var'='revenue_TOD_is_shown', 'collapsed_by_default'=true },
			    { 'name'='Financial Capacity Payments', 'caption'='Capacity Payments', 'collapsible'=true, 'collapsible_var'='revenue_capacity_payments_is_shown', 'collapsed_by_default'=true },
			    { 'name'='Financial Curtailment Price', 'caption'='Curtailment Payments', 'collapsible'=true, 'collapsible_var'='revenue_curtailment_is_shown', 'collapsed_by_default'=true } ]],
            { 'sidebar'='Revenue', 'help'='revenue_ppa' } ); */

  addpage( [[ 'Financial Solution Mode Single Owner ETES',
  			    { 'name'='Financial TOD Factors', 'caption'='Time of Delivery', 'collapsible'=true, 'collapsible_var'='revenue_TOD_is_shown', 'collapsed_by_default'=true },
			    { 'name'='Financial Capacity Payments', 'caption'='Capacity Payments', 'collapsible'=true, 'collapsible_var'='revenue_capacity_payments_is_shown', 'collapsed_by_default'=true } ]],
            { 'sidebar'='Revenue', 'help'='revenue_ppa' } );
  addpage( [[ 'Financial Tax Credits','Financial Cash Incentives']],
           { 'sidebar'='Incentives', 'help'='incentives' } );
  addpage( [['Financial Depreciation Detailed' ]],
           { 'sidebar'='Depreciation', 'help'='depreciation' });
}


function setup_merchant_plant_pages()
{
  setting( { 'analysis_period_var'='cf_length' } );
  addpage( [[ 'Financial Analysis Parameters',
		      'Financial Tax and Insurance Rates',
		      'Financial Salvage Value',
		      {'name'='Financial Debt DSCR or Debt Fraction','caption'='Project Term Debt','collapsible'=true,'collapsible_var'='show_DebtConstDSCR'},
              {'name'='Financial Cost of Financing Single Owner', 'caption'='Cost of Acquiring Financing','collapsible'=true,'collapsible_var'='show_CapitalCostSO'},
              {'name'='Financial Construction Financing','caption'='Construction Financing','collapsible'=true,'collapsible_var'='show_construction_period', 'collapsed_by_default'=false},
              {'name'='Financial Reserve Accounts', 'caption'='Reserve Accounts','collapsible'=true,'collapsible_var'='show_ReserveAccounts'} ]],
           { 'sidebar'='Financial Parameters', 'help'='fin_merchant_plant' }  );

  addpage( [[{'name'='Financial Merchant Plant Energy Market Revenue', 'caption'='Energy Market'}],
			[{'name'='Financial Merchant Plant Ancillary Service 1', 'caption'='Ancillary Service 1' }],
			[{'name'='Financial Merchant Plant Ancillary Service 2', 'caption'='Ancillary Service 2' }],
			[{'name'='Financial Merchant Plant Ancillary Service 3', 'caption'='Ancillary Service 3' }],
			[{'name'='Financial Merchant Plant Ancillary Service 4', 'caption'='Ancillary Service 4' }]],
			{ 'sidebar'='Revenue', 'help'='revenue_merchant_plant', 'exclusive_var'='revenue_tab',
			  'exclusive_header_pages' = ['Financial Merchant Plant Description','Financial Capacity Payments','Cambium API Data'],  'exclusive_tabs'=true, 'exclusive_hide' = false} );

  addpage( [[ 'Financial Tax Credits','Financial Cash Incentives']],
           { 'sidebar'='Incentives', 'help'='incentives' } );
  addpage( [['Financial Depreciation Detailed' ]],
           { 'sidebar'='Depreciation', 'help'='depreciation' });
}

function setup_leveraged_partnership_flip_pages()
{
  setting( { 'analysis_period_var'='cf_length' } );
  addpage( [[ 'Financial Solution Mode Flip Leaseback',
              'Financial Equity Flip Structure',
			  'Financial Analysis Parameters',
			  'Financial Tax and Insurance Rates',
			  'Financial Salvage Value',
		      {'name'='Financial Debt DSCR or Debt Fraction','caption'='Project Term Debt','collapsible'=true,'collapsible_var'='show_DebtConstDSCR'},
              {'name'='Financial Cost of Financing Flip Leaseback', 'caption'='Cost of Acquiring Financing','collapsible'=true,'collapsible_var'='show_CapitalCostSO'},
              {'name'='Financial Construction Financing','caption'='Construction Financing','collapsible'=true,'collapsible_var'='show_construction_period'},
              {'name'='Financial Reserve Accounts', 'caption'='Reserve Accounts','collapsible'=true,'collapsible_var'='show_ReserveAccounts'} ]],
           { 'sidebar'='Financial Parameters', 'help'='fin_leveraged_partnership' }  );
  addpage( [[ 'Financial TOD Factors' ]], { 'sidebar'='Time of Delivery Factors', 'help'='tod_factors' });
/*    addpage( [[ {'name'='Financial TOD Factors', 'caption'='TOD Factors by Schedule'}],
			[ {'name'='Financial TOD Factors Timestep', 'caption'='TOD Factors by Time Step' }],],
           {  'sidebar'='Time of Delivery Factors','help'='tod_factors', 'exclusive_var'='ppa_multiplier_model' } );*/
  addpage( [[ 'Financial Tax Credits',
              'Financial Cash Incentives']],
           { 'sidebar'='Incentives', 'help'='incentives' } );
  addpage( [['Financial Depreciation Detailed' ]],
           { 'sidebar'='Depreciation', 'help'='depreciation' });
}

function setup_all_equity_partnership_flip_pages()
{
  setting( { 'analysis_period_var'='cf_length' } );
  addpage( [[ 'Financial Solution Mode Flip Leaseback',
              'Financial Equity Flip Structure',
              'Financial Flip Developer Capital Recovery',
			  'Financial Analysis Parameters',
			  'Financial Tax and Insurance Rates',
			  'Financial Salvage Value',
              {'name'='Financial Cost of Financing Flip Leaseback', 'caption'='Cost of Acquiring Financing','collapsible'=true,'collapsible_var'='show_CapitalCostSO'},
              {'name'='Financial Construction Financing','caption'='Construction Financing','collapsible'=true,'collapsible_var'='show_construction_period'},
              {'name'='Financial Reserve Accounts', 'caption'='Reserve Accounts','collapsible'=true,'collapsible_var'='show_ReserveAccounts'} ]],
           { 'sidebar'='Financial Parameters', 'help'='fin_all_equity_partnership' }  );
  addpage( [[ 'Financial TOD Factors' ]], { 'sidebar'='Time of Delivery Factors', 'help'='tod_factors' });
/*    addpage( [[ {'name'='Financial TOD Factors', 'caption'='TOD Factors by Schedule'}],
			[ {'name'='Financial TOD Factors Timestep', 'caption'='TOD Factors by Time Step' }],],
           {  'sidebar'='Time of Delivery Factors','help'='tod_factors', 'exclusive_var'='ppa_multiplier_model' } );*/
  addpage( [[ 'Financial Tax Credits',
              'Financial Cash Incentives']],
           { 'sidebar'='Incentives', 'help'='incentives' } );
  addpage( [['Financial Depreciation Detailed' ]],
           { 'sidebar'='Depreciation', 'help'='depreciation' });
}

function setup_sale_leaseback_pages()
{
  setting( { 'analysis_period_var'='cf_length' } );
  addpage( [[ 'Financial Solution Mode Flip Leaseback',
              'Financial Sale Leaseback',
			  'Financial Analysis Parameters',
			  'Financial Tax and Insurance Rates',
			  'Financial Salvage Value',
              {'name'='Financial Cost of Financing Flip Leaseback', 'caption'='Cost of Acquiring Financing','collapsible'=true,'collapsible_var'='show_CapitalCostSO'},
              {'name'='Financial Construction Financing','caption'='Construction Financing','collapsible'=true,'collapsible_var'='show_construction_period'},
              {'name'='Financial Reserve Accounts', 'caption'='Reserve Accounts','collapsible'=true,'collapsible_var'='show_ReserveAccounts'} ]],
          { 'sidebar'='Financial Parameters', 'help'='fin_sale_leaseback' }  );
  addpage( [[ 'Financial TOD Factors' ]], { 'sidebar'='Time of Delivery Factors', 'help'='tod_factors' });
/*    addpage( [[ {'name'='Financial TOD Factors', 'caption'='TOD Factors by Schedule'}],
			[ {'name'='Financial TOD Factors Timestep', 'caption'='TOD Factors by Time Step' }],],
           {  'sidebar'='Time of Delivery Factors','help'='tod_factors', 'exclusive_var'='ppa_multiplier_model' } );*/
  addpage( [[ 'Financial Tax Credits',
              'Financial Cash Incentives']],
           { 'sidebar'='Incentives', 'help'='incentives' } );
  addpage ( [['Financial Depreciation Detailed' ]],
            { 'sidebar'='Depreciation', 'help'='depreciation' });
}

function setup_windpower_pages()
{
	addpage( [[ 'Wind Resource File'],
	          [ 'Wind Speed Weibull Distribution'],
	          [ 'Wind Resource Probability Table']],
	         { 'sidebar'='Wind Resource', 'exclusive_var'='wind_resource_model_choice', 'help'='wind_resource' } );
	//addpage( [[ 'Wind Siting Considerations' ]], { 'sidebar'='Siting Considerations' } );
	addpage( [[ 'Wind Turbine Design' ]], { 'sidebar'='Wind Turbine', 'help'='wind_turbine' } );
	addpage( [[ 'Wind Farm Specifications' ]], { 'sidebar'='Wind Farm', 'help'='wind_farm' } );
	addpage( [[ 'Wind Losses' ]], { 'sidebar'='Losses', 'help'='wind_losses'} );
	addpage( [ [{ 'name'='Wind Uncertainty None','caption'='No Uncertainty Model'}],
	           [{ 'name'='Wind Uncertainty','caption'='Enable Uncertainty Model' }] ],
	         { 'sidebar'='Uncertainties','help'='wind_uncertainties', 'exclusive_var' = 'en_wind_uncertainty'} );
	setup_grid_limits_page();
}

function setup_solar_water_heating_pages()
{
	addpage( [[ 'Solar Resource Data' ]], { 'sidebar'='Location and Resource' , 'help'='shw_location_and_resource' });
	addpage( [[ 'Solar Water Heating' ]], { 'sidebar'='Solar Water Heating', 'help'='shw_system' } );
}

function setup_etes_pages()
{
	addpage( [['Solar Resource Data']], { 'sidebar'='Location and Resource', 'help'='etes_location_and_resource' } );
	addpage( [['ETES System Design']], { 'sidebar'='System Design', 'help'='etes_system_design'} );
	addpage( [['ETES Heater']], {'sidebar'='Heater', 'help'='etes_heater' } );
	addpage( [[ 'Rankine Cycle Air or Evaporative Cooling' ], [ 'User-Defined Power Cycle' ]],
			{ 'sidebar'='Power Cycle', 'help'='etes_power_cycle', 'exclusive_var' = 'pc_config',
			  'exclusive_header_pages' = ['ETES Power Block Common']} );
	addpage( [[ 'TES Direct Two Tank' ]], { 'sidebar'='Thermal Storage', 'help'='etes_thermal_storage' } );
	addpage( [[ 'ETES System Control' ]], { 'sidebar'='System Control', 'help'='etes_system_control'});
}

function setup_ptes_pages()
{
	addpage( [['Solar Resource Data']], { 'sidebar'='Location and Resource', 'help'='ptes_location_and_resource' } );
	addpage( [['PTES System Design']], { 'sidebar'='System Design', 'help' = 'ptes_system_design' } );
	addpage( [['PTES Energy Stores']], { 'sidebar'='Thermal Energy Storage', 'help' = 'ptes_energy_storage' } );
	addpage( [['PTES Heat Pump']], { 'sidebar'='Heat Pump', 'help' = 'ptes_heat_pump'} );
	addpage( [['PTES Power Cycle']], { 'sidebar'='Power Cycle', 'help' = 'ptes_power_cycle' });
	addpage( [['ETES System Control']], { 'sidebar'='System Control', 'help' = 'ptes_system_control' });
}

function setup_csp_physical_trough_pages()
{
	addpage( [[ 'Solar Resource Data' ]], { 'sidebar'='Location and Resource', 'help'='troughphysical_location_and_resource' } );
	addpage( [[ 'Physical Trough System Design' ]], { 'sidebar'='System Design', 'help'='troughphysical_system_design' } );
	addpage( [[ 'Physical Trough Solar Field' ]], { 'sidebar'='Solar Field', 'help'='troughphysical_solar_field' } );
	addpage( [[ 'Physical Trough Collector Header',
	 {'name'='Physical Trough Collector Type 1', 'caption'='Collector Type 1', 'collapsible'=false, 'collapsible_var'='sca_1_is_shown'},
	 {'name'='Physical Trough Collector Type 2', 'caption'='Collector Type 2', 'collapsible'=true, 'collapsible_var'='sca_2_is_shown'},
	 {'name'='Physical Trough Collector Type 3', 'caption'='Collector Type 3', 'collapsible'=true, 'collapsible_var'='sca_3_is_shown'},
	 {'name'='Physical Trough Collector Type 4', 'caption'='Collector Type 4', 'collapsible'=true, 'collapsible_var'='sca_4_is_shown'} ]],
	 { 'sidebar'='Collectors (SCAs)', 'help'='troughphysical_collectors_scas' } );
	addpage( [[ 'Physical Trough Receiver Header',
	 {'name'='Physical Trough Receiver Type 1', 'caption'='Receiver Type 1', 'collapsible'=false, 'collapsible_var'='hce_1_is_shown'},
	 {'name'='Physical Trough Receiver Type 2', 'caption'='Receiver Type 2', 'collapsible'=true, 'collapsible_var'='hce_2_is_shown'},
	 {'name'='Physical Trough Receiver Type 3', 'caption'='Receiver Type 3', 'collapsible'=true, 'collapsible_var'='hce_3_is_shown'},
	 {'name'='Physical Trough Receiver Type 4', 'caption'='Receiver Type 4', 'collapsible'=true, 'collapsible_var'='hce_4_is_shown'} ]],
	 { 'sidebar'='Receivers (HCEs)', 'help'='troughphysical_receivers_hces' } );
	addpage( [[ 'Rankine Cycle' ], [ 'User Defined Power Cycle' ]],
			{ 'sidebar'='Power Cycle', 'help'='troughphysical_power_cycle', 'exclusive_var' = 'pc_config',
			  'exclusive_header_pages' = ['Physical Trough Power Cycle Common']} );

	//addpage( [[ 'Physical Trough Power Block Common' ,
	  //{'name' = 'Physical Trough Rankine Cycle', 'caption' = 'Rankine Cycle', 'collapsible'=false, 'collapsible_var'='csp_dispatch_is_shown'} ]],
	  //{ 'sidebar'='Power Cycle', 'help'='troughphysical_power_cycle' } );
	//addpage( [[ 'Physical Trough Power Block' ]], { 'sidebar'='Power Cycle', 'help'='troughphysical_power_cycle' } );
	addpage( [[ 'Physical Trough Thermal Storage' ]], { 'sidebar'='Thermal Storage', 'help'='troughphysical_thermal_storage' } );
	addpage( [[ 'Physical Trough System Control' ,
	  {'name' = 'Physical Trough Dispatch Control', 'caption'='Dispatch Control', 'collapsible'=false, 'collapsible_var'='csp_dispatch_is_shown'} ]],
	  { 'sidebar'='System Control', 'help'='troughphysical_system_control' } );
	setup_grid_limits_page();
}

function setup_cst_physical_trough_pages()
{
	addpage( [[ 'Solar Resource Data' ]], { 'sidebar'='Location and Resource', 'help'='iph_mslf_location_and_resource' } );
	addpage( [[ 'Physical Trough IPH System Design' ]], { 'sidebar'='System Design', 'help'='iph_mslf_system_design' } );
	addpage( [[ 'Physical Trough Solar Field' ]], { 'sidebar'='Solar Field', 'help'='iph_mslf_solar_field' } );

	addpage( [[ 'Physical Trough Collector Header',
	 {'name'='Physical Trough Collector Type 1', 'caption'='Collector Type 1', 'collapsible'=false, 'collapsible_var'='sca_1_is_shown'},
	 {'name'='Physical Trough Collector Type 2', 'caption'='Collector Type 2', 'collapsible'=true, 'collapsible_var'='sca_2_is_shown'},
	 {'name'='Physical Trough Collector Type 3', 'caption'='Collector Type 3', 'collapsible'=true, 'collapsible_var'='sca_3_is_shown'},
	 {'name'='Physical Trough Collector Type 4', 'caption'='Collector Type 4', 'collapsible'=true, 'collapsible_var'='sca_4_is_shown'} ]],
	 { 'sidebar'='Collectors (SCAs)', 'help'='troughphysical_collectors_scas' } );
	addpage( [[ 'Physical Trough Receiver Header',
	 {'name'='Physical Trough Receiver Type 1', 'caption'='Receiver Type 1', 'collapsible'=false, 'collapsible_var'='hce_1_is_shown'},
	 {'name'='Physical Trough Receiver Type 2', 'caption'='Receiver Type 2', 'collapsible'=true, 'collapsible_var'='hce_2_is_shown'},
	 {'name'='Physical Trough Receiver Type 3', 'caption'='Receiver Type 3', 'collapsible'=true, 'collapsible_var'='hce_3_is_shown'},
	 {'name'='Physical Trough Receiver Type 4', 'caption'='Receiver Type 4', 'collapsible'=true, 'collapsible_var'='hce_4_is_shown'} ]],
	 { 'sidebar'='Receivers (HCEs)', 'help'='troughphysical_receivers_hces' } );

	addpage( [[ 'Physical Trough Thermal Storage' ]], { 'sidebar'='Thermal Storage', 'help'='troughphysical_thermal_storage' } );

	addpage( [[ 'Physical Trough IPH System Control' ,
		{'name' = 'Physical Trough IPH Dispatch Control', 'caption'='Dispatch Control', 'collapsible'=false, 'collapsible_var'='csp_dispatch_is_shown'} ]],
		{ 'sidebar'='System Control', 'help'='iph_mslf_system_control' } );
}

function setup_csp_empirical_trough_pages()
{
	addpage( [[ 'Solar Resource Data' ]], { 'sidebar'='Location and Resource', 'help'='troughempirical_location_and_resource' } );
	addpage( [[ 'Empirical Trough Solar Field' ]], { 'sidebar'='Solar Field', 'help'='troughempirical_solar_field' } );
	addpage( [[ 'Empirical Trough SCA' ]], { 'sidebar'='Collectors (SCAs)', 'help'='troughempirical_collectors_scas' } );
	addpage( [[ 'Empirical Trough HCE' ]], { 'sidebar'='Receivers (HCEs)', 'help'='troughempirical_receivers_hces' } );
	addpage( [[ 'Empirical Trough Power Block' ]], { 'sidebar'='Power Block', 'help'='troughempirical_power_block' } );
	addpage( [[ 'Empirical Trough Thermal Storage',
	  {'name' = 'CSP Dispatch Control', 'caption'='Dispatch Control', 'collapsible'=false, 'collapsible_var'='csp_dispatch_is_shown'} ]],
	  { 'sidebar'='Thermal Storage', 'help'='troughempirical_thermal_storage' } );
	addpage( [[ 'Empirical Trough Parasitics' ]], { 'sidebar'='Parasitics', 'help'='troughempirical_parasitics' } );
	setup_grid_limits_page();
}

function setup_geothermal_power_pages()
{
	addpage( [[ 'Solar Resource Data' ]], { 'sidebar'='Ambient Conditions', 'help'='geo_ambient_conditions' } );
	addpage( [[ 'Geothermal Resource',
	{'name'='Geothermal Reservoir Input', 'caption'='Geothermal Reservoir Model Input Table', 'collapsible'=true, 'collapsible_var'='reservoir_model_inputs_shown'} ]], 
	{ 'sidebar'='Geothermal Resource', 'help'='geo_geothermal_resource' } );
	addpage( [[ 'Geothermal Plant and Equipment' ]], { 'sidebar'='Plant and Equipment', 'help'='geo_plant_equipment' } );
	addpage( [[ 'Geothermal Power Block' ]], { 'sidebar'='Power Block', 'help'='geo_power_block' } );
    setup_grid_limits_page();
}

function setup_generic_systems()
{
	addpage([['Empty']], {'bin_name': 'Retired'} );
}

////////////////////////////////////////////////////////////////////////////////
// now set up all the pages ////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////

//Generic Configs retired
//['Residential', 'Commercial', 'Third Party', 'Host Developer', 'Single Owner', 'Merchant Plant', 'Leveraged Partnership Flip', 'All Equity Partnership Flip', 'Sale Leaseback']
/*
setconfig('Generic Battery', 'Single Owner');
setup_generic_systems();
setconfig('Generic Battery', 'Host Developer');
setup_generic_systems();
setconfig('Generic Battery', 'Merchant Plant');
setup_generic_systems();
setconfig('Generic Battery', 'Leveraged Partnership Flip');
setup_generic_systems();
setconfig('Generic Battery', 'All Equity Partnership Flip');
setup_generic_systems();
setconfig('Generic Battery', 'Sale Leaseback');
setup_generic_systems();
setconfig('Generic Battery', 'Residential');
setup_generic_systems();
setconfig('Generic Battery', 'Commercial');
setup_generic_systems();
setconfig('Generic Battery', 'Third Party');
setup_generic_systems();
setconfig('Generic Battery', 'Host Developer');
setup_generic_systems();
setconfig('Generic System', 'Single Owner');
setup_generic_systems();
setconfig('Generic System', 'Host Developer');
setup_generic_systems();
setconfig('Generic System', 'Merchant Plant');
setup_generic_systems();
setconfig('Generic System', 'Leveraged Partnership Flip');
setup_generic_systems();
setconfig('Generic System', 'All Equity Partnership Flip');
setup_generic_systems();
setconfig('Generic System', 'Sale Leaseback');
setup_generic_systems();
setconfig('Generic System', 'Residential');
setup_generic_systems();
setconfig('Generic System', 'Commercial');
setup_generic_systems();
setconfig('Generic System', 'Third Party');
setup_generic_systems();
setconfig('Generic System', 'Host Developer');
setup_generic_systems();
setconfig('CustomGeneration PVWatts Wind FuelCell Battery Hybrid', 'Single Owner');
setup_generic_systems();
setconfig('CustomGeneration PVWatts Wind FuelCell Battery Hybrid', 'Host Developer');
setup_generic_systems();
*/


// CSP - Empirical Trough ///////////////////////////////////////////////////////
setconfig( 'Empirical Trough', 'LCOE Calculator' );
setmodules( ['tcstrough_empirical', 'lcoefcr']);
setup_csp_empirical_trough_pages();
setup_lcoefcr_pages();

setconfig( 'Empirical Trough', 'None' );
setmodules( ['tcstrough_empirical']);
setup_csp_empirical_trough_pages();

setconfig( 'Empirical Trough', 'Commercial' );
setmodules( ['tcstrough_empirical', 'utilityrate5', 'cashloan']);
setup_csp_empirical_trough_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Empirical Trough Capital Costs' ]], { 'sidebar'='Installation Costs', 'help'='cc_trough' } );
addpage( [[ 'Operating Costs Fuel', 'Operating Costs Land Lease' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_commercial_pages(LOAD_SIMPLE); //belpe not valid for commercial

setconfig( 'Empirical Trough', 'Single Owner' );
setmodules( ['tcstrough_empirical', 'utilityrate5','singleowner']);
setup_csp_empirical_trough_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Empirical Trough Capital Costs' ]], { 'sidebar'='Installation Costs', 'help'='cc_trough' } );
addpage( [[ 'Operating Costs Fuel', 'Operating Costs Land Lease' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_single_owner_pages();
setup_electricity_purchases();

setconfig( 'Empirical Trough', 'Merchant Plant' );
setmodules( ['tcstrough_empirical', 'utilityrate5', 'merchantplant']);
setup_csp_empirical_trough_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Empirical Trough Capital Costs' ]], { 'sidebar'='Installation Costs', 'help'='cc_trough' } );
addpage( [[ 'Operating Costs Fuel', 'Operating Costs Land Lease' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_merchant_plant_pages();
setup_electricity_purchases();

setconfig( 'Empirical Trough', 'Leveraged Partnership Flip' );
setmodules( ['tcstrough_empirical', 'utilityrate5', 'levpartflip']);
setup_csp_empirical_trough_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Empirical Trough Capital Costs' ]], { 'sidebar'='Installation Costs', 'help'='cc_trough' } );
addpage( [[ 'Operating Costs Fuel', 'Operating Costs Land Lease' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_leveraged_partnership_flip_pages();
setup_electricity_purchases();

setconfig( 'Empirical Trough', 'Sale Leaseback' );
setmodules( ['tcstrough_empirical', 'utilityrate5', 'saleleaseback']);
setup_csp_empirical_trough_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Empirical Trough Capital Costs' ]], { 'sidebar'='Installation Costs', 'help'='cc_trough' } );
addpage( [[ 'Operating Costs Fuel', 'Operating Costs Land Lease' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_sale_leaseback_pages();
setup_electricity_purchases();

setconfig( 'Empirical Trough', 'All Equity Partnership Flip' );
setmodules( ['tcstrough_empirical', 'utilityrate5', 'equpartflip']);
setup_csp_empirical_trough_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Empirical Trough Capital Costs' ]], { 'sidebar'='Installation Costs', 'help'='cc_trough' } );
addpage( [[ 'Operating Costs Fuel', 'Operating Costs Land Lease' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_all_equity_partnership_flip_pages();
setup_electricity_purchases();

// Flat Plate PV ////////////////////////////////////////////////////////////////
setconfig( 'Flat Plate PV', 'LCOE Calculator' );
setup_flat_plate_pv_pages();
setup_lcoefcr_pages();
setmodules( ['pvsamv1', 'grid', 'lcoefcr'] );

setconfig( 'Flat Plate PV', 'None' );
setup_flat_plate_pv_pages();
setmodules( ['pvsamv1', 'grid'] );

setconfig( 'Flat Plate PV', 'Residential' );
setmodules( ['belpe', 'pvsamv1', 'grid', 'utilityrate5', 'cashloan']);
setup_flat_plate_pv_pages();
setup_lifetime_page( DEGRADATION_PVSAM );
addpage( [[ 'PV Capital Costs' ],
	[ 'PV Capital Cost Curve', 'PV Capex Table', 'PV Capex Table AC', 'PV Capex Table Land' ]],
	{ 'sidebar'='Installation Costs', 'exclusive_var'='pv_capex_cost_choice','help'='cc_pv'} );
addpage( [[ 'Operating Costs' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_residential_pages( LOAD_BELPE ); //includes building load calculator

setconfig( 'Flat Plate PV', 'Third Party' );
setmodules( ['belpe', 'pvsamv1', 'grid', 'utilityrate5', 'thirdpartyownership']);
setup_flat_plate_pv_pages();
setup_lifetime_page( DEGRADATION_PVSAM );
setup_thirdparty_pages( LOAD_BELPE ); //includes building load calculator by default in this function

setconfig( 'Flat Plate PV', 'Host Developer' );
setmodules( ['pvsamv1', 'grid', 'utilityrate5', 'host_developer']);
setup_flat_plate_pv_pages();
setup_lifetime_page( DEGRADATION_PVSAM );
addpage( [[ 'PV Capital Costs' ],
	[ 'PV Capital Cost Curve', 'PV Capex Table', 'PV Capex Table AC', 'PV Capex Table Land']],
	{ 'sidebar'='Installation Costs', 'exclusive_var'='pv_capex_cost_choice','help'='cc_pv' } );
addpage( [[ 'Operating Costs' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_host_developer_pages( LOAD_SIMPLE );

setconfig( 'Flat Plate PV', 'Commercial' );
setmodules( ['pvsamv1', 'grid', 'utilityrate5', 'cashloan']);
setup_flat_plate_pv_pages();
setup_lifetime_page( DEGRADATION_PVSAM );
addpage( [[ 'PV Capital Costs' ],
	[ 'PV Capital Cost Curve', 'PV Capex Table', 'PV Capex Table AC', 'PV Capex Table Land']],
	{ 'sidebar'='Installation Costs', 'exclusive_var'='pv_capex_cost_choice','help'='cc_pv'} );
addpage( [[ 'Operating Costs' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_commercial_pages( LOAD_SIMPLE ); //belpe not valid for commercial

setconfig( 'Flat Plate PV', 'Single Owner' );
// TO DO include utilityrate5 for inverter nighttime consumption? update all PPA and Merchant Plant configs accordingly
//setmodules( ['pvsamv1', 'grid', 'utilityrate5', 'singleowner'] );
setmodules( ['pvsamv1', 'grid', 'utilityrate5', 'singleowner'] );
setup_flat_plate_pv_pages();
setup_lifetime_page( DEGRADATION_PVSAM );
addpage( [[ 'PV Capital Costs' ],
	[ 'PV Capital Cost Curve', 'PV Capex Table', 'PV Capex Table AC', 'PV Capex Table Land']],
	{ 'sidebar'='Installation Costs', 'exclusive_var'='pv_capex_cost_choice','help'='cc_pv'} );
addpage( [[ 'Operating Costs', 'Operating Costs Land Lease' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_single_owner_pages( );
//addpage( [[ 'Financial Capacity Payments' ]], { 'sidebar'='Ancillary Services', 'help'='ancillary_services' });
setup_electricity_purchases(); // required if utilityrate5 included in config

setconfig( 'Flat Plate PV', 'Merchant Plant' );
setmodules( ['pvsamv1', 'grid', 'utilityrate5', 'merchantplant']);
setup_flat_plate_pv_pages();
setup_lifetime_page( DEGRADATION_PVSAM );
addpage( [[ 'PV Capital Costs' ],
	[ 'PV Capital Cost Curve', 'PV Capex Table', 'PV Capex Table AC', 'PV Capex Table Land']],
	{ 'sidebar'='Installation Costs', 'exclusive_var'='pv_capex_cost_choice','help'='cc_pv'} );
addpage( [[ 'Operating Costs', 'Operating Costs Land Lease' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_merchant_plant_pages( );
setup_electricity_purchases();

setconfig( 'Flat Plate PV', 'Leveraged Partnership Flip' );
setmodules( ['pvsamv1', 'grid', 'utilityrate5', 'levpartflip']);
setup_flat_plate_pv_pages();
setup_lifetime_page( DEGRADATION_PVSAM );
addpage( [[ 'PV Capital Costs' ],
	[ 'PV Capital Cost Curve', 'PV Capex Table', 'PV Capex Table AC', 'PV Capex Table Land']],
	{ 'sidebar'='Installation Costs', 'exclusive_var'='pv_capex_cost_choice','help'='cc_pv'} );
addpage( [[ 'Operating Costs', 'Operating Costs Land Lease' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_leveraged_partnership_flip_pages( );
setup_electricity_purchases();

setconfig( 'Flat Plate PV', 'All Equity Partnership Flip' );
setmodules( ['pvsamv1', 'grid', 'utilityrate5', 'equpartflip']);
setup_flat_plate_pv_pages();
setup_lifetime_page( DEGRADATION_PVSAM );
addpage( [[ 'PV Capital Costs' ],
	[ 'PV Capital Cost Curve', 'PV Capex Table', 'PV Capex Table AC', 'PV Capex Table Land']],
	{ 'sidebar'='Installation Costs', 'exclusive_var'='pv_capex_cost_choice','help'='cc_pv'} );
addpage( [[ 'Operating Costs', 'Operating Costs Land Lease' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_all_equity_partnership_flip_pages( );
setup_electricity_purchases();

setconfig( 'Flat Plate PV', 'Sale Leaseback' );
setmodules( ['pvsamv1', 'grid', 'utilityrate5', 'saleleaseback']);
setup_flat_plate_pv_pages();
setup_lifetime_page( DEGRADATION_PVSAM );
addpage( [[ 'PV Capital Costs' ],
	[ 'PV Capital Cost Curve', 'PV Capex Table', 'PV Capex Table AC', 'PV Capex Table Land']],
	{ 'sidebar'='Installation Costs', 'exclusive_var'='pv_capex_cost_choice','help'='cc_pv'} );
addpage( [[ 'Operating Costs', 'Operating Costs Land Lease' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_sale_leaseback_pages( );
setup_electricity_purchases();

// ETES ///////
setconfig('ETES', 'Single Owner');
setmodules( ['etes_electric_resistance', 'singleowner']);
setup_etes_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage([['ETES Capital Costs']],{'sidebar'='System Costs','help'='cc_etes'});
addpage([['Operating Costs']], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_single_owner_dispatch_pages();
//setup_electricity_purchases();

//setconfig('ETES', 'Merchant Plant');
//setmodules( ['etes_electric_resistance', 'merchantplant']);
//setup_etes_pages();
//setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
//addpage([['ETES Capital Costs']],{'sidebar'='System Costs','help'='pt_system_costs'});
//addpage([['Operating Costs']], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
//setup_merchant_plant_pages();

// PTES ///////
setconfig('PTES', 'Single Owner');
setmodules( ['etes_ptes', 'singleowner']);
setup_ptes_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage([['PTES Capital Costs']],{'sidebar'='Installation Costs','help'='cc_system_costs'});
addpage([['Operating Costs']], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_single_owner_dispatch_pages();

// CSThermal - Physical Trough ////////////////////////////////
setconfig( 'Physical Trough IPH', 'None' );
setmodules( ['trough_physical_iph']);
setup_cst_physical_trough_pages();
addpage( [['Sales Tax Rate Single Input','Physical Trough IPH Capital Costs' ]],{ 'sidebar'='Installation Costs', 'help'='cc_physical_trough' } );
addpage( [['Financial Construction Financing']],{'sidebar'='Construction Financing'}); // 'Financial Tax and Insurance Rates']]); //, 'Financial Analysis Parameters']]);

setconfig('Physical Trough IPH', 'LCOH Calculator');
setmodules( ['trough_physical_iph', 'lcoefcr_design']);	// 'iph_to_lcoefcr', 
setup_cst_physical_trough_pages();
addpage( [['Sales Tax Rate Single Input','Physical Trough IPH Capital Costs' ]],{ 'sidebar'='Installation Costs', 'help'='cc_tower' } );
addpage( [['Financial Construction Financing']],{'sidebar'='Construction Financing'}); // 'Financial Tax and Insurance Rates']]); //, 'Financial Analysis Parameters']]);
setup_iph_lcoefcr_cost_pages();

// CSP - Physical Trough ///////////////////////////////////////////////////////
setconfig( 'Physical Trough', 'LCOE Calculator' );
setmodules( ['trough_physical', 'grid', 'lcoefcr']);
setup_csp_physical_trough_pages();
addpage( [['Sales Tax Rate Single Input','Physical Trough Capital Costs' ]],{ 'sidebar'='Installation Costs', 'help'='cc_tower' } );
addpage( [[ 'Financial LCOE Calc with Costs']],{ 'sidebar'='Financial Parameters', 'help'='fin_lcoefcr'} );

setconfig( 'Physical Trough', 'None' );
setmodules( ['trough_physical', 'grid']);
setup_csp_physical_trough_pages();
addpage( [['Sales Tax Rate Single Input','Physical Trough Capital Costs' ]],{ 'sidebar'='Installation Costs', 'help'='cc_tower' } );

//-----------------------------------------------------
setconfig( 'Physical Trough', 'Leveraged Partnership Flip' );
setmodules( ['trough_physical', 'grid', 'utilityrate5', 'levpartflip']);
setup_csp_physical_trough_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Physical Trough Capital Costs' ]], { 'sidebar'='Installation Costs', 'help'='cc_trough' } );
addpage( [[ 'Operating Costs', 'Operating Costs Land Lease' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_leveraged_partnership_flip_pages();
setup_electricity_purchases();

//-----------------------------------------------------
setconfig( 'Physical Trough', 'All Equity Partnership Flip' );
setmodules( ['trough_physical', 'grid', 'utilityrate5', 'equpartflip']);
setup_csp_physical_trough_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Physical Trough Capital Costs' ]], { 'sidebar'='Installation Costs', 'help'='cc_trough' } );
addpage( [[ 'Operating Costs', 'Operating Costs Land Lease' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_all_equity_partnership_flip_pages();
setup_electricity_purchases();

//-----------------------------------------------------
setconfig( 'Physical Trough', 'Sale Leaseback' );
setmodules( ['trough_physical', 'grid', 'utilityrate5', 'saleleaseback']);
setup_csp_physical_trough_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Physical Trough Capital Costs' ]], { 'sidebar'='Installation Costs', 'help'='cc_trough' } );
addpage( [[ 'Operating Costs', 'Operating Costs Land Lease' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_sale_leaseback_pages();
setup_electricity_purchases();

//-----------------------------------------------------
setconfig( 'Physical Trough', 'Single Owner' );
setmodules( ['trough_physical', 'grid', 'utilityrate5', 'singleowner']);
setup_csp_physical_trough_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Physical Trough Capital Costs' ]], { 'sidebar'='Installation Costs', 'help'='cc_trough' } );
addpage( [[ 'Operating Costs', 'Operating Costs Land Lease' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_single_owner_pages();
setup_electricity_purchases();

setconfig( 'Physical Trough', 'Merchant Plant' );
setmodules( ['trough_physical', 'grid', 'utilityrate5', 'merchantplant']);
setup_csp_physical_trough_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Physical Trough Capital Costs' ]], { 'sidebar'='Installation Costs', 'help'='cc_trough' } );
addpage( [[ 'Operating Costs', 'Operating Costs Land Lease' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_merchant_plant_pages();
setup_electricity_purchases();

// PVWatts /////////////////////////////////////////////////////////////////////
setconfig( 'PVWatts', 'LCOE Calculator' );
setmodules( ['pvwattsv8', 'grid','lcoefcr']);
setup_pvwatts_pages();
setup_lcoefcr_pages();

setconfig( 'PVWatts', 'None' );
setmodules( ['pvwattsv8','grid']);
setup_pvwatts_pages();

setconfig( 'PVWatts', 'Residential' );
setmodules( ['pvwattsv8', 'belpe', 'grid', 'utilityrate5', 'cashloan']);
setup_pvwatts_pages();
setup_lifetime_page( DEGRADATION_AC_SINGLE_YEAR );
addpage( [[ 'PV Capital Costs' ],
	[ 'PVWatts Capital Cost Curve', 'PV Capex Table', 'PV Capex Table AC']],
	{ 'sidebar'='Installation Costs', 'exclusive_var'='pv_capex_cost_choice','help'='cc_pv'} );
addpage( [[ 'Operating Costs' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_residential_pages( LOAD_BELPE ); //includes building load calculator

setconfig( 'PVWatts', 'Commercial' );
setmodules( ['pvwattsv8', 'grid', 'utilityrate5', 'cashloan']);
setup_pvwatts_pages();
setup_lifetime_page( DEGRADATION_AC_SINGLE_YEAR );
addpage( [[ 'PV Capital Costs' ],
	[ 'PVWatts Capital Cost Curve', 'PV Capex Table', 'PV Capex Table AC']],
	{ 'sidebar'='Installation Costs', 'exclusive_var'='pv_capex_cost_choice','help'='cc_pv'} );
addpage( [[ 'Operating Costs' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_commercial_pages(LOAD_SIMPLE); //belpe not valid for commercial

setconfig( 'PVWatts', 'Leveraged Partnership Flip' );
setmodules( ['pvwattsv8', 'grid', 'utilityrate5', 'levpartflip']);
setup_pvwatts_pages();
setup_lifetime_page( DEGRADATION_AC_SINGLE_YEAR );
addpage( [[ 'PV Capital Costs' ],
	[ 'PVWatts Capital Cost Curve', 'PV Capex Table', 'PV Capex Table AC']],
	{ 'sidebar'='Installation Costs', 'exclusive_var'='pv_capex_cost_choice','help'='cc_pv'} );
addpage( [[ 'Operating Costs', 'Operating Costs Land Lease' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_leveraged_partnership_flip_pages();
setup_electricity_purchases();

setconfig( 'PVWatts', 'All Equity Partnership Flip' );
setmodules( ['pvwattsv8', 'grid', 'utilityrate5', 'equpartflip']);
setup_pvwatts_pages();
setup_lifetime_page( DEGRADATION_AC_SINGLE_YEAR );
addpage( [[ 'PV Capital Costs' ],
	[ 'PVWatts Capital Cost Curve', 'PV Capex Table', 'PV Capex Table AC']],
	{ 'sidebar'='Installation Costs', 'exclusive_var'='pv_capex_cost_choice','help'='cc_pv'} );
addpage( [[ 'Operating Costs', 'Operating Costs Land Lease' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_all_equity_partnership_flip_pages();
setup_electricity_purchases();

setconfig( 'PVWatts', 'Sale Leaseback' );
setmodules( ['pvwattsv8', 'grid', 'utilityrate5', 'saleleaseback']);
setup_pvwatts_pages();
setup_lifetime_page( DEGRADATION_AC_SINGLE_YEAR );
addpage( [[ 'PV Capital Costs' ],
	[ 'PVWatts Capital Cost Curve', 'PV Capex Table', 'PV Capex Table AC']],
	{ 'sidebar'='Installation Costs', 'exclusive_var'='pv_capex_cost_choice','help'='cc_pv'} );
addpage( [[ 'Operating Costs', 'Operating Costs Land Lease' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_sale_leaseback_pages();
setup_electricity_purchases();

setconfig( 'PVWatts', 'Single Owner' );
setmodules( ['pvwattsv8', 'grid', 'utilityrate5', 'singleowner']);
setup_pvwatts_pages();
setup_lifetime_page( DEGRADATION_AC_SINGLE_YEAR );
addpage( [[ 'PV Capital Costs' ],
	[ 'PVWatts Capital Cost Curve', 'PV Capex Table', 'PV Capex Table AC']],
	{ 'sidebar'='Installation Costs', 'exclusive_var'='pv_capex_cost_choice','help'='cc_pv'} );
addpage( [[ 'Operating Costs', 'Operating Costs Land Lease' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_single_owner_pages();
setup_electricity_purchases();

setconfig( 'PVWatts', 'Community Solar' );
setmodules( ['pvwattsv8', 'grid', 'communitysolar']);
setup_pvwatts_pages();
setup_lifetime_page( DEGRADATION_AC_SINGLE_YEAR );
addpage( [[ 'PV Capital Costs' ],
	[ 'PVWatts Capital Cost Curve', 'PV Capex Table', 'PV Capex Table AC']],
	{ 'sidebar'='Installation Costs', 'exclusive_var'='pv_capex_cost_choice','help'='cc_pv'} );
addpage( [[ 'Operating Costs', 'Operating Costs Land Lease' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_community_solar_pages();
// setup_electricity_purchases(); pvwatts without storage only option for community solar for now, so no need for electricity purchases

setconfig( 'PVWatts', 'Merchant Plant' );
setmodules( ['pvwattsv8', 'grid', 'utilityrate5', 'merchantplant']);
setup_pvwatts_pages();
setup_lifetime_page( DEGRADATION_AC_SINGLE_YEAR );
addpage( [[ 'PV Capital Costs' ],
	[ 'PVWatts Capital Cost Curve', 'PV Capex Table', 'PV Capex Table AC']],
	{ 'sidebar'='Installation Costs', 'exclusive_var'='pv_capex_cost_choice','help'='cc_pv'} );
addpage( [[ 'Operating Costs', 'Operating Costs Land Lease' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_merchant_plant_pages();
setup_electricity_purchases();

setconfig( 'PVWatts', 'Host Developer' );
setmodules( ['pvwattsv8', 'grid', 'utilityrate5', 'host_developer']);
setup_pvwatts_pages();
setup_lifetime_page( DEGRADATION_AC_SINGLE_YEAR );
addpage( [[ 'PV Capital Costs' ],
	[ 'PVWatts Capital Cost Curve', 'PV Capex Table', 'PV Capex Table AC']],
	{ 'sidebar'='Installation Costs', 'exclusive_var'='pv_capex_cost_choice','help'='cc_pv'} );
addpage( [[ 'Operating Costs' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_host_developer_pages( LOAD_SIMPLE ); //includes building load calculator by default in this function

setconfig( 'PVWatts', 'Third Party' );
setmodules( ['pvwattsv8', 'belpe', 'grid', 'utilityrate5', 'thirdpartyownership']);
setup_pvwatts_pages();
setup_lifetime_page( DEGRADATION_AC_SINGLE_YEAR );
setup_thirdparty_pages( LOAD_BELPE); //includes building load calculator by default in this function

// Wind Power //////////////////////////////////////////////////////////////////

landbosse_caption = 'Land-Based Balance of System Cost Model (v2.3.0.3)';

//-----------------------------------------------------
setconfig( 'Wind Power', 'Residential' );
setmodules( ['windpower', 'grid', 'utilityrate5', 'cashloan']);
setup_windpower_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [['Wind Farm Costs']],
		{ 'sidebar'='Installation Costs', 'help'='cc_wind' } );
addpage( [[ 'Operating Costs' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_residential_pages( LOAD_SIMPLE ); //does not include building load calculator

//-----------------------------------------------------
setconfig( 'Wind Power', 'Commercial' );
setmodules( ['windpower', 'grid', 'utilityrate5', 'cashloan']);
setup_windpower_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [['Wind Farm Costs']],
		{ 'sidebar'='Installation Costs', 'help'='cc_wind' } );
addpage( [[ 'Operating Costs' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_commercial_pages( LOAD_SIMPLE ); //does not include building load calculator


//-----------------------------------------------------
setconfig( 'Wind Power', 'Leveraged Partnership Flip' );
setmodules( ['windpower', 'grid', 'wind_landbosse', 'utilityrate5', 'levpartflip']);
setup_windpower_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [['Wind Farm Costs',
		{'name'='Wind LandBOSSE','caption'=landbosse_caption,'collapsible'=true,'collapsible_var'='wind_bos_shown'},
		{'name'='Wind OBOS','caption'='Offshore Balance of System Cost Model', 'collapsible'=true,'collapsible_var'='wind_obos_shown'}]],
		{ 'sidebar'='Installation Costs', 'help'='cc_wind' } );
addpage( [[ 'Operating Costs' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_leveraged_partnership_flip_pages();
setup_electricity_purchases();

//-----------------------------------------------------
setconfig( 'Wind Power', 'All Equity Partnership Flip' );
setmodules( ['windpower', 'grid', 'wind_landbosse', 'utilityrate5', 'equpartflip']);
setup_windpower_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [['Wind Farm Costs',
		{'name'='Wind LandBOSSE','caption'=landbosse_caption,'collapsible'=true,'collapsible_var'='wind_bos_shown'},
		{'name'='Wind OBOS','caption'='Offshore Balance of System Cost Model', 'collapsible'=true,'collapsible_var'='wind_obos_shown'}]],
		{ 'sidebar'='Installation Costs', 'help'='cc_wind' } );
addpage( [[ 'Operating Costs' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_all_equity_partnership_flip_pages();
setup_electricity_purchases();

//-----------------------------------------------------
setconfig( 'Wind Power', 'Sale Leaseback' );
setmodules( ['windpower', 'grid', 'wind_landbosse', 'utilityrate5', 'saleleaseback']);
setup_windpower_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [['Wind Farm Costs',
		{'name'='Wind LandBOSSE','caption'=landbosse_caption,'collapsible'=true,'collapsible_var'='wind_bos_shown'},
		{'name'='Wind OBOS','caption'='Offshore Balance of System Cost Model', 'collapsible'=true,'collapsible_var'='wind_obos_shown'}]],
		{ 'sidebar'='Installation Costs', 'help'='cc_wind' } );
addpage( [[ 'Operating Costs' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_sale_leaseback_pages();
setup_electricity_purchases();

//-----------------------------------------------------
setconfig( 'Wind Power', 'Single Owner' );
setmodules( ['windpower', 'grid', 'wind_landbosse', 'utilityrate5', 'singleowner']);
setup_windpower_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [['Wind Farm Costs',
		{'name'='Wind LandBOSSE','caption'=landbosse_caption,'collapsible'=true,'collapsible_var'='wind_bos_shown'},
		{'name'='Wind OBOS','caption'='Offshore Balance of System Cost Model', 'collapsible'=true,'collapsible_var'='wind_obos_shown'}]],
		{ 'sidebar'='Installation Costs', 'help'='cc_wind' } );
addpage( [[ 'Operating Costs' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_single_owner_pages();
setup_electricity_purchases();

setconfig( 'Wind Power', 'Merchant Plant' );
setmodules( ['windpower', 'grid', 'wind_landbosse', 'utilityrate5', 'merchantplant']);
setup_windpower_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [['Wind Farm Costs',
		{'name'='Wind LandBOSSE','caption'=landbosse_caption,'collapsible'=true,'collapsible_var'='wind_bos_shown'},
		{'name'='Wind OBOS','caption'='Offshore Balance of System Cost Model', 'collapsible'=true,'collapsible_var'='wind_obos_shown'}]],
		{ 'sidebar'='Installation Costs', 'help'='cc_wind' } );
addpage( [[ 'Operating Costs' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_merchant_plant_pages();
setup_electricity_purchases();

//-----------------------------------------------------
setconfig( 'Wind Power', 'LCOE Calculator' );
setmodules( ['windpower', 'grid', 'lcoefcr']);
setup_windpower_pages();
setup_lcoefcr_pages();

//-----------------------------------------------------
setconfig( 'Wind Power', 'None' );
setmodules( ['windpower', 'grid']);
setup_windpower_pages();

// Solar Water Heating /////////////////////////////////////////////////////////
setconfig( 'Solar Water Heating', 'LCOE Calculator');
setmodules( ['swh',  'lcoefcr'] );
setup_solar_water_heating_pages();
setup_lcoefcr_pages();

setconfig( 'Solar Water Heating', 'None');
setmodules( ['swh'] );
setup_solar_water_heating_pages();

setconfig( 'Solar Water Heating', 'Residential');
setmodules( ['swh',  'belpe', 'utilityrate5', 'cashloan'] );
setup_solar_water_heating_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Solar Water Heating Costs' ]], { 'sidebar'='Installation Costs', 'help'='cc_shw' } );
addpage( [[ 'Operating Costs' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_residential_pages( LOAD_BELPE ); //yes belpe

setconfig( 'Solar Water Heating', 'Commercial');
setmodules( ['swh', 'utilityrate5', 'cashloan'] );
setup_solar_water_heating_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Solar Water Heating Costs' ]], { 'sidebar'='Installation Costs', 'help'='cc_shw' } );
addpage( [[ 'Operating Costs' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_commercial_pages(LOAD_SIMPLE); //belpe not valid for commercial

// Fuel Cell /////////////////////////////////////////////////////////
setconfig( 'Fuel Cell', 'Commercial');
setmodules( ['pvwattsv8', 'fuelcell', 'battery', 'grid', 'utilityrate5', 'thermalrate', 'cashloan'] );
addpage( [[ 'Solar Resource Data' ]], { 'sidebar'='Location and Resource', 'help'='pv_location_and_resource' } );
addpage( [[ 'PVWatts',
            { 'name'='PV Land Area', 'caption' = 'Land Area', 'collapsible'=true, 'collapsible_var'='pv_land_area_is_shown'},
            { 'name'='PVWatts Advanced Inputs', 'caption' = 'Advanced Inputs', 'collapsible'=true, 'collapsible_var'='pvwatts.advanced.is_shown'} ]],
         { 'sidebar'='PV System', 'help'='pvwatts_system_design' } );
addpage( [[ { 'name'='Battery None', 'caption'='No Battery'}],
	      [ { 'name'='Battery Model', 'caption'='Enable Battery'},
			'Battery Bank Sizing',
			'Battery Current and Capacity',
			'Battery Configuration',
			'Battery Life Options',
			'Battery Life Cycle Calendar',
			{ 'name'='Battery Replacements', 'caption'='Battery Replacements', 'collapsible'=true, 'collapsible_var'='battery_replacements_shown'},
			{ 'name'='Battery Voltage', 'caption'='Battery Voltage', 'collapsible'=true, 'collapsible_var'='battery_voltage_shown'},
			{ 'name'='Battery Losses', 'caption'='Battery Losses', 'collapsible'=true, 'collapsible_var'='battery_losses_shown'},
			{ 'name'='Battery Thermal', 'caption'='Battery Thermal', 'collapsible'=true, 'collapsible_var'='battery_thermal_shown'},
			'Battery Standalone Enable' ]],
		 { 'sidebar'='Battery Storage', 'help'='battery_storage_btm', 'exclusive_var'='en_batt'} );
addpage( [[ {'name'='Battery Dispatch Peak Shaving BTM', 'caption'='Peak Shaving'} ],
		  [ {'name'='Battery Dispatch Grid Power Targets', 'caption'='Grid Power Targets'} ],
		  [ {'name'='Battery Dispatch Battery Power Targets', 'caption'='Battery Power Targets'}],
		  [ {'name'='Battery Dispatch Manual', 'caption'='Manual'}],
		  [ {'name'='Battery Dispatch Retail Rate', 'caption'='Retail Rate'} ],
		  [ {'name'='Battery Dispatch Self Consumption', 'caption'='Self Consumption'} ]],
		 { 'sidebar'='Battery Dispatch', 'help'='battery_dispatch_btm', 'exclusive_var' = 'batt_dispatch_excl', 'exclusive_header_pages' = ['Battery Dispatch Common', 'Battery Dispatch Options BTM'], 'exclusive_tabs'=true, 'exclusive_hide'=true  } );
addpage( [[ 'Fuel Cell' ]], 
		 {'sidebar'='Fuel Cell', 'help'='fuelcell_fuel_cell'});
addpage( [[ {'name'='AA Empty', 'caption'='Fixed Output'} ], 
	      [ {'name'='AA Empty', 'caption'='Follow Electric Load'} ],
		  [ {'name'='Fuel Cell Dispatch Manual', 'caption'='Manual Dispatch'} ], 
		  [ {'name'='AA Empty', 'caption'='Input Dispatch'}] ],
		 { 'sidebar'='Fuel Cell Dispatch', 'help'='fuelcell_dispatch', 'exclusive_var' = 'fuelcell_dispatch_excl', 'exclusive_header_pages' = ['Fuel Cell Dispatch BTM'], 'exclusive_tabs'=true, 'exclusive_hide'=true} );
setup_grid_limits_page();
setup_grid_outage_page();
setup_lifetime_page( DEGRADATION_DC_LIFETIME );
addpage( [[ 'Fuel Cell Costs' ],
		  [ 'PVWatts Battery FuelCell Capital Cost Curve', 'PV Capex Table', 'PV Capex Table AC', 'PV Capex Table Battery', 'PV Capex Fuel Cell']],
		 { 'sidebar'='Installation Costs', 'exclusive_var' = 'pv_capex_cost_choice','help'='cc_fuel_cell' } );
addpage( [[ 'Operating Costs Fuel Cell' ]], 
         {'sidebar' = 'Operating Costs', 'help'='oc_fuel_cell'} );
setup_commercial_pages(LOAD_SIMPLE); //belpe not valid for commercial
addpage( [[ 'Thermal Rate' ]], 
         {'sidebar' = 'Thermal Rates','help' = 'thermal_rates'});
addpage( [[ 'Thermal Load' ]], 
         {'sidebar' = 'Thermal Load','help' = 'thermal_load'});

setconfig( 'Fuel Cell', 'Single Owner');
setmodules( ['pvwattsv8', 'fuelcell', 'battery', 'grid', 'utilityrate5', 'thermalrate', 'singleowner']);
addpage( [[ 'Solar Resource Data' ]], { 'sidebar'='Location and Resource', 'help'='pv_location_and_resource' } );
addpage( [[ 'PVWatts',
            { 'name'='PV Land Area', 'caption' = 'Land Area', 'collapsible'=true, 'collapsible_var'='pv_land_area_is_shown'},
            { 'name'='PVWatts Advanced Inputs', 'caption' = 'Advanced Inputs', 'collapsible'=true, 'collapsible_var'='pvwatts.advanced.is_shown'} ]],
         { 'sidebar'='PV System', 'help'='pvwatts_system_design' } );
addpage( [[ { 'name'='Battery None','caption'='No Battery'}],
		  [ { 'name'='Battery Model', 'caption'='Enable Battery'},
		    'Battery Bank Sizing',
		    'Battery Current and Capacity',
		    'Battery Configuration',
		    'Battery Life Options',
		    'Battery Life Cycle Calendar',
		    { 'name'='Battery Replacements', 'caption'='Battery Replacements', 'collapsible'=true, 'collapsible_var'='battery_replacements_shown'},
		    { 'name'='Battery Voltage', 'caption'='Battery Voltage', 'collapsible'=true, 'collapsible_var'='battery_voltage_shown'},
		    { 'name'='Battery Losses', 'caption'='Battery Losses', 'collapsible'=true, 'collapsible_var'='battery_losses_shown'},
		    { 'name'='Battery Thermal', 'caption'='Battery Thermal', 'collapsible'=true, 'collapsible_var'='battery_thermal_shown'},
		    'Battery Standalone Enable' ]],
	     { 'sidebar'='Battery Storage', 'help'='battery_storage_fom', 'exclusive_var'='en_batt'} );
addpage( [[ { 'name'='Battery Dispatch Automated FOM', 'caption'='Automated'} ], 
		  [ { 'name'='Battery Dispatch PV Smoothing', 'caption'='PV Smoothing'} ],
		  [ { 'name'='Battery Dispatch Custom Time Series', 'caption'='Custom Time Series'} ],
		  [ {'name'='Battery Dispatch Manual', 'caption'='Manual'} ]],
		 { 'sidebar'='Battery Dispatch', 'help'='battery_dispatch_fom', 'exclusive_var' = 'batt_dispatch_excl', 'exclusive_header_pages' = ['Battery Dispatch Common', 'Battery Dispatch Options FOM'], 'exclusive_tabs'=true, 'exclusive_hide'=true} );
addpage( [[ 'Fuel Cell']], {'sidebar'='Fuel Cell', 'help'='fuelcell_fuel_cell'});
addpage( [[ { 'name'='AA Empty', 'caption'='Fixed Output'} ], 
		  [ { 'name'='Fuel Cell Dispatch Manual', 'caption'='Manual Dispatch'} ], 
		  [ { 'name'='AA Empty', 'caption'='Input Dispatch'}] ],
		 { 'sidebar'='Fuel Cell Dispatch', 'help'='fuelcell_dispatch', 'exclusive_var' = 'fuelcell_dispatch_excl', 'exclusive_header_pages' = ['Fuel Cell Dispatch FOM'], 'exclusive_tabs'=true, 'exclusive_hide'=true} );
setup_grid_limits_page();
setup_lifetime_page( DEGRADATION_DC_LIFETIME );
addpage( [[ 'Fuel Cell Costs' ], [ 'PVWatts Battery FuelCell Capital Cost Curve', 'PV Capex Table', 'PV Capex Table AC', 'PV Capex Table Battery', 'PV Capex Fuel Cell']],
         { 'sidebar'='Installation Costs', 'exclusive_var' = 'pv_capex_cost_choice','help'='cc_fuel_cell' } );
addpage( [[ 'Operating Costs Fuel Cell', 'Operating Costs Land Lease' ]],
         {'sidebar' = 'Operating Costs', 'help'='oc_fuel_cell'} );
setup_single_owner_pages();
setup_electricity_purchases();
addpage( [[ 'Thermal Rate' ]],
         {'sidebar' = 'Thermal Rates','help' = 'thermal_rates'} );

// Geothermal Power ////////////////////////////////////////////////////////////

setconfig( 'Geothermal Power', 'Leveraged Partnership Flip' );
setmodules( ['geothermal', 'grid', 'utilityrate5', 'levpartflip']);
setup_geothermal_power_pages();
addpage( [[ 'Geothermal Costs' ]], { 'sidebar'='Installation Costs', 'help'='cc_geothermal' } );
addpage( [[ 'Operating Costs', 'Geothermal OM Costs' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_leveraged_partnership_flip_pages();
setup_electricity_purchases();

setconfig( 'Geothermal Power', 'All Equity Partnership Flip' );
setmodules( ['geothermal', 'grid', 'utilityrate5', 'equpartflip']);
setup_geothermal_power_pages();
addpage( [[ 'Geothermal Costs' ]], { 'sidebar'='Installation Costs', 'help'='cc_geothermal' } );
addpage( [[ 'Operating Costs', 'Geothermal OM Costs' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_all_equity_partnership_flip_pages();
setup_electricity_purchases();

setconfig( 'Geothermal Power', 'Sale Leaseback' );
setmodules( ['geothermal', 'grid', 'utilityrate5', 'saleleaseback']);
setup_geothermal_power_pages();
addpage( [[ 'Geothermal Costs' ]], { 'sidebar'='Installation Costs', 'help'='cc_geothermal' } );
addpage( [[ 'Operating Costs', 'Geothermal OM Costs' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_sale_leaseback_pages();
setup_electricity_purchases();

setconfig( 'Geothermal Power', 'Single Owner' );
setmodules( ['geothermal', 'grid', 'utilityrate5', 'singleowner']);
setup_geothermal_power_pages();
addpage( [[ 'Geothermal Costs' ]], { 'sidebar'='Installation Costs', 'help'='cc_geothermal' } );
addpage( [[ 'Operating Costs', 'Geothermal OM Costs' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_single_owner_pages();
setup_electricity_purchases();

setconfig( 'Geothermal Power', 'Merchant Plant' );
setmodules( ['geothermal', 'grid', 'utilityrate5', 'merchantplant']);
setup_geothermal_power_pages();
addpage( [[ 'Geothermal Costs' ]], { 'sidebar'='Installation Costs', 'help'='cc_geothermal' } );
addpage( [[ 'Operating Costs', 'Geothermal OM Costs' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_merchant_plant_pages();
setup_electricity_purchases();

setconfig( 'Geothermal Power', 'LCOE Calculator' );
setmodules( ['geothermal',  'grid', 'lcoefcr']);
setup_geothermal_power_pages();
addpage( [[ 'Geothermal Costs' ]], { 'sidebar'='Installation Costs', 'help'='cc_geothermal' } );
addpage( [[ 'Financial LCOE Calc with Capex Page']], { 'sidebar'='Financial Parameters', 'help'='fin_lcoefcr'} );

setconfig( 'Geothermal Power', 'None' );
setmodules( ['geothermal', 'grid',]);
setup_geothermal_power_pages();
addpage( [['Geothermal Drilling' ]], { 'sidebar'='Well Drilling', 'help'='cc_geothermal' } );

// Generic System //////////////////////////////////////////////////////////////
function setup_custom_generation_pages()
{
	addpage( [[ 'Custom Generation Plant', 'Battery Enable' ]], { 'sidebar'='Generation Profile' , 'help'='custom_generation_profile' } );
	setup_grid_limits_page();
}


//-----------------------------------------------------
setconfig( 'Custom Generation Profile', 'Residential' );
setmodules( ['custom_generation', 'grid', 'utilityrate5', 'cashloan']);
setup_custom_generation_pages();
setup_lifetime_page( DEGRADATION_AC_SINGLE_YEAR );
addpage( [[ 'Custom Generation Costs']],{ 'sidebar'='Installation Costs', 'help'='cc_custom_generation' } );
addpage( [[ 'Operating Costs Fuel' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_residential_pages( LOAD_SIMPLE ); //does not include building load calculator

//-----------------------------------------------------
setconfig( 'Custom Generation Profile', 'Third Party' );
setmodules( ['custom_generation', 'grid', 'utilityrate5', 'thirdpartyownership']);
setup_custom_generation_pages();
setup_lifetime_page( DEGRADATION_AC_SINGLE_YEAR );
setup_thirdparty_pages( LOAD_SIMPLE );

//-----------------------------------------------------
setconfig( 'Custom Generation Profile', 'Commercial' );
setmodules( ['custom_generation',  'grid', 'utilityrate5', 'cashloan']);
setup_custom_generation_pages();
setup_lifetime_page( DEGRADATION_AC_SINGLE_YEAR );
addpage( [[ 'Custom Generation Costs']],{ 'sidebar'='Installation Costs', 'help'='cc_custom_generation' } );
addpage( [[ 'Operating Costs Fuel' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_commercial_pages(LOAD_SIMPLE); //does not include building load calculator

//-----------------------------------------------------
setconfig( 'Custom Generation Profile', 'Leveraged Partnership Flip' );
setmodules( ['custom_generation', 'grid', 'utilityrate5', 'levpartflip']);
setup_custom_generation_pages();
setup_lifetime_page( DEGRADATION_AC_SINGLE_YEAR );
addpage( [[ 'Custom Generation Costs']],{ 'sidebar'='Installation Costs', 'help'='cc_custom_generation' } );
addpage( [[ 'Operating Costs Fuel' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_leveraged_partnership_flip_pages();
setup_electricity_purchases();

//-----------------------------------------------------
setconfig( 'Custom Generation Profile', 'All Equity Partnership Flip' );
setmodules( ['custom_generation', 'grid', 'utilityrate5', 'equpartflip']);
setup_custom_generation_pages();
setup_lifetime_page( DEGRADATION_AC_SINGLE_YEAR );
addpage( [[ 'Custom Generation Costs']],{ 'sidebar'='Installation Costs', 'help'='cc_custom_generation' } );
addpage( [[ 'Operating Costs Fuel' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_all_equity_partnership_flip_pages();
setup_electricity_purchases();

//-----------------------------------------------------
setconfig( 'Custom Generation Profile', 'Sale Leaseback' );
setmodules( ['custom_generation', 'grid', 'utilityrate5', 'saleleaseback']);
setup_custom_generation_pages();
setup_lifetime_page( DEGRADATION_AC_SINGLE_YEAR );
addpage( [[ 'Custom Generation Costs']],{ 'sidebar'='Installation Costs', 'help'='cc_custom_generation' } );
addpage( [[ 'Operating Costs Fuel' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_sale_leaseback_pages();
setup_electricity_purchases();

//-----------------------------------------------------
setconfig( 'Custom Generation Profile', 'Single Owner' );
setmodules( ['custom_generation', 'grid', 'utilityrate5', 'singleowner']);
setup_custom_generation_pages();
setup_lifetime_page( DEGRADATION_AC_SINGLE_YEAR );
addpage( [[ 'Custom Generation Costs']],{ 'sidebar'='Installation Costs', 'help'='cc_custom_generation' } );
addpage( [[ 'Operating Costs Fuel' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_single_owner_pages();
setup_electricity_purchases();

setconfig( 'Custom Generation Profile', 'Merchant Plant' );
setmodules( ['custom_generation', 'grid', 'utilityrate5', 'merchantplant']);
setup_custom_generation_pages();
setup_lifetime_page( DEGRADATION_AC_SINGLE_YEAR );
addpage( [[ 'Custom Generation Costs']],{ 'sidebar'='Installation Costs', 'help'='cc_custom_generation' } );
addpage( [[ 'Operating Costs Fuel' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_merchant_plant_pages();
setup_electricity_purchases();

setconfig( 'Custom Generation Profile', 'Host Developer' );
setmodules( ['custom_generation', 'grid', 'utilityrate5', 'host_developer']);
setup_custom_generation_pages();
setup_lifetime_page( DEGRADATION_AC_SINGLE_YEAR );
addpage( [[ 'Custom Generation Costs']],{ 'sidebar'='Installation Costs', 'help'='cc_custom_generation' } );
addpage( [[ 'Operating Costs Fuel' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_host_developer_pages( LOAD_SIMPLE ); //includes building load calculator by default in this function

//-----------------------------------------------------
setconfig( 'Custom Generation Profile', 'LCOE Calculator' );
setmodules( ['custom_generation', 'grid', 'lcoefcr']);
setup_custom_generation_pages();
setup_lcoefcr_pages();

//-----------------------------------------------------
setconfig( 'Custom Generation Profile', 'None' );
setmodules( ['custom_generation', 'grid']);
setup_custom_generation_pages();

// Generic CSP System //////////////////////////////////////////////////////////
function setup_generic_csp_pages()
{
	addpage( [[ 'Solar Resource Data' ]], { 'sidebar'='Location and Resource', 'help'='gss_location_and_resource' } );
	addpage( [[ 'Generic CSP Solar Field' ]], { 'sidebar'='Solar Field', 'help'='gss_solar_field' } );
	addpage( [[ 'Generic CSP Power Block' ]], { 'sidebar'='Power Block', 'help'='gss_power_block' } );
//	addpage( [[ 'Generic CSP Thermal Storage' ]], { 'sidebar'='Thermal Storage', 'help'='gss_thermal_storage' } );
	addpage( [[ 'Generic CSP Thermal Storage' ,
	  {'name' = 'CSP Dispatch Control', 'caption'='Dispatch Control', 'collapsible'=false, 'collapsible_var'='csp_dispatch_is_shown'} ]],
	  { 'sidebar'='Thermal Storage', 'help'='gss_thermal_storage' } );
 	setup_grid_limits_page();
}

//-----------------------------------------------------
setconfig( 'Generic CSP System', 'Commercial' );
setmodules( ['tcsgeneric_solar', 'grid', 'utilityrate5', 'cashloan']);
setup_generic_csp_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Generic CSP System Costs']],{ 'sidebar'='Installation Costs', 'help'='cc_generic_solar' } );
addpage( [[ 'Operating Costs Fuel', 'Operating Costs Land Lease' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_commercial_pages(LOAD_SIMPLE); //belpe not valid for commercial
//-----------------------------------------------------
setconfig( 'Generic CSP System', 'Leveraged Partnership Flip' );
setmodules( ['tcsgeneric_solar', 'grid', 'utilityrate5', 'levpartflip']);
setup_generic_csp_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Generic CSP System Costs']],{ 'sidebar'='Installation Costs', 'help'='cc_generic_solar' } );
addpage( [[ 'Operating Costs Fuel', 'Operating Costs Land Lease' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_leveraged_partnership_flip_pages();
setup_electricity_purchases();
//-----------------------------------------------------
setconfig( 'Generic CSP System', 'All Equity Partnership Flip' );
setmodules( ['tcsgeneric_solar', 'grid', 'utilityrate5', 'equpartflip']);
setup_generic_csp_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Generic CSP System Costs']],{ 'sidebar'='Installation Costs', 'help'='cc_generic_solar' } );
addpage( [[ 'Operating Costs Fuel', 'Operating Costs Land Lease' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_all_equity_partnership_flip_pages();
setup_electricity_purchases();
//-----------------------------------------------------
setconfig( 'Generic CSP System', 'Sale Leaseback' );
setmodules( ['tcsgeneric_solar', 'grid', 'utilityrate5', 'saleleaseback']);
setup_generic_csp_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Generic CSP System Costs']],{ 'sidebar'='Installation Costs', 'help'='cc_generic_solar' } );
addpage( [[ 'Operating Costs Fuel', 'Operating Costs Land Lease' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_sale_leaseback_pages();
setup_electricity_purchases();
//-----------------------------------------------------
setconfig( 'Generic CSP System', 'Single Owner' );
setmodules( ['tcsgeneric_solar', 'grid', 'utilityrate5', 'singleowner']);
setup_generic_csp_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Generic CSP System Costs']],{ 'sidebar'='Installation Costs', 'help'='cc_generic_solar' } );
addpage( [[ 'Operating Costs Fuel', 'Operating Costs Land Lease' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_single_owner_pages();
setup_electricity_purchases();
//-----------------------------------------------------
setconfig( 'Generic CSP System', 'Merchant Plant' );
setmodules( ['tcsgeneric_solar', 'grid', 'utilityrate5', 'merchantplant']);
setup_generic_csp_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Generic CSP System Costs']],{ 'sidebar'='Installation Costs', 'help'='cc_generic_solar' } );
addpage( [[ 'Operating Costs Fuel', 'Operating Costs Land Lease' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_merchant_plant_pages();
setup_electricity_purchases();
//-----------------------------------------------------
setconfig( 'Generic CSP System', 'LCOE Calculator' );
setmodules( ['tcsgeneric_solar', 'grid',  'lcoefcr']);
setup_generic_csp_pages();
setup_lcoefcr_pages();
//-----------------------------------------------------
setconfig( 'Generic CSP System', 'None' );
setmodules( ['tcsgeneric_solar', 'grid']);
setup_generic_csp_pages();

// High-X Concentrating PV /////////////////////////////////////////////////////
function setup_hcpv_pages()
{
	addpage( [[ 'Solar Resource Data' ]], { 'sidebar'='Location and Resource', 'help'='pv_location_and_resource' } );
	addpage( [[ 'HCPV Module' ]], { 'sidebar'='Module', 'help'='hcpv_module' } );
	addpage( [ ['Inverter CEC Database']], { 'sidebar'='Inverter', 'help'='hcpv_inverter' } );
	addpage( [[ 'HCPV Array' ]], { 'sidebar'='Array', 'help'='hcpv_array' } );
	setup_grid_limits_page();
}

//-----------------------------------------------------
setconfig( 'High-X Concentrating PV', 'Leveraged Partnership Flip' );
setmodules( ['hcpv', 'grid', 'utilityrate5', 'levpartflip']);
setup_hcpv_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'HCPV Costs']],{ 'sidebar'='Installation Costs', 'help'='cc_pv' } );
addpage( [[ 'Operating Costs', 'Operating Costs Land Lease' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_leveraged_partnership_flip_pages();
setup_electricity_purchases();
//-----------------------------------------------------
setconfig( 'High-X Concentrating PV', 'All Equity Partnership Flip' );
setmodules( ['hcpv', 'grid', 'utilityrate5', 'equpartflip']);
setup_hcpv_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'HCPV Costs']],{ 'sidebar'='Installation Costs', 'help'='cc_pv' } );
addpage( [[ 'Operating Costs', 'Operating Costs Land Lease' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_all_equity_partnership_flip_pages();
setup_electricity_purchases();
//-----------------------------------------------------
setconfig( 'High-X Concentrating PV', 'Sale Leaseback' );
setmodules( ['hcpv', 'grid', 'utilityrate5', 'saleleaseback']);
setup_hcpv_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'HCPV Costs']],{ 'sidebar'='Installation Costs', 'help'='cc_pv' } );
addpage( [[ 'Operating Costs', 'Operating Costs Land Lease' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_sale_leaseback_pages();
setup_electricity_purchases();
//-----------------------------------------------------
setconfig( 'High-X Concentrating PV', 'Single Owner' );
setmodules( ['hcpv', 'grid', 'utilityrate5', 'singleowner']);
setup_hcpv_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'HCPV Costs']],{ 'sidebar'='Installation Costs', 'help'='cc_pv' } );
addpage( [[ 'Operating Costs', 'Operating Costs Land Lease' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_single_owner_pages();
setup_electricity_purchases();
//-----------------------------------------------------
setconfig( 'High-X Concentrating PV', 'Merchant Plant' );
setmodules( ['hcpv', 'grid', 'utilityrate5', 'merchantplant']);
setup_hcpv_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'HCPV Costs']],{ 'sidebar'='Installation Costs', 'help'='cc_pv' } );
addpage( [[ 'Operating Costs', 'Operating Costs Land Lease' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_merchant_plant_pages();
setup_electricity_purchases();
//-----------------------------------------------------
setconfig( 'High-X Concentrating PV', 'LCOE Calculator' );
setmodules( ['hcpv', 'grid', 'lcoefcr']);
setup_hcpv_pages();
setup_lcoefcr_pages();
//-----------------------------------------------------
setconfig( 'High-X Concentrating PV', 'None' );
setmodules( ['hcpv', 'grid']);
setup_hcpv_pages();

// Dish Stirling ///////////////////////////////////////////////////////////////
/* //Dish Stirling has become outdated and does not have funding support to be updated and will thus be hidden beginning with the next major release
function setup_dish_stirling_pages()
{
	addpage( [[ 'Solar Resource Data' ]], { 'sidebar'='Location and Resource', 'help'='dish_location_and_resource' } );
	addpage( [[ 'Dish Solar Field' ]], { 'sidebar'='Solar Field', 'help'='dish_solar_field' } );
	addpage( [[ 'Dish Collector' ]], { 'sidebar'='Collector', 'help'='dish_collector' } );
	addpage( [[ 'Dish Receiver' ]], { 'sidebar'='Receiver', 'help'='dish_receiver' } );
	addpage( [[ 'Dish Stirling Engine' ]], { 'sidebar'='Stirling Engine', 'help'='dish_stirling_engine' } );
	addpage( [[ 'Dish Parasitics' ]], { 'sidebar'='Parasitics', 'help'='dish_parasitics' } );
	addpage( [[ 'Dish Reference Inputs' ]], { 'sidebar'='Reference Inputs', 'help'='dish_reference_inputs' } );
	setup_grid_limits_page();
}

//-----------------------------------------------------
setconfig( 'Dish Stirling', 'Commercial' );
setmodules( ['tcsdish', 'grid', 'utilityrate5', 'cashloan']);
setup_dish_stirling_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Dish Capital Costs','O and M Costs']],{ 'sidebar'='System Costs', 'help'='dish_system_costs' } );
setup_commercial_pages(LOAD_SIMPLE); //belpe not valid for commercial
//-----------------------------------------------------
setconfig( 'Dish Stirling', 'Leveraged Partnership Flip' );
setmodules( ['tcsdish', 'grid', 'utilityrate5', 'levpartflip']);
setup_dish_stirling_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Dish Capital Costs','O and M Costs']],{ 'sidebar'='System Costs', 'help'='dish_system_costs' } );
setup_leveraged_partnership_flip_pages();
//-----------------------------------------------------
setconfig( 'Dish Stirling', 'All Equity Partnership Flip' );
setmodules( ['tcsdish', 'grid', 'utilityrate5', 'equpartflip']);
setup_dish_stirling_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Dish Capital Costs','O and M Costs']],{ 'sidebar'='System Costs', 'help'='dish_system_costs' } );
setup_all_equity_partnership_flip_pages();
//-----------------------------------------------------
setconfig( 'Dish Stirling', 'Sale Leaseback' );
setmodules( ['tcsdish', 'grid', 'utilityrate5', 'saleleaseback']);
setup_dish_stirling_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Dish Capital Costs','O and M Costs']],{ 'sidebar'='System Costs', 'help'='dish_system_costs' } );
setup_sale_leaseback_pages();
//-----------------------------------------------------
setconfig( 'Dish Stirling', 'Single Owner' );
setmodules( ['tcsdish', 'grid', 'singleowner']);
setup_dish_stirling_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Dish Capital Costs','O and M Costs']],{ 'sidebar'='System Costs', 'help'='dish_system_costs' } );
setup_single_owner_pages();
//-----------------------------------------------------
setconfig( 'Dish Stirling', 'Merchant Plant' );
setmodules( ['tcsdish', 'grid', 'merchantplant']);
setup_dish_stirling_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Dish Capital Costs','O and M Costs']],{ 'sidebar'='System Costs', 'help'='dish_system_costs' } );
setup_merchant_plant_pages();
//-----------------------------------------------------
setconfig( 'Dish Stirling', 'LCOE Calculator' );
setmodules( ['tcsdish', 'grid',  'lcoefcr']);
setup_dish_stirling_pages();
setup_lcoefcr_pages();
//-----------------------------------------------------
setconfig( 'Dish Stirling', 'None' );
setmodules( ['tcsdish', 'grid']);
setup_dish_stirling_pages();*/

// Biopower ////////////////////////////////////////////////////////////////////
function setup_biopower_pages()
{
	addpage( [[ 'Solar Resource Data' ]], { 'sidebar'='Ambient Conditions', 'help'='biopower_location_ambient_conditions' } );
	addpage( [[ 'Biopower Feedstock' ]], { 'sidebar'='Feedstock', 'help'='biopower_feedstock' } );
	addpage( [[ 'Biopower Plant Specifications' ]], { 'sidebar'='Plant Specs', 'help'='biopower_plant_specs' } );
	addpage( [[ 'Biopower Emissions Comparison' ]], { 'sidebar'='Emissions', 'help'='biopower_emissions' } );
	setup_grid_limits_page();
}

//-----------------------------------------------------
setconfig( 'Biopower', 'Leveraged Partnership Flip' );
setmodules( ['biomass', 'grid', 'utilityrate5', 'levpartflip']);
setup_biopower_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Biopower System Cost' ]],{ 'sidebar'='Installation Costs', 'help'='cc_biopower' } );
addpage( [[ 'Operating Costs' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
addpage( [[ 'Biopower Feedstock Costs' ]], { 'sidebar'='Feedstock Costs', 'help'='biopower_feedstock_costs' } );
setup_leveraged_partnership_flip_pages();
setup_electricity_purchases();
//-----------------------------------------------------
setconfig( 'Biopower', 'All Equity Partnership Flip' );
setmodules( ['biomass', 'grid', 'utilityrate5', 'equpartflip']);
setup_biopower_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Biopower System Cost' ]],{ 'sidebar'='Installation Costs', 'help'='cc_biopower' } );
addpage( [[ 'Operating Costs' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
addpage( [[ 'Biopower Feedstock Costs' ]], { 'sidebar'='Feedstock Costs', 'help'='biopower_feedstock_costs' } );
setup_all_equity_partnership_flip_pages();
setup_electricity_purchases();
//-----------------------------------------------------
setconfig( 'Biopower', 'Sale Leaseback' );
setmodules( ['biomass', 'grid', 'utilityrate5', 'saleleaseback']);
setup_biopower_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Biopower System Cost' ]],{ 'sidebar'='Installation Costs', 'help'='cc_biopower' } );
addpage( [[ 'Operating Costs' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
addpage( [[ 'Biopower Feedstock Costs' ]], { 'sidebar'='Feedstock Costs', 'help'='biopower_feedstock_costs' } );
setup_sale_leaseback_pages();
setup_electricity_purchases();
//-----------------------------------------------------
setconfig( 'Biopower', 'Single Owner' );
setmodules( ['biomass', 'grid', 'utilityrate5', 'singleowner']);
setup_biopower_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Biopower System Cost' ]],{ 'sidebar'='Installation Costs', 'help'='cc_biopower' } );
addpage( [[ 'Operating Costs' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
addpage( [[ 'Biopower Feedstock Costs' ]], { 'sidebar'='Feedstock Costs', 'help'='biopower_feedstock_costs' } );
setup_single_owner_pages();
setup_electricity_purchases();
//-----------------------------------------------------
setconfig( 'Biopower', 'Merchant Plant' );
setmodules( ['biomass', 'grid', 'utilityrate5', 'merchantplant']);
setup_biopower_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Biopower System Cost' ]],{ 'sidebar'='Installation Costs', 'help'='cc_biopower' } );
addpage( [[ 'Operating Costs' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
addpage( [[ 'Biopower Feedstock Costs' ]], { 'sidebar'='Feedstock Costs', 'help'='biopower_feedstock_costs' } );
setup_merchant_plant_pages();
setup_electricity_purchases();
//-----------------------------------------------------
setconfig( 'Biopower', 'LCOE Calculator' );
setmodules( ['biomass', 'grid', 'lcoefcr']);
setup_biopower_pages();
setup_lcoefcr_pages();
//-----------------------------------------------------
setconfig( 'Biopower', 'None' );
setmodules( ['biomass', 'grid']);
setup_biopower_pages();

// Molten Salt Power Tower ////////////////////////////////////////////////////////////////////
function setup_MSPT_pages(is_grid_limits)
{
	addpage( [[ 'Solar Resource Data' ]], { 'sidebar'='Location and Resource', 'help'='pt_location_and_resource' } );
	addpage( [[ 'MSPT System Design' ]], { 'sidebar'='System Design', 'help'='mspt_system_design' } );
	addpage( [[ 'Tower SolarPilot Solar Field' ]], { 'sidebar'='Heliostat Field', 'help'='mspt_heliostat_field' } );
	addpage( [[ 'MSPT Receiver External' ], [ 'MSPT Receiver Cavity' ]],
			{ 'sidebar'='Tower and Receiver', 'help'='mspt_tower_and_receiver', 'exclusive_var'='receiver_type',
			'exclusive_header_pages' = ['MSPT Receiver']} );
	addpage( [[ 'MSPT Parallel Heater' ]], { 'sidebar'='Electric HTF Heater', 'help' = 'mspt_electric_htf_heater' } );
	addpage( [[ 'Rankine Cycle' ], [ 'User-Defined Power Cycle' ]],
			{ 'sidebar'='Power Cycle', 'help'='mspt_power_cycle', 'exclusive_var' = 'pc_config',
			  'exclusive_header_pages' = ['Molten Salt Tower Power Block Common']} );
	addpage( [[ 'TES Direct Two Tank' ]], { 'sidebar'='Thermal Storage', 'help'='mspt_thermal_storage' } );
	addpage( [[ 'MSPT System Control' ,
	  {'name' = 'MSPT Dispatch Control', 'caption'='Dispatch Control', 'collapsible'=false, 'collapsible_var'='csp_dispatch_is_shown'} ]],
	  { 'sidebar'='System Control', 'help'='mspt_system_control' } );
  	if(is_grid_limits == 1){
		setup_grid_limits_page();
  	}
}

function setup_MSPT_IPH_pages()
{
	addpage( [[ 'Solar Resource Data' ]], { 'sidebar'='Location and Resource', 'help'='iph_mspt_location_and_resource' } );
	addpage( [[ 'MSPT IPH System Design' ]], { 'sidebar'='System Design', 'help'='iph_mspt_system_design' } );
	addpage( [[ 'Tower SolarPilot Solar Field' ]], { 'sidebar'='Heliostat Field', 'help'='iph_mspt_heliostat_field' } );
	addpage( [[ 'MSPT Receiver External' ], [ 'MSPT Receiver Cavity' ]],
			{ 'sidebar'='Tower and Receiver', 'help'='iph_mspt_tower_receiver', 'exclusive_var'='receiver_type',
			'exclusive_header_pages' = ['MSPT Receiver']} );
	//addpage( [[ 'MSPT Parallel Heater' ]], { 'sidebar'='Electric HTF Heater', 'help' = 'mspt_electric_htf_heater' } );
	addpage( [[ 'TES Direct Two Tank' ]], { 'sidebar'='Thermal Storage', 'help'='iph_mspt_thermal_storage' } );
	addpage( [[ 'MSPT IPH System Control' ,
	{'name' = 'MSPT IPH Dispatch Control', 'caption'='Dispatch Control', 'collapsible'=false, 'collapsible_var'='csp_dispatch_is_shown'} ]],
	  { 'sidebar'='System Control', 'help'='iph_mspt_system_control' } );
}

//-----------------------------------------------------
setconfig('MSPT', 'None');
setmodules( ['tcsmolten_salt']);
setup_MSPT_pages(0);
addpage( [['Sales Tax Rate Single Input','Tower SolarPilot Capital Costs' ]],{ 'sidebar'='Installation Costs', 'help'='cc_tower' } );
addpage( [['Financial Construction Financing']],{'sidebar'='Construction Financing'}); // 'Financial Tax and Insurance Rates']]); //, 'Financial Analysis Parameters']]);

//-----------------------------------------------------
setconfig('MSPT IPH', 'None');
setmodules( ['mspt_iph']);
setup_MSPT_IPH_pages();
addpage( [['Sales Tax Rate Single Input','MSPT IPH Capital Costs' ]],{ 'sidebar'='Installation Costs', 'help'='cc_tower' } );
addpage( [['Financial Construction Financing']],{'sidebar'='Construction Financing'}); // 'Financial Tax and Insurance Rates']]); //, 'Financial Analysis Parameters']]);

setconfig('MSPT IPH', 'LCOH Calculator');
setmodules( ['mspt_iph', 'lcoefcr_design']);	// 'iph_to_lcoefcr', 
setup_MSPT_IPH_pages();
addpage( [['Sales Tax Rate Single Input','MSPT IPH Capital Costs' ]],{ 'sidebar'='Installation Costs', 'help'='cc_tower' } );
addpage( [['Financial Construction Financing']],{'sidebar'='Construction Financing'}); // 'Financial Tax and Insurance Rates']]); //, 'Financial Analysis Parameters']]);
setup_iph_lcoefcr_cost_pages();

//-----------------------------------------------------
setconfig( 'MSPT', 'Leveraged Partnership Flip' );
setmodules( ['tcsmolten_salt', 'grid', 'utilityrate5', 'levpartflip']);
setup_MSPT_pages(1);
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Tower SolarPilot Capital Costs' ]],{ 'sidebar'='Installation Costs', 'help'='cc_tower' } );
addpage( [[ 'Operating Costs', 'Operating Costs Land Lease' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_leveraged_partnership_flip_pages();
setup_electricity_purchases();
//-----------------------------------------------------
setconfig( 'MSPT', 'All Equity Partnership Flip' );
setmodules( ['tcsmolten_salt', 'grid', 'utilityrate5', 'equpartflip']);
setup_MSPT_pages(1);
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Tower SolarPilot Capital Costs' ]],{ 'sidebar'='Installation Costs', 'help'='cc_tower' } );
addpage( [[ 'Operating Costs', 'Operating Costs Land Lease' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_all_equity_partnership_flip_pages();
setup_electricity_purchases();
//-----------------------------------------------------
setconfig( 'MSPT', 'Sale Leaseback' );
setmodules( ['tcsmolten_salt', 'grid', 'utilityrate5', 'saleleaseback']);
setup_MSPT_pages(1);
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Tower SolarPilot Capital Costs' ]],{ 'sidebar'='Installation Costs', 'help'='cc_tower' } );
addpage( [[ 'Operating Costs', 'Operating Costs Land Lease' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_sale_leaseback_pages();
setup_electricity_purchases();
//-----------------------------------------------------
setconfig( 'MSPT', 'Single Owner' );
setmodules( ['tcsmolten_salt', 'grid', 'utilityrate5', 'singleowner']);
setup_MSPT_pages(1);
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Tower SolarPilot Capital Costs' ]],{ 'sidebar'='Installation Costs', 'help'='cc_tower' } );
addpage( [[ 'Operating Costs', 'Operating Costs Land Lease' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_single_owner_pages();
setup_electricity_purchases();
//-----------------------------------------------------
setconfig( 'MSPT', 'Merchant Plant' );
setmodules( ['tcsmolten_salt', 'grid', 'utilityrate5', 'merchantplant']);
setup_MSPT_pages(1);
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Tower SolarPilot Capital Costs' ]],{ 'sidebar'='Installation Costs', 'help'='cc_tower' } );
addpage( [[ 'Operating Costs', 'Operating Costs Land Lease' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_merchant_plant_pages();
setup_electricity_purchases();

// Direct Steam Linear IPH ////////////
function setup_DSGL_IPH_pages()
{
	addpage( [[ 'Solar Resource Data' ]], { 'sidebar'='Location and Resource', 'help'='iph_linear_ds_location_and_resource' } );
	addpage( [[ 'LF DSG System Design' ]], { 'sidebar'='System Design', 'help'='iph_linear_ds_system_design' } );
	addpage( [[ 'LF DSG Solar Field' ]], { 'sidebar'='Solar Field', 'help'='iph_linear_ds_solar_field' } );
	addpage( [[ 'LF DSG Boiler Header', 'Linear Fresnel Boiler Geometry' ]], { 'sidebar'='Collector and Receiver', 'help'='iph_linear_ds_collector_receiver' } );
}

//--------------------------------------------------
setconfig( 'DSGL IPH', 'None' );
setmodules( ['linear_fresnel_dsg_iph'] );
setup_DSGL_IPH_pages();

setconfig( 'DSGL IPH', 'LCOH Calculator' );
setmodules( ['linear_fresnel_dsg_iph', 'iph_to_lcoefcr', 'lcoefcr'] );
setup_DSGL_IPH_pages();
setup_iph_lcoefcr_pages();


// Direct Steam Linear Fresnel ////////////////////////////////////////////////////////////////////
function setup_DSLF_pages()
{
	addpage( [[ 'Solar Resource Data' ]], { 'sidebar'='Location and Resource', 'help'='dslf_location_and_resource' } );
	addpage( [[ 'Linear Fresnel Solar Field' ]], { 'sidebar'='Solar Field', 'help'='dslf_solar_field' } );

	addpage( [[ 'Linear Fresnel Collector and Receiver Header',
	 {'name'='Linear Fresnel Boiler Geometry', 'caption'='Boiler Geometry', 'collapsible'=true, 'collapsible_var'='boiler_is_shown'},
	 {'name'='Linear Fresnel Superheater Geometry', 'caption'='Superheater Geometry', 'collapsible'=true, 'collapsible_var'='superheater_is_shown'} ]],
	 { 'sidebar'='Collector and Receiver', 'help'='dslf_collector_and_receiver' } );
	addpage( [[ 'PBNS Power Block', {'name' = 'CSP PBNS Dispatch Control', 'caption'='Dispatch Control', 'collapsible'=false, 'collapsible_var'='csp_dispatch_is_shown'}  ]], { 'sidebar'='Power Cycle', 'help'='dslf_power_cycle' } );
	addpage( [[ 'Linear Fresnel Parasitics' ]], { 'sidebar'='Parasitics', 'help'='dslf_parasitics' } );
 	setup_grid_limits_page();
}

//-----------------------------------------------------
setconfig( 'DSLF', 'LCOE Calculator' );
setmodules( ['tcslinear_fresnel', 'grid', 'lcoefcr']);
setup_DSLF_pages();
setup_lcoefcr_pages();

//-----------------------------------------------------
setconfig( 'DSLF', 'None' );
setmodules( ['tcslinear_fresnel', 'grid']);
setup_DSLF_pages();

//-----------------------------------------------------
setconfig( 'DSLF', 'Commercial' );
setmodules( ['tcslinear_fresnel', 'grid', 'utilityrate5', 'cashloan']);
setup_DSLF_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Linear Fresnel Capital Costs' ]], { 'sidebar'='Installation Costs', 'help'='cc_linear_fresnel' } );
addpage( [[ 'Operating Costs Fuel', 'Operating Costs Land Lease' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_commercial_pages(LOAD_SIMPLE); //belpe not valid for commercial
//-----------------------------------------------------
setconfig( 'DSLF', 'Leveraged Partnership Flip' );
setmodules( ['tcslinear_fresnel', 'grid', 'utilityrate5', 'levpartflip']);
setup_DSLF_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Linear Fresnel Capital Costs' ]], { 'sidebar'='Installation Costs', 'help'='cc_linear_fresnel' } );
addpage( [[ 'Operating Costs Fuel', 'Operating Costs Land Lease' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_leveraged_partnership_flip_pages();
setup_electricity_purchases();
//-----------------------------------------------------
setconfig( 'DSLF', 'All Equity Partnership Flip' );
setmodules( ['tcslinear_fresnel', 'grid', 'utilityrate5', 'equpartflip']);
setup_DSLF_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Linear Fresnel Capital Costs' ]], { 'sidebar'='Installation Costs', 'help'='cc_linear_fresnel' } );
addpage( [[ 'Operating Costs Fuel', 'Operating Costs Land Lease' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_all_equity_partnership_flip_pages();
setup_electricity_purchases();
//-----------------------------------------------------
setconfig( 'DSLF', 'Sale Leaseback' );
setmodules( ['tcslinear_fresnel', 'grid', 'utilityrate5', 'saleleaseback']);
setup_DSLF_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Linear Fresnel Capital Costs' ]], { 'sidebar'='Installation Costs', 'help'='cc_linear_fresnel' } );
addpage( [[ 'Operating Costs Fuel', 'Operating Costs Land Lease' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_sale_leaseback_pages();
setup_electricity_purchases();
//-----------------------------------------------------
setconfig( 'DSLF', 'Single Owner' );
setmodules( ['tcslinear_fresnel', 'grid', 'utilityrate5', 'singleowner']);
setup_DSLF_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Linear Fresnel Capital Costs' ]], { 'sidebar'='Installation Costs', 'help'='cc_linear_fresnel' } );
addpage( [[ 'Operating Costs Fuel', 'Operating Costs Land Lease' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_single_owner_pages();
setup_electricity_purchases();
//-----------------------------------------------------
setconfig( 'DSLF', 'Merchant Plant' );
setmodules( ['tcslinear_fresnel', 'grid', 'utilityrate5', 'merchantplant']);
setup_DSLF_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'Linear Fresnel Capital Costs' ]], { 'sidebar'='Installation Costs', 'help'='cc_linear_fresnel' } );
addpage( [[ 'Operating Costs Fuel', 'Operating Costs Land Lease' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_merchant_plant_pages();
setup_electricity_purchases();
//-----------------------------------------------------

// NEW Molten Salt Linear Fresnel ////////////////////////////////////////////////////////////////////
function setup_MSLF_pages()
{
	addpage( [[ 'Solar Resource Data' ]], { 'sidebar'='Location and Resource', 'help'='mslf_location_and_resource' } );
	addpage( [[ 'MSLF System Design' ]], { 'sidebar'='System Design', 'help'='mslf_system_design' } );
	addpage( [[ 'MSLF Solar Field' ]], { 'sidebar'='Solar Field', 'help'='mslf_solar_field' } );

	addpage( [[ 'MSLF Collector and Receiver' ]],
		{ 'sidebar'='Collector and Receiver', 'help'='mslf_collector_and_receiver' } );

	addpage( [[ 'Rankine Cycle' ], [ 'User Defined Power Cycle' ]],
		{ 'sidebar'='Power Cycle', 'help'='mslf_power_cycle', 'exclusive_var' = 'pc_config',
		'exclusive_header_pages' = ['MSLF Power Cycle Common']} );

	addpage( [[ 'MSLF Storage' ]], { 'sidebar'='Thermal Storage', 'help'='mslf_thermal_storage' } );

	addpage( [[ 'MSLF System Control' ,
		{'name' = 'MSLF Dispatch Control', 'caption'='Dispatch Control', 'collapsible'=false, 'collapsible_var'='csp_dispatch_is_shown'} ]],
		{ 'sidebar'='System Control', 'help'='mslf_system_control' } );
		
 	setup_grid_limits_page();
}

//-----------------------------------------------------
//setconfig( 'MSLF_v2', 'LCOE Calculator' );
//setmodules( ['fresnel_physical', 'grid', 'lcoefcr']);
//setup_MSLF_v2_pages();
//setup_lcoefcr_pages();

//-----------------------------------------------------
//setconfig( 'MSLF_v2', 'None' );
//setmodules( ['fresnel_physical', 'grid']);
//setup_MSLF_v2_pages();

//-----------------------------------------------------
//setconfig( 'MSLF_v2', 'Commercial' );
//setmodules( ['fresnel_physical', 'grid', 'utilityrate5', 'cashloan']);
//setup_MSLF_v2_pages();
//setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
//addpage( [[ 'MSLF_v2 Capital Costs' ]], { 'sidebar'='Installation Costs', 'help'='cc_linear_fresnel' } );
//addpage( [[ 'Operating Costs Fuel', 'Operating Costs Land Lease' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
//setup_commercial_pages(LOAD_SIMPLE); //belpe not valid for commercial
//-----------------------------------------------------
setconfig( 'MSLF', 'Leveraged Partnership Flip' );
setmodules( ['fresnel_physical', 'grid', 'utilityrate5', 'levpartflip']);
setup_MSLF_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'MSLF Capital Costs' ]], { 'sidebar'='Installation Costs', 'help'='cc_linear_fresnel' } );
addpage( [[ 'Operating Costs Fuel', 'Operating Costs Land Lease' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_leveraged_partnership_flip_pages();
setup_electricity_purchases();
//-----------------------------------------------------
setconfig( 'MSLF', 'All Equity Partnership Flip' );
setmodules( ['fresnel_physical', 'grid', 'utilityrate5', 'equpartflip']);
setup_MSLF_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'MSLF Capital Costs' ]], { 'sidebar'='Installation Costs', 'help'='cc_linear_fresnel' } );
addpage( [[ 'Operating Costs Fuel', 'Operating Costs Land Lease' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_all_equity_partnership_flip_pages();
setup_electricity_purchases();
//-----------------------------------------------------
setconfig( 'MSLF', 'Sale Leaseback' );
setmodules( ['fresnel_physical', 'grid', 'utilityrate5', 'saleleaseback']);
setup_MSLF_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'MSLF Capital Costs' ]], { 'sidebar'='Installation Costs', 'help'='cc_linear_fresnel' } );
addpage( [[ 'Operating Costs Fuel', 'Operating Costs Land Lease' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_sale_leaseback_pages();
setup_electricity_purchases();
//-----------------------------------------------------
setconfig( 'MSLF', 'Single Owner' );
setmodules( ['fresnel_physical', 'grid', 'utilityrate5', 'singleowner']);
setup_MSLF_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'MSLF Capital Costs' ]], { 'sidebar'='Installation Costs', 'help'='cc_linear_fresnel' } );
addpage( [[ 'Operating Costs Fuel', 'Operating Costs Land Lease' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_single_owner_pages();
setup_electricity_purchases();
//-----------------------------------------------------
setconfig( 'MSLF', 'Merchant Plant' );
setmodules( ['fresnel_physical', 'grid', 'utilityrate5', 'merchantplant']);
setup_MSLF_pages();
setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
addpage( [[ 'MSLF Capital Costs' ]], { 'sidebar'='Installation Costs', 'help'='cc_linear_fresnel' } );
addpage( [[ 'Operating Costs Fuel', 'Operating Costs Land Lease' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_merchant_plant_pages();
setup_electricity_purchases();
//-----------------------------------------------------

function setup_MSLF_IPH_pages()
{
	addpage( [[ 'Solar Resource Data' ]], { 'sidebar'='Location and Resource', 'help'='iph_mslf_location_and_resource' } );
	addpage( [[ 'MSLF IPH System Design' ]], { 'sidebar'='System Design', 'help'='iph_mslf_system_design' } );
	addpage( [[ 'MSLF Solar Field' ]], { 'sidebar'='Solar Field', 'help'='iph_mslf_solar_field' } );

	addpage( [[ 'MSLF Collector and Receiver' ]],
		{ 'sidebar'='Collector and Receiver', 'help'='iph_mslf_collector_receiver' } );

	addpage( [[ 'MSLF Storage' ]], { 'sidebar'='Thermal Storage', 'help'='iph_mslf_thermal_storage' } );

	addpage( [[ 'MSLF IPH System Control' ,
		{'name' = 'MSLF IPH Dispatch Control', 'caption'='Dispatch Control', 'collapsible'=false, 'collapsible_var'='csp_dispatch_is_shown'} ]],
		{ 'sidebar'='System Control', 'help'='iph_mslf_system_control' } );
}

//-----------------------------------------------------
setconfig('MSLF IPH', 'None');
setmodules( ['fresnel_physical_iph']);
setup_MSLF_IPH_pages();
addpage( [['Sales Tax Rate Single Input','MSLF IPH Capital Costs' ]],{ 'sidebar'='Installation Costs', 'help'='cc_linear_fresnel' } );
addpage( [['Financial Construction Financing']],{'sidebar'='Construction Financing'}); // 'Financial Tax and Insurance Rates']]); //, 'Financial Analysis Parameters']]);

//-----------------------------------------------------
setconfig('MSLF IPH', 'LCOH Calculator');
setmodules( ['fresnel_physical_iph', 'lcoefcr_design']);	// 'iph_to_lcoefcr', 
setup_MSLF_IPH_pages();
addpage( [['Sales Tax Rate Single Input','MSLF IPH Capital Costs' ]],{ 'sidebar'='Installation Costs', 'help'='cc_linear_fresnel' } );
addpage( [['Financial Construction Financing']],{'sidebar'='Construction Financing'}); // 'Financial Tax and Insurance Rates']]); //, 'Financial Analysis Parameters']]);
setup_iph_lcoefcr_cost_pages();

// Marine Energy ////////////////////////////////////////////////////////////////////
function setup_mewave_pages(lcoe_fcr)
{
	addpage( [[ {'name'='Marine Wave Resource', 'caption'='Frequency of Occurrence'}],[ {'name'='Marine Wave Resource Time Series', 'caption'='Time Series'}]],
			  { 'sidebar'='Wave Resource', 'help'='me_wave_resource', 'exclusive_header_pages'=['Marine Wave Resource Header'], 'exclusive_var'='wave_resource_model_choice', 'exclusive_hide' = true } );
	addpage( [[ 'Marine Wave Converter' ]], { 'sidebar'='Wave Energy Converter', 'help'='me_wave_converter' } );
	addpage( [[ 'Marine Array' ]], { 'sidebar'='Array', 'help'='me_wave_array' } );
	addpage( [[ 'Marine Losses', 'Marine Availability']], { 'sidebar'='Losses', 'help'='me_wave_losses' } );
	if (lcoe_fcr == 1) {
		addpage( [[ 'Marine Costs - Device Costs',{'name'='Marine Costs - Structural Assembly','caption' = 'Structural Assembly Cost Breakdown','collapsible'=true,'collapsible_var'='stuctural_assem_shown'},
			{'name'='Marine Costs - PTO','caption'= 'Power Take-off System Cost Breakdown','collapsible'=true,'collapsible_var'='pto_shown'},
			{'name'='Marine Costs - Mooring','caption'='Mooring, Foundation, and Substructure Cost Breakdown','collapsible'=true,'collapsible_var'='mooring_shown'}]],
			{ 'sidebar'='Capital Costs: Device', 'help'='cc_marine_energy'} );
		addpage( [[ 'Marine Costs - BoS',{'name'='Marine Costs - Development','caption' = 'Development Cost Breakdown','collapsible'=true,'collapsible_var'='development_shown'},
			{'name'='Marine Costs - E&M','caption' = 'Engineering and Management Cost Breakdown','collapsible'=true,'collapsible_var'='e&m_shown'},
			{'name'='Marine Costs - Electrical Infrastructure','caption' = 'Electrical Infrastructure Cost Breakdown','collapsible'=true,'collapsible_var'='elec_infrac_shown'},
			{'name'='Marine Costs - Site Access, Port & Staging','caption'= 'Site Access, Port and Staging Cost Breakdown','collapsible'=true,'collapsible_var'='site_access_shown'},
			{'name'='Marine Costs - Assembly & Installation','caption'= 'Assembly and Installation Cost Breakdown','collapsible'=true,'collapsible_var'='assem_install_shown'},
			{'name'='Marine Costs - Other Infrastructure','caption' = 'Other Infrastructure Cost Breakdown','collapsible'=true,'collapsible_var'='assem_other_infras_shown'} ]],
			{ 'sidebar'='Capital Costs: BOS','help'='cc_marine_energy'} );
		/*addpage( [[ 'Marine Costs - Financial',{'name'='Marine Costs - Project Contingency Budget','caption'='Project Contingency Budget','collapsible'=true,'collapsible_var'='project_conting_shown'},
			{'name'='Marine Costs - Insurance During Construction','caption'='Insurance During Construction','collapsible'=true,'collapsible_var'='ins_during_const_shown'},
			{'name'='Marine Costs - Construction Financing Costs','caption'='Construction Financing Costs','collapsible'=true,'collapsible_var'='const_finance_costs_shown'},
			{'name'='Marine Costs - Reserve Costs','caption'='Reserve Costs','collapsible'=true,'collapsible_var'='reserve_costs_shown'},
			{'name'='Marine Costs - Other Financial Costs','caption'='Other Financial Costs','collapsible'=true,'collapsible_var'='other_finance_costs_shown'} ]],
			{'sidebar'='Financial Costs','help'='me_wave_capital_costs'} );*/
		addpage( [[ 'Marine Costs - Financial', {'name'='Marine Costs - Financial Itemized','caption'='Reserve Accounts Cost Breakdown','collapsible'=true,'collapsible_var'='financial_itemized_shown'}]],
			{'sidebar'='Capital Costs: Financial','help'='cc_marine_energy'});
		addpage( [[ 'Marine Costs - O&M', {'name'='Marine Costs - Operations','caption'='Operations Cost Breakdown','collapsible'=true,'collapsible_var'='opex_we_shown'},
			{'name'='Marine Costs - Maintenance','caption'='Maintenance Cost Breakdown','collapsible'=true,'collapsible_var'='maintenance_we_shown'} ]],
			{'sidebar'='O&M Costs','help'='oc_marine_energy'} );
	}

}

function setup_mewave_so()
{
	addpage( [[ {'name'='Marine Wave Resource Time Series', 'caption'='Time Series'}]],
			  { 'sidebar'='Wave Resource', 'help'='me_wave_resource'} );
	addpage( [[ 'Marine Wave Converter' ]], { 'sidebar'='Wave Energy Converter', 'help'='me_wave_converter' } );
	addpage( [[ 'Marine Array']], { 'sidebar'='Array', 'help'='me_wave_array' } );
	addpage( [[ 'Marine Losses', 'Marine Availability']], { 'sidebar'='Losses', 'help'='me_wave_losses' } );
	setup_grid_limits_page();
	setup_lifetime_page(DEGRADATION_AC_SINGLE_YEAR);
	addpage( [[ 'Marine Costs - Device Costs',{'name'='Marine Costs - Structural Assembly','caption' = 'Structural Assembly Cost Breakdown','collapsible'=true,'collapsible_var'='stuctural_assem_shown'},
		{'name'='Marine Costs - PTO','caption'= 'Power Take-off System Cost Breakdown','collapsible'=true,'collapsible_var'='pto_shown'},
		{'name'='Marine Costs - Mooring','caption'='Mooring, Foundation, and Substructure Cost Breakdown','collapsible'=true,'collapsible_var'='mooring_shown'}]],
		{ 'sidebar'='Capital Costs: Device', 'help'='cc_marine_energy'} );
	addpage( [[ 'Marine Costs - BoS',{'name'='Marine Costs - Development','caption' = 'Development Cost Breakdown','collapsible'=true,'collapsible_var'='development_shown'},
		{'name'='Marine Costs - E&M','caption' = 'Engineering and Management Cost Breakdown','collapsible'=true,'collapsible_var'='e&m_shown'},
		{'name'='Marine Costs - Electrical Infrastructure','caption' = 'Electrical Infrastructure Cost Breakdown','collapsible'=true,'collapsible_var'='elec_infrac_shown'},
		{'name'='Marine Costs - Site Access, Port & Staging','caption'= 'Site Access, Port and Staging Cost Breakdown','collapsible'=true,'collapsible_var'='site_access_shown'},
		{'name'='Marine Costs - Assembly & Installation','caption'= 'Assembly and Installation Cost Breakdown','collapsible'=true,'collapsible_var'='assem_install_shown'},
		{'name'='Marine Costs - Other Infrastructure','caption' = 'Other Infrastructure Cost Breakdown','collapsible'=true,'collapsible_var'='assem_other_infras_shown'} ]],
		{ 'sidebar'='Capital Costs: BOS','help'='cc_marine_energy'} );
	addpage( [[ 'Marine Costs - Financial', {'name'='Marine Costs - Financial Itemized','caption'='Reserve Accounts Cost Breakdown','collapsible'=true,'collapsible_var'='financial_itemized_shown'}]],
		{'sidebar'='Capital Costs: Financial','help'='cc_marine_energy'});
	addpage( [[ 'Marine Costs - O&M', {'name'='Marine Costs - Operations','caption'='Operations Cost Breakdown','collapsible'=true,'collapsible_var'='opex_we_shown'},
		{'name'='Marine Costs - Maintenance','caption'='Maintenance Cost Breakdown','collapsible'=true,'collapsible_var'='maintenance_we_shown'} ]],
		{'sidebar'='O&M Costs','help'='oc_marine_energy'} );
	

}

function setup_mewave_batt_so()
{
	addpage( [[ {'name'='Marine Wave Resource Time Series', 'caption'='Time Series'}]],
			  { 'sidebar'='Wave Resource', 'help'='me_wave_resource'} );
	addpage( [[ 'Marine Wave Converter', 'Battery Enable' ]], { 'sidebar'='Wave Energy Converter', 'help'='me_wave_converter' } );
	addpage( [[ 'Marine Array' ]], { 'sidebar'='Array', 'help'='me_wave_array' } );
	addpage( [[ 'Marine Losses', 'Marine Availability']], { 'sidebar'='Losses', 'help'='me_wave_losses' } );
	setup_pages_battery_cell_and_system(false, false); // No REopt and FOM
	setup_pages_battery_life();
	setup_pages_pv_battery_dispatch_fom();
	setup_grid_limits_page();
	setup_lifetime_page(DEGRADATION_AC_LIFETIME);
	addpage( [[ 'Marine Costs - Device Costs',{'name'='Marine Costs - Structural Assembly','caption' = 'Structural Assembly Cost Breakdown','collapsible'=true,'collapsible_var'='stuctural_assem_shown'},
		{'name'='Marine Costs - PTO','caption'= 'Power Take-off System Cost Breakdown','collapsible'=true,'collapsible_var'='pto_shown'},
		{'name'='Marine Costs - Mooring','caption'='Mooring, Foundation, and Substructure Cost Breakdown','collapsible'=true,'collapsible_var'='mooring_shown'}]],
		{ 'sidebar'='Capital Costs: Device','help'='cc_marine_energy'} );
	addpage( [[ 'Marine Costs - Battery']],{'sidebar'='Capital Costs: Battery', 'help'='cc_standalone_battery'} );
	addpage( [[ 'Marine Costs - BoS',{'name'='Marine Costs - Development','caption' = 'Development Cost Breakdown','collapsible'=true,'collapsible_var'='development_shown'},
		{'name'='Marine Costs - E&M','caption' = 'Engineering and Management Cost Breakdown','collapsible'=true,'collapsible_var'='e&m_shown'},
		{'name'='Marine Costs - Electrical Infrastructure','caption' = 'Electrical Infrastructure Cost Breakdown','collapsible'=true,'collapsible_var'='elec_infrac_shown'},
		{'name'='Marine Costs - Site Access, Port & Staging','caption'= 'Site Access, Port and Staging Cost Breakdown','collapsible'=true,'collapsible_var'='site_access_shown'},
		{'name'='Marine Costs - Assembly & Installation','caption'= 'Assembly and Installation Cost Breakdown','collapsible'=true,'collapsible_var'='assem_install_shown'},
		{'name'='Marine Costs - Other Infrastructure','caption' = 'Other Infrastructure Cost Breakdown','collapsible'=true,'collapsible_var'='assem_other_infras_shown'} ]],
		{ 'sidebar'='Capital Costs: BOS','help'='cc_marine_energy'} );
	addpage( [[ 'Marine Costs - Financial', {'name'='Marine Costs - Financial Itemized','caption'='Reserve Accounts Cost Breakdown','collapsible'=true,'collapsible_var'='financial_itemized_shown'}]],
		{'sidebar'='Capital Costs: Financial','help'='cc_marine_energy'});
	addpage( [[ 'Marine Costs - O&M', {'name'='Marine Costs - Operations','caption'='Operations Cost Breakdown','collapsible'=true,'collapsible_var'='opex_we_shown'},
		{'name'='Marine Costs - Maintenance','caption'='Maintenance Cost Breakdown','collapsible'=true,'collapsible_var'='maintenance_we_shown'},
		{'name'='Marine Costs - Battery O&M','caption'='Battery Operations and Maintenance Costs','collapsible'=true,'collapsible_var'='batt_om_we_shown'} ]],
		{'sidebar'='O&M Costs','help'='oc_marine_energy'} );
	

}

setconfig( 'MEwave', 'LCOE Calculator' );
setmodules( ['wave_file_reader', 'mhk_wave', 'lcoefcr']);
//setmodules( ['mhk_wave', 'lcoefcr']);
setup_mewave_pages(1);
addpage( [[ 'Financial LCOE Calc with Costs Page']], { 'sidebar'='Financial Parameters', 'help'='fin_lcoefcr'} );
//-----------------------------------------------------
setconfig( 'MEwave', 'None' );
setmodules( ['wave_file_reader', 'mhk_wave']);
setup_mewave_pages(0);

setconfig( 'MEwave', 'Single Owner' );
setmodules( ['wave_file_reader', 'mhk_wave', 'grid', 'utilityrate5','singleowner']);
setup_mewave_so();
setup_single_owner_pages( );
setup_electricity_purchases();

setconfig('MEwave Battery', 'Single Owner' );
setmodules( ['wave_file_reader', 'mhk_wave', 'battery', 'grid', 'utilityrate5', 'singleowner']);
setup_mewave_batt_so();
setup_single_owner_pages();
setup_electricity_purchases();



function setup_metidal_pages(lcoe_fcr)
{
	addpage( [[ 'Marine Tidal Resource'], ['Marine Tidal Resource File']], { 'sidebar'='Tidal Resource', 'help'='me_tidal_resource', 'exclusive_header_pages'=['Marine Tidal Resource Header'],'exclusive_var'='tidal_resource_model_choice', 'exclusive_hide' = true } );
	addpage( [[ {'name'='Marine Tidal Converter', 'caption'='Tidal Converter Library'}],
			[{'name'='Marine Tidal Converter User', 'caption'='Tidal Converter Input'}],
			[{'name'='Marine Tidal Turbine Design', 'caption'='Tidal Converter Design'}]], 
		{ 'sidebar'='Tidal Energy Converter', 'help'='me_tidal_converter', 'exclusive_var'='tidal_design_excl','exclusive_tab'=true, 'exclusive_hide'=true, 'exclusive_header_pages'=['Marine Tidal Converter Header'] } );
	addpage( [[ 'Marine Array' ]], { 'sidebar'='Array', 'help'='me_tidal_array' } );
	addpage( [[ 'Marine Losses', 'Marine Availability' ]], { 'sidebar'='Losses', 'help'='me_tidal_losses' } );
	if (lcoe_fcr == 1) {
		addpage( [[ 'Marine Costs - Device Costs',{'name'='Marine Costs - Structural Assembly','caption' = 'Structural Assembly Cost Breakdown','collapsible'=true,'collapsible_var'='stuctural_assem_shown'},
			{'name'='Marine Costs - PTO','caption'= 'Power Take-off System Cost Breakdown','collapsible'=true,'collapsible_var'='pto_shown'},
			{'name'='Marine Costs - Mooring','caption'='Mooring, Foundation, and Substructure Cost Breakdown','collapsible'=true,'collapsible_var'='mooring_shown'}]],
			{ 'sidebar'='Capital Costs: Device','help'='cc_marine_energy'} );
		addpage( [[ 'Marine Costs - BoS',{'name'='Marine Costs - Development','caption' = 'Development Cost Breakdown','collapsible'=true,'collapsible_var'='development_shown'},
			{'name'='Marine Costs - E&M','caption' = 'Engineering and Management Cost Breakdown','collapsible'=true,'collapsible_var'='e&m_shown'},
			{'name'='Marine Costs - Electrical Infrastructure','caption' = 'Electrical Infrastructure Cost Breakdown','collapsible'=true,'collapsible_var'='elec_infrac_shown'},
			{'name'='Marine Costs - Site Access, Port & Staging','caption'= 'Site Access, Port and Staging Cost Breakdown','collapsible'=true,'collapsible_var'='site_access_shown'},
			{'name'='Marine Costs - Assembly & Installation','caption'= 'Assembly and Installation Cost Breakdown','collapsible'=true,'collapsible_var'='assem_install_shown'},
			{'name'='Marine Costs - Other Infrastructure','caption' = 'Other Infrastructure Cost Breakdown','collapsible'=true,'collapsible_var'='assem_other_infras_shown'} ]],
			{ 'sidebar'='Capital Costs: BOS','help'='cc_marine_energy'} );
		addpage( [[ 'Marine Costs - Financial',{'name'='Marine Costs - Financial Itemized','caption' = 'Reserve Accounts Cost Breakdown', 'collapsible' = true,'collapsible_var'='financial_itemized_shown'}]],
			{'sidebar'='Capital Costs: Financial','help'='cc_marine_energy'});
		addpage( [[ 'Marine Costs - O&M', {'name'='Marine Costs - Operations','caption'='Operations Cost Breakdown','collapsible'=true,'collapsible_var'='opex_we_shown'},
			{'name'='Marine Costs - Maintenance','caption'='Maintenance Cost Breakdown','collapsible'=true,'collapsible_var'='maintenance_we_shown'} ]],
			{'sidebar'='O&M Costs','help'='oc_marine_energy'} );
	}
}
setconfig( 'MEtidal', 'LCOE Calculator' );
setmodules( ['tidal_file_reader', 'mhk_tidal', 'lcoefcr']);
setup_metidal_pages(1);
addpage( [[ 'Financial LCOE Calc with Costs Page']], { 'sidebar'='Financial Parameters', 'help'='fin_lcoefcr'} );

setconfig( 'MEtidal', 'None' );
setmodules( ['tidal_file_reader', 'mhk_tidal'] );
setup_metidal_pages(0);

// Battery /////////////////////////////////////////////////////////////////////

// PV Battery //////////////////////////////////////////////////////////////

function setup_pv_battery_pages(is_btm)
{
	addpage( [[ 'Solar Resource Data', {'name'='PV Albedo and Radiation', 'caption' = 'Albedo - Sky Diffuse Model - Irradiance Data (Advanced)', 'collapsible'=true, 'collapsible_var'='pv.radmode.is_shown'} ]], { 'sidebar'='Location and Resource', 'bin_name'='PV','help'='pv_location_and_resource' } );
	addpage( [ ['Simple Efficiency Module Model'],
//				['CEC Performance Model with Module Database', { 'name'='Test 1', 'collapsible'=true, 'collapsible_var'='pv.module.test_1.is_shown' }],
				['CEC Performance Model with Module Database'],
				['CEC Performance Model with User Entered Specifications'],
				['Sandia PV Array Performance Model with Module Database'],
				['IEC61853 Single Diode Model'] ],
			{ 'sidebar'='Module', 'help'='pv_module', 'exclusive_var'='module_model', 'bin_name'='PV' } );
	addpage( [ ['Inverter CEC Database', 'Inverter Temp Derate CEC DB'],
			 ['Inverter Datasheet', 'Inverter Temp Derate DS'],
			 ['Inverter Part Load Curve', 'Inverter Temp Derate PLC'],
			 ['Inverter CEC Coefficient Generator', 'Inverter Temp Derate CEC CG'] ],
			{ 'sidebar'='Inverter', 'help'='pv_inverter', 'exclusive_var'='inverter_model', 'bin_name'='PV' } );
	// Battery Enable form stores hidden en_batt variable required by some UI forms to determine if there is a battery
	addpage( [ ['PV System Design', 
	            {'name'='PV Land Area', 'caption' = 'Land Area', 'collapsible'=true, 'collapsible_var'='pv_land_area_is_shown'},
				{'name'='PV Subarray Voltage Mismatch', 'collapsible'=true, 'collapsible_var' = 'mismatch_shown'},
				'Battery Enable'] ], { 'sidebar'='System Design', 'help'='pv_system_design', 'bin_name'='PV' } );
	addpage( [ ['PV Shading'] ], { 'sidebar'='Shading and Layout', 'help'='pv_shading', 'bin_name'='PV' } );
	addpage( [ ['PV Losses'] ], { 'sidebar'='Losses', 'help'='pv_losses', 'bin_name'='PV' } );

	if (is_btm)
	{
		setup_pages_battery_cell_and_system(true,true); // REopt and BTM
		setup_pages_battery_life();
		setup_pages_battery_dispatch_btm();
		setup_grid_limits_page();
		setup_grid_outage_page();
	}
	else
	{
		setup_pages_battery_cell_and_system(false, false); // No REopt and FOM
		setup_pages_battery_life();
		setup_pages_pv_battery_dispatch_fom();
		setup_grid_limits_page();
	}
}

setconfig( 'PV Battery', 'Residential' );
setmodules( ['belpe', 'pvsamv1', 'grid', 'utilityrate5', 'cashloan']);
setup_pv_battery_pages(BTM);
setup_lifetime_page( DEGRADATION_PVSAM );
addpage( [[ 'PV Battery Capital Costs' ],
	[ 'PV Battery Capital Cost Curves', 'PV Capex Table', 'PV Capex Table AC', 'PV Capex Table Land', 'PV Capex Table Battery']], { 'sidebar'='Installation Costs', 'help'='cc_pv','exclusive_var'='pv_capex_cost_choice' } );
addpage( [[ 'Operating Costs PV Battery' ]], {'sidebar' = 'Operating Costs', 'help'='oc_pv-battery'} );
setup_residential_pages( LOAD_BELPE ); //includes building load calculator

setconfig( 'PV Battery', 'Commercial' );
setmodules( ['pvsamv1', 'grid', 'utilityrate5', 'cashloan']);
setup_pv_battery_pages(BTM);
setup_lifetime_page( DEGRADATION_PVSAM );
addpage( [[ 'PV Battery Capital Costs' ],
	[ 'PV Battery Capital Cost Curves', 'PV Capex Table', 'PV Capex Table AC', 'PV Capex Table Land', 'PV Capex Table Battery']], { 'sidebar'='Installation Costs', 'help'='cc_pv','exclusive_var'='pv_capex_cost_choice' } );
addpage( [[ 'Operating Costs PV Battery' ]], {'sidebar' = 'Operating Costs', 'help'='oc_pv-battery'} );
setup_commercial_pages( LOAD_SIMPLE ); //belpe not valid for commercial

setconfig( 'PV Battery', 'Third Party' );
setmodules( ['belpe', 'pvsamv1', 'grid', 'utilityrate5', 'thirdpartyownership']);
setup_pv_battery_pages(BTM);
setup_lifetime_page( DEGRADATION_PVSAM );
setup_thirdparty_pages( LOAD_BELPE ); //includes building load calculator by default in this function

setconfig( 'PV Battery', 'Host Developer' );
setmodules( ['pvsamv1', 'grid', 'utilityrate5', 'host_developer']);
setup_pv_battery_pages(BTM);
setup_lifetime_page( DEGRADATION_PVSAM );
addpage( [[ 'PV Battery Capital Costs' ],
		[ 'PV Battery Capital Cost Curves', 'PV Capex Table', 'PV Capex Table AC', 'PV Capex Table Land', 'PV Capex Table Battery']], { 'sidebar'='Installation Costs', 'help'='cc_pv','exclusive_var'='pv_capex_cost_choice' } );
addpage( [[ 'Operating Costs PV Battery' ]], {'sidebar' = 'Operating Costs', 'help'='oc_pv-battery'} );
setup_host_developer_pages( LOAD_SIMPLE ); //includes building load calculator by default in this function

setconfig( 'PV Battery', 'Single Owner' );
setmodules( ['pvsamv1', 'grid', 'utilityrate5', 'singleowner']);
setup_pv_battery_pages(FOM);
setup_lifetime_page( DEGRADATION_PVSAM );
addpage( [[ 'PV Battery Capital Costs' ],
		[ 'PV Battery Capital Cost Curves', 'PV Capex Table', 'PV Capex Table AC', 'PV Capex Table Land', 'PV Capex Table Battery']], { 'sidebar'='Installation Costs', 'help'='cc_pv','exclusive_var'='pv_capex_cost_choice' } );
addpage( [[ 'Operating Costs PV Battery', 'Operating Costs Land Lease' ]], {'sidebar' = 'Operating Costs', 'help'='oc_pv-battery'} );
setup_single_owner_pages( );
setup_electricity_purchases();

setconfig( 'PV Battery', 'Merchant Plant' );
setmodules( ['pvsamv1', 'grid', 'utilityrate5', 'merchantplant']);
setup_pv_battery_pages(FOM);
setup_lifetime_page( DEGRADATION_PVSAM );
addpage( [[ 'PV Battery Capital Costs' ],
		[ 'PV Battery Capital Cost Curves', 'PV Capex Table', 'PV Capex Table AC', 'PV Capex Table Land', 'PV Capex Table Battery']], { 'sidebar'='Installation Costs', 'help'='cc_pv','exclusive_var'='pv_capex_cost_choice' } );
addpage( [[ 'Operating Costs PV Battery', 'Operating Costs Land Lease' ]], {'sidebar' = 'Operating Costs', 'help'='oc_pv-battery'} );
setup_merchant_plant_pages( );
setup_electricity_purchases();

setconfig( 'PV Battery', 'Leveraged Partnership Flip' );
setmodules( ['pvsamv1', 'grid', 'utilityrate5', 'levpartflip']);
setup_pv_battery_pages(FOM);
setup_lifetime_page( DEGRADATION_PVSAM );
addpage( [[ 'PV Battery Capital Costs' ],
		[ 'PV Battery Capital Cost Curves', 'PV Capex Table', 'PV Capex Table AC', 'PV Capex Table Land', 'PV Capex Table Battery']], { 'sidebar'='Installation Costs', 'help'='cc_pv','exclusive_var'='pv_capex_cost_choice' } );
addpage( [[ 'Operating Costs PV Battery', 'Operating Costs Land Lease' ]], {'sidebar' = 'Operating Costs', 'help'='oc_pv-battery'} );
setup_leveraged_partnership_flip_pages( );
setup_electricity_purchases();

setconfig( 'PV Battery', 'All Equity Partnership Flip' );
setmodules( ['pvsamv1', 'grid', 'utilityrate5', 'equpartflip']);
setup_pv_battery_pages(FOM);
setup_lifetime_page( DEGRADATION_PVSAM );
addpage( [[ 'PV Battery Capital Costs' ],
		[ 'PV Battery Capital Cost Curves', 'PV Capex Table', 'PV Capex Table AC', 'PV Capex Table Land', 'PV Capex Table Battery']], { 'sidebar'='Installation Costs', 'help'='cc_pv','exclusive_var'='pv_capex_cost_choice' } );
addpage( [[ 'Operating Costs PV Battery', 'Operating Costs Land Lease' ]], {'sidebar' = 'Operating Costs', 'help'='oc_pv-battery'} );
setup_all_equity_partnership_flip_pages( );
setup_electricity_purchases();

setconfig( 'PV Battery', 'Sale Leaseback' );
setmodules( ['pvsamv1', 'grid', 'utilityrate5', 'saleleaseback']);
setup_pv_battery_pages(FOM);
setup_lifetime_page( DEGRADATION_PVSAM );
addpage( [[ 'PV Battery Capital Costs' ],
		[ 'PV Battery Capital Cost Curves', 'PV Capex Table', 'PV Capex Table AC', 'PV Capex Table Land', 'PV Capex Table Battery']], { 'sidebar'='Installation Costs', 'help'='cc_pv','exclusive_var'='pv_capex_cost_choice' } );
addpage( [[ 'Operating Costs PV Battery', 'Operating Costs Land Lease' ]], {'sidebar' = 'Operating Costs', 'help'='oc_pv-battery'} );
setup_sale_leaseback_pages( );
setup_electricity_purchases();

// Generic Battery /////////////////////////////////////////////////////////

function setup_generic_battery_pages(is_btm) {
	addpage( [[ 'Custom Generation Plant', 'Battery Enable' ]], { 'sidebar'='Generation Profile' , 'help'='custom_generation_profile' } );
	if (is_btm)
	{
		setup_pages_battery_cell_and_system(false, true); // No REopt and BTM
		setup_pages_battery_life();
		setup_pages_battery_dispatch_btm();
		setup_grid_limits_page();
		setup_grid_outage_page();
	}
	else
	{
		setup_pages_battery_cell_and_system(false, false); // No REopt and FOM
		setup_pages_battery_life();
		setup_pages_pv_battery_dispatch_fom(); // want pv smoothing for custom generation profile with measured pv data option
		setup_grid_limits_page();
	}
}

setconfig( 'Custom Generation Battery', 'Residential' );
setmodules( ['custom_generation', 'battery',  'grid', 'utilityrate5', 'cashloan']);
setup_generic_battery_pages(BTM);
setup_lifetime_page( DEGRADATION_AC_LIFETIME );
addpage( [[ 'Custom Generation Battery Costs']],{ 'sidebar'='Installation Costs', 'help'='cc_custom_generation' } );
addpage( [[ 'Operating Costs Custom Generation Battery' ]], {'sidebar' = 'Operating Costs', 'help'='oc_battery'} );
setup_residential_pages( LOAD_SIMPLE );

setconfig( 'Custom Generation Battery', 'Commercial' );
setmodules( ['custom_generation', 'battery',  'grid', 'utilityrate5', 'cashloan']);
setup_generic_battery_pages(BTM);
setup_lifetime_page( DEGRADATION_AC_LIFETIME );
addpage( [[ 'Custom Generation Battery Costs']],{ 'sidebar'='Installation Costs', 'help'='cc_custom_generation' } );
addpage( [[ 'Operating Costs Custom Generation Battery' ]], {'sidebar' = 'Operating Costs', 'help'='oc_battery'} );
setup_commercial_pages( LOAD_SIMPLE ); //does not include building load calculator

setconfig( 'Custom Generation Battery', 'Third Party' );
setmodules( ['custom_generation', 'battery', 'grid', 'utilityrate5', 'thirdpartyownership']);
setup_generic_battery_pages(BTM);
setup_lifetime_page( DEGRADATION_AC_LIFETIME );
setup_thirdparty_pages( LOAD_SIMPLE );

setconfig( 'Custom Generation Battery', 'Host Developer' );
setmodules( ['custom_generation', 'battery', 'grid', 'utilityrate5', 'host_developer']);
setup_generic_battery_pages(BTM);
setup_lifetime_page( DEGRADATION_AC_LIFETIME );
addpage( [[ 'Custom Generation Battery Costs' ]], { 'sidebar'='Installation Costs', 'help'='cc_custom_generation' } );
addpage( [[ 'Operating Costs Custom Generation Battery' ]], {'sidebar' = 'Operating Costs', 'help'='oc_battery'} );
setup_host_developer_pages( LOAD_SIMPLE );

setconfig( 'Custom Generation Battery', 'Single Owner' );
setmodules( ['custom_generation', 'battery', 'grid', 'utilityrate5', 'singleowner']);
setup_generic_battery_pages(FOM);
setup_lifetime_page( DEGRADATION_AC_LIFETIME );
addpage( [[ 'Custom Generation Battery Costs' ]], { 'sidebar'='Installation Costs', 'help'='cc_custom_generation' } );
addpage( [[ 'Operating Costs Custom Generation Battery' ]], {'sidebar' = 'Operating Costs', 'help'='oc_battery'} );
setup_single_owner_pages( );
setup_electricity_purchases();

setconfig( 'Custom Generation Battery', 'Merchant Plant' );
setmodules( ['custom_generation', 'battery', 'grid', 'utilityrate5', 'merchantplant']);
setup_generic_battery_pages(FOM);
setup_lifetime_page( DEGRADATION_AC_LIFETIME );
addpage( [[ 'Custom Generation Battery Costs' ]], { 'sidebar'='Installation Costs', 'help'='cc_custom_generation' } );
addpage( [[ 'Operating Costs Custom Generation Battery' ]], {'sidebar' = 'Operating Costs', 'help'='oc_battery'} );
setup_merchant_plant_pages( );
setup_electricity_purchases();

setconfig( 'Custom Generation Battery', 'Leveraged Partnership Flip' );
setmodules( ['custom_generation', 'battery', 'grid', 'utilityrate5', 'levpartflip']);
setup_generic_battery_pages(FOM);
setup_lifetime_page( DEGRADATION_AC_LIFETIME );
addpage( [[ 'Custom Generation Battery Costs' ]], { 'sidebar'='Installation Costs', 'help'='cc_custom_generation' } );
addpage( [[ 'Operating Costs Custom Generation Battery' ]], {'sidebar' = 'Operating Costs', 'help'='oc_battery'} );
setup_leveraged_partnership_flip_pages( );
setup_electricity_purchases();

setconfig( 'Custom Generation Battery', 'All Equity Partnership Flip' );
setmodules( ['custom_generation', 'battery', 'grid', 'utilityrate5', 'equpartflip']);
setup_generic_battery_pages(FOM);
setup_lifetime_page( DEGRADATION_AC_LIFETIME );
addpage( [[ 'Custom Generation Battery Costs' ]], { 'sidebar'='Installation Costs', 'help'='cc_custom_generation' } );
addpage( [[ 'Operating Costs Custom Generation Battery' ]], {'sidebar' = 'Operating Costs', 'help'='oc_battery'} );
setup_all_equity_partnership_flip_pages( );
setup_electricity_purchases();

setconfig( 'Custom Generation Battery', 'Sale Leaseback' );
setmodules( ['custom_generation', 'battery', 'grid', 'utilityrate5', 'saleleaseback']);
setup_generic_battery_pages(FOM);
setup_lifetime_page( DEGRADATION_AC_LIFETIME );
addpage( [[ 'Custom Generation Battery Costs' ]], { 'sidebar'='Installation Costs', 'help'='cc_custom_generation' } );
addpage( [[ 'Operating Costs Custom Generation Battery' ]], {'sidebar' = 'Operating Costs', 'help'='oc_battery'} );
setup_sale_leaseback_pages();
setup_electricity_purchases();

// Standalone Battery /////////////////////////////////////////////////////////

function setup_standalone_battery_pages(is_btm) {
	
	if (is_btm) {
		setup_pages_battery_cell_and_system(false, true); // No REopt and BTM
		addpage([['Battery Standalone Timestep',
			 ]], { 'sidebar'='Battery Time Step', 'help'='battery_time_step', 'bin_name'='Battery' } );
		setup_pages_battery_life();
		setup_pages_standalone_battery_dispatch_btm();
		setup_grid_limits_page();
		setup_grid_outage_page();
	}
	else {
		setup_pages_battery_cell_and_system(false, false); // No REopt and FOM
		addpage([['Battery Standalone Timestep',
			 ]], { 'sidebar'='Battery Time Step', 'help'='battery_time_step', 'bin_name'='Battery' } );
		setup_pages_battery_life();
		setup_pages_standalone_battery_dispatch_fom();
		setup_grid_limits_page();
	}

}

setconfig( 'Standalone Battery', 'Residential' );
setmodules( ['battery',  'grid', 'utilityrate5', 'cashloan']);
setup_standalone_battery_pages(BTM);
addpage( [[ 'Standalone Battery Costs']],{ 'sidebar'='Installation Costs', 'help'='cc_standalone_battery' } );
addpage( [[ 'Operating Costs Standalone Battery']],{ 'sidebar'='Operating Costs', 'help'='oc_battery' } );
setup_residential_pages( LOAD_SIMPLE );

setconfig( 'Standalone Battery', 'Commercial' );
setmodules( ['battery',  'grid', 'utilityrate5', 'cashloan']);
setup_standalone_battery_pages(BTM);
addpage( [[ 'Standalone Battery Costs']],{ 'sidebar'='Installation Costs', 'help'='cc_standalone_battery' } );
addpage( [[ 'Operating Costs Standalone Battery']],{ 'sidebar'='Operating Costs', 'help'='oc_battery' } );
setup_commercial_pages( LOAD_SIMPLE ); //does not include building load calculator

setconfig( 'Standalone Battery', 'Third Party' );
setmodules( ['battery', 'grid', 'utilityrate5', 'thirdpartyownership']);
setup_standalone_battery_pages(BTM);
setup_thirdparty_pages( LOAD_SIMPLE );

setconfig( 'Standalone Battery', 'Host Developer' );
setmodules( ['battery', 'grid', 'utilityrate5', 'host_developer']);
setup_standalone_battery_pages(BTM);
addpage( [[ 'Standalone Battery Costs']],{ 'sidebar'='Installation Costs', 'help'='cc_standalone_battery' } );
addpage( [[ 'Operating Costs Standalone Battery']],{ 'sidebar'='Operating Costs', 'help'='oc_battery' } );
setup_host_developer_pages( LOAD_SIMPLE );

setconfig( 'Standalone Battery', 'Single Owner' );
setmodules( ['battery', 'grid', 'utilityrate5', 'singleowner']);
setup_standalone_battery_pages(FOM);
addpage( [[ 'Standalone Battery Costs']],{ 'sidebar'='Installation Costs', 'help'='cc_standalone_battery' } );
addpage( [[ 'Operating Costs Standalone Battery']],{ 'sidebar'='Operating Costs', 'help'='oc_battery' } );
setup_single_owner_pages( );
setup_electricity_purchases();

setconfig( 'Standalone Battery', 'Merchant Plant' );
setmodules( ['battery', 'grid', 'utilityrate5', 'merchantplant']);
setup_standalone_battery_pages(FOM);
addpage( [[ 'Standalone Battery Costs']],{ 'sidebar'='Installation Costs', 'help'='cc_standalone_battery' } );
addpage( [[ 'Operating Costs Standalone Battery']],{ 'sidebar'='Operating Costs', 'help'='oc_battery' } );
setup_merchant_plant_pages( );
setup_electricity_purchases();

setconfig( 'Standalone Battery', 'Leveraged Partnership Flip' );
setmodules( ['battery', 'grid', 'utilityrate5', 'levpartflip']);
setup_standalone_battery_pages(FOM);
addpage( [[ 'Standalone Battery Costs']],{ 'sidebar'='Installation Costs', 'help'='cc_standalone_battery' } );
addpage( [[ 'Operating Costs Standalone Battery']],{ 'sidebar'='Operating Costs', 'help'='oc_battery' } );
setup_leveraged_partnership_flip_pages( );
setup_electricity_purchases();

setconfig( 'Standalone Battery', 'All Equity Partnership Flip' );
setmodules( ['battery', 'grid', 'utilityrate5', 'equpartflip']);
setup_standalone_battery_pages(FOM);
addpage( [[ 'Standalone Battery Costs']],{ 'sidebar'='Installation Costs', 'help'='cc_standalone_battery' } );
addpage( [[ 'Operating Costs Standalone Battery']],{ 'sidebar'='Operating Costs', 'help'='oc_battery' } );
setup_all_equity_partnership_flip_pages( );
setup_electricity_purchases();

setconfig( 'Standalone Battery', 'Sale Leaseback' );
setmodules( ['battery', 'grid', 'utilityrate5', 'saleleaseback']);
setup_standalone_battery_pages(FOM);
addpage( [[ 'Standalone Battery Costs']],{ 'sidebar'='Installation Costs', 'help'='cc_standalone_battery' } );
addpage( [[ 'Operating Costs Standalone Battery']],{ 'sidebar'='Operating Costs', 'help'='oc_battery' } );
setup_sale_leaseback_pages( );
setup_electricity_purchases();

// PVWatts Battery /////////////////////////////////////////////////////////
setconfig( 'PVWatts Battery', 'Residential' );
setmodules( ['pvwattsv8', 'belpe', 'battwatts', 'grid', 'utilityrate5', 'cashloan']);
setup_pvwatts_battery_pages_behind_the_meter();
setup_lifetime_page( DEGRADATION_AC_SINGLE_YEAR );
addpage( [[ 'PV Battery Capital Costs' ],
		[ 'PVWatts Battery Capital Cost Curve', 'PV Capex Table', 'PV Capex Table AC', 'PV Capex Table Battery']], { 'sidebar'='Installation Costs', 'help'='cc_pv','exclusive_var'='pv_capex_cost_choice' } );
addpage( [[ 'Operating Costs' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_residential_pages( LOAD_BELPE ); //includes building load calculator

setconfig( 'PVWatts Battery', 'Commercial' );
setmodules( ['pvwattsv8', 'battwatts', 'grid', 'utilityrate5', 'cashloan']);
setup_pvwatts_battery_pages_behind_the_meter();
setup_lifetime_page( DEGRADATION_AC_SINGLE_YEAR );
addpage( [[ 'PV Battery Capital Costs' ],
		[ 'PVWatts Battery Capital Cost Curve', 'PV Capex Table', 'PV Capex Table AC', 'PV Capex Table Battery']], { 'sidebar'='Installation Costs', 'help'='cc_pv','exclusive_var'='pv_capex_cost_choice' } );
addpage( [[ 'Operating Costs' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_commercial_pages(LOAD_SIMPLE); //belpe not valid for commercial

setconfig( 'PVWatts Battery', 'Host Developer' );
setmodules( ['pvwattsv8', 'battwatts', 'grid', 'utilityrate5', 'host_developer']);
setup_pvwatts_battery_pages_behind_the_meter();
setup_lifetime_page( DEGRADATION_AC_SINGLE_YEAR );
addpage( [[ 'PV Battery Capital Costs' ],
		[ 'PVWatts Battery Capital Cost Curve', 'PV Capex Table', 'PV Capex Table AC', 'PV Capex Table Battery']], { 'sidebar'='Installation Costs', 'help'='cc_pv','exclusive_var'='pv_capex_cost_choice' } );
addpage( [[ 'Operating Costs' ]], {'sidebar' = 'Operating Costs', 'help'='oc_operating'} );
setup_host_developer_pages( LOAD_SIMPLE ); //includes building load calculator by default in this function

setconfig( 'PVWatts Battery', 'Third Party' );
setmodules( ['pvwattsv8', 'belpe', 'battwatts', 'grid', 'utilityrate5', 'thirdpartyownership']);
setup_pvwatts_battery_pages_behind_the_meter();
setup_lifetime_page( DEGRADATION_AC_SINGLE_YEAR );
setup_thirdparty_pages( LOAD_BELPE ); //includes building load calculator by default in this function

// Hybrid Power ////////////////////////////////////////////////////////////////

function setup_hybrid_battery_pages(is_btm) {
	if (is_btm)
	{
		setup_pages_battery_cell_and_system(false, true); // No REopt and BTM
		setup_pages_battery_life();
		setup_pages_battery_dispatch_btm();
		setup_grid_limits_page();
		setup_grid_outage_page();
	}
	else
	{
		setup_pages_battery_cell_and_system(false, false); // No REopt and FOM
		setup_pages_battery_life();
		setup_pages_pv_battery_dispatch_fom();
		setup_grid_limits_page();
	}
}

////////////////////////////////////////////////////////////////////////////////
setconfig('PVWatts Wind Battery Hybrid', 'Single Owner' );
setmodules( ['pvwattsv8', 'windpower', 'battery', 'grid', 'utilityrate5', 'singleowner']);
sethybridvariabledependencies([
{ 'IndependentVartableIndex' = 0,'IndependentVariableName' = 'ac_nameplate', 'DependentVartableIndex' = 3,'DependentVariableName' = 'ac_nameplate'},
{ 'IndependentVartableIndex' = 0,'IndependentVariableName' = 'solar_resource_file', 'DependentVartableIndex' = 2,'DependentVariableName' = 'solar_resource_file'}, // battery dispatch
{ 'IndependentVartableIndex' = 0,'IndependentVariableName' = 'total_installed_cost', 'DependentVartableIndex' = 3,'DependentVariableName' = 'pv_total_installed_cost'},
{ 'IndependentVartableIndex' = 0,'IndependentVariableName' = 'ui_step_minutes', 'DependentVartableIndex' = 2,'DependentVariableName' = 'pv_ui_step_minutes'}, // pv smoothing dispatch
{ 'IndependentVartableIndex' = 1,'IndependentVariableName' = 'ui_step_minutes', 'DependentVartableIndex' = 2,'DependentVariableName' = 'wind_ui_step_minutes'}, // pv smoothing dispatch
{ 'IndependentVartableIndex' = 1,'IndependentVariableName' = 'system_capacity', 'DependentVartableIndex' = 3,'DependentVariableName' = 'wind_system_capacity'},
{ 'IndependentVartableIndex' = 1,'IndependentVariableName' = 'total_installed_cost', 'DependentVartableIndex' = 3,'DependentVariableName' = 'wind_total_installed_cost'},
{ 'IndependentVartableIndex' = 2,'IndependentVariableName' = 'batt_power_discharge_max_kwac', 'DependentVartableIndex' = 3,'DependentVariableName' = 'batt_power_discharge_max_kwac'}, 
{ 'IndependentVartableIndex' = 2,'IndependentVariableName' = 'batt_replacement_option', 'DependentVartableIndex' = 3,'DependentVariableName' = 'batt_replacement_option'}, // battery replacements
{ 'IndependentVartableIndex' = 2,'IndependentVariableName' = 'system_capacity', 'DependentVartableIndex' = 3,'DependentVariableName' = 'battery_system_capacity'},
{ 'IndependentVartableIndex' = 2,'IndependentVariableName' = 'total_installed_cost', 'DependentVartableIndex' = 3,'DependentVariableName' = 'battery_total_installed_cost'}, 
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'analysis_period', 'DependentVartableIndex' = 0,'DependentVariableName' = 'analysis_period'},
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'analysis_period', 'DependentVartableIndex' = 1,'DependentVariableName' = 'analysis_period'},
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'analysis_period', 'DependentVartableIndex' = 2,'DependentVariableName' = 'analysis_period'},
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'dispatch_sched_weekday', 'DependentVartableIndex' = 2,'DependentVariableName' = 'dispatch_sched_weekday'}, // battery dispatch
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'dispatch_sched_weekend', 'DependentVartableIndex' = 2,'DependentVariableName' = 'dispatch_sched_weekend'}, // battery dispatch
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'dispatch_tod_factors', 'DependentVartableIndex' = 2,'DependentVariableName' = 'dispatch_tod_factors'}, // battery dispatch
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'grid_interconnection_limit_kwac', 'DependentVartableIndex' = 2,'DependentVariableName' = 'grid_interconnection_limit_kwac'}, // battery dispatch
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'inflation_rate', 'DependentVartableIndex' = 0,'DependentVariableName' = 'inflation_rate'},
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'inflation_rate', 'DependentVartableIndex' = 1,'DependentVariableName' = 'inflation_rate'},
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'inflation_rate', 'DependentVartableIndex' = 2,'DependentVariableName' = 'inflation_rate'},
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'ppa_escalation', 'DependentVartableIndex' = 2,'DependentVariableName' = 'ppa_escalation'}, // battery dispatch
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'ppa_multiplier_model', 'DependentVartableIndex' = 2,'DependentVariableName' = 'ppa_multiplier_model'}, // battery dispatch
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'ppa_price_input', 'DependentVartableIndex' = 2,'DependentVariableName' = 'ppa_price_input'}, // battery dispatch
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'sales_tax_rate', 'DependentVartableIndex' = 0,'DependentVariableName' = 'sales_tax_rate'},
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'sales_tax_rate', 'DependentVartableIndex' = 1,'DependentVariableName' = 'sales_tax_rate'},
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'sales_tax_rate', 'DependentVartableIndex' = 2,'DependentVariableName' = 'sales_tax_rate'},
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'system_capacity', 'DependentVartableIndex' = 2,'DependentVariableName' = 'hybrid_system_capacity'}
]);
addpage([['Hybrid System']], {'sidebar'='Hybrid System', 'help'='hybrid_system', 'top_page'=true});
// pvwatts
addpage( [[ 'Solar Resource Data' ]], { 'sidebar'='PV Location and Resource', 'help'='pvwatts_location_and_resource', 'bin_name'='PVWatts' } );
addpage( [[ 'PVWatts', {'name'='PV Land Area', 'caption' = 'Land Area', 'collapsible'=true, 'collapsible_var'='pv_land_area_is_shown'}, {'name'='PVWatts Advanced Inputs', 'caption' = 'Advanced Inputs', 'collapsible'=true, 'collapsible_var'='pvwatts.advanced.is_shown'} ]], { 'sidebar'='PV System Design', 'help'='pvwatts_system_design', 'bin_name'='PVWatts' } );
addpage( [[ 'Degradation AC Single Year'], ], { 'sidebar'='PV AC Degradation','help'='degradation_ac', 'bin_name'='PVWatts' } );
addpage( [[ 'PV Capital Costs' ]], { 'sidebar'='PV Installation Costs', 'help'='cc_pv', 'bin_name'='PVWatts'} );
addpage( [[ 'Operating Costs', 'Operating Costs Land Lease' ]], {'sidebar' = 'PV Operating Costs', 'help'='oc_operating', 'bin_name'='PVWatts'} );
// wind
addpage( [[ 'Wind Resource File'], [ 'Wind Speed Weibull Distribution'], [ 'Wind Resource Probability Table']], { 'sidebar'='Wind Resource', 'exclusive_var'='wind_resource_model_choice', 'help'='wind_resource', 'bin_name'='Wind' } );
addpage( [[ 'Wind Turbine Design' ]], { 'sidebar'='Wind Turbine', 'help'='wind_turbine', 'bin_name'='Wind' } );
addpage( [[ 'Wind Farm Specifications' ]], { 'sidebar'='Wind Farm', 'help'='wind_farm', 'bin_name'='Wind' } );
addpage( [[ 'Wind Losses' ]], { 'sidebar'='Wind Losses', 'help'='wind_losses', 'bin_name'='Wind'} );
addpage( [[ 'Degradation AC Single Year'] ], { 'sidebar'='Wind AC Degradation','help'='degradation_ac', 'bin_name'='Wind'} );
addpage( [[ 'Wind Farm Costs']], { 'sidebar'='Wind Installation Costs', 'help'='cc_wind', 'bin_name'='Wind' } );
addpage( [[ 'Operating Costs' ]], {'sidebar' = 'Wind Operating Costs', 'help'='oc_operating', 'bin_name'='Wind'} );
// battery
setup_hybrid_battery_pages(FOM);
addpage( [[ 'Standalone Battery Costs' ]], { 'sidebar'='Battery Installation Costs', 'help'='cc_standalone_battery', 'bin_name'='Battery' } );
addpage( [[ 'Operating Costs Standalone Battery']], { 'sidebar'='Battery Operating Costs', 'help'='oc_battery', 'bin_name'='Battery' } );
// single owner
addpage([['Hybrid Costs']], {'sidebar'='Hybrid System Costs', 'help'='hybrid_system_costs', 'top_page'=true});

setup_single_owner_pages( );
setup_electricity_purchases();

////////////////////////////////////////////////////////////////////////////////
setconfig('PVWatts Wind Battery Hybrid', 'Host Developer' );
setmodules( ['pvwattsv8', 'windpower', 'battery', 'grid', 'utilityrate5', 'host_developer']);
sethybridvariabledependencies([
{ 'IndependentVartableIndex' = 0,'IndependentVariableName' = 'ac_nameplate', 'DependentVartableIndex' = 3,'DependentVariableName' = 'ac_nameplate'},
{ 'IndependentVartableIndex' = 0,'IndependentVariableName' = 'solar_resource_file', 'DependentVartableIndex' = 2,'DependentVariableName' = 'solar_resource_file'}, // battery dispatch
{ 'IndependentVartableIndex' = 0,'IndependentVariableName' = 'system_capacity', 'DependentVartableIndex' = 2,'DependentVariableName' = 'pv_system_capacity'}, // pv smoothing dispatch
{ 'IndependentVartableIndex' = 0,'IndependentVariableName' = 'total_installed_cost', 'DependentVartableIndex' = 3,'DependentVariableName' = 'pv_total_installed_cost'},
{ 'IndependentVartableIndex' = 0,'IndependentVariableName' = 'ui_step_minutes', 'DependentVartableIndex' = 2,'DependentVariableName' = 'ui_step_minutes'}, // pv smoothing dispatch
{ 'IndependentVartableIndex' = 1,'IndependentVariableName' = 'system_capacity', 'DependentVartableIndex' = 3,'DependentVariableName' = 'wind_system_capacity'},
{ 'IndependentVartableIndex' = 1,'IndependentVariableName' = 'total_installed_cost', 'DependentVartableIndex' = 3,'DependentVariableName' = 'wind_total_installed_cost'},
{ 'IndependentVartableIndex' = 2,'IndependentVariableName' = 'batt_power_discharge_max_kwac', 'DependentVartableIndex' = 3,'DependentVariableName' = 'batt_power_discharge_max_kwac'}, 
{ 'IndependentVartableIndex' = 2,'IndependentVariableName' = 'batt_replacement_option', 'DependentVartableIndex' = 3,'DependentVariableName' = 'batt_replacement_option'}, // battery replacements
{ 'IndependentVartableIndex' = 2,'IndependentVariableName' = 'system_capacity', 'DependentVartableIndex' = 3,'DependentVariableName' = 'battery_system_capacity'},
{ 'IndependentVartableIndex' = 2,'IndependentVariableName' = 'total_installed_cost', 'DependentVartableIndex' = 3,'DependentVariableName' = 'battery_total_installed_cost'}, 
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'analysis_period', 'DependentVartableIndex' = 0,'DependentVariableName' = 'analysis_period'},
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'analysis_period', 'DependentVartableIndex' = 1,'DependentVariableName' = 'analysis_period'},
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'analysis_period', 'DependentVartableIndex' = 2,'DependentVariableName' = 'analysis_period'},
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'dispatch_sched_weekday', 'DependentVartableIndex' = 2,'DependentVariableName' = 'dispatch_sched_weekday'}, // battery dispatch
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'dispatch_sched_weekend', 'DependentVartableIndex' = 2,'DependentVariableName' = 'dispatch_sched_weekend'}, // battery dispatch
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'dispatch_tod_factors', 'DependentVartableIndex' = 2,'DependentVariableName' = 'dispatch_tod_factors'}, // battery dispatch
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'grid_interconnection_limit_kwac', 'DependentVartableIndex' = 2,'DependentVariableName' = 'grid_interconnection_limit_kwac'}, // battery dispatch
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'inflation_rate', 'DependentVartableIndex' = 0,'DependentVariableName' = 'inflation_rate'},
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'inflation_rate', 'DependentVartableIndex' = 1,'DependentVariableName' = 'inflation_rate'},
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'inflation_rate', 'DependentVartableIndex' = 2,'DependentVariableName' = 'inflation_rate'},
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'load', 'DependentVartableIndex' = 2,'DependentVariableName' = 'load'}, // battery dispatch
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'load_escalation', 'DependentVartableIndex' = 2,'DependentVariableName' = 'load_escalation'}, // battery dispatch
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'ppa_escalation', 'DependentVartableIndex' = 2,'DependentVariableName' = 'ppa_escalation'}, // battery dispatch
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'ppa_multiplier_model', 'DependentVartableIndex' = 2,'DependentVariableName' = 'ppa_multiplier_model'}, // battery dispatch
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'ppa_price_input', 'DependentVartableIndex' = 2,'DependentVariableName' = 'ppa_price_input'}, // battery dispatch
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'sales_tax_rate', 'DependentVartableIndex' = 0,'DependentVariableName' = 'sales_tax_rate'},
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'sales_tax_rate', 'DependentVartableIndex' = 1,'DependentVariableName' = 'sales_tax_rate'},
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'sales_tax_rate', 'DependentVartableIndex' = 2,'DependentVariableName' = 'sales_tax_rate'}
]);
addpage([['Hybrid System']], {'sidebar'='Hybrid System', 'help'='hybrid_system', 'top_page'=true});
// pvwatts
addpage( [[ 'Solar Resource Data' ]], { 'sidebar'='PV Location and Resource', 'help'='pvwatts_location_and_resource', 'bin_name'='PVWatts' } );
addpage( [[ 'PVWatts', {'name'='PV Land Area', 'caption' = 'Land Area', 'collapsible'=true, 'collapsible_var'='pv_land_area_is_shown'}, {'name'='PVWatts Advanced Inputs', 'caption' = 'Advanced Inputs', 'collapsible'=true, 'collapsible_var'='pvwatts.advanced.is_shown'} ]], { 'sidebar'='PV System Design', 'help'='pvwatts_system_design', 'bin_name'='PVWatts' } );
addpage( [[ 'Degradation AC Single Year'], ], { 'sidebar'='PV AC Degradation','help'='degradation_ac', 'bin_name'='PVWatts' } );
addpage( [[ 'PV Capital Costs' ]], { 'sidebar'='PV Installation Costs', 'help'='cc_pv', 'bin_name'='PVWatts'} );
addpage( [[ 'Operating Costs']], {'sidebar' = 'PV Operating Costs', 'help'='oc_operating', 'bin_name'='PVWatts'} );
// wind
addpage( [[ 'Wind Resource File'], [ 'Wind Speed Weibull Distribution'], [ 'Wind Resource Probability Table']], { 'sidebar'='Wind Resource', 'exclusive_var'='wind_resource_model_choice', 'help'='wind_resource', 'bin_name'='Wind' } );
addpage( [[ 'Wind Turbine Design' ]], { 'sidebar'='Wind Turbine', 'help'='wind_turbine', 'bin_name'='Wind' } );
addpage( [[ 'Wind Farm Specifications' ]], { 'sidebar'='Wind Farm', 'help'='wind_farm', 'bin_name'='Wind' } );
addpage( [[ 'Wind Losses' ]], { 'sidebar'='Wind Losses', 'help'='wind_losses', 'bin_name'='Wind'} );
addpage( [[ 'Degradation AC Single Year'] ], { 'sidebar'='Wind AC Degradation','help'='degradation_ac', 'bin_name'='Wind'} );
addpage( [[ 'Wind Farm Costs']], { 'sidebar'='Wind Installation Costs', 'help'='cc_wind', 'bin_name'='Wind' } );
addpage( [[ 'Operating Costs' ]], {'sidebar' = 'Wind Operating Costs', 'help'='oc_operating', 'bin_name'='Wind'} );
// battery
setup_hybrid_battery_pages(BTM);
addpage( [[ 'Standalone Battery Costs', 'Battery Enable' ]],{ 'sidebar'='Battery Installation Costs', 'help'='cc_standalone_battery', 'bin_name'='Battery' } );
addpage( [[ 'Operating Costs Standalone Battery']],{ 'sidebar'='Battery Operating Costs', 'help'='oc_battery', 'bin_name'='Battery' } );
// host developer
setup_host_developer_pages(LOAD_SIMPLE);
addpage([['Hybrid Costs']], {'sidebar'='Hybrid System Costs', 'help'='hybrid_system_costs', 'top_page'=true});

//PVWatts + Wind + Fuel Cell + Battery
setconfig('PVWatts Wind FuelCell Battery Hybrid', 'Single Owner' );
setmodules( ['pvwattsv8', 'windpower', 'fuelcell', 'battery', 'grid', 'utilityrate5', 'singleowner']);
sethybridvariabledependencies([
{ 'IndependentVartableIndex' = 0,'IndependentVariableName' = 'ac_nameplate', 'DependentVartableIndex' = 4,'DependentVariableName' = 'ac_nameplate'},
{ 'IndependentVartableIndex' = 0,'IndependentVariableName' = 'solar_resource_file', 'DependentVartableIndex' = 3,'DependentVariableName' = 'solar_resource_file'}, // battery dispatch
{ 'IndependentVartableIndex' = 0,'IndependentVariableName' = 'total_installed_cost', 'DependentVartableIndex' = 4,'DependentVariableName' = 'pv_total_installed_cost'},
{ 'IndependentVartableIndex' = 0,'IndependentVariableName' = 'ui_step_minutes', 'DependentVartableIndex' = 3,'DependentVariableName' = 'pv_ui_step_minutes'}, // pv smoothing dispatch
{ 'IndependentVartableIndex' = 1,'IndependentVariableName' = 'ui_step_minutes', 'DependentVartableIndex' = 3,'DependentVariableName' = 'wind_ui_step_minutes'}, // pv smoothing dispatch
{ 'IndependentVartableIndex' = 1,'IndependentVariableName' = 'system_capacity', 'DependentVartableIndex' = 4,'DependentVariableName' = 'wind_system_capacity'},
{ 'IndependentVartableIndex' = 1,'IndependentVariableName' = 'total_installed_cost', 'DependentVartableIndex' = 4,'DependentVariableName' = 'wind_total_installed_cost'},
{ 'IndependentVartableIndex' = 2,'IndependentVariableName' = 'fuelcell_power_nameplate', 'DependentVartableIndex' = 4,'DependentVariableName' = 'fuelcell_power_nameplate'}, // fuel cell costs hybrid
{ 'IndependentVartableIndex' = 2,'IndependentVariableName' = 'fuelcell_power_nameplate', 'DependentVartableIndex' = 4,'DependentVariableName' = 'fuelcell_system_capacity'},
{ 'IndependentVartableIndex' = 2,'IndependentVariableName' = 'total_installed_cost', 'DependentVartableIndex' = 4,'DependentVariableName' = 'fuelcell_total_installed_cost'},
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'batt_dispatch_choice_ui', 'DependentVartableIndex' = 2,'DependentVariableName' = 'batt_dispatch_choice_ui'}, // fuel cell dispatch
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'batt_power_discharge_max_kwac', 'DependentVartableIndex' = 4,'DependentVariableName' = 'batt_power_discharge_max_kwac'},
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'batt_replacement_option', 'DependentVartableIndex' = 4,'DependentVariableName' = 'batt_replacement_option'}, // battery replacements
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'system_capacity', 'DependentVartableIndex' = 4,'DependentVariableName' = 'battery_system_capacity'},
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'total_installed_cost', 'DependentVartableIndex' = 4,'DependentVariableName' = 'battery_total_installed_cost'},
{ 'IndependentVartableIndex' = 4,'IndependentVariableName' = 'analysis_period', 'DependentVartableIndex' = 0,'DependentVariableName' = 'analysis_period'},
{ 'IndependentVartableIndex' = 4,'IndependentVariableName' = 'analysis_period', 'DependentVartableIndex' = 1,'DependentVariableName' = 'analysis_period'},
{ 'IndependentVartableIndex' = 4,'IndependentVariableName' = 'analysis_period', 'DependentVartableIndex' = 2,'DependentVariableName' = 'analysis_period'},
{ 'IndependentVartableIndex' = 4,'IndependentVariableName' = 'analysis_period', 'DependentVartableIndex' = 3,'DependentVariableName' = 'analysis_period'},
{ 'IndependentVartableIndex' = 4,'IndependentVariableName' = 'dispatch_sched_weekday', 'DependentVartableIndex' = 3,'DependentVariableName' = 'dispatch_sched_weekday'}, // battery dispatch
{ 'IndependentVartableIndex' = 4,'IndependentVariableName' = 'dispatch_sched_weekend', 'DependentVartableIndex' = 3,'DependentVariableName' = 'dispatch_sched_weekend'}, // battery dispatch
{ 'IndependentVartableIndex' = 4,'IndependentVariableName' = 'dispatch_tod_factors', 'DependentVartableIndex' = 3,'DependentVariableName' = 'dispatch_tod_factors'}, // battery dispatch
{ 'IndependentVartableIndex' = 4,'IndependentVariableName' = 'grid_interconnection_limit_kwac', 'DependentVartableIndex' = 3,'DependentVariableName' = 'grid_interconnection_limit_kwac'}, // battery dispatch
{ 'IndependentVartableIndex' = 4,'IndependentVariableName' = 'inflation_rate', 'DependentVartableIndex' = 0,'DependentVariableName' = 'inflation_rate'},
{ 'IndependentVartableIndex' = 4,'IndependentVariableName' = 'inflation_rate', 'DependentVartableIndex' = 1,'DependentVariableName' = 'inflation_rate'},
{ 'IndependentVartableIndex' = 4,'IndependentVariableName' = 'inflation_rate', 'DependentVartableIndex' = 2,'DependentVariableName' = 'inflation_rate'},
{ 'IndependentVartableIndex' = 4,'IndependentVariableName' = 'inflation_rate', 'DependentVartableIndex' = 3,'DependentVariableName' = 'inflation_rate'},
{ 'IndependentVartableIndex' = 4,'IndependentVariableName' = 'ppa_escalation', 'DependentVartableIndex' = 3,'DependentVariableName' = 'ppa_escalation'}, // battery dispatch
{ 'IndependentVartableIndex' = 4,'IndependentVariableName' = 'ppa_multiplier_model', 'DependentVartableIndex' = 3,'DependentVariableName' = 'ppa_multiplier_model'}, // battery dispatch
{ 'IndependentVartableIndex' = 4,'IndependentVariableName' = 'ppa_price_input', 'DependentVartableIndex' = 3,'DependentVariableName' = 'ppa_price_input'}, // battery dispatch
{ 'IndependentVartableIndex' = 4,'IndependentVariableName' = 'sales_tax_rate', 'DependentVartableIndex' = 0,'DependentVariableName' = 'sales_tax_rate'},
{ 'IndependentVartableIndex' = 4,'IndependentVariableName' = 'sales_tax_rate', 'DependentVartableIndex' = 1,'DependentVariableName' = 'sales_tax_rate'},
{ 'IndependentVartableIndex' = 4,'IndependentVariableName' = 'sales_tax_rate', 'DependentVartableIndex' = 2,'DependentVariableName' = 'sales_tax_rate'},
{ 'IndependentVartableIndex' = 4,'IndependentVariableName' = 'sales_tax_rate', 'DependentVartableIndex' = 3,'DependentVariableName' = 'sales_tax_rate'},
{ 'IndependentVartableIndex' = 4,'IndependentVariableName' = 'system_capacity', 'DependentVartableIndex' = 3,'DependentVariableName' = 'hybrid_system_capacity'} // pv smoothing dispatch
]);
addpage([['Hybrid System']], {'sidebar'='Hybrid System', 'help'='hybrid_system', 'top_page'=true});
// pvwatts
addpage( [[ 'Solar Resource Data' ]], { 'sidebar'='PV Location and Resource', 'help'='pvwatts_location_and_resource', 'bin_name'='PVWatts' } );
addpage( [[ 'PVWatts', {'name'='PV Land Area', 'caption' = 'Land Area', 'collapsible'=true, 'collapsible_var'='pv_land_area_is_shown'}, {'name'='PVWatts Advanced Inputs', 'caption' = 'Advanced Inputs', 'collapsible'=true, 'collapsible_var'='pvwatts.advanced.is_shown'} ]], { 'sidebar'='PV System Design', 'help'='pvwatts_system_design', 'bin_name'='PVWatts' } );
addpage( [[ 'Degradation AC Single Year'], ], { 'sidebar'='PV AC Degradation','help'='degradation_ac', 'bin_name'='PVWatts' } );
addpage( [[ 'PV Capital Costs' ]], { 'sidebar'='PV Installation Costs', 'help'='cc_pv', 'bin_name'='PVWatts'} );
addpage( [[ 'Operating Costs', 'Operating Costs Land Lease' ]], {'sidebar' = 'PV Operating Costs', 'help'='oc_operating', 'bin_name'='PVWatts'} );
// wind
addpage( [[ 'Wind Resource File'], [ 'Wind Speed Weibull Distribution'], [ 'Wind Resource Probability Table']], { 'sidebar'='Wind Resource', 'exclusive_var'='wind_resource_model_choice', 'help'='wind_resource', 'bin_name'='Wind' } );
addpage( [[ 'Wind Turbine Design' ]], { 'sidebar'='Wind Turbine', 'help'='wind_turbine', 'bin_name'='Wind' } );
addpage( [[ 'Wind Farm Specifications' ]], { 'sidebar'='Wind Farm', 'help'='wind_farm', 'bin_name'='Wind' } );
addpage( [[ 'Wind Losses' ]], { 'sidebar'='Wind Losses', 'help'='wind_losses', 'bin_name'='Wind'} );
addpage( [[ 'Degradation AC Single Year'] ], { 'sidebar'='Wind AC Degradation','help'='degradation_ac', 'bin_name'='Wind'} );
addpage( [[ 'Wind Farm Costs']], { 'sidebar'='Wind Installation Costs', 'help'='cc_wind', 'bin_name'='Wind' } );
addpage( [[ 'Operating Costs' ]], {'sidebar' = 'Wind Operating Costs', 'help'='oc_operating', 'bin_name'='Wind'} );
//fuel cell
addpage( [[ 'Fuel Cell']], {'sidebar'='Fuel Cell', 'help'='fuelcell_fuel_cell', 'bin_name'='FuelCell'});
addpage( [[{'name'='AA Empty', 'caption'='Fixed Output'}], [{'name'='Fuel Cell Dispatch Manual', 'caption'='Manual'}], [{'name'='AA Empty', 'caption'='Input Dispatch'}]], { 'sidebar'='Fuel Cell Dispatch', 'help'='fuelcell_dispatch', 'exclusive_var' = 'fuelcell_dispatch_excl', 'exclusive_header_pages' = ['Fuel Cell Dispatch FOM'], 'exclusive_tabs'=true, 'exclusive_hide'=true, 'bin_name'='FuelCell'} );
addpage( [[ 'Fuel Cell Costs Hybrid' ]], { 'sidebar'='Fuel Cell Installation Costs', 'help'='cc_fuel_cell', 'bin_name'='FuelCell' } );
addpage( [[ 'Operating Costs Fuel Cell Hybrid' ]], { 'sidebar'='Fuel Cell Operating Costs', 'help'='oc_fuel_cell', 'bin_name'='FuelCell' } );
// battery
addpage( [['Battery Model', 'Battery Bank Sizing', 'Battery Current and Capacity', 'Battery Configuration', {'name'='Battery Voltage', 'caption'='Battery Voltage', 'collapsible'=true, 'collapsible_var'='battery_voltage_shown'}, {'name'='Battery Losses', 'caption'='Battery Losses', 'collapsible'=true, 'collapsible_var'='battery_losses_shown'}, {'name'='Battery Thermal', 'caption'='Battery Thermal', 'collapsible'=true, 'collapsible_var'='battery_thermal_shown'}, 'Battery Standalone Enable', ]], { 'sidebar'='Battery Cell and System', 'help'='battery_storage_fom', 'bin_name'='Battery'  } );
addpage( [[ {'name'='Battery Life Cycle Calendar', 'caption'='Calendar and Cycle Degradation'}], [{'name'='Battery Life Empty 1','caption'='Li-on NMC/Graphite Degradation'}], [{'name'='Battery Life Empty 2','caption'='Li-ion LMO/LTO Degradation'}]], {'sidebar'='Battery Life', 'help'='battery_life' , 'exclusive_var' = 'batt_life_excl', 'exclusive_header_pages' = ['Battery Replacements','Battery Life Options' ], 'exclusive_tabs' = true, 'exclusive_hide' = true, 'bin_name'='Battery'  } );
addpage( [[ {'name'='Battery Dispatch Automated FOM', 'caption'='Automated'} ], [{'name'='Battery Dispatch PV Smoothing', 'caption'='System Smoothing'}], [ {'name'='Battery Dispatch Custom Time Series', 'caption'='Custom Time Series'} ], [ {'name'='Battery Dispatch Manual', 'caption'='Manual'}] ], { 'sidebar'='Battery Dispatch', 'help'='battery_dispatch_fom', 'exclusive_var' = 'batt_dispatch_excl', 'exclusive_header_pages' = ['Battery Dispatch Common', 'Battery Dispatch Options FOM'], 'exclusive_tabs'=true, 'exclusive_hide'=true, 'bin_name'='Battery'} );
addpage( [[ 'Standalone Battery Costs'/*, 'Battery Enable' set on battery dispatch automated fom*/ ]], { 'sidebar'='Battery Installation Costs', 'help'='cc_standalone_battery', 'bin_name'='Battery' } );
addpage( [[ 'Operating Costs Standalone Battery']], { 'sidebar'='Battery Operating Costs', 'help'='oc_battery', 'bin_name'='Battery' } );
// grid
setup_grid_limits_page();
// single owner
addpage([['Hybrid Costs']], {'sidebar'='Hybrid System Costs', 'help'='hybrid_system_costs', 'top_page'=true});
setup_single_owner_pages( );
setup_electricity_purchases();

setconfig('PVWatts Wind FuelCell Battery Hybrid', 'Host Developer' );
setmodules( ['pvwattsv8', 'windpower', 'fuelcell', 'battery', 'grid', 'utilityrate5', 'thermalrate', 'host_developer']);
sethybridvariabledependencies([
{ 'IndependentVartableIndex' = 0,'IndependentVariableName' = 'ac_nameplate', 'DependentVartableIndex' = 4,'DependentVariableName' = 'ac_nameplate'},
{ 'IndependentVartableIndex' = 0,'IndependentVariableName' = 'solar_resource_file', 'DependentVartableIndex' = 3,'DependentVariableName' = 'solar_resource_file'}, // battery dispatch
{ 'IndependentVartableIndex' = 0,'IndependentVariableName' = 'system_capacity', 'DependentVartableIndex' = 4,'DependentVariableName' = 'pv_system_capacity'},
{ 'IndependentVartableIndex' = 0,'IndependentVariableName' = 'total_installed_cost', 'DependentVartableIndex' = 4,'DependentVariableName' = 'pv_total_installed_cost'},
{ 'IndependentVartableIndex' = 1,'IndependentVariableName' = 'system_capacity', 'DependentVartableIndex' = 4,'DependentVariableName' = 'wind_system_capacity'},
{ 'IndependentVartableIndex' = 1,'IndependentVariableName' = 'total_installed_cost', 'DependentVartableIndex' = 4,'DependentVariableName' = 'wind_total_installed_cost'},
{ 'IndependentVartableIndex' = 2,'IndependentVariableName' = 'fuelcell_power_nameplate', 'DependentVartableIndex' = 4,'DependentVariableName' = 'fuelcell_power_nameplate'}, // fuel cell costs hybrid
//{ 'IndependentVartableIndex' = 2,'IndependentVariableName' = 'fuelcell_power_thermal', 'DependentVartableIndex' = 4,'DependentVariableName' = 'fuelcell_power_thermal'}, // for cmod_thermalrate - output = handled in cmod_hybrid
{ 'IndependentVartableIndex' = 2,'IndependentVariableName' = 'fuelcell_power_nameplate', 'DependentVartableIndex' = 4,'DependentVariableName' = 'fuelcell_system_capacity'},
{ 'IndependentVartableIndex' = 2,'IndependentVariableName' = 'total_installed_cost', 'DependentVartableIndex' = 4,'DependentVariableName' = 'fuelcell_total_installed_cost'},
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'batt_power_discharge_max_kwac', 'DependentVartableIndex' = 4,'DependentVariableName' = 'batt_power_discharge_max_kwac'},
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'batt_replacement_option', 'DependentVartableIndex' = 4,'DependentVariableName' = 'batt_replacement_option'}, // battery dispatch
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'system_capacity', 'DependentVartableIndex' = 4,'DependentVariableName' = 'battery_system_capacity'},
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'total_installed_cost', 'DependentVartableIndex' = 4,'DependentVariableName' = 'battery_total_installed_cost'}, 
{ 'IndependentVartableIndex' = 4,'IndependentVariableName' = 'analysis_period', 'DependentVartableIndex' = 0,'DependentVariableName' = 'analysis_period'},
{ 'IndependentVartableIndex' = 4,'IndependentVariableName' = 'analysis_period', 'DependentVartableIndex' = 1,'DependentVariableName' = 'analysis_period'},
{ 'IndependentVartableIndex' = 4,'IndependentVariableName' = 'analysis_period', 'DependentVartableIndex' = 2,'DependentVariableName' = 'analysis_period'},
{ 'IndependentVartableIndex' = 4,'IndependentVariableName' = 'analysis_period', 'DependentVartableIndex' = 3,'DependentVariableName' = 'analysis_period'},
{ 'IndependentVartableIndex' = 4,'IndependentVariableName' = 'dispatch_sched_weekday', 'DependentVartableIndex' = 3,'DependentVariableName' = 'dispatch_sched_weekday'}, // battery dispatch
{ 'IndependentVartableIndex' = 4,'IndependentVariableName' = 'dispatch_sched_weekend', 'DependentVartableIndex' = 3,'DependentVariableName' = 'dispatch_sched_weekend'}, // battery dispatch
{ 'IndependentVartableIndex' = 4,'IndependentVariableName' = 'dispatch_tod_factors', 'DependentVartableIndex' = 3,'DependentVariableName' = 'dispatch_tod_factors'}, // battery dispatch
{ 'IndependentVartableIndex' = 4,'IndependentVariableName' = 'inflation_rate', 'DependentVartableIndex' = 0,'DependentVariableName' = 'inflation_rate'},
{ 'IndependentVartableIndex' = 4,'IndependentVariableName' = 'inflation_rate', 'DependentVartableIndex' = 1,'DependentVariableName' = 'inflation_rate'},
{ 'IndependentVartableIndex' = 4,'IndependentVariableName' = 'inflation_rate', 'DependentVartableIndex' = 2,'DependentVariableName' = 'inflation_rate'},
{ 'IndependentVartableIndex' = 4,'IndependentVariableName' = 'inflation_rate', 'DependentVartableIndex' = 3,'DependentVariableName' = 'inflation_rate'},
{ 'IndependentVartableIndex' = 4,'IndependentVariableName' = 'load', 'DependentVartableIndex' = 3,'DependentVariableName' = 'load'}, // battery dispatch
{ 'IndependentVartableIndex' = 4,'IndependentVariableName' = 'load_escalation', 'DependentVartableIndex' = 3,'DependentVariableName' = 'load_escalation'}, // battery dispatch
{ 'IndependentVartableIndex' = 4,'IndependentVariableName' = 'ppa_escalation', 'DependentVartableIndex' = 3,'DependentVariableName' = 'ppa_escalation'}, // battery dispatch
{ 'IndependentVartableIndex' = 4,'IndependentVariableName' = 'ppa_multiplier_model', 'DependentVartableIndex' = 3,'DependentVariableName' = 'ppa_multiplier_model'}, // battery dispatch
{ 'IndependentVartableIndex' = 4,'IndependentVariableName' = 'ppa_price_input', 'DependentVartableIndex' = 3,'DependentVariableName' = 'ppa_price_input'}, // battery dispatch
{ 'IndependentVartableIndex' = 4,'IndependentVariableName' = 'sales_tax_rate', 'DependentVartableIndex' = 0,'DependentVariableName' = 'sales_tax_rate'},
{ 'IndependentVartableIndex' = 4,'IndependentVariableName' = 'sales_tax_rate', 'DependentVartableIndex' = 1,'DependentVariableName' = 'sales_tax_rate'},
{ 'IndependentVartableIndex' = 4,'IndependentVariableName' = 'sales_tax_rate', 'DependentVartableIndex' = 2,'DependentVariableName' = 'sales_tax_rate'},
{ 'IndependentVartableIndex' = 4,'IndependentVariableName' = 'sales_tax_rate', 'DependentVartableIndex' = 3,'DependentVariableName' = 'sales_tax_rate'}
]);
addpage([['Hybrid System']], {'sidebar'='Hybrid System', 'help'='hybrid_system', 'top_page'=true});
// pvwatts
addpage( [[ 'Solar Resource Data' ]], { 'sidebar'='PV Location and Resource', 'help'='pvwatts_location_and_resource', 'bin_name'='PVWatts' } );
addpage( [[ 'PVWatts', {'name'='PV Land Area', 'caption' = 'Land Area', 'collapsible'=true, 'collapsible_var'='pv_land_area_is_shown'}, {'name'='PVWatts Advanced Inputs', 'caption' = 'Advanced Inputs', 'collapsible'=true, 'collapsible_var'='pvwatts.advanced.is_shown'} ]], { 'sidebar'='PV System Design', 'help'='pvwatts_system_design', 'bin_name'='PVWatts' } );
addpage( [[ 'Degradation AC Single Year'], ], { 'sidebar'='PV AC Degradation','help'='degradation_ac', 'bin_name'='PVWatts' } );
addpage( [[ 'PV Capital Costs' ]], { 'sidebar'='PV Installation Costs', 'help'='cc_pv', 'bin_name'='PVWatts'} );
addpage( [[ 'Operating Costs']], {'sidebar' = 'PV Operating Costs', 'help'='oc_operating', 'bin_name'='PVWatts'} );
// wind
addpage( [[ 'Wind Resource File'], [ 'Wind Speed Weibull Distribution'], [ 'Wind Resource Probability Table']], { 'sidebar'='Wind Resource', 'exclusive_var'='wind_resource_model_choice', 'help'='wind_resource', 'bin_name'='Wind' } );
addpage( [[ 'Wind Turbine Design' ]], { 'sidebar'='Wind Turbine', 'help'='wind_turbine', 'bin_name'='Wind' } );
addpage( [[ 'Wind Farm Specifications' ]], { 'sidebar'='Wind Farm', 'help'='wind_farm', 'bin_name'='Wind' } );
addpage( [[ 'Wind Losses' ]], { 'sidebar'='Wind Losses', 'help'='wind_losses', 'bin_name'='Wind'} );
addpage( [[ 'Degradation AC Single Year'] ], { 'sidebar'='Wind AC Degradation','help'='degradation_ac', 'bin_name'='Wind'} );
addpage( [[ 'Wind Farm Costs']], { 'sidebar'='Wind Installation Costs', 'help'='cc_wind', 'bin_name'='Wind' } );
addpage( [[ 'Operating Costs' ]], {'sidebar' = 'Wind Operating Costs', 'help'='oc_operating', 'bin_name'='Wind'} );
//fuel cell
addpage( [[ 'Fuel Cell']], {'sidebar'='Fuel Cell', 'help'='fuelcell_fuel_cell', 'bin_name'='FuelCell'});
addpage( [[ {'name'='AA Empty', 'caption'='Fixed Output'} ], [ {'name'='AA Empty', 'caption'='Follow Electric Load'} ], [ {'name'='Fuel Cell Dispatch Manual', 'caption'='Manual Dispatch'} ], [ {'name'='AA Empty', 'caption'='Input Dispatch'}] ], { 'sidebar'='Fuel Cell Dispatch', 'help'='fuelcell_dispatch', 'exclusive_var' = 'fuelcell_dispatch_excl', 'exclusive_header_pages' = ['Fuel Cell Dispatch BTM'], 'exclusive_tabs'=true, 'exclusive_hide'=true, 'bin_name'='FuelCell'} );
addpage( [[ 'Fuel Cell Costs Hybrid' ]], { 'sidebar'='Fuel Cell Installation Costs', 'help'='cc_fuel_cell', 'bin_name'='FuelCell' } );
addpage( [[ 'Operating Costs Fuel Cell Hybrid' ]], { 'sidebar'='Fuel Cell Operating Costs', 'help'='oc_fuel_cell', 'bin_name'='FuelCell' } );
// battery
addpage( [[ 'Battery Model', 'Battery Bank Sizing', 'Battery Current and Capacity', 'Battery Configuration', {'name'='Battery Voltage', 'caption'='Battery Voltage', 'collapsible'=true, 'collapsible_var'='battery_voltage_shown'}, {'name'='Battery Losses', 'caption'='Battery Losses', 'collapsible'=true, 'collapsible_var'='battery_losses_shown'}, {'name'='Battery Thermal', 'caption'='Battery Thermal', 'collapsible'=true, 'collapsible_var'='battery_thermal_shown'}, 'Battery Standalone Enable', ]], { 'sidebar'='Battery Cell and System', 'help'='battery_storage_btm', 'bin_name'='Battery'  } );
addpage( [[ {'name'='Battery Life Cycle Calendar', 'caption'='Calendar and Cycle Degradation'}], [{'name'='Battery Life Empty 1','caption'='Li-on NMC/Graphite Degradation'}], [{'name'='Battery Life Empty 2','caption'='Li-ion LMO/LTO Degradation'}]], {'sidebar'='Battery Life', 'help'='battery_life' , 'exclusive_var' = 'batt_life_excl', 'exclusive_header_pages' = ['Battery Replacements','Battery Life Options' ], 'exclusive_tabs' = true, 'exclusive_hide' = true, 'bin_name'='Battery'  } );
addpage( [[ {'name'='Battery Dispatch Peak Shaving BTM', 'caption'='Peak Shaving'} ], [ {'name'='Battery Dispatch Grid Power Targets', 'caption'='Grid Power Targets'} ], [ {'name'='Battery Dispatch Battery Power Targets', 'caption'='Battery Power Targets'}], [ {'name'='Battery Dispatch Manual', 'caption'='Manual'}], [ {'name'='Battery Dispatch Retail Rate', 'caption'='Retail Rate'} ], [ {'name'='Battery Dispatch Self Consumption', 'caption'='Self Consumption'} ]], { 'sidebar'='Battery Dispatch', 'help'='battery_dispatch_btm', 'exclusive_var' = 'batt_dispatch_excl', 'exclusive_header_pages' = ['Battery Dispatch Common', 'Battery Dispatch Options BTM'], 'exclusive_tabs'=true, 'exclusive_hide'=true, 'bin_name'='Battery' } );
addpage( [[ 'Standalone Battery Costs', 'Battery Enable' ]],{ 'sidebar'='Battery Installation Costs', 'help'='cc_standalone_battery', 'bin_name'='Battery' } );
addpage( [[ 'Operating Costs Standalone Battery']],{ 'sidebar'='Battery Operating Costs', 'help'='oc_battery', 'bin_name'='Battery' } );
// grid
setup_grid_limits_page();
setup_grid_outage_page();// host developer
// host developer
setup_host_developer_pages(LOAD_SIMPLE);
addpage( [[ 'Thermal Rate' ]], 
         {'sidebar' = 'Thermal Rates','help' = 'thermal_rates'});
addpage( [[ 'Thermal Load' ]], 
         {'sidebar' = 'Thermal Load','help' = 'thermal_load'});
addpage([['Hybrid Costs']], {'sidebar'='Hybrid System Costs', 'help'='hybrid_system_costs', 'top_page'=true});

//Wind + Detailed PV + Battery
setconfig('Photovoltaic Wind Battery Hybrid', 'Single Owner' );
setmodules( ['pvsamv1', 'windpower', 'battery', 'grid', 'utilityrate5', 'singleowner']);
sethybridvariabledependencies([
{ 'IndependentVartableIndex' = 0,'IndependentVariableName' = 'solar_resource_file', 'DependentVartableIndex' = 2,'DependentVariableName' = 'solar_resource_file'}, // battery dispatch
{ 'IndependentVartableIndex' = 0,'IndependentVariableName' = 'total_installed_cost', 'DependentVartableIndex' = 3,'DependentVariableName' = 'pv_total_installed_cost'},
{ 'IndependentVartableIndex' = 0,'IndependentVariableName' = 'total_inverter_capacity', 'DependentVartableIndex' = 3,'DependentVariableName' = 'total_inverter_capacity'},
{ 'IndependentVartableIndex' = 0,'IndependentVariableName' = 'ui_step_minutes', 'DependentVartableIndex' = 2,'DependentVariableName' = 'pv_ui_step_minutes'}, // pv smoothing dispatch
{ 'IndependentVartableIndex' = 1,'IndependentVariableName' = 'ui_step_minutes', 'DependentVartableIndex' = 2,'DependentVariableName' = 'wind_ui_step_minutes'}, // pv smoothing dispatch
{ 'IndependentVartableIndex' = 1,'IndependentVariableName' = 'system_capacity', 'DependentVartableIndex' = 3,'DependentVariableName' = 'wind_system_capacity'},
{ 'IndependentVartableIndex' = 1,'IndependentVariableName' = 'total_installed_cost', 'DependentVartableIndex' = 3,'DependentVariableName' = 'wind_total_installed_cost'},
{ 'IndependentVartableIndex' = 2,'IndependentVariableName' = 'batt_power_discharge_max_kwac', 'DependentVartableIndex' = 3,'DependentVariableName' = 'batt_power_discharge_max_kwac'},
{ 'IndependentVartableIndex' = 2,'IndependentVariableName' = 'batt_replacement_option', 'DependentVartableIndex' = 3,'DependentVariableName' = 'batt_replacement_option'}, // battery replacements
{ 'IndependentVartableIndex' = 2,'IndependentVariableName' = 'system_capacity', 'DependentVartableIndex' = 3,'DependentVariableName' = 'battery_system_capacity'},
{ 'IndependentVartableIndex' = 2,'IndependentVariableName' = 'total_installed_cost', 'DependentVartableIndex' = 3,'DependentVariableName' = 'battery_total_installed_cost'}, 
//{ 'IndependentVartableIndex' = 2,'IndependentVariableName' = 'batt_calendar_choice', 'DependentVartableIndex' = 0,'DependentVariableName' = 'batt_calendar_choice'}, 
//{ 'IndependentVartableIndex' = 2,'IndependentVariableName' = 'batt_chem', 'DependentVartableIndex' = 0,'DependentVariableName' = 'batt_chem'},
//{ 'IndependentVartableIndex' = 2,'IndependentVariableName' = 'batt_computed_series', 'DependentVartableIndex' = 0,'DependentVariableName' = 'batt_computed_series'},
//{ 'IndependentVartableIndex' = 2,'IndependentVariableName' = 'batt_computed_strings', 'DependentVartableIndex' = 0,'DependentVariableName' = 'batt_computed_strings'},
//{ 'IndependentVartableIndex' = 2,'IndependentVariableName' = 'batt_dispatch_charge_only_system_exceeds_load', 'DependentVartableIndex' = 0,'DependentVariableName' = 'batt_dispatch_charge_only_system_exceeds_load'},
//{ 'IndependentVartableIndex' = 2,'IndependentVariableName' = 'batt_dispatch_choice', 'DependentVartableIndex' = 0,'DependentVariableName' = 'batt_dispatch_choice'},
//{ 'IndependentVartableIndex' = 2,'IndependentVariableName' = 'batt_lifetime_matrix', 'DependentVartableIndex' = 0,'DependentVariableName' = 'batt_lifetime_matrix'},
//{ 'IndependentVartableIndex' = 2,'IndependentVariableName' = 'batt_meter_position', 'DependentVartableIndex' = 0,'DependentVariableName' = 'batt_meter_position'},
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'analysis_period', 'DependentVartableIndex' = 0,'DependentVariableName' = 'analysis_period'},
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'analysis_period', 'DependentVartableIndex' = 1,'DependentVariableName' = 'analysis_period'},
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'analysis_period', 'DependentVartableIndex' = 2,'DependentVariableName' = 'analysis_period'},
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'dispatch_sched_weekday', 'DependentVartableIndex' = 0,'DependentVariableName' = 'dispatch_sched_weekday'}, // battery dispatch
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'dispatch_sched_weekday', 'DependentVartableIndex' = 2,'DependentVariableName' = 'dispatch_sched_weekday'}, // battery dispatch
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'dispatch_sched_weekend', 'DependentVartableIndex' = 0,'DependentVariableName' = 'dispatch_sched_weekend'}, // battery dispatch
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'dispatch_sched_weekend', 'DependentVartableIndex' = 2,'DependentVariableName' = 'dispatch_sched_weekend'}, // battery dispatch
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'dispatch_tod_factors', 'DependentVartableIndex' = 0,'DependentVariableName' = 'dispatch_tod_factors'}, // battery dispatch
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'dispatch_tod_factors', 'DependentVartableIndex' = 2,'DependentVariableName' = 'dispatch_tod_factors'}, // battery dispatch
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'grid_interconnection_limit_kwac', 'DependentVartableIndex' = 2,'DependentVariableName' = 'grid_interconnection_limit_kwac'}, // battery dispatch
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'inflation_rate', 'DependentVartableIndex' = 0,'DependentVariableName' = 'inflation_rate'},
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'inflation_rate', 'DependentVartableIndex' = 1,'DependentVariableName' = 'inflation_rate'},
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'inflation_rate', 'DependentVartableIndex' = 2,'DependentVariableName' = 'inflation_rate'},
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'ppa_escalation', 'DependentVartableIndex' = 0,'DependentVariableName' = 'ppa_escalation'}, // battery dispatch
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'ppa_escalation', 'DependentVartableIndex' = 2,'DependentVariableName' = 'ppa_escalation'}, // battery dispatch
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'ppa_multiplier_model', 'DependentVartableIndex' = 0,'DependentVariableName' = 'ppa_multiplier_model'}, // battery dispatch
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'ppa_multiplier_model', 'DependentVartableIndex' = 2,'DependentVariableName' = 'ppa_multiplier_model'}, // battery dispatch
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'ppa_price_input', 'DependentVartableIndex' = 0,'DependentVariableName' = 'ppa_price_input'}, // battery dispatch
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'ppa_price_input', 'DependentVartableIndex' = 2,'DependentVariableName' = 'ppa_price_input'}, // battery dispatch
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'sales_tax_rate', 'DependentVartableIndex' = 0,'DependentVariableName' = 'sales_tax_rate'},
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'sales_tax_rate', 'DependentVartableIndex' = 1,'DependentVariableName' = 'sales_tax_rate'},
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'sales_tax_rate', 'DependentVartableIndex' = 2,'DependentVariableName' = 'sales_tax_rate'},
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'system_capacity', 'DependentVartableIndex' = 2,'DependentVariableName' = 'hybrid_system_capacity'} // pv smoothing dispatch

]);
addpage([['Hybrid System']], {'sidebar'='Hybrid System', 'help'='hybrid_system', 'top_page'=true});
// detailed pv
addpage( [[ 'Solar Resource Data', {'name'='PV Albedo and Radiation', 'caption' = 'Albedo - Sky Diffuse Model - Irradiance Data (Advanced)', 'collapsible'=true, 'collapsible_var'='pv.radmode.is_shown'} ]], { 'sidebar'='PV Location and Resource', 'help'='pv_location_and_resource', 'bin_name'='Photovoltaic' } );
addpage( [ ['Simple Efficiency Module Model'], ['CEC Performance Model with Module Database'], ['CEC Performance Model with User Entered Specifications'], ['Sandia PV Array Performance Model with Module Database'], ['IEC61853 Single Diode Model'] ], { 'sidebar'='PV Module', 'help'='pv_module', 'exclusive_var'='module_model', 'bin_name'='Photovoltaic' } );
addpage( [ ['Inverter CEC Database', 'Inverter Temp Derate CEC DB'], ['Inverter Datasheet', 'Inverter Temp Derate DS'], ['Inverter Part Load Curve', 'Inverter Temp Derate PLC'], ['Inverter CEC Coefficient Generator', 'Inverter Temp Derate CEC CG'] ], { 'sidebar'='PV Inverter', 'help'='pv_inverter', 'exclusive_var'='inverter_model', 'bin_name'='Photovoltaic' } );
addpage( [ ['PV System Design', {'name'='PV Land Area', 'caption' = 'Land Area', 'collapsible'=true, 'collapsible_var'='pv_land_area_is_shown'}, {'name'='PV Subarray Voltage Mismatch', 'collapsible'=true, 'collapsible_var' = 'mismatch_shown'}, 'Battery Enable'] ], { 'sidebar'='PV System Design', 'help'='pv_system_design', 'bin_name'='Photovoltaic' } );
addpage( [ ['PV Shading'] ], { 'sidebar'='PV Shading and Layout', 'help'='pv_shading', 'bin_name'='Photovoltaic' } ); 
addpage( [ ['PV Losses'] ], { 'sidebar'='PV Losses', 'help'='pv_losses', 'bin_name'='Photovoltaic' } );
addpage( [ [ 'Degradation DC Lifetime', 'Degradation AC DC Lifetime Daily', 'Degradation Lifetime Variables'], ], { 'sidebar'='PV Degradation','help'='degradation_dc' , 'bin_name'='Photovoltaic' } );
addpage( [[ 'PV Capital Costs' ]], { 'sidebar'='PV Installation Costs', 'help'='cc_pv', 'bin_name'='Photovoltaic'} );
addpage( [[ 'Operating Costs', 'Operating Costs Land Lease' ]], {'sidebar' = 'PV Operating Costs', 'help'='oc_operating', 'bin_name'='Photovoltaic'} );
// wind
addpage( [[ 'Wind Resource File'], [ 'Wind Speed Weibull Distribution'], [ 'Wind Resource Probability Table']], { 'sidebar'='Wind Resource', 'exclusive_var'='wind_resource_model_choice', 'help'='wind_resource', 'bin_name'='Wind' } );
addpage( [[ 'Wind Turbine Design' ]], { 'sidebar'='Wind Turbine', 'help'='wind_turbine', 'bin_name'='Wind' } );
addpage( [[ 'Wind Farm Specifications' ]], { 'sidebar'='Wind Farm', 'help'='wind_farm', 'bin_name'='Wind' } );
addpage( [[ 'Wind Losses' ]], { 'sidebar'='Wind Losses', 'help'='wind_losses', 'bin_name'='Wind'} );
addpage( [[ 'Degradation AC Single Year'] ], { 'sidebar'='Wind AC Degradation','help'='degradation_ac', 'bin_name'='Wind'} );
addpage( [[ 'Wind Farm Costs']], { 'sidebar'='Wind Installation Costs', 'help'='cc_wind', 'bin_name'='Wind' } );
addpage( [[ 'Operating Costs' ]], {'sidebar' = 'Wind Operating Costs', 'help'='oc_operating', 'bin_name'='Wind'} );
// battery
setup_hybrid_battery_pages(FOM);
addpage( [[ 'Standalone Battery Costs' ]], { 'sidebar'='Battery Installation Costs', 'help'='cc_standalone_battery', 'bin_name'='Battery' } );
addpage( [[ 'Operating Costs Standalone Battery']], { 'sidebar'='Battery Operating Costs', 'help'='oc_battery', 'bin_name'='Battery' } );
// single owner
addpage([['Hybrid Costs']], {'sidebar'='Hybrid System Costs', 'help'='hybrid_system_costs', 'top_page'=true});

setup_single_owner_pages( );
setup_electricity_purchases();

////////////////////////////////////////////////////////////////////////////////
setconfig('Photovoltaic Wind Battery Hybrid', 'Host Developer' );
setmodules( ['pvsamv1', 'windpower', 'battery', 'grid', 'utilityrate5', 'host_developer']);
sethybridvariabledependencies([
{ 'IndependentVartableIndex' = 0,'IndependentVariableName' = 'solar_resource_file', 'DependentVartableIndex' = 2,'DependentVariableName' = 'solar_resource_file'}, // battery dispatch
{ 'IndependentVartableIndex' = 0,'IndependentVariableName' = 'system_capacity', 'DependentVartableIndex' = 3,'DependentVariableName' = 'pv_system_capacity'},
{ 'IndependentVartableIndex' = 0,'IndependentVariableName' = 'total_installed_cost', 'DependentVartableIndex' = 3,'DependentVariableName' = 'pv_total_installed_cost'},
{ 'IndependentVartableIndex' = 0,'IndependentVariableName' = 'total_inverter_capacity', 'DependentVartableIndex' = 3,'DependentVariableName' = 'total_inverter_capacity'},
{ 'IndependentVartableIndex' = 1,'IndependentVariableName' = 'system_capacity', 'DependentVartableIndex' = 3,'DependentVariableName' = 'wind_system_capacity'},
{ 'IndependentVartableIndex' = 1,'IndependentVariableName' = 'total_installed_cost', 'DependentVartableIndex' = 3,'DependentVariableName' = 'wind_total_installed_cost'},
{ 'IndependentVartableIndex' = 2,'IndependentVariableName' = 'batt_power_discharge_max_kwac', 'DependentVartableIndex' = 3,'DependentVariableName' = 'batt_power_discharge_max_kwac'},
{ 'IndependentVartableIndex' = 2,'IndependentVariableName' = 'batt_replacement_option', 'DependentVartableIndex' = 3,'DependentVariableName' = 'batt_replacement_option'}, // battery dispatch
{ 'IndependentVartableIndex' = 2,'IndependentVariableName' = 'system_capacity', 'DependentVartableIndex' = 3,'DependentVariableName' = 'battery_system_capacity'},
{ 'IndependentVartableIndex' = 2,'IndependentVariableName' = 'total_installed_cost', 'DependentVartableIndex' = 3,'DependentVariableName' = 'battery_total_installed_cost'}, 
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'analysis_period', 'DependentVartableIndex' = 0,'DependentVariableName' = 'analysis_period'},
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'analysis_period', 'DependentVartableIndex' = 1,'DependentVariableName' = 'analysis_period'},
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'analysis_period', 'DependentVartableIndex' = 2,'DependentVariableName' = 'analysis_period'},
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'dispatch_sched_weekday', 'DependentVartableIndex' = 2,'DependentVariableName' = 'dispatch_sched_weekday'}, // battery dispatch
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'dispatch_sched_weekend', 'DependentVartableIndex' = 2,'DependentVariableName' = 'dispatch_sched_weekend'}, // battery dispatch
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'dispatch_tod_factors', 'DependentVartableIndex' = 2,'DependentVariableName' = 'dispatch_tod_factors'}, // battery dispatch
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'inflation_rate', 'DependentVartableIndex' = 0,'DependentVariableName' = 'inflation_rate'},
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'inflation_rate', 'DependentVartableIndex' = 1,'DependentVariableName' = 'inflation_rate'},
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'inflation_rate', 'DependentVartableIndex' = 2,'DependentVariableName' = 'inflation_rate'},
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'load', 'DependentVartableIndex' = 2,'DependentVariableName' = 'load'}, // battery dispatch
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'load_escalation', 'DependentVartableIndex' = 2,'DependentVariableName' = 'load_escalation'}, // battery dispatch
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'ppa_escalation', 'DependentVartableIndex' = 2,'DependentVariableName' = 'ppa_escalation'}, // battery dispatch
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'ppa_multiplier_model', 'DependentVartableIndex' = 2,'DependentVariableName' = 'ppa_multiplier_model'}, // battery dispatch
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'ppa_price_input', 'DependentVartableIndex' = 2,'DependentVariableName' = 'ppa_price_input'}, // battery dispatch
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'sales_tax_rate', 'DependentVartableIndex' = 0,'DependentVariableName' = 'sales_tax_rate'},
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'sales_tax_rate', 'DependentVartableIndex' = 1,'DependentVariableName' = 'sales_tax_rate'},
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'sales_tax_rate', 'DependentVartableIndex' = 2,'DependentVariableName' = 'sales_tax_rate'}
]);
addpage([['Hybrid System']], {'sidebar'='Hybrid System', 'help'='hybrid_system', 'top_page'=true});
// detailed pv
addpage( [[ 'Solar Resource Data', {'name'='PV Albedo and Radiation', 'caption' = 'Albedo - Sky Diffuse Model - Irradiance Data (Advanced)', 'collapsible'=true, 'collapsible_var'='pv.radmode.is_shown'} ]], { 'sidebar'='Location and Resource', 'help'='pv_location_and_resource', 'bin_name'='Photovoltaic' } );
addpage( [ ['Simple Efficiency Module Model'], ['CEC Performance Model with Module Database'], ['CEC Performance Model with User Entered Specifications'], ['Sandia PV Array Performance Model with Module Database'], ['IEC61853 Single Diode Model'] ], { 'sidebar'='PV Module', 'help'='pv_module', 'exclusive_var'='module_model', 'bin_name'='Photovoltaic' } );
addpage( [ ['Inverter CEC Database', 'Inverter Temp Derate CEC DB'], ['Inverter Datasheet', 'Inverter Temp Derate DS'], ['Inverter Part Load Curve', 'Inverter Temp Derate PLC'], ['Inverter CEC Coefficient Generator', 'Inverter Temp Derate CEC CG'] ], { 'sidebar'='PV Inverter', 'help'='pv_inverter', 'exclusive_var'='inverter_model', 'bin_name'='Photovoltaic' } );
addpage( [ ['PV System Design', {'name'='PV Land Area', 'caption' = 'Land Area', 'collapsible'=true, 'collapsible_var'='pv_land_area_is_shown'}, {'name'='PV Subarray Voltage Mismatch', 'collapsible'=true, 'collapsible_var' = 'mismatch_shown'}, 'Battery Enable'] ], { 'sidebar'='PV System Design', 'help'='pv_system_design', 'bin_name'='Photovoltaic' } );
addpage( [ ['PV Shading'] ], { 'sidebar'='PV Shading and Layout', 'help'='pv_shading', 'bin_name'='Photovoltaic' } ); 
addpage( [ ['PV Losses'] ], { 'sidebar'='PV Losses', 'help'='pv_losses', 'bin_name'='Photovoltaic' } );
addpage( [ [ 'Degradation DC Lifetime', 'Degradation AC DC Lifetime Daily', 'Degradation Lifetime Variables'], ], { 'sidebar'='PV Degradation','help'='degradation_dc' , 'bin_name'='Photovoltaic' } );
addpage( [[ 'PV Capital Costs' ]], { 'sidebar'='PV Installation Costs', 'help'='cc_pv', 'bin_name'='Photovoltaic'} );
addpage( [[ 'Operating Costs', 'Operating Costs Land Lease' ]], {'sidebar' = 'PV Operating Costs', 'help'='oc_operating', 'bin_name'='Photovoltaic'} );
// wind
addpage( [[ 'Wind Resource File'], [ 'Wind Speed Weibull Distribution'], [ 'Wind Resource Probability Table']], { 'sidebar'='Wind Resource', 'exclusive_var'='wind_resource_model_choice', 'help'='wind_resource', 'bin_name'='Wind' } );
addpage( [[ 'Wind Turbine Design' ]], { 'sidebar'='Wind Turbine', 'help'='wind_turbine', 'bin_name'='Wind' } );
addpage( [[ 'Wind Farm Specifications' ]], { 'sidebar'='Wind Farm', 'help'='wind_farm', 'bin_name'='Wind' } );
addpage( [[ 'Wind Losses' ]], { 'sidebar'='Wind Losses', 'help'='wind_losses', 'bin_name'='Wind'} );
addpage( [[ 'Degradation AC Single Year'] ], { 'sidebar'='Wind AC Degradation','help'='degradation_ac', 'bin_name'='Wind'} );
addpage( [[ 'Wind Farm Costs']], { 'sidebar'='Wind Installation Costs', 'help'='cc_wind', 'bin_name'='Wind' } );
addpage( [[ 'Operating Costs' ]], {'sidebar' = 'Wind Operating Costs', 'help'='oc_operating', 'bin_name'='Wind'} );
// battery
setup_hybrid_battery_pages(BTM);
addpage( [[ 'Standalone Battery Costs', 'Battery Enable' ]],{ 'sidebar'='Battery Installation Costs', 'help'='cc_standalone_battery', 'bin_name'='Battery' } );
addpage( [[ 'Operating Costs Standalone Battery']],{ 'sidebar'='Battery Operating Costs', 'help'='oc_battery', 'bin_name'='Battery' } );
// host developer
setup_host_developer_pages(LOAD_SIMPLE);
addpage([['Hybrid Costs']], {'sidebar'='Hybrid System Costs', 'help'='hybrid_system_costs', 'top_page'=true});

//Generic System + PVWatts + Wind + Fuel Cell + Battery
setconfig('CustomGeneration PVWatts Wind FuelCell Battery Hybrid', 'Single Owner' );
setmodules( ['custom_generation', 'pvwattsv8', 'windpower', 'fuelcell', 'battery', 'grid', 'utilityrate5', 'singleowner']);
sethybridvariabledependencies([
{ 'IndependentVartableIndex' = 0,'IndependentVariableName' = 'system_capacity', 'DependentVartableIndex' = 5,'DependentVariableName' = 'customgeneration_system_capacity'},
{ 'IndependentVartableIndex' = 0,'IndependentVariableName' = 'total_installed_cost', 'DependentVartableIndex' = 5,'DependentVariableName' = 'customgeneration_total_installed_cost'},
{ 'IndependentVartableIndex' = 1,'IndependentVariableName' = 'ac_nameplate', 'DependentVartableIndex' = 5,'DependentVariableName' = 'ac_nameplate'},
{ 'IndependentVartableIndex' = 1,'IndependentVariableName' = 'solar_resource_file', 'DependentVartableIndex' = 4,'DependentVariableName' = 'solar_resource_file'}, // battery dispatch
{ 'IndependentVartableIndex' = 1,'IndependentVariableName' = 'total_installed_cost', 'DependentVartableIndex' = 5,'DependentVariableName' = 'pv_total_installed_cost'},
{ 'IndependentVartableIndex' = 0,'IndependentVariableName' = 'ui_step_minutes', 'DependentVartableIndex' = 4,'DependentVariableName' = 'generic_ui_step_minutes'}, // pv smoothing dispatch
{ 'IndependentVartableIndex' = 1,'IndependentVariableName' = 'ui_step_minutes', 'DependentVartableIndex' = 4,'DependentVariableName' = 'pv_ui_step_minutes'}, // pv smoothing dispatch
{ 'IndependentVartableIndex' = 2,'IndependentVariableName' = 'ui_step_minutes', 'DependentVartableIndex' = 4,'DependentVariableName' = 'wind_ui_step_minutes'}, // pv smoothing dispatch
{ 'IndependentVartableIndex' = 2,'IndependentVariableName' = 'system_capacity', 'DependentVartableIndex' = 5,'DependentVariableName' = 'wind_system_capacity'},
{ 'IndependentVartableIndex' = 2,'IndependentVariableName' = 'total_installed_cost', 'DependentVartableIndex' = 5,'DependentVariableName' = 'wind_total_installed_cost'},
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'fuelcell_power_nameplate', 'DependentVartableIndex' = 5,'DependentVariableName' = 'fuelcell_system_capacity'},
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'total_installed_cost', 'DependentVartableIndex' = 5,'DependentVariableName' = 'fuelcell_total_installed_cost'},
{ 'IndependentVartableIndex' = 4,'IndependentVariableName' = 'batt_power_discharge_max_kwac', 'DependentVartableIndex' = 5,'DependentVariableName' = 'batt_power_discharge_max_kwac'},
{ 'IndependentVartableIndex' = 4,'IndependentVariableName' = 'batt_replacement_option', 'DependentVartableIndex' = 4,'DependentVariableName' = 'batt_replacement_option'}, // battery replacements
{ 'IndependentVartableIndex' = 4,'IndependentVariableName' = 'system_capacity', 'DependentVartableIndex' = 5,'DependentVariableName' = 'battery_system_capacity'},
{ 'IndependentVartableIndex' = 4,'IndependentVariableName' = 'total_installed_cost', 'DependentVartableIndex' = 5,'DependentVariableName' = 'battery_total_installed_cost'},
{ 'IndependentVartableIndex' = 5,'IndependentVariableName' = 'analysis_period', 'DependentVartableIndex' = 0,'DependentVariableName' = 'analysis_period'},
{ 'IndependentVartableIndex' = 5,'IndependentVariableName' = 'analysis_period', 'DependentVartableIndex' = 1,'DependentVariableName' = 'analysis_period'},
{ 'IndependentVartableIndex' = 5,'IndependentVariableName' = 'analysis_period', 'DependentVartableIndex' = 2,'DependentVariableName' = 'analysis_period'},
{ 'IndependentVartableIndex' = 5,'IndependentVariableName' = 'analysis_period', 'DependentVartableIndex' = 3,'DependentVariableName' = 'analysis_period'},
{ 'IndependentVartableIndex' = 5,'IndependentVariableName' = 'analysis_period', 'DependentVartableIndex' = 4,'DependentVariableName' = 'analysis_period'},
{ 'IndependentVartableIndex' = 5,'IndependentVariableName' = 'dispatch_sched_weekday', 'DependentVartableIndex' = 4,'DependentVariableName' = 'dispatch_sched_weekday'}, // battery dispatch
{ 'IndependentVartableIndex' = 5,'IndependentVariableName' = 'dispatch_sched_weekend', 'DependentVartableIndex' = 4,'DependentVariableName' = 'dispatch_sched_weekend'}, // battery dispatch
{ 'IndependentVartableIndex' = 5,'IndependentVariableName' = 'dispatch_tod_factors', 'DependentVartableIndex' = 4,'DependentVariableName' = 'dispatch_tod_factors'}, // battery dispatch
{ 'IndependentVartableIndex' = 5,'IndependentVariableName' = 'grid_interconnection_limit_kwac', 'DependentVartableIndex' = 4,'DependentVariableName' = 'grid_interconnection_limit_kwac'}, // battery dispatch
{ 'IndependentVartableIndex' = 5,'IndependentVariableName' = 'inflation_rate', 'DependentVartableIndex' = 0,'DependentVariableName' = 'inflation_rate'},
{ 'IndependentVartableIndex' = 5,'IndependentVariableName' = 'inflation_rate', 'DependentVartableIndex' = 1,'DependentVariableName' = 'inflation_rate'},
{ 'IndependentVartableIndex' = 5,'IndependentVariableName' = 'inflation_rate', 'DependentVartableIndex' = 2,'DependentVariableName' = 'inflation_rate'},
{ 'IndependentVartableIndex' = 5,'IndependentVariableName' = 'inflation_rate', 'DependentVartableIndex' = 3,'DependentVariableName' = 'inflation_rate'},
{ 'IndependentVartableIndex' = 5,'IndependentVariableName' = 'inflation_rate', 'DependentVartableIndex' = 4,'DependentVariableName' = 'inflation_rate'},
{ 'IndependentVartableIndex' = 5,'IndependentVariableName' = 'ppa_escalation', 'DependentVartableIndex' = 4,'DependentVariableName' = 'ppa_escalation'}, // battery dispatch
{ 'IndependentVartableIndex' = 5,'IndependentVariableName' = 'ppa_multiplier_model', 'DependentVartableIndex' = 4,'DependentVariableName' = 'ppa_multiplier_model'}, // battery dispatch
{ 'IndependentVartableIndex' = 5,'IndependentVariableName' = 'ppa_price_input', 'DependentVartableIndex' = 4,'DependentVariableName' = 'ppa_price_input'}, // battery dispatch
{ 'IndependentVartableIndex' = 5,'IndependentVariableName' = 'sales_tax_rate', 'DependentVartableIndex' = 0,'DependentVariableName' = 'sales_tax_rate'},
{ 'IndependentVartableIndex' = 5,'IndependentVariableName' = 'sales_tax_rate', 'DependentVartableIndex' = 1,'DependentVariableName' = 'sales_tax_rate'},
{ 'IndependentVartableIndex' = 5,'IndependentVariableName' = 'sales_tax_rate', 'DependentVartableIndex' = 2,'DependentVariableName' = 'sales_tax_rate'},
{ 'IndependentVartableIndex' = 5,'IndependentVariableName' = 'sales_tax_rate', 'DependentVartableIndex' = 3,'DependentVariableName' = 'sales_tax_rate'},
{ 'IndependentVartableIndex' = 5,'IndependentVariableName' = 'sales_tax_rate', 'DependentVartableIndex' = 4,'DependentVariableName' = 'sales_tax_rate'},
{ 'IndependentVartableIndex' = 5,'IndependentVariableName' = 'system_capacity', 'DependentVartableIndex' = 4,'DependentVariableName' = 'hybrid_system_capacity'},
]);
addpage([['Hybrid System']], {'sidebar'='Hybrid System', 'help'='hybrid_system', 'top_page'=true});
//generic
addpage( [[ 'Custom Generation Plant' ]], { 'sidebar'='Custom Generation Profile' , 'help'='custom_generation_profile', 'bin_name'='CustomGeneration' } );
addpage( [[ 'Degradation AC Single Year'], ], { 'sidebar'='Custom Generation AC Degradation','help'='degradation_ac', 'bin_name'='CustomGeneration' } );
addpage( [[ 'Custom Generation Costs']],{ 'sidebar'='Custom Generation Installation Costs', 'help'='cc_custom_generation', 'bin_name'='CustomGeneration' } );
addpage( [[ 'Operating Costs Fuel' ]], {'sidebar' = 'Custom Generation Operating Costs', 'help'='oc_operating', 'bin_name'='CustomGeneration'} );
// pvwatts
addpage( [[ 'Solar Resource Data' ]], { 'sidebar'='PV Location and Resource', 'help'='pvwatts_location_and_resource', 'bin_name'='PVWatts' } );
addpage( [[ 'PVWatts', {'name'='PV Land Area', 'caption' = 'Land Area', 'collapsible'=true, 'collapsible_var'='pv_land_area_is_shown'}, {'name'='PVWatts Advanced Inputs', 'caption' = 'Advanced Inputs', 'collapsible'=true, 'collapsible_var'='pvwatts.advanced.is_shown'} ]], { 'sidebar'='PV System Design', 'help'='pvwatts_system_design', 'bin_name'='PVWatts' } );
addpage( [[ 'Degradation AC Single Year'], ], { 'sidebar'='PV AC Degradation','help'='degradation_ac', 'bin_name'='PVWatts' } );
addpage( [[ 'PV Capital Costs' ]], { 'sidebar'='PV Installation Costs', 'help'='cc_pv', 'bin_name'='PVWatts'} );
addpage( [[ 'Operating Costs', 'Operating Costs Land Lease' ]], {'sidebar' = 'PV Operating Costs', 'help'='oc_operating', 'bin_name'='PVWatts'} );
// wind
addpage( [[ 'Wind Resource File'], [ 'Wind Speed Weibull Distribution'], [ 'Wind Resource Probability Table']], { 'sidebar'='Wind Resource', 'exclusive_var'='wind_resource_model_choice', 'help'='wind_resource', 'bin_name'='Wind' } );
addpage( [[ 'Wind Turbine Design' ]], { 'sidebar'='Wind Turbine', 'help'='wind_turbine', 'bin_name'='Wind' } );
addpage( [[ 'Wind Farm Specifications' ]], { 'sidebar'='Wind Farm', 'help'='wind_farm', 'bin_name'='Wind' } );
addpage( [[ 'Wind Losses' ]], { 'sidebar'='Wind Losses', 'help'='wind_losses', 'bin_name'='Wind'} );
addpage( [[ 'Degradation AC Single Year'] ], { 'sidebar'='Wind AC Degradation','help'='degradation_ac', 'bin_name'='Wind'} );
addpage( [[ 'Wind Farm Costs']], { 'sidebar'='Wind Installation Costs', 'help'='cc_wind', 'bin_name'='Wind' } );
addpage( [[ 'Operating Costs' ]], {'sidebar' = 'Wind Operating Costs', 'help'='oc_operating', 'bin_name'='Wind'} );
//fuel cell
addpage( [[ 'Fuel Cell']], {'sidebar'='Fuel Cell', 'help'='fuelcell_fuel_cell', 'bin_name'='FuelCell'});
addpage( [[{'name'='AA Empty', 'caption'='Fixed Output'}], [{'name'='Fuel Cell Dispatch Manual', 'caption'='Manual'}], [{'name'='AA Empty', 'caption'='Input Dispatch'}]], { 'sidebar'='Fuel Cell Dispatch', 'help'='fuelcell_dispatch', 'exclusive_var' = 'fuelcell_dispatch_excl', 'exclusive_header_pages' = ['Fuel Cell Dispatch FOM'], 'exclusive_tabs'=true, 'exclusive_hide'=true, 'bin_name'='FuelCell'} );
addpage( [[ 'Fuel Cell Costs Hybrid' ]], { 'sidebar'='Fuel Cell Installation Costs', 'help'='cc_fuel_cell', 'bin_name'='FuelCell' } );
addpage( [[ 'Operating Costs Fuel Cell Hybrid' ]], { 'sidebar'='Fuel Cell Operating Costs', 'help'='oc_fuel_cell', 'bin_name'='FuelCell' } );
// battery
addpage( [['Battery Model', 'Battery Bank Sizing', 'Battery Current and Capacity', 'Battery Configuration', {'name'='Battery Voltage', 'caption'='Battery Voltage', 'collapsible'=true, 'collapsible_var'='battery_voltage_shown'}, {'name'='Battery Losses', 'caption'='Battery Losses', 'collapsible'=true, 'collapsible_var'='battery_losses_shown'}, {'name'='Battery Thermal', 'caption'='Battery Thermal', 'collapsible'=true, 'collapsible_var'='battery_thermal_shown'}, 'Battery Standalone Enable', ]], { 'sidebar'='Battery Cell and System', 'help'='battery_storage_fom', 'bin_name'='Battery'  } );
addpage( [[ {'name'='Battery Life Cycle Calendar', 'caption'='Calendar and Cycle Degradation'}], [{'name'='Battery Life Empty 1','caption'='Li-on NMC/Graphite Degradation'}], [{'name'='Battery Life Empty 2','caption'='Li-ion LMO/LTO Degradation'}]], {'sidebar'='Battery Life', 'help'='battery_life' , 'exclusive_var' = 'batt_life_excl', 'exclusive_header_pages' = ['Battery Replacements','Battery Life Options' ], 'exclusive_tabs' = true, 'exclusive_hide' = true, 'bin_name'='Battery'  } );
addpage( [[ {'name'='Battery Dispatch Automated FOM', 'caption'='Automated'} ], [{'name'='Battery Dispatch PV Smoothing', 'caption'='PV Smoothing'}], [ {'name'='Battery Dispatch Custom Time Series', 'caption'='Custom Time Series'} ], [ {'name'='Battery Dispatch Manual', 'caption'='Manual'}] ], { 'sidebar'='Battery Dispatch', 'help'='battery_dispatch_fom', 'exclusive_var' = 'batt_dispatch_excl', 'exclusive_header_pages' = ['Battery Dispatch Common', 'Battery Dispatch Options FOM'], 'exclusive_tabs'=true, 'exclusive_hide'=true, 'bin_name'='Battery'} );
addpage( [[ 'Standalone Battery Costs'/*, 'Battery Enable' set on battery dispatch automated fom*/ ]], { 'sidebar'='Battery Installation Costs', 'help'='cc_standalone_battery', 'bin_name'='Battery' } );
addpage( [[ 'Operating Costs Standalone Battery']], { 'sidebar'='Battery Operating Costs', 'help'='oc_battery', 'bin_name'='Battery' } );
// grid
setup_grid_limits_page();
// single owner
addpage([['Hybrid Costs']], {'sidebar'='Hybrid System Costs', 'help'='hybrid_system_costs', 'top_page'=true});
setup_single_owner_pages( );
setup_electricity_purchases();

setconfig('CustomGeneration PVWatts Wind FuelCell Battery Hybrid', 'Host Developer' );
setmodules( ['custom_generation', 'pvwattsv8', 'windpower', 'fuelcell', 'battery', 'grid', 'utilityrate5', 'thermalrate', 'host_developer']);
sethybridvariabledependencies([
{ 'IndependentVartableIndex' = 0,'IndependentVariableName' = 'system_capacity', 'DependentVartableIndex' = 5,'DependentVariableName' = 'customgeneration_system_capacity'},
{ 'IndependentVartableIndex' = 0,'IndependentVariableName' = 'total_installed_cost', 'DependentVartableIndex' = 5,'DependentVariableName' = 'customgeneration_total_installed_cost'},
{ 'IndependentVartableIndex' = 1,'IndependentVariableName' = 'ac_nameplate', 'DependentVartableIndex' = 5,'DependentVariableName' = 'ac_nameplate'},
{ 'IndependentVartableIndex' = 1,'IndependentVariableName' = 'dc_ac_ratio', 'DependentVartableIndex' = 5,'DependentVariableName' = 'dc_ac_ratio'},
{ 'IndependentVartableIndex' = 1,'IndependentVariableName' = 'solar_resource_file', 'DependentVartableIndex' = 4,'DependentVariableName' = 'solar_resource_file'}, // battery dispatch
{ 'IndependentVartableIndex' = 1,'IndependentVariableName' = 'system_capacity', 'DependentVartableIndex' = 4,'DependentVariableName' = 'pv_system_capacity'}, // pv smoothing dispatch
{ 'IndependentVartableIndex' = 1,'IndependentVariableName' = 'total_installed_cost', 'DependentVartableIndex' = 5,'DependentVariableName' = 'pv_total_installed_cost'},
{ 'IndependentVartableIndex' = 1,'IndependentVariableName' = 'ui_step_minutes', 'DependentVartableIndex' = 4,'DependentVariableName' = 'ui_step_minutes'}, // pv smoothing dispatch
{ 'IndependentVartableIndex' = 2,'IndependentVariableName' = 'system_capacity', 'DependentVartableIndex' = 5,'DependentVariableName' = 'wind_system_capacity'},
{ 'IndependentVartableIndex' = 2,'IndependentVariableName' = 'total_installed_cost', 'DependentVartableIndex' = 5,'DependentVariableName' = 'wind_total_installed_cost'},
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'fuelcell_power_nameplate', 'DependentVartableIndex' = 5,'DependentVariableName' = 'fuelcell_system_capacity'},
{ 'IndependentVartableIndex' = 3,'IndependentVariableName' = 'total_installed_cost', 'DependentVartableIndex' = 5,'DependentVariableName' = 'fuelcell_total_installed_cost'},
{ 'IndependentVartableIndex' = 4,'IndependentVariableName' = 'batt_power_discharge_max_kwac', 'DependentVartableIndex' = 5,'DependentVariableName' = 'batt_power_discharge_max_kwac'},
{ 'IndependentVartableIndex' = 4,'IndependentVariableName' = 'batt_replacement_option', 'DependentVartableIndex' = 4,'DependentVariableName' = 'batt_replacement_option'}, // battery replacements
{ 'IndependentVartableIndex' = 4,'IndependentVariableName' = 'system_capacity', 'DependentVartableIndex' = 5,'DependentVariableName' = 'battery_system_capacity'},
{ 'IndependentVartableIndex' = 4,'IndependentVariableName' = 'total_installed_cost', 'DependentVartableIndex' = 5,'DependentVariableName' = 'battery_total_installed_cost'},
{ 'IndependentVartableIndex' = 5,'IndependentVariableName' = 'analysis_period', 'DependentVartableIndex' = 0,'DependentVariableName' = 'analysis_period'},
{ 'IndependentVartableIndex' = 5,'IndependentVariableName' = 'analysis_period', 'DependentVartableIndex' = 1,'DependentVariableName' = 'analysis_period'},
{ 'IndependentVartableIndex' = 5,'IndependentVariableName' = 'analysis_period', 'DependentVartableIndex' = 2,'DependentVariableName' = 'analysis_period'},
{ 'IndependentVartableIndex' = 5,'IndependentVariableName' = 'analysis_period', 'DependentVartableIndex' = 3,'DependentVariableName' = 'analysis_period'},
{ 'IndependentVartableIndex' = 5,'IndependentVariableName' = 'analysis_period', 'DependentVartableIndex' = 4,'DependentVariableName' = 'analysis_period'},
{ 'IndependentVartableIndex' = 5,'IndependentVariableName' = 'dispatch_sched_weekday', 'DependentVartableIndex' = 4,'DependentVariableName' = 'dispatch_sched_weekday'}, // battery dispatch
{ 'IndependentVartableIndex' = 5,'IndependentVariableName' = 'dispatch_sched_weekend', 'DependentVartableIndex' = 4,'DependentVariableName' = 'dispatch_sched_weekend'}, // battery dispatch
{ 'IndependentVartableIndex' = 5,'IndependentVariableName' = 'dispatch_tod_factors', 'DependentVartableIndex' = 4,'DependentVariableName' = 'dispatch_tod_factors'}, // battery dispatch
{ 'IndependentVartableIndex' = 5,'IndependentVariableName' = 'grid_interconnection_limit_kwac', 'DependentVartableIndex' = 4,'DependentVariableName' = 'grid_interconnection_limit_kwac'}, // battery dispatch
{ 'IndependentVartableIndex' = 5,'IndependentVariableName' = 'inflation_rate', 'DependentVartableIndex' = 0,'DependentVariableName' = 'inflation_rate'},
{ 'IndependentVartableIndex' = 5,'IndependentVariableName' = 'inflation_rate', 'DependentVartableIndex' = 1,'DependentVariableName' = 'inflation_rate'},
{ 'IndependentVartableIndex' = 5,'IndependentVariableName' = 'inflation_rate', 'DependentVartableIndex' = 2,'DependentVariableName' = 'inflation_rate'},
{ 'IndependentVartableIndex' = 5,'IndependentVariableName' = 'inflation_rate', 'DependentVartableIndex' = 3,'DependentVariableName' = 'inflation_rate'},
{ 'IndependentVartableIndex' = 5,'IndependentVariableName' = 'inflation_rate', 'DependentVartableIndex' = 4,'DependentVariableName' = 'inflation_rate'},
{ 'IndependentVartableIndex' = 5,'IndependentVariableName' = 'load', 'DependentVartableIndex' = 4,'DependentVariableName' = 'load'}, // battery dispatch
{ 'IndependentVartableIndex' = 5,'IndependentVariableName' = 'load_escalation', 'DependentVartableIndex' = 4,'DependentVariableName' = 'load_escalation'}, // battery dispatch
{ 'IndependentVartableIndex' = 5,'IndependentVariableName' = 'ppa_escalation', 'DependentVartableIndex' = 4,'DependentVariableName' = 'ppa_escalation'}, // battery dispatch
{ 'IndependentVartableIndex' = 5,'IndependentVariableName' = 'ppa_multiplier_model', 'DependentVartableIndex' = 4,'DependentVariableName' = 'ppa_multiplier_model'}, // battery dispatch
{ 'IndependentVartableIndex' = 5,'IndependentVariableName' = 'ppa_price_input', 'DependentVartableIndex' = 4,'DependentVariableName' = 'ppa_price_input'}, // battery dispatch
{ 'IndependentVartableIndex' = 5,'IndependentVariableName' = 'sales_tax_rate', 'DependentVartableIndex' = 0,'DependentVariableName' = 'sales_tax_rate'},
{ 'IndependentVartableIndex' = 5,'IndependentVariableName' = 'sales_tax_rate', 'DependentVartableIndex' = 1,'DependentVariableName' = 'sales_tax_rate'},
{ 'IndependentVartableIndex' = 5,'IndependentVariableName' = 'sales_tax_rate', 'DependentVartableIndex' = 2,'DependentVariableName' = 'sales_tax_rate'},
{ 'IndependentVartableIndex' = 5,'IndependentVariableName' = 'sales_tax_rate', 'DependentVartableIndex' = 3,'DependentVariableName' = 'sales_tax_rate'},
{ 'IndependentVartableIndex' = 5,'IndependentVariableName' = 'sales_tax_rate', 'DependentVartableIndex' = 4,'DependentVariableName' = 'sales_tax_rate'}
]);
addpage([['Hybrid System']], {'sidebar'='Hybrid System', 'help'='hybrid_system', 'top_page'=true});
//generic
addpage( [[ 'Custom Generation Plant' ]], { 'sidebar'='Custom Generation Profile' , 'help'='custom_generation_profile', 'bin_name'='CustomGeneration' } );
addpage( [[ 'Degradation AC Single Year'], ], { 'sidebar'='Generic AC Degradation','help'='degradation_ac', 'bin_name'='CustomGeneration' } );
addpage( [[ 'Custom Generation Costs']],{ 'sidebar'='Custom Generation Installation Costs', 'help'='cc_custom_generation', 'bin_name'='CustomGeneration' } );
addpage( [[ 'Operating Costs Fuel' ]], {'sidebar' = 'Custom Generation Operating Costs', 'help'='oc_operating', 'bin_name'='CustomGeneration'} );
// pvwatts
addpage( [[ 'Solar Resource Data' ]], { 'sidebar'='PV Location and Resource', 'help'='pvwatts_location_and_resource', 'bin_name'='PVWatts' } );
addpage( [[ 'PVWatts', {'name'='PV Land Area', 'caption' = 'Land Area', 'collapsible'=true, 'collapsible_var'='pv_land_area_is_shown'}, {'name'='PVWatts Advanced Inputs', 'caption' = 'Advanced Inputs', 'collapsible'=true, 'collapsible_var'='pvwatts.advanced.is_shown'} ]], { 'sidebar'='PV System Design', 'help'='pvwatts_system_design', 'bin_name'='PVWatts' } );
addpage( [[ 'Degradation AC Single Year'], ], { 'sidebar'='PV AC Degradation','help'='degradation_ac', 'bin_name'='PVWatts' } );
addpage( [[ 'PV Capital Costs' ]], { 'sidebar'='PV Installation Costs', 'help'='cc_pv', 'bin_name'='PVWatts'} );
addpage( [[ 'Operating Costs', 'Operating Costs Land Lease' ]], {'sidebar' = 'PV Operating Costs', 'help'='oc_operating', 'bin_name'='PVWatts'} );
// wind
addpage( [[ 'Wind Resource File'], [ 'Wind Speed Weibull Distribution'], [ 'Wind Resource Probability Table']], { 'sidebar'='Wind Resource', 'exclusive_var'='wind_resource_model_choice', 'help'='wind_resource', 'bin_name'='Wind' } );
addpage( [[ 'Wind Turbine Design' ]], { 'sidebar'='Wind Turbine', 'help'='wind_turbine', 'bin_name'='Wind' } );
addpage( [[ 'Wind Farm Specifications' ]], { 'sidebar'='Wind Farm', 'help'='wind_farm', 'bin_name'='Wind' } );
addpage( [[ 'Wind Losses' ]], { 'sidebar'='Wind Losses', 'help'='wind_losses', 'bin_name'='Wind'} );
addpage( [[ 'Degradation AC Single Year'] ], { 'sidebar'='Wind AC Degradation','help'='degradation_ac', 'bin_name'='Wind'} );
addpage( [[ 'Wind Farm Costs']], { 'sidebar'='Wind Installation Costs', 'help'='cc_wind', 'bin_name'='Wind' } );
addpage( [[ 'Operating Costs' ]], {'sidebar' = 'Wind Operating Costs', 'help'='oc_operating', 'bin_name'='Wind'} );
//fuel cell
addpage( [[ 'Fuel Cell']], {'sidebar'='Fuel Cell', 'help'='fuelcell_fuel_cell', 'bin_name'='FuelCell'});
addpage( [[ {'name'='AA Empty', 'caption'='Fixed Output'} ], [ {'name'='AA Empty', 'caption'='Follow Electric Load'} ], [ {'name'='Fuel Cell Dispatch Manual', 'caption'='Manual Dispatch'} ], [ {'name'='AA Empty', 'caption'='Input Dispatch'}] ], { 'sidebar'='Fuel Cell Dispatch', 'help'='fuelcell_dispatch', 'exclusive_var' = 'fuelcell_dispatch_excl', 'exclusive_header_pages' = ['Fuel Cell Dispatch BTM'], 'exclusive_tabs'=true, 'exclusive_hide'=true, 'bin_name'='FuelCell'} );
addpage( [[ 'Fuel Cell Costs Hybrid' ]], { 'sidebar'='Fuel Cell Installation Costs', 'help'='cc_fuel_cell', 'bin_name'='FuelCell' } );
addpage( [[ 'Operating Costs Fuel Cell Hybrid' ]], { 'sidebar'='Fuel Cell Operating Costs', 'help'='oc_fuel_cell', 'bin_name'='FuelCell' } );
// battery
addpage( [[ 'Battery Model', 'Battery Bank Sizing', 'Battery Current and Capacity', 'Battery Configuration', {'name'='Battery Voltage', 'caption'='Battery Voltage', 'collapsible'=true, 'collapsible_var'='battery_voltage_shown'}, {'name'='Battery Losses', 'caption'='Battery Losses', 'collapsible'=true, 'collapsible_var'='battery_losses_shown'}, {'name'='Battery Thermal', 'caption'='Battery Thermal', 'collapsible'=true, 'collapsible_var'='battery_thermal_shown'}, 'Battery Standalone Enable', ]], { 'sidebar'='Battery Cell and System', 'help'='battery_storage_btm', 'bin_name'='Battery'  } );
addpage( [[ {'name'='Battery Life Cycle Calendar', 'caption'='Calendar and Cycle Degradation'}], [{'name'='Battery Life Empty 1','caption'='Li-on NMC/Graphite Degradation'}], [{'name'='Battery Life Empty 2','caption'='Li-ion LMO/LTO Degradation'}]], {'sidebar'='Battery Life', 'help'='battery_life' , 'exclusive_var' = 'batt_life_excl', 'exclusive_header_pages' = ['Battery Replacements','Battery Life Options' ], 'exclusive_tabs' = true, 'exclusive_hide' = true, 'bin_name'='Battery'  } );
addpage( [[ {'name'='Battery Dispatch Peak Shaving BTM', 'caption'='Peak Shaving'} ], [ {'name'='Battery Dispatch Grid Power Targets', 'caption'='Grid Power Targets'} ], [ {'name'='Battery Dispatch Battery Power Targets', 'caption'='Battery Power Targets'}], [ {'name'='Battery Dispatch Manual', 'caption'='Manual'}], [ {'name'='Battery Dispatch Retail Rate', 'caption'='Retail Rate'} ], [ {'name'='Battery Dispatch Self Consumption', 'caption'='Self Consumption'} ]], { 'sidebar'='Battery Dispatch', 'help'='battery_dispatch_btm', 'exclusive_var' = 'batt_dispatch_excl', 'exclusive_header_pages' = ['Battery Dispatch Common', 'Battery Dispatch Options BTM'], 'exclusive_tabs'=true, 'exclusive_hide'=true, 'bin_name'='Battery' } );
addpage( [[ 'Standalone Battery Costs', 'Battery Enable' ]],{ 'sidebar'='Battery Installation Costs', 'help'='cc_standalone_battery', 'bin_name'='Battery' } );
addpage( [[ 'Operating Costs Standalone Battery']],{ 'sidebar'='Battery Operating Costs', 'help'='oc_battery', 'bin_name'='Battery' } );
// grid
setup_grid_limits_page();
setup_grid_outage_page();// host developer
// host developer
setup_host_developer_pages(LOAD_SIMPLE);
addpage( [[ 'Thermal Rate' ]], 
         {'sidebar' = 'Thermal Rates','help' = 'thermal_rates'});
addpage( [[ 'Thermal Load' ]], 
         {'sidebar' = 'Thermal Load','help' = 'thermal_load'});
addpage([['Hybrid Costs']], {'sidebar'='Hybrid System Costs', 'help'='hybrid_system_costs', 'top_page'=true});
